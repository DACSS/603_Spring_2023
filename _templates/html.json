{
  "hash": "fa0b0346978ca5669915c30598b24536",
  "result": {
    "markdown": "---\ntitle: \"Homework 1\"\nauthor: \"Felix Betanourt\"\ndesription: \"DACSS 603 HW1\"\ndate: \"02/24/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw1\n  - density\n  - probability distribution\n  - descriptives\n  - visualization\n  - ggplot2\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE, warning = FALSE)\n```\n:::\n\n\n\n\n## Homework 1\nDACSS 603, Spring 2023\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Loading packages\n\nsuppressPackageStartupMessages(library(dplyr))\nsuppressPackageStartupMessages(library(tidyverse))\nlibrary(formattable)\nsuppressPackageStartupMessages(library(kableExtra))\nlibrary(ggplot2)\nlibrary(readxl)\n\n# Setting working directory and loading dataset.\n\nsetwd(\"C:/Users/fbeta/OneDrive/1_UMASS_DACSS/603 - Quantittative/603_Spring_2023/posts/_data\")\n\nlung <- read_excel(\"LungCapData.xls\")\n```\n:::\n\n\n## Part A - Lung Capacity Dataset\n\nLet's first explore the database\n\nStructure\n\n::: {.cell}\n\n```{.r .cell-code}\nstr(lung)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [725 × 6] (S3: tbl_df/tbl/data.frame)\n $ LungCap  : num [1:725] 6.47 10.12 9.55 11.12 4.8 ...\n $ Age      : num [1:725] 6 18 16 14 5 11 8 11 15 11 ...\n $ Height   : num [1:725] 62.1 74.7 69.7 71 56.9 58.7 63.3 70.4 70.5 59.2 ...\n $ Smoke    : chr [1:725] \"no\" \"yes\" \"no\" \"no\" ...\n $ Gender   : chr [1:725] \"male\" \"female\" \"female\" \"male\" ...\n $ Caesarean: chr [1:725] \"no\" \"no\" \"yes\" \"no\" ...\n```\n:::\n:::\n\n\nSummary\n\n::: {.cell}\n\n```{.r .cell-code}\nLC_table1 <- summary(lung)\nprint(LC_table1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    LungCap            Age            Height         Smoke          \n Min.   : 0.507   Min.   : 3.00   Min.   :45.30   Length:725        \n 1st Qu.: 6.150   1st Qu.: 9.00   1st Qu.:59.90   Class :character  \n Median : 8.000   Median :13.00   Median :65.40   Mode  :character  \n Mean   : 7.863   Mean   :12.33   Mean   :64.84                     \n 3rd Qu.: 9.800   3rd Qu.:15.00   3rd Qu.:70.30                     \n Max.   :14.675   Max.   :19.00   Max.   :81.80                     \n    Gender           Caesarean        \n Length:725         Length:725        \n Class :character   Class :character  \n Mode  :character   Mode  :character  \n                                      \n                                      \n                                      \n```\n:::\n:::\n\n\n### a) What does the distribution of LungCap look like?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Density histogram\nhist(lung$LungCap, freq = FALSE, col=\"white\", main = \"Histogram of Probability Density for Lung Capacity\", xlab = \"Values\", ylab = \"Density\")\nlines(density(lung$LungCap), col = \"blue\", lwd = 2)\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_HW1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\nDistribution looks like a normal distribution, most of the observation close to the mean and a few cases close to the extrems (0.5 and 14.6).\n\n### b) Compare the probability distribution of the LungCap with respect to Males and Females? (Hint: make boxplots separated by gender using the boxplot() function)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbox_plot_crop<-ggplot(data=lung, aes(x=Gender, y=LungCap, fill=Gender)) \nbox_plot_crop+ geom_boxplot() +\n  theme(legend.position = \"right\") +\n  theme (axis.text.x=element_blank(),\n        axis.ticks.x=element_blank())+\n  coord_cartesian(ylim =  c(0, 15))+\n  labs(title=\"Box Plot - Lung Capacity\",\n        x =\"Gender\", y = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_HW1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressPackageStartupMessages (library(hrbrthemes))\nsuppressPackageStartupMessages (library(viridis))\n\nGender_d <- ggplot(data=lung, aes(x=LungCap, group=Gender, fill=Gender)) +\n    geom_density(adjust=1.5, alpha=.4) +\n    theme_ipsum()\nGender_d\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_HW1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nLC_table <- lung %>%  \n group_by(Gender) %>%\n  summarise(N = n(), LC.Mean = mean(LungCap, na.rm=TRUE), LC.Median = median(LungCap, na.rm=TRUE), LC.SD = sd(LungCap, na.rm=TRUE))\n  \nLC_table_o <- LC_table[with (LC_table, order(-LC.Mean)),]\nformattable(LC_table_o) %>% \n  kable(\"html\", escape = F, caption = \"Summary of Lung Capacity Grouped by Gender\", align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\")) %>% \n  kable_classic(full_width = F, html_font = \"Cambria\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Summary of Lung Capacity Grouped by Gender</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Gender </th>\n   <th style=\"text-align:center;\"> N </th>\n   <th style=\"text-align:center;\"> LC.Mean </th>\n   <th style=\"text-align:center;\"> LC.Median </th>\n   <th style=\"text-align:center;\"> LC.SD </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> male </td>\n   <td style=\"text-align:center;\"> 367 </td>\n   <td style=\"text-align:center;\"> 8.309332 </td>\n   <td style=\"text-align:center;\"> 8.35 </td>\n   <td style=\"text-align:center;\"> 2.683238 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> female </td>\n   <td style=\"text-align:center;\"> 358 </td>\n   <td style=\"text-align:center;\"> 7.405746 </td>\n   <td style=\"text-align:center;\"> 7.75 </td>\n   <td style=\"text-align:center;\"> 2.564242 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\nIt was not possible for me to plot a Box Plot with Density like I did for Histogram but I was able to plot separately the Box Plot and Density. It seems that the distribution for the two genders are similar while the Male distribution shows a bit higher average lung capacity.\n\n### c. Compare the mean lung capacities for smokers and non-smokers. Does it make sense?\n\n\nLet's visualize the differences\n\n::: {.cell}\n\n```{.r .cell-code}\nbox_plot_crop <- ggplot(data=lung, aes(x=Smoke, y=LungCap, fill=Smoke)) \nbox_plot_crop+ geom_boxplot() +\n  theme(legend.position = \"right\") +\n  theme (axis.text.x=element_blank(),\n        axis.ticks.x=element_blank())+\n  coord_cartesian(ylim =  c(0, 15))+\n  labs(title=\"Box Plot - Lung Capacity\",\n        x =\"Smoke\", y = \"Density\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_HW1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\nNow let's see the specific numbers in this summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\nLC_table_s <- lung %>%  \n group_by(Smoke) %>%\n  summarise(N = n(), LC.Mean = mean(LungCap, na.rm=TRUE), LC.Median = median(LungCap, na.rm=TRUE), LC.SD = sd(LungCap, na.rm=TRUE))\n\nLC_table_s2 <- LC_table_s[with (LC_table_s, order(-LC.Mean)),]\nformattable(LC_table_s2) %>% \n  kable(\"html\", escape = F, caption = \"Summary of Lung Capacity Grouped by Smoker\", align = c(\"l\", \"c\", \"c\", \"c\", \"c\", \"c\")) %>% \n  kable_classic(full_width = F, html_font = \"Cambria\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style=\"font-family: Cambria; width: auto !important; margin-left: auto; margin-right: auto;\">\n<caption>Summary of Lung Capacity Grouped by Smoker</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Smoke </th>\n   <th style=\"text-align:center;\"> N </th>\n   <th style=\"text-align:center;\"> LC.Mean </th>\n   <th style=\"text-align:center;\"> LC.Median </th>\n   <th style=\"text-align:center;\"> LC.SD </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> yes </td>\n   <td style=\"text-align:center;\"> 77 </td>\n   <td style=\"text-align:center;\"> 8.645454 </td>\n   <td style=\"text-align:center;\"> 8.65 </td>\n   <td style=\"text-align:center;\"> 1.882894 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> no </td>\n   <td style=\"text-align:center;\"> 648 </td>\n   <td style=\"text-align:center;\"> 7.770188 </td>\n   <td style=\"text-align:center;\"> 7.90 </td>\n   <td style=\"text-align:center;\"> 2.726113 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\nSeems that smokers has more lung capacity than non-smokers, and I would expect the opposite. It is interesting to note that the lung capacity in smokers is more homogeneous distribution (lower SD) compared to non-smokers, even though the number of smokers is significantly smaller than  non-smokers.\n\n\n### d. Examine the relationship between Smoking and Lung Capacity within age groups: “less than or equal to 13”, “14 to 15”, “16 to 17”, and “greater than or equal to 18”.\n\n### e. Compare the lung capacities for smokers and non-smokers within each age group. Is your answer different from the one in part c. What could possibly be going on here?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# First, let's create the categories for age\n\nlung2 <-lung %>%\n  mutate(Age_Cat = case_when(\n        Age >= 0 & Age <= 13 ~ \"13 or less\",\n        Age >= 14 & Age <= 15 ~ \"14 to 15\" ,\n        Age >= 16 & Age <= 17 ~ \"16 to 17\" ,\n        Age >= 18 ~ \"18 or more\" ,\n        ))\n\nbox_plot_crop2<-ggplot(data=lung2, aes(x=Smoke, y=LungCap, fill=Smoke)) \nbox_plot_crop2+ geom_boxplot() +\n  theme(legend.position = \"right\") +\n  theme (axis.text.x=element_blank(),\n        axis.ticks.x=element_blank())+\n  coord_cartesian(ylim =  c(0, 15))+\n  labs(title=\"Box Plot - Lung Capacity\",\n        x =\"Smoke\", y = \"Density\")+\n  facet_wrap(.~Age_Cat, scales= \"free\")\n```\n\n::: {.cell-output-display}\n![](FelixBetancourt_HW1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nFrom this graph I can note the following:\n\n  1. Except for the group of 13 or less, non-smokers shows higher lung capacity compared with smokers.\n  \n  2. On the other hand, seems that the Lung Capacity increases with the years regardless the smoke condition.\n\nLet's see more detailed numbers. I want to see the Lung Capacity Means and dispersion for each group. for this we will do a crosstab showing n, mean, median and sd.\n\n\n\nFirst let's see the frequencies for both variables in a crosstab.\n\n::: {.cell}\n\n```{.r .cell-code}\nxtabs(~Age_Cat+Smoke, data=lung2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Smoke\nAge_Cat       no yes\n  13 or less 401  27\n  14 to 15   105  15\n  16 to 17    77  20\n  18 or more  65  15\n```\n:::\n:::\n\n\nMean Lung Capacity by Age Group and Smoke condition\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(lung2, tapply(LungCap, list(Age_Group=Age_Cat,Smoker=Smoke), mean) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Smoker\nAge_Group           no       yes\n  13 or less  6.358746  7.201852\n  14 to 15    9.138810  8.391667\n  16 to 17   10.469805  9.383750\n  18 or more 11.068846 10.513333\n```\n:::\n:::\n\n\nMedian Lung Capacity by Age Group and Smoke condition\n\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(lung2, tapply(LungCap, list(Age_Group=Age_Cat,Smoker=Smoke), median) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Smoker\nAge_Group        no    yes\n  13 or less  6.575  7.025\n  14 to 15    9.000  8.475\n  16 to 17   10.600  9.550\n  18 or more 10.850 10.475\n```\n:::\n:::\n\n\nStandard Deviation Lung Capacity by Age Group and Smoke condition\n\n::: {.cell}\n\n```{.r .cell-code}\nwith(lung2, tapply(LungCap, list(Age_Group=Age_Cat,Smoker=Smoke), sd) )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Smoker\nAge_Group          no      yes\n  13 or less 2.214412 1.577728\n  14 to 15   1.546130 1.437497\n  16 to 17   1.536745 1.326136\n  18 or more 1.555139 1.250959\n```\n:::\n:::\n\n\nClearly the lung capacity is higher for non smokers within each age group except 13 or less years old group, where the smoker's mean (and median) is higher than non-smokers.\n\nAs noted before it is also clear that the lung capacity increases with the age regardless the smoke condition. \n\nHowever it is interesting to note that:\n\na. The number of cases in the group 13 or less is aout the 50% of the whole sample. So it is explaining the findings in the question part \"c\" above (higher overall Lung Capacity average for smokers).\n\nb. The lung capacity makes a bigger jump for non-smokers from 13 or less to the next bracket (14-15 years) compared to smokers. In other words, non-smokers close the gap and exceed smokers when they pass the 13 years. \n\nIt seems that smoking in early ages affects lungs capacity and making it falling behind consistently from non-smokers as getting older.\n\n## Part B - Let X = number of prior convictions for prisoners at a state prison at which there are 810 prisoners.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create the frequency table\nconvicted <- data.frame(\n  p_convic = c(0, 1, 2, 3, 4),\n  freq = c(128, 434, 160, 64, 24))\n```\n:::\n\n\n\nFrequency Table and Cumulative Frequency Table:\n\n::: {.cell}\n\n```{.r .cell-code}\nconv.tbl <- xtabs(freq ~ p_convic, data=convicted)\nprint (conv.tbl)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\np_convic\n  0   1   2   3   4 \n128 434 160  64  24 \n```\n:::\n\n```{.r .cell-code}\ncumfreq_data <- cumsum(conv.tbl)\nprint (cumfreq_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  0   1   2   3   4 \n128 562 722 786 810 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# \nprob_data <- conv.tbl/810\n\nprob_data2 <- as.vector(prob_data)\nprob_data3 <- data.frame (\n  p_convic = c(convicted$p_convic),\n  prob = c(prob_data2))\n```\n:::\n\n\n### a) What is the probability that a randomly selected inmate has exactly 2 prior convictions?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(prob_data3[which(prob_data3$p_convic == 2), 2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.1975309\n```\n:::\n:::\n\n\nThe Probability is 19.7% \n\n\n### b) What is the probability that a randomly selected inmate has fewer than 2 prior convictions?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(prob_data3[which(prob_data3$p_convic < 2), 2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6938272\n```\n:::\n:::\n\n\nThe Probability is 69.3% \n\n\n### c) What is the probability that a randomly selected inmate has 2 or fewer prior convictions?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(prob_data3[which(prob_data3$p_convic <= 2), 2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.891358\n```\n:::\n:::\n\n\nThe Probability is 89.1%\n\n### d) What is the probability that a randomly selected inmate has more than 2 prior convictions?\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum(prob_data3[which(prob_data3$p_convic > 2), 2])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.108642\n```\n:::\n:::\n\n\nThe Probability is 10.8%\n\n### e) What is the expected value for the number of prior convictions?\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_convic2 <- as.vector(convicted$p_convic)\nconvicted_prob <- as.vector(prob_data)\n\nExpected_mean <- sum(p_convic2*convicted_prob)\nExpected_mean\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.28642\n```\n:::\n:::\n\nThe long term mean for prior convictions is 1.29\n\n\n### f) Calculate the variance and the standard deviation for the Prior Convictions.\n\n\nVariance\n\n::: {.cell}\n\n```{.r .cell-code}\n#Variance\n\nVar_c <- var(rep(convicted$p_convic, convicted$freq))\nVar_c\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8572937\n```\n:::\n:::\n\n\nStandard Deviation\n\n\n::: {.cell}\n\n```{.r .cell-code}\nSD_c <- sd(rep(convicted$p_convic, convicted$freq))\nSD_c\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9259016\n```\n:::\n:::\n",
    "supporting": [
      "FelixBetancourt_HW1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}