{
  "hash": "315ba321ded354d1e0a819caeffb838c",
  "result": {
    "markdown": "---\ntitle: \"Final Project checkin 5\"\nauthor: \"Diana Rinker\"\ndescription: \"Final project DACSS 603\"\ndate: \"5/9/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\neditor: \n  markdown: \n    wrap: 72\neditor_options: \n  chunk_output_type: console\n---\n\n\n## DACSS 603, spring 2023\n\n## Final Project check-in 5, Diana Rinker.\n\n# Introduction. Online engagement\n\nIt is well known that online engagement with the web resource is a\nhighly valuable metric and is contributing to the site revenue. This\nresearch project is exploring which factors contribute to users online\nengagement. To do that I will use the data of an online blog on the news\nwebsite. The author of this blog is posting articles about interpersonal\nrelationships every work day (Mon- Fri). The posts are formulated as a\nletter from a reader with the situation and a question about\nrelationships. The author gives an advice about the situation. Website\nreaders are free to comment under each post, but cannot make their own\nposts.\n\nAll post methadata and comments are public. They are saved by the\nwebsite and available for the analysis. Using this data set, I will\nexplore how readers' engagement connected with blogs's author\nengagement, site comments', web source of readers and negative behaviors\nonline.\n\n# Research Question and hypothesis.\n\n**RQ:** Which factors influence user's engagement in online blog?\n\n\n**DV:** My dependent construct is **\"user's engagement**\", I will\nmeasure users' engagement at the level of individual post, using the\nfollowing metrics:\n\n1\\. Exit rate or \"bounces\". When the visitor is coming to the page and\nthen leaving, i.e. not opening other pages on this website. this will\nrepresent all readers.\n\n2\\. Number of comments - is engagement metric, representing only loyal\nreaders, who have created an account and signed in.\n\n**IV:** My main independent variables are\n\n1.  Post popularity. Unique users - number of unique people viewed the\n    post.\n2.  Source of the readers - which web page the reader came from. This is\n    represented by 6 different variables, each is continuous type.\n3.  Mood of the conversation , derivative continuous variable calculated\n    as the ratio of \"likes\" to all emotions (sum of thumbs up and thumbs\n    down), with the range 0-1.\n4.  Blocked and flagged comments.\n5.  Number of author's comments.\n6.  Weekday of the post.\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nâ”€â”€ Attaching packages â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse 1.3.2 â”€â”€\nâœ” tibble  3.1.8     âœ” purrr   1.0.1\nâœ” tidyr   1.3.0     âœ” stringr 1.5.0\nâœ” readr   2.1.4     âœ” forcats 1.0.0\nâ”€â”€ Conflicts â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ tidyverse_conflicts() â”€â”€\nâœ– dplyr::filter() masks stats::filter()\nâœ– dplyr::lag()    masks stats::lag()\n\nAttaching package: 'gridExtra'\n\n\nThe following object is masked from 'package:dplyr':\n\n    combine\n\n\n\nPlease cite as: \n\n\n Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.\n\n R package version 5.2.3. https://CRAN.R-project.org/package=stargazer \n```\n:::\n:::\n\n\n### Data source and description.\n\nTo answer my research question I will use two datasets. The first data\nset has information about all comments associated with each post by post\nID. The second data set is analytics data for the web page. It contains\none post per row and variables describe each post as a whole without\nbreaking down to the comment level.\n\nIn this project I will analyze posts for January 2022 - March 2023. Here\nis the list of variables in each data set:\n\nComments data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngetwd()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"C:/Users/Diana/OneDrive - University Of Massachusetts Medical School/Documents/R/R working directory/DACSS/603/603_Spring_2023/posts\"\n```\n:::\n\n```{.r .cell-code}\n# First, I will load the data set with the comment level data:\nraw <- as_tibble (read_csv(\"C:\\\\Users\\\\Diana\\\\OneDrive - University Of Massachusetts Medical School\\\\Documents\\\\R\\\\R working directory\\\\DACSS\\\\603\\\\my study files for dacss603\\\\globe\\\\ data.2021.plus.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 105136 Columns: 17\nâ”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nDelimiter: \",\"\nchr  (6): content, user_name, display_name, image_url, email, approved\ndbl  (7): message_id, post_id, user_id, parent, absolute_likes, absolute_dis...\nlgl  (3): email_verified, created_at, private_profile\ndttm (1): written_at\n\nâ„¹ Use `spec()` to retrieve the full column specification for this data.\nâ„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\ncomments.data<-raw \ncolnames (comments.data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"content\"           \"message_id\"        \"post_id\"          \n [4] \"user_id\"           \"user_name\"         \"display_name\"     \n [7] \"image_url\"         \"email\"             \"email_verified\"   \n[10] \"created_at\"        \"private_profile\"   \"approved\"         \n[13] \"written_at\"        \"parent\"            \"absolute_likes\"   \n[16] \"absolute_dislikes\" \"comment.year\"     \n```\n:::\n\n```{.r .cell-code}\nhead(comments.data$written_at)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"2021-01-01 08:28:44 UTC\" \"2021-01-01 08:57:08 UTC\"\n[3] \"2021-01-01 10:36:58 UTC\" \"2021-01-01 11:13:13 UTC\"\n[5] \"2021-01-01 12:27:44 UTC\" \"2021-01-01 12:51:48 UTC\"\n```\n:::\n\n```{.r .cell-code}\ncomments.data <-comments.data%>%\n              mutate(com.year = format(written_at,format = \"%Y\" ))\n# range(comments.data$com.year)\n# dim(comments.data)\nstr(comments.data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [105,136 Ã— 18] (S3: tbl_df/tbl/data.frame)\n $ content          : chr [1:105136] \"08:15  Dawn of the 21st year of the 21st century<br/>&quot;21st Century Schizoid Man&quot;  on the BOSE\" \"Liz:  ðŸ˜„\" \"Happy New Year to all y'all. And Ms. G, thank you for letting me play for another year playing in your sandbox.\" \"Blog needs a new name - Hate Letters\" ...\n $ message_id       : num [1:105136] 1.15e+08 1.15e+08 1.15e+08 1.15e+08 1.15e+08 ...\n $ post_id          : num [1:105136] 27071015 27071015 27071009 27071009 27071009 ...\n $ user_id          : num [1:105136] 2889100 1855822 5133556 5156343 5560421 ...\n $ user_name        : chr [1:105136] \"Lefty49\" \"JacquiSmith\" \"Bzznlike-crazyman\" \"--SnowMan--\" ...\n $ display_name     : chr [1:105136] \"Lefty49\" \"JacquiSmith\" \"Bzznlike-crazyman\" \"--SnowMan--\" ...\n $ image_url        : chr [1:105136] \"https://u.o0bc.com/avatars/48/121/77/5077296.png?35\" \"https://u.o0bc.com/avatars/41/194/84/5554729.png?47\" \"https://u.o0bc.com/avatars/85/175/84/5549909.png?9\" \"https://u.o0bc.com/avatars/64/191/84/5553984.png?5\" ...\n $ email            : chr [1:105136] \"danwalker1949@aol.com\" \"amcr1124@comcast.net\" \"eflynn105@yahoo.com\" \"markedoc@yahoo.com\" ...\n $ email_verified   : logi [1:105136] FALSE FALSE FALSE FALSE FALSE FALSE ...\n $ created_at       : logi [1:105136] NA NA NA NA NA NA ...\n $ private_profile  : logi [1:105136] FALSE FALSE FALSE FALSE FALSE FALSE ...\n $ approved         : chr [1:105136] \"approved\" \"approved\" \"approved\" \"approved\" ...\n $ written_at       : POSIXct[1:105136], format: \"2021-01-01 08:28:44\" \"2021-01-01 08:57:08\" ...\n $ parent           : num [1:105136] NA 1.15e+08 NA NA 1.15e+08 ...\n $ absolute_likes   : num [1:105136] 2 0 14 7 7 7 4 3 2 4 ...\n $ absolute_dislikes: num [1:105136] 1 0 1 0 1 1 1 1 1 0 ...\n $ comment.year     : num [1:105136] 2021 2021 2021 2021 2021 ...\n $ com.year         : chr [1:105136] \"2021\" \"2021\" \"2021\" \"2021\" ...\n```\n:::\n\n```{.r .cell-code}\ndim(comments.data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 105136     18\n```\n:::\n\n```{.r .cell-code}\ncomments.data <- comments.data%>%\n  filter(written_at  >=\t\"2022-01-01\")\n```\n:::\n\n\nPost data:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Second, loadng post-level data :\nmerged <- as_tibble (read_csv(\"C:\\\\Users\\\\Diana\\\\OneDrive - University Of Massachusetts Medical School\\\\Documents\\\\R\\\\R working directory\\\\DACSS\\\\603\\\\my study files for dacss603\\\\globe\\\\data.merged.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 535 Columns: 23\nâ”€â”€ Column specification â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€\nDelimiter: \",\"\nchr   (3): Letter, Exit rate, post.month\ndbl  (18): Page views, Search + amp referral visits, Direct (non-email) refe...\nnum   (1): Visits when post was on LL HP\ndate  (1): post.date\n\nâ„¹ Use `spec()` to retrieve the full column specification for this data.\nâ„¹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n# colnames(merged)\nstr(merged)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\ntibble [535 Ã— 23] (S3: tbl_df/tbl/data.frame)\n $ post.date                         : Date[1:535], format: \"2021-01-04\" \"2021-01-05\" ...\n $ Letter                            : chr [1:535] \"love letters | blog | I don&'t want him to let me go\" \"love letters | blog | Should I be working to get her back?\" \"love letters | blog | I&'m sick of thinking about the breakup\" \"love letters | blog | I don&'t want to be selfish about 2020 Christmas\" ...\n $ Page views                        : num [1:535] 14830 12067 11921 12817 12866 ...\n $ Search + amp referral visits      : num [1:535] 1005 822 793 765 934 ...\n $ Direct (non-email) referral visits: num [1:535] 10005 7948 7997 8746 8400 ...\n $ Visits                            : num [1:535] 12998 10391 10331 11040 10818 ...\n $ Uniques                           : num [1:535] 11453 8985 8917 9662 8564 ...\n $ Other website referral visits     : num [1:535] 129 232 106 152 139 153 165 157 85 151 ...\n $ Social referral visits            : num [1:535] 457 94 156 106 113 368 90 171 84 129 ...\n $ BDC referral visits               : num [1:535] 7087 5312 5185 5901 4570 ...\n $ Visits when post was on LL HP     : num [1:535] 3167 3323 2929 3056 4795 ...\n $ Exits                             : num [1:535] 9679 7549 7613 8188 7900 ...\n $ Exit rate                         : chr [1:535] \"74%\" \"73%\" \"74%\" \"74%\" ...\n $ dup                               : num [1:535] 0 0 0 0 0 0 0 0 0 0 ...\n $ post_id                           : num [1:535] 27071003 27070997 27070991 27070985 27070979 ...\n $ n.comments                        : num [1:535] 267 207 266 372 319 267 337 154 179 375 ...\n $ post.year                         : num [1:535] 2021 2021 2021 2021 2021 ...\n $ post.month                        : chr [1:535] \"01\" \"01\" \"01\" \"01\" ...\n $ post.likes                        : num [1:535] 1440 864 936 1497 1145 ...\n $ post.dislikes                     : num [1:535] 72 106 96 520 154 188 150 62 106 150 ...\n $ post.total.likes                  : num [1:535] 1512 970 1032 2017 1299 ...\n $ blocked.sum                       : num [1:535] 1 2 3 9 2 3 4 0 3 3 ...\n $ pct.positive                      : num [1:535] 95.2 89.1 90.7 74.2 88.1 ...\n```\n:::\n\n```{.r .cell-code}\ndim(merged)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 535  23\n```\n:::\n\n```{.r .cell-code}\n# Limiting the dataset to 2022: \nmerged <- merged%>%\n  filter(post.date  >=\t\"2022-01-01\")\ndim(merged)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 287  23\n```\n:::\n\n```{.r .cell-code}\n# Due to dataset of comments having more data than post dataset,  I will cut them to match: \nmerged <- merged %>%\n  filter (!is.na(merged$pct.positive))\n```\n:::\n\n\nTo begin, I will review available variables and evaluate to idntify a\nmetric for each construct in my study.\n\n# 1.DV: engagement.\n\n## Exit rate\n\nThis variable is measuring how many people visited the page and then\nleft the website after the first view. This metric is the best measure\nof engagement for all users, as it represents the first step after being\nexposed to the post - either quitting the site or remaining on the site.\n\nHere can see the distribution of this variable :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# str(merged)\nmerged <- merged %>%\n  mutate(e.rate = Exits/`Page views`)\nselect (merged, `Exit rate`, e.rate)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 287 Ã— 2\n   `Exit rate` e.rate\n   <chr>        <dbl>\n 1 76%          0.675\n 2 79%          0.703\n 3 86%          0.791\n 4 68%          0.600\n 5 75%          0.665\n 6 76%          0.678\n 7 83%          0.751\n 8 88%          0.804\n 9 91%          0.836\n10 72%          0.620\n# â€¦ with 277 more rows\n```\n:::\n\n```{.r .cell-code}\n# merged$`Exit rate` <- as.numeric(sub(\"%\", \"\", merged$`Exit rate`)) / 100\n\nggplot(data=merged, mapping=aes(x=e.rate))+\n    geom_histogram(binwidth = 0.01, fill = \"sandybrown\", alpha = 0.7)+\n  labs(title=\"Exit rate histogram\")\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nDistribution of exit rate over time:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# creating  year_month  variable \nmerged$post.month <-as.numeric(merged$post.month)\nmerged$year_month <- paste0(merged$post.year, \"-\", sprintf(\"%02d\", merged$post.month))\n\nggplot(merged, mapping = aes(x=year_month , y=`e.rate`, fill=year_month ))+\n  geom_boxplot() +\n  labs(title = \"distribution of `Exit rate` per post \", y = \"Exit rate\" , x=\"Month\")+ \n     theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Number of comments:\n\nengagement metric for loyal readers.\n\nCommenting requires user to log in, which is an indicator of greater\nengagement of an individual user. Therefore this variable represents\nengagement of a subset of users,loyal readers, who have created an\naccount.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# merged$year_month \nggplot(data=merged, mapping=aes(x=n.comments))+\n  geom_histogram(fill = \"seagreen4\")+\n  labs(title=\"Number of comments histogram\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nAnd change in the distribution over time:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(merged, mapping = aes(x=year_month , y=n.comments, fill=year_month ))+\n  geom_boxplot() +\n  labs(title = \"distribution of comments per post \", y = \"Number of comments\" )+\n  scale_y_continuous(breaks = seq (from=0, to= 10000, by= 100)) + \n     theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n# 2.IV. Independent variables:\n\n### 2.1.Popularity\n\n\"Uniques\" variable represents number of unique people who came to the\npage and viewed it at least once, his metric represents popularity of\nthe post. It has Poisson distribution:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# colnames(merged)\nggplot(data=merged, mapping=aes(x=Uniques))+\n    geom_histogram(fill = \"purple2\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\nWe can see a long tail on the right, showing that there is a number of\nposts who are way more popular than the majority of the sample.\n\n\nDistribution of popularity over time also showing significant variance: \n\n::: {.cell}\n\n```{.r .cell-code}\nggplot( data=merged, mapping=aes(y=Uniques, x=merged$year_month))+\n          geom_boxplot()+\n  labs(title=\"Number of unique viewers per month\", x=\"Month\", y=\"Number of unique viewers\")+ \n  theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Use of `merged$year_month` is discouraged.\nâ„¹ Use `year_month` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nNext plot is illustrating connection between popularity and engagement\nmetrics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npairs(subset (merged, select=c(Uniques, e.rate, n.comments )))\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\nWe can see that popularity strongly correlated with exit rate, where an\nincrease in popularity causes decrease of engagement.\nIt is not as strongly correlated with number of comments. Engagement rate and number\nof comments don't show obvious pattern between each other.\n\n### 2.2. Referral sources.\n\nThe website analytics provides information on where the viewers are\ncoming from to the blog page. For example, if people clicked on the blog\nlink posted on FaceBook, that would be referral from social media. If\npeople clicked on the blog link within BDC website, that would be \"BDC\nreferral visit\".\n\nThere are 5 sources of referrals, each corresponding with a variable in\nthe data set. Variable's value is a number of visits from this referral\nsource.\n\n```         \n\"Search + amp referral visits\"\n\"Direct (non-email) referral visits\"\n\"Other website referral visits\"\n\"Social referral visits\"\n\"BDC referral visits\"\n\"Visits when post was on LL HP\" \n```\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#renaming variables for convenience: \nmerged<-merged%>%\n  rename(google =\"Search + amp referral visits\",\n         direct =\"Direct (non-email) referral visits\",\n         other.web = \"Other website referral visits\",\n          social= \"Social referral visits\",\n          bdc= \"BDC referral visits\",\n          ll= \"Visits when post was on LL HP\" )\n\nggplot(merged, mapping=aes(x=post.date))+\n  geom_point(aes(y=google), color=\"red\")+\n  geom_point(aes(y=direct), color=\"green\")+\n  geom_point(aes(y=other.web), color=\"yellow\")+\n  geom_point(aes(y=social), color=\"purple\")+\n  geom_point(aes(y=bdc), color=\"blue\")+\n  geom_point(aes(y=ll), color=\"pink\")  +\n  labs(title = \"Referral sources per post \", y = \"Number of referrals\" , x=\"Post\")+ \n  scale_color_manual(values = c(\"red\", \"green\", \"yellow\", \"purple\", \"blue\", \"pink\"),\n                     labels = c(\"Google\", \"Direct\", \"Other Web\", \"Social\", \"Bdc\", \"LL\"))\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\nThis graph is showing of \"Search + amp referral visits\" have high\nvariability. Other referral sources range is much smaller.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(comments.data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"content\"           \"message_id\"        \"post_id\"          \n [4] \"user_id\"           \"user_name\"         \"display_name\"     \n [7] \"image_url\"         \"email\"             \"email_verified\"   \n[10] \"created_at\"        \"private_profile\"   \"approved\"         \n[13] \"written_at\"        \"parent\"            \"absolute_likes\"   \n[16] \"absolute_dislikes\" \"comment.year\"      \"com.year\"         \n```\n:::\n\n```{.r .cell-code}\n# Calculating date of the post and weekday  from comments data \n\nlibrary(lubridate)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'lubridate'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    date, intersect, setdiff, union\n```\n:::\n\n```{.r .cell-code}\npost.date <-comments.data %>%\n    group_by(post_id)%>%\n    arrange(written_at)%>%\n    summarize(post.dt = first(written_at))\n\npost.date  <-post.date %>%\n  mutate (weekday = wday(post.dt, label = TRUE),\n          n.coms =n())%>%\n  filter (n.coms>100)%>%\n  select(post_id,post.dt,  weekday )\n\n # Adding weekdays to both data sets: comments level and post level:\ncomments.data <- merge(comments.data, post.date , by = \"post_id\", all = TRUE)\nmerged <- merge( merged, post.date , by = \"post_id\", all = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(merged, mapping=aes(x=direct , y=e.rate))+\n  geom_point()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n### 2.3. Post weekdays\n\nThe posts are being published Monday through Friday (with rare\nexceptions). No posts are published on the weekend. Below is a plot for\nexit rate and number of comments' distributions per week day\n\n\n::: {.cell}\n\n```{.r .cell-code}\n ggplot (merged,  mapping=aes(x=weekday, y=e.rate) )+\n  geom_boxplot()+\n  geom_point()+\n  labs(title=\"Exit rate per weekday\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing non-finite values (`stat_boxplot()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot (merged,  mapping=aes(x=weekday, y=n.comments) )+\n  geom_boxplot()+\n  geom_point()+\n  labs(title=\"Number of comments per weekday\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing non-finite values (`stat_boxplot()`).\nRemoved 144 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n:::\n\n\nWe can see that exit rate is overall lower on Tuesday, and number of\ncomments overall highest on Fridays.\n\n### 2.4. Authors comments\n\nTo identify, how much the author of the blog is engaged in the post, I\nwill create an additional variable derived from a user_name field and\nreview the distribution of autor's comments :\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# str(merged)\ncomments.data$user_name<-  ifelse (is.na(comments.data$user_name), 0, comments.data$user_name)\ncomments.data$author<-  ifelse (comments.data$user_name==\"MeredithGoldstein\", 1, 0)\n\ncomments.grouped <-comments.data %>%\n  group_by(post_id)%>%\n  summarize(n.comments=n(),\n            author.sum = sum(author))\n\n# Comments data contains rows that dont actually reporesent posts, and were crearted by web support team for troubleshooting. I need to remove these rows. They typically have very low number of comments\ncomments.grouped <-comments.grouped %>%\nfilter(n.comments >100)  # removing invalid posts created by the  website management team.\n\ncomments.grouped <-comments.grouped %>%\n  select(post_id, author.sum)\n dim(comments.grouped)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 287   2\n```\n:::\n\n```{.r .cell-code}\n#adding author.sum to main data set: \nmerged <- merge( merged , comments.grouped, by = \"post_id\", all = TRUE)\n\n ggplot (merged,  mapping=aes(x=author.sum) )+\n  geom_histogram()+\n  labs(title=\"Authors comments distribution\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing non-finite values (`stat_bin()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\nAuthors comments per engagement metrics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot (merged,  mapping=aes(x=author.sum, y=e.rate ))+\n  geom_point()+\n  labs(title=\"Exit rate per author.sum\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot (merged,  mapping=aes(x=author.sum, y=n.comments) )+\n  geom_point()+\n  labs(title=\"Number of comments per author.sum\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n:::\n\n\nThis graph shows, that majority of posts have no author's comments.\n\n### 2.5. Mood of the post.\n\nThis is a numerical variable, calculated as percentage of \"thumbs up\"\nfrom all likes (both \"thumbs up\" and \"thumbs down\").\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# colnames(merged)\n ggplot (merged,  mapping=aes(x=pct.positive) )+\n  geom_histogram(fill = \"springgreen3\")+\n  labs(title=\"Mood of the post (pct.positive) distribution\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing non-finite values (`stat_bin()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\nPlotting mood pf the post against engagement metyrics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n ggplot (merged,  mapping=aes(x=pct.positive, y=e.rate ))+\n  geom_point()+\n  labs(title=\"Exit rate per pct.positive\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot (merged,  mapping=aes(x=pct.positive, y=n.comments) )+\n  geom_point()+\n  labs(title=\"Number of comments per pct.positive\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-18-2.png){width=672}\n:::\n:::\n\n\nDistribution of mood over time:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n ggplot(merged, mapping = aes(x=year_month , y=pct.positive, fill=year_month ))+\n  geom_boxplot() +\n  labs(title = \"distribution of Mood per post \", y = \"Mood\" , x=\"Month\")+ \n     theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing non-finite values (`stat_boxplot()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n\n### 2.6. Blocked comments per post.\n\nNow I will visualize amount of blocked comments per post. It  also has Poisson distribution. \n\n::: {.cell}\n\n```{.r .cell-code}\n ggplot (merged,  mapping=aes(x=blocked.sum) )+\n  geom_histogram(fill = \"brown\")+\n  labs(title=\"blocked.sum distribution\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing non-finite values (`stat_bin()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n:::\n\n\nPlotting blocked comments against engagement metrics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n ggplot (merged,  mapping=aes(x=blocked.sum, y=e.rate ))+\n  geom_point()+\n  labs(title=\"Exit rate per blocked.sum\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot (merged,  mapping=aes(x=blocked.sum, y=n.comments) )+\n  geom_point()+\n  labs(title=\"Number of comments per blocked.sum\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-21-2.png){width=672}\n:::\n:::\n\n\nDistribution of blocked comments over time:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(merged, mapping = aes(x=year_month , y=blocked.sum, fill=year_month ))+\n  geom_boxplot() +\n  labs(title = \"Number Blocked comments  per post \", y = \"Number of blocked comments per post\" , x=\"Month\")+ \n     theme(axis.text.x = element_text(angle = 45, hjust = 1))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 144 rows containing non-finite values (`stat_boxplot()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-22-1.png){width=672}\n:::\n:::\n\n\n# 3. Creating a model for exit rate - all users engagement.\n\n### 3.1 Basic model.\n\nI will start with entering all of the independent variable in the model\nand then eliminating ones that are not significant.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# colnames(merged)\nmodel.1 <- lm(e.rate ~ log(Uniques) +google +direct +other.web +social +bdc + ll + author.sum +n.comments +blocked.sum + pct.positive +weekday , data = merged)\n\nmerged<- merged %>%\n     mutate (author.sum =author.sum +0.001,\n          blocked.sum =blocked.sum +0.001)\n\n# logging variables with Poisson distribution to see if that increases significantce.\nmodel.2 <- lm(e.rate ~ log(Uniques) +google +direct +other.web +social +bdc + ll + log(author.sum) +n.comments + log(blocked.sum) + pct.positive +weekday , data = merged)\n\nmodel.3 <- lm(e.rate ~ log(Uniques)+ google +direct +other.web +social +bdc  +weekday , data = merged)\n\nstargazer( model.1, model.2, model.3,  type = 'text')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n=================================================================================================\n                                                 Dependent variable:                             \n                    -----------------------------------------------------------------------------\n                                                       e.rate                                    \n                               (1)                       (2)                       (3)           \n-------------------------------------------------------------------------------------------------\nlog(Uniques)                0.189***                  0.190***                  0.191***         \n                             (0.009)                   (0.009)                   (0.009)         \n                                                                                                 \ngoogle                     -0.00000***               -0.00000***               -0.00000***       \n                            (0.00000)                 (0.00000)                 (0.00000)        \n                                                                                                 \ndirect                     -0.00003***               -0.00003***               -0.00002***       \n                            (0.00000)                 (0.00000)                 (0.00000)        \n                                                                                                 \nother.web                  -0.00001***               -0.00001***               -0.00001***       \n                            (0.00000)                 (0.00000)                 (0.00000)        \n                                                                                                 \nsocial                     -0.00004**                -0.00004**                -0.00004**        \n                            (0.00002)                 (0.00002)                 (0.00002)        \n                                                                                                 \nbdc                        0.00002***                0.00002***                0.00002***        \n                            (0.00000)                 (0.00000)                 (0.00000)        \n                                                                                                 \nll                           0.00000                   0.00000                                   \n                            (0.00000)                 (0.00000)                                  \n                                                                                                 \nauthor.sum                   -0.002                                                              \n                             (0.002)                                                             \n                                                                                                 \nlog(author.sum)                                        -0.001                                    \n                                                      (0.0005)                                   \n                                                                                                 \nn.comments                  -0.00002                  -0.00002                                   \n                            (0.00003)                 (0.00003)                                  \n                                                                                                 \nblocked.sum                  -0.0001                                                             \n                            (0.0002)                                                             \n                                                                                                 \nlog(blocked.sum)                                       0.0002                                    \n                                                      (0.0004)                                   \n                                                                                                 \npct.positive                -0.00001                   0.00001                                   \n                            (0.0002)                  (0.0002)                                   \n                                                                                                 \nweekday.L                    0.006*                    0.006*                    0.007**         \n                             (0.003)                   (0.003)                   (0.003)         \n                                                                                                 \nweekday.Q                   0.012***                  0.012***                  0.014***         \n                             (0.003)                   (0.003)                   (0.003)         \n                                                                                                 \nweekday.C                     0.003                     0.003                     0.004          \n                             (0.003)                   (0.003)                   (0.003)         \n                                                                                                 \nweekday4                     0.006**                   0.007**                  0.007***         \n                             (0.003)                   (0.003)                   (0.003)         \n                                                                                                 \nConstant                    -1.030***                 -1.038***                 -1.047***        \n                             (0.086)                   (0.086)                   (0.082)         \n                                                                                                 \n-------------------------------------------------------------------------------------------------\nObservations                   287                       287                       287           \nR2                            0.918                     0.918                     0.917          \nAdjusted R2                   0.914                     0.914                     0.914          \nResidual Std. Error     0.020 (df = 271)          0.020 (df = 271)          0.020 (df = 276)     \nF Statistic         203.411*** (df = 15; 271) 203.257*** (df = 15; 271) 306.564*** (df = 10; 276)\n=================================================================================================\nNote:                                                                 *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\n\nElimination of non-significant factors slightly impacted coefficients of\nsignificant variables, and did not change R\\^2 or adjusted R\\^2 much.\n\nMy next step is to diagnose this model:\n\n### 3.2. Diagnostic of linear models:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel.3 <- lm(e.rate ~ log(Uniques)+ google +direct +other.web +social +bdc  +weekday , data = merged)\n\nplot(model.3, which = 1:6)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-6.png){width=672}\n:::\n:::\n\n\nWe can see the issue with distribution of residuals in \"Residuals vs\nfitted\" plot. This suggests non-linear relationship between variables.\n\n\nI will transform some referral variables to see if that gives me a better\nmodel:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#original model\nmodel.3 <- lm(e.rate ~ log(Uniques)+ google +direct +other.web +social +bdc  +weekday , data = merged)\n# Logging Google referrals\nmodel.4 <- lm(e.rate ~ log(Uniques)+log(google) +direct +other.web +social +bdc  +weekday , data = merged)\n\nstargazer( model.3, model.4, model.5,    type = 'text')\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in .stargazer.wrap(..., type = type, title = title, style = style, : object 'model.5' not found\n```\n:::\n:::\n\nThis table showing better fit when google variable is logged.  Uniques' coefficient also changed significantly as I am modified google variable. That might indicate interaction between\nthem, which I will explore later in this  paper.\n\nNow, I will log the rest of referral variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel.4 <- lm(e.rate ~ log(Uniques)+log(google) +direct +other.web +social +bdc  +weekday , data = merged)\nmodel.5 <- lm(e.rate ~ log(Uniques)+log(google) +log(direct) +log(other.web) +log(social) +log(bdc)  +weekday , data = merged)\nmodel.6 <- lm(e.rate ~ log(Uniques)+log(google) +log(direct) +other.web +social +log(bdc)  +weekday , data = merged)\n\nstargazer( model.4,model.5,model.6,  type = 'text')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n=================================================================\n                                      Dependent variable:        \n                               ----------------------------------\n                                             e.rate              \n                                   (1)        (2)         (3)    \n-----------------------------------------------------------------\nlog(Uniques)                    0.106***    0.096***   0.112***  \n                                 (0.012)    (0.013)     (0.013)  \n                                                                 \nlog(google)                     0.016***    0.019***   0.014***  \n                                 (0.004)    (0.005)     (0.005)  \n                                                                 \ndirect                         -0.00003***                       \n                                (0.00000)                        \n                                                                 \nother.web                      -0.00001***            -0.00001***\n                                (0.00000)              (0.00000) \n                                                                 \nsocial                         -0.00003**              -0.00003  \n                                (0.00002)              (0.00002) \n                                                                 \nbdc                            0.00003***                        \n                                (0.00000)                        \n                                                                 \nlog(direct)                                -0.298***   -0.307*** \n                                            (0.029)     (0.027)  \n                                                                 \nlog(other.web)                               -0.001              \n                                            (0.002)              \n                                                                 \nlog(social)                                  -0.005              \n                                            (0.003)              \n                                                                 \nlog(bdc)                                    0.218***   0.220***  \n                                            (0.018)     (0.017)  \n                                                                 \nweekday.L                        0.008**    0.009***   0.010***  \n                                 (0.003)    (0.003)     (0.003)  \n                                                                 \nweekday.Q                       0.016***    0.018***   0.019***  \n                                 (0.003)    (0.003)     (0.003)  \n                                                                 \nweekday.C                        0.005*     0.006**     0.006**  \n                                 (0.003)    (0.003)     (0.003)  \n                                                                 \nweekday4                        0.008***    0.009***   0.008***  \n                                 (0.003)    (0.003)     (0.003)  \n                                                                 \nConstant                        -0.384***   0.453***   0.396***  \n                                 (0.073)    (0.094)     (0.093)  \n                                                                 \n-----------------------------------------------------------------\nObservations                       287        287         287    \nR2                                0.913      0.901       0.906   \nAdjusted R2                       0.910      0.898       0.903   \nResidual Std. Error (df = 276)    0.020      0.021       0.021   \nF Statistic (df = 10; 276)     291.392***  252.106*** 266.805*** \n=================================================================\nNote:                                 *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\nAll referral sources except \"other.web\" and \"social\" show better fit\nwhen logged. \nMoving forward, I will use these two variables not logeed:\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel.7 <- lm(e.rate ~ log(Uniques)+log(google) +log(direct) +other.web+social +log(bdc)  +weekday , data = merged)\n\nstargazer(model.7,  type = 'text')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n===============================================\n                        Dependent variable:    \n                    ---------------------------\n                              e.rate           \n-----------------------------------------------\nlog(Uniques)                 0.112***          \n                              (0.013)          \n                                               \nlog(google)                  0.014***          \n                              (0.005)          \n                                               \nlog(direct)                  -0.307***         \n                              (0.027)          \n                                               \nother.web                   -0.00001***        \n                             (0.00000)         \n                                               \nsocial                       -0.00003          \n                             (0.00002)         \n                                               \nlog(bdc)                     0.220***          \n                              (0.017)          \n                                               \nweekday.L                    0.010***          \n                              (0.003)          \n                                               \nweekday.Q                    0.019***          \n                              (0.003)          \n                                               \nweekday.C                     0.006**          \n                              (0.003)          \n                                               \nweekday4                     0.008***          \n                              (0.003)          \n                                               \nConstant                     0.396***          \n                              (0.093)          \n                                               \n-----------------------------------------------\nObservations                    287            \nR2                             0.906           \nAdjusted R2                    0.903           \nResidual Std. Error      0.021 (df = 276)      \nF Statistic          266.805*** (df = 10; 276) \n===============================================\nNote:               *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\n\nDiagnostics of model.7:\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,3))\nplot(model.7, which = 1:6)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-28-1.png){width=672}\n:::\n:::\n\nWe still observe curvi-linear distribution of residuals.\n\nNow I will explore an ineraction with popularity (Uniques)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# last model\nmodel.7 <- lm(e.rate ~ log(Uniques)+log(google) +log(direct) +other.web +log(bdc)+social  +weekday , data = merged)\n\n# adding interaction: \nmodel.8 <- lm(e.rate ~ log(Uniques)*log(google) +log(direct) +other.web +social +log(bdc)  +weekday , data = merged)\nstargazer( model.7,model.8, type = 'text')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================================\n                                         Dependent variable:                \n                         ---------------------------------------------------\n                                               e.rate                       \n                                    (1)                       (2)           \n----------------------------------------------------------------------------\nlog(Uniques)                     0.112***                  0.372***         \n                                  (0.013)                   (0.042)         \n                                                                            \nlog(google)                      0.014***                  0.200***         \n                                  (0.005)                   (0.029)         \n                                                                            \nlog(direct)                      -0.307***                 -0.293***        \n                                  (0.027)                   (0.026)         \n                                                                            \nother.web                       -0.00001***               -0.00001***       \n                                 (0.00000)                 (0.00000)        \n                                                                            \nlog(bdc)                         0.220***                  0.181***         \n                                  (0.017)                   (0.017)         \n                                                                            \nsocial                           -0.00003                 -0.00003**        \n                                 (0.00002)                 (0.00002)        \n                                                                            \nweekday.L                        0.010***                  0.009***         \n                                  (0.003)                   (0.003)         \n                                                                            \nweekday.Q                        0.019***                  0.017***         \n                                  (0.003)                   (0.003)         \n                                                                            \nweekday.C                         0.006**                   0.006**         \n                                  (0.003)                   (0.003)         \n                                                                            \nweekday4                         0.008***                  0.007***         \n                                  (0.003)                   (0.003)         \n                                                                            \nlog(Uniques):log(google)                                   -0.021***        \n                                                            (0.003)         \n                                                                            \nConstant                         0.396***                  -1.734***        \n                                  (0.093)                   (0.345)         \n                                                                            \n----------------------------------------------------------------------------\nObservations                        287                       287           \nR2                                 0.906                     0.918          \nAdjusted R2                        0.903                     0.915          \nResidual Std. Error          0.021 (df = 276)          0.020 (df = 275)     \nF Statistic              266.805*** (df = 10; 276) 281.232*** (df = 11; 275)\n============================================================================\nNote:                                            *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\nAdding interaction between popularity and google referrals significcntly\nimproved the model: interaction term has negative correlation with\ndependent variable, it also made \"social\" referrals significant, and\nimproved models R\\^2 and adjusted R\\^2.\n\nIt also significantly changed distribution of residuals: now distribution is equally spread around 0.\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nplot(model.7, which = 1)\nplot(model.8, which = 1)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-30-1.png){width=672}\n:::\n:::\n\n\n\nLets review other diagnostic plots:\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nplot(model.7, which = 2)\nplot(model.8, which = 2)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-31-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nplot(model.7, which = 3)\nplot(model.8, which = 3)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-31-2.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(2,2))\nplot(model.7, which = 4)\nplot(model.8, which = 4)\n\npar(mfrow = c(2,2))\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-31-3.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(model.7, which = 5)\nplot(model.8, which = 5)\n\npar(mfrow = c(2,2))\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-31-4.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(model.7, which = 6)\nplot(model.8, which = 6)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-31-5.png){width=672}\n:::\n:::\n\n\nWe can see from both models, that variable 231 is an outlier that\nsignificantly impacts the model. I will remove that observation and\nre-evaluate the model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged.old <- merged\ndim(merged)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 431  28\n```\n:::\n\n```{.r .cell-code}\ndim(merged.old)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 431  28\n```\n:::\n\n```{.r .cell-code}\nmerged <- merged[-c(235), ]\nmodel.8 <- lm(e.rate ~ log(Uniques)*log(google) +log(direct) +other.web +social +log(bdc)  +weekday , data = merged.old)\nmodel.9 <- lm(e.rate ~ log(Uniques)*log(google) +log(direct) +other.web +social +log(bdc)  +weekday , data = merged)\n\nstargazer( model.8,model.9, type = 'text')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n============================================================================\n                                         Dependent variable:                \n                         ---------------------------------------------------\n                                               e.rate                       \n                                    (1)                       (2)           \n----------------------------------------------------------------------------\nlog(Uniques)                     0.372***                  0.359***         \n                                  (0.042)                   (0.042)         \n                                                                            \nlog(google)                      0.200***                  0.194***         \n                                  (0.029)                   (0.029)         \n                                                                            \nlog(direct)                      -0.293***                 -0.287***        \n                                  (0.026)                   (0.025)         \n                                                                            \nother.web                       -0.00001***                -0.00000         \n                                 (0.00000)                 (0.00000)        \n                                                                            \nsocial                          -0.00003**                 -0.00003*        \n                                 (0.00002)                 (0.00002)        \n                                                                            \nlog(bdc)                         0.181***                  0.177***         \n                                  (0.017)                   (0.017)         \n                                                                            \nweekday.L                        0.009***                  0.009***         \n                                  (0.003)                   (0.003)         \n                                                                            \nweekday.Q                        0.017***                  0.016***         \n                                  (0.003)                   (0.003)         \n                                                                            \nweekday.C                         0.006**                   0.005**         \n                                  (0.003)                   (0.003)         \n                                                                            \nweekday4                         0.007***                  0.007***         \n                                  (0.003)                   (0.003)         \n                                                                            \nlog(Uniques):log(google)         -0.021***                 -0.021***        \n                                  (0.003)                   (0.003)         \n                                                                            \nConstant                         -1.734***                 -1.647***        \n                                  (0.345)                   (0.341)         \n                                                                            \n----------------------------------------------------------------------------\nObservations                        287                       286           \nR2                                 0.918                     0.921          \nAdjusted R2                        0.915                     0.918          \nResidual Std. Error          0.020 (df = 275)          0.019 (df = 274)     \nF Statistic              281.232*** (df = 11; 275) 289.654*** (df = 11; 274)\n============================================================================\nNote:                                            *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nplot(model.8, which = 1)\nplot(model.9, which = 1)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nplot(model.8, which = 2)\nplot(model.9, which = 2)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-2.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,2))\nplot(model.8, which = 3)\nplot(model.9, which = 3)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-3.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(2,2))\nplot(model.8, which = 4)\nplot(model.9, which = 4)\n\npar(mfrow = c(2,2))\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-4.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(model.8, which = 5)\nplot(model.9, which = 5)\n\npar(mfrow = c(2,2))\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-5.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(model.8, which = 6)\nplot(model.9, which = 6)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-6.png){width=672}\n:::\n:::\n\n\nNew, the variable \"other.web\" became unsignificant, but model fit\nimproved.\n\n### 3.3. Improved model.\n\nI will check whether other referral sources have an interaction with\npopularity:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel.9 <- lm(e.rate ~ log(Uniques)*log(google) +log(direct) +other.web +social +log(bdc)  +weekday , data = merged)\n# adding interactions to all IVs\nmodel.10 <- lm(e.rate ~ log(Uniques)*log(google) +log(Uniques)* log(direct) +log(Uniques)*other.web +log(Uniques)*social +log(Uniques)*log(bdc)  +log(Uniques)*weekday , data = merged)\n# removing interations from thos that are not significant \nmodel.11 <- lm(e.rate ~ log(Uniques)*log(google) +log(Uniques)* log(direct) +other.web +social +log(bdc)  +log(Uniques)*weekday , data = merged)\n\nstargazer( model.9,model.10,model.11, type = 'text')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n======================================================================================================\n                                                      Dependent variable:                             \n                         -----------------------------------------------------------------------------\n                                                            e.rate                                    \n                                    (1)                       (2)                       (3)           \n------------------------------------------------------------------------------------------------------\nlog(Uniques)                     0.359***                   -0.126                    -0.027          \n                                  (0.042)                   (0.165)                   (0.122)         \n                                                                                                      \nlog(google)                      0.194***                  0.339***                  0.316***         \n                                  (0.029)                   (0.051)                   (0.048)         \n                                                                                                      \nlog(direct)                      -0.287***                 -1.336***                 -0.892***        \n                                  (0.025)                   (0.477)                   (0.183)         \n                                                                                                      \nother.web                        -0.00000                  -0.00004                  -0.00000*        \n                                 (0.00000)                 (0.00004)                 (0.00000)        \n                                                                                                      \nsocial                           -0.00003*                  -0.0004                  -0.00003*        \n                                 (0.00002)                 (0.0003)                  (0.00002)        \n                                                                                                      \nlog(bdc)                         0.177***                    0.507                   0.173***         \n                                  (0.017)                   (0.344)                   (0.017)         \n                                                                                                      \nweekday.L                        0.009***                    0.036                     0.009          \n                                  (0.003)                   (0.065)                   (0.061)         \n                                                                                                      \nweekday.Q                        0.016***                   0.124**                   0.105*          \n                                  (0.003)                   (0.059)                   (0.058)         \n                                                                                                      \nweekday.C                         0.005**                    0.085                     0.084          \n                                  (0.003)                   (0.055)                   (0.055)         \n                                                                                                      \nweekday4                         0.007***                   0.113**                   0.099*          \n                                  (0.003)                   (0.052)                   (0.052)         \n                                                                                                      \nlog(Uniques):log(google)         -0.021***                 -0.037***                 -0.034***        \n                                  (0.003)                   (0.006)                   (0.005)         \n                                                                                                      \nlog(Uniques):log(direct)                                    0.103**                  0.058***         \n                                                            (0.048)                   (0.018)         \n                                                                                                      \nlog(Uniques):other.web                                      0.00000                                   \n                                                           (0.00000)                                  \n                                                                                                      \nlog(Uniques):social                                         0.00004                                   \n                                                           (0.00003)                                  \n                                                                                                      \nlog(Uniques):log(bdc)                                       -0.034                                    \n                                                            (0.034)                                   \n                                                                                                      \nlog(Uniques):weekday.L                                      -0.003                    0.00001         \n                                                            (0.007)                   (0.006)         \n                                                                                                      \nlog(Uniques):weekday.Q                                      -0.011*                   -0.009          \n                                                            (0.006)                   (0.006)         \n                                                                                                      \nlog(Uniques):weekday.C                                      -0.008                    -0.008          \n                                                            (0.006)                   (0.006)         \n                                                                                                      \nlog(Uniques):weekday4                                      -0.011**                   -0.009*         \n                                                            (0.005)                   (0.005)         \n                                                                                                      \nConstant                         -1.647***                  3.580**                   2.592**         \n                                  (0.341)                   (1.682)                   (1.301)         \n                                                                                                      \n------------------------------------------------------------------------------------------------------\nObservations                        286                       286                       286           \nR2                                 0.921                     0.926                     0.925          \nAdjusted R2                        0.918                     0.921                     0.921          \nResidual Std. Error          0.019 (df = 274)          0.019 (df = 266)          0.019 (df = 269)     \nF Statistic              289.654*** (df = 11; 274) 175.995*** (df = 19; 266) 208.476*** (df = 16; 269)\n======================================================================================================\nNote:                                                                      *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,3))\nplot(model.9, which = 1)\nplot(model.10, which = 1)\nplot(model.11, which = 1)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,3))\nplot(model.9, which = 2)\nplot(model.10, which = 2)\nplot(model.11, which = 2)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-2.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,3))\nplot(model.9, which = 3)\nplot(model.10, which = 3)\nplot(model.11, which = 3)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-3.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,3))\nplot(model.9, which = 4)\nplot(model.10, which = 4)\nplot(model.11, which = 4)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-4.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,3))\nplot(model.9, which = 5)\nplot(model.10, which = 5)\nplot(model.11, which = 5)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-5.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1,3))\nplot(model.9, which = 6)\nplot(model.10, which = 6)\nplot(model.11, which = 6)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-6.png){width=672}\n:::\n:::\n\n\nAll models have similar R\\^2 and adjusted R\\^2. However, the last model\n(model.11) best accounts for all source variables.\n\nCalculation of AIC and BIC:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(model.9) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1433.42\n```\n:::\n\n```{.r .cell-code}\nAIC(model.10) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1438.009\n```\n:::\n\n```{.r .cell-code}\nAIC(model.11) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1440.382\n```\n:::\n\n```{.r .cell-code}\nBIC(model.9) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1385.892\n```\n:::\n\n```{.r .cell-code}\nBIC(model.10) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1361.233\n```\n:::\n\n```{.r .cell-code}\nBIC(model.11) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -1374.574\n```\n:::\n:::\n\n\nAIC and BIC are very close to each other in all three models.\n\nTo summarize, the model \\# 11 demonstrated the best fit with high R\\^2\nvalue and good results in diagnostic plots.\n\nTe final model of my analysis is:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel.11 <- lm(e.rate ~ log(Uniques)*log(google) +log(Uniques)* log(direct) +other.web +social +log(bdc)  + weekday , data = merged)\n\nmodel.12 <- lm(e.rate ~ log(Uniques)*log(google) , data = merged)\nsummary(model.11)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = e.rate ~ log(Uniques) * log(google) + log(Uniques) * \n    log(direct) + other.web + social + log(bdc) + weekday, data = merged)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.058474 -0.011661  0.001312  0.011192  0.043908 \n\nCoefficients:\n                           Estimate Std. Error t value Pr(>|t|)    \n(Intercept)               1.603e+00  1.129e+00   1.420  0.15681    \nlog(Uniques)              6.603e-02  1.058e-01   0.624  0.53298    \nlog(google)               2.940e-01  4.389e-02   6.699 1.20e-10 ***\nlog(direct)              -7.589e-01  1.585e-01  -4.790 2.74e-06 ***\nother.web                -3.105e-06  1.850e-06  -1.678  0.09443 .  \nsocial                   -3.085e-05  1.506e-05  -2.048  0.04148 *  \nlog(bdc)                  1.714e-01  1.694e-02  10.118  < 2e-16 ***\nweekday.L                 9.004e-03  2.948e-03   3.054  0.00248 ** \nweekday.Q                 1.714e-02  2.900e-03   5.909 1.02e-08 ***\nweekday.C                 6.138e-03  2.581e-03   2.378  0.01808 *  \nweekday^4                 7.633e-03  2.512e-03   3.039  0.00261 ** \nlog(Uniques):log(google) -3.187e-02  4.968e-03  -6.416 6.16e-10 ***\nlog(Uniques):log(direct)  4.562e-02  1.513e-02   3.016  0.00280 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.019 on 273 degrees of freedom\n  (144 observations deleted due to missingness)\nMultiple R-squared:  0.9234,\tAdjusted R-squared:   0.92 \nF-statistic: 274.1 on 12 and 273 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n### 3.4. Visualizing interaction: \n\nModerating impact of popularity referrals on relationship between referral sourceand engagement: \n\n\n::: {.cell}\n\n```{.r .cell-code}\ninteract_plot(model.11, pred =Uniques , modx =  google, plot.points = TRUE )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing data merged from global environment. This could cause incorrect\nresults if merged has been altered since the model was fit. You can\nmanually provide the data to the \"data =\" argument.\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(Terms, newdata, na.action = na.action, xlev = object$xlevels): factor weekday has new level Sun\n```\n:::\n\n```{.r .cell-code}\ninteract_plot(model.11, pred = google, modx =  Uniques, plot.points = TRUE )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing data merged from global environment. This could cause incorrect\nresults if merged has been altered since the model was fit. You can\nmanually provide the data to the \"data =\" argument.\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(Terms, newdata, na.action = na.action, xlev = object$xlevels): factor weekday has new level Sun\n```\n:::\n:::\n\nThis graph shows that low levels of popularity (Uniques) there is no connection between google referrals and exit rate. At higher levels of popularity exit rate is significantly higher overall, but seem to dlightly decrease with increase of google refrrals.  \n\n\n, increase of popularity (uniques) decreases engagement more rapidly, than at higher levels of google referrals.  I.e. at some level of Google referrals (~15-30K) poupularity impacts engagement not as strongly. \n\n### Moderating impact of direct referrals on relationship between popularity and engagement: \n\n::: {.cell}\n\n```{.r .cell-code}\nplot (Uniques ~ direct, data = merged)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-37-1.png){width=672}\n:::\n\n```{.r .cell-code}\ninteract_plot(model.11, pred = Uniques, modx = direct, plot.points = TRUE )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing data merged from global environment. This could cause incorrect\nresults if merged has been altered since the model was fit. You can\nmanually provide the data to the \"data =\" argument.\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(Terms, newdata, na.action = na.action, xlev = object$xlevels): factor weekday has new level Sun\n```\n:::\n\n```{.r .cell-code}\ninteract_plot(model.11, pred =direct , modx = Uniques , plot.points = TRUE )\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nUsing data merged from global environment. This could cause incorrect\nresults if merged has been altered since the model was fit. You can\nmanually provide the data to the \"data =\" argument.\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(Terms, newdata, na.action = na.action, xlev = object$xlevels): factor weekday has new level Sun\n```\n:::\n:::\n\nSimilarly, this graph shows that  higher direct associated with higher popularity. While exit rate is generally going down with increase of direct referrals,  higher levels of popularity generally associated with higher direct and significantly giher exit rate (i.e. popularity decreases engagement despite direct referrals increasing engagement) \n\nlower levels  of direct referrals correspond with higher exit rate and \n\nThis graph demonstrates that with the lower values of direct referrals, exit rates are higher for the same amount of unique users. \n\n\n\n\n# 4. Model for N.comments - loyal readers engagement:\n\n## 4.1. Basic model for n.comments\n\nNow as I have created a model for exit rate, I will do the same for\nn.comments as dependent variable, which represents the measurement of\nengagement of loyal readers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncolnames(merged)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"post_id\"          \"post.date\"        \"Letter\"           \"Page views\"      \n [5] \"google\"           \"direct\"           \"Visits\"           \"Uniques\"         \n [9] \"other.web\"        \"social\"           \"bdc\"              \"ll\"              \n[13] \"Exits\"            \"Exit rate\"        \"dup\"              \"n.comments\"      \n[17] \"post.year\"        \"post.month\"       \"post.likes\"       \"post.dislikes\"   \n[21] \"post.total.likes\" \"blocked.sum\"      \"pct.positive\"     \"e.rate\"          \n[25] \"year_month\"       \"post.dt\"          \"weekday\"          \"author.sum\"      \n```\n:::\n\n```{.r .cell-code}\nsummary(lm(n.comments ~ log(Uniques)+ author.sum + google +direct +other.web +social +bdc + ll + blocked.sum + pct.positive +weekday , data = merged))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = n.comments ~ log(Uniques) + author.sum + google + \n    direct + other.web + social + bdc + ll + blocked.sum + pct.positive + \n    weekday, data = merged)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-80.548 -23.394  -5.804  21.956 151.626 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)   \n(Intercept)   7.432e+01  1.637e+02   0.454  0.65021   \nlog(Uniques) -8.003e+00  1.687e+01  -0.474  0.63564   \nauthor.sum    8.216e-01  3.336e+00   0.246  0.80563   \ngoogle        2.942e-04  6.805e-04   0.432  0.66585   \ndirect        9.693e-03  5.076e-03   1.910  0.05724 . \nother.web     1.444e-03  3.526e-03   0.410  0.68238   \nsocial        6.617e-02  2.921e-02   2.266  0.02425 * \nbdc          -5.924e-03  5.062e-03  -1.170  0.24297   \nll            9.182e-03  3.776e-03   2.432  0.01567 * \nblocked.sum   4.578e-01  3.547e-01   1.291  0.19793   \npct.positive  9.584e-01  3.804e-01   2.520  0.01232 * \nweekday.L     1.638e-01  6.024e+00   0.027  0.97833   \nweekday.Q    -1.835e+01  6.078e+00  -3.019  0.00278 **\nweekday.C    -3.235e+00  5.186e+00  -0.624  0.53324   \nweekday^4    -2.934e+00  4.941e+00  -0.594  0.55316   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 37.17 on 271 degrees of freedom\n  (144 observations deleted due to missingness)\nMultiple R-squared:  0.2167,\tAdjusted R-squared:  0.1762 \nF-statistic: 5.355 on 14 and 271 DF,  p-value: 5.205e-09\n```\n:::\n\n```{.r .cell-code}\nmodel.1 <- lm(n.comments ~ log(Uniques)+ author.sum + google +direct +other.web +social +bdc + ll + blocked.sum + pct.positive +weekday , data = merged)\nmodel.2 <- lm(n.comments ~ Uniques+ author.sum + google +direct +other.web +social +bdc + ll + blocked.sum + pct.positive +weekday , data = merged)\n#removing unsignificant variables:\nmodel.3 <- lm(n.comments ~  direct  +social + ll  + pct.positive +weekday , data = merged)\nstargazer( model.1,model.2, model.3, type = 'text')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n==========================================================================================\n                                             Dependent variable:                          \n                    ----------------------------------------------------------------------\n                                                  n.comments                              \n                              (1)                     (2)                    (3)          \n------------------------------------------------------------------------------------------\nlog(Uniques)                -8.003                                                        \n                           (16.871)                                                       \n                                                                                          \nUniques                                              0.004                                \n                                                    (0.004)                               \n                                                                                          \nauthor.sum                   0.822                   0.721                                \n                            (3.336)                 (3.332)                               \n                                                                                          \ngoogle                      0.0003                  -0.004                                \n                            (0.001)                 (0.004)                               \n                                                                                          \ndirect                      0.010*                   0.008                 0.004***       \n                            (0.005)                 (0.006)                (0.001)        \n                                                                                          \nother.web                    0.001                  -0.003                                \n                            (0.004)                 (0.005)                               \n                                                                                          \nsocial                      0.066**                 0.062**                0.069**        \n                            (0.029)                 (0.029)                (0.029)        \n                                                                                          \nbdc                         -0.006                  -0.008                                \n                            (0.005)                 (0.005)                               \n                                                                                          \nll                          0.009**                 0.011**                0.012***       \n                            (0.004)                 (0.004)                (0.003)        \n                                                                                          \nblocked.sum                  0.458                   0.486                                \n                            (0.355)                 (0.355)                               \n                                                                                          \npct.positive                0.958**                0.992***                0.964**        \n                            (0.380)                 (0.380)                (0.377)        \n                                                                                          \nweekday.L                    0.164                  -0.517                  1.543         \n                            (6.024)                 (6.055)                (5.933)        \n                                                                                          \nweekday.Q                 -18.347***              -18.766***              -20.018***      \n                            (6.078)                 (6.072)                (5.934)        \n                                                                                          \nweekday.C                   -3.235                  -3.077                  -4.667        \n                            (5.186)                 (5.159)                (5.084)        \n                                                                                          \nweekday4                    -2.934                  -3.141                  -3.437        \n                            (4.941)                 (4.942)                (4.897)        \n                                                                                          \nConstant                    74.315                  -10.920                 10.915        \n                           (163.698)               (38.080)                (35.162)       \n                                                                                          \n------------------------------------------------------------------------------------------\nObservations                  286                     286                    286          \nR2                           0.217                   0.219                  0.201         \nAdjusted R2                  0.176                   0.178                  0.178         \nResidual Std. Error    37.166 (df = 271)       37.122 (df = 271)      37.133 (df = 277)   \nF Statistic         5.355*** (df = 14; 271) 5.414*** (df = 14; 271) 8.698*** (df = 8; 277)\n==========================================================================================\nNote:                                                          *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\n\n## 4.2. Diagnostics:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel.3 <- lm(n.comments ~  direct  +social + ll  + pct.positive +weekday , data = merged)\n\npar(mfrow = c(2,3))\nplot(model.3, which = 1:6)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-39-1.png){width=672}\n:::\n:::\n\n\nObservation #48 looks like on outlier impacting the model. I will remove\nthis observation to see if that gives us any different results:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmerged.old <- merged\nmerged <- merged[-c(48), ]\nmodel.3 <- lm(n.comments ~  direct  +social + ll  + pct.positive +weekday , data = merged.old )\nmodel.4 <- lm(n.comments ~  direct  +social + ll  + pct.positive +weekday , data = merged)\nstargazer( model.3, model.4, type = 'text')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n=================================================================\n                                 Dependent variable:             \n                    ---------------------------------------------\n                                     n.comments                  \n                             (1)                    (2)          \n-----------------------------------------------------------------\ndirect                     0.004***               0.004***       \n                           (0.001)                (0.001)        \n                                                                 \nsocial                     0.069**                0.069**        \n                           (0.029)                (0.029)        \n                                                                 \nll                         0.012***               0.012***       \n                           (0.003)                (0.003)        \n                                                                 \npct.positive               0.964**                0.963**        \n                           (0.377)                (0.378)        \n                                                                 \nweekday.L                   1.543                  1.549         \n                           (5.933)                (5.944)        \n                                                                 \nweekday.Q                 -20.018***             -20.046***      \n                           (5.934)                (5.950)        \n                                                                 \nweekday.C                   -4.667                 -4.664        \n                           (5.084)                (5.093)        \n                                                                 \nweekday4                    -3.437                 -3.385        \n                           (4.897)                (4.929)        \n                                                                 \nConstant                    10.915                 11.044        \n                           (35.162)               (35.245)       \n                                                                 \n-----------------------------------------------------------------\nObservations                 286                    285          \nR2                          0.201                  0.200         \nAdjusted R2                 0.178                  0.177         \nResidual Std. Error   37.133 (df = 277)      37.199 (df = 276)   \nF Statistic         8.698*** (df = 8; 277) 8.648*** (df = 8; 276)\n=================================================================\nNote:                                 *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\n\nWe can see that removing #48 changed some coefficients, did not impact\nsignificance of variables. It also improved R\\^2 and adjusted R\\^2.\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,3))\nplot(model.4, which = 1:6)\n```\n\n::: {.cell-output-display}\n![](Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-41-1.png){width=672}\n:::\n:::\n\n\n# 4. Conlusion\n\nWe have build two models for different engagement metrics: engagement of\nall readers and engagement of loyal readers. As we can see from the\nmodels, different factors contribute to engagement of these two groups\nof readers:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstargazer( model.11, model.4, type = 'text')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n=========================================================================\n                                       Dependent variable:               \n                         ------------------------------------------------\n                                  e.rate                 n.comments      \n                                    (1)                     (2)          \n-------------------------------------------------------------------------\nlog(Uniques)                       0.066                                 \n                                  (0.106)                                \n                                                                         \nlog(google)                      0.294***                                \n                                  (0.044)                                \n                                                                         \nlog(direct)                      -0.759***                               \n                                  (0.158)                                \n                                                                         \nother.web                        -0.00000*                               \n                                 (0.00000)                               \n                                                                         \ndirect                                                    0.004***       \n                                                          (0.001)        \n                                                                         \nsocial                          -0.00003**                0.069**        \n                                 (0.00002)                (0.029)        \n                                                                         \nlog(bdc)                         0.171***                                \n                                  (0.017)                                \n                                                                         \nll                                                        0.012***       \n                                                          (0.003)        \n                                                                         \npct.positive                                              0.963**        \n                                                          (0.378)        \n                                                                         \nweekday.L                        0.009***                  1.549         \n                                  (0.003)                 (5.944)        \n                                                                         \nweekday.Q                        0.017***                -20.046***      \n                                  (0.003)                 (5.950)        \n                                                                         \nweekday.C                         0.006**                  -4.664        \n                                  (0.003)                 (5.093)        \n                                                                         \nweekday4                         0.008***                  -3.385        \n                                  (0.003)                 (4.929)        \n                                                                         \nlog(Uniques):log(google)         -0.032***                               \n                                  (0.005)                                \n                                                                         \nlog(Uniques):log(direct)         0.046***                                \n                                  (0.015)                                \n                                                                         \nConstant                           1.603                   11.044        \n                                  (1.129)                 (35.245)       \n                                                                         \n-------------------------------------------------------------------------\nObservations                        286                     285          \nR2                                 0.923                   0.200         \nAdjusted R2                        0.920                   0.177         \nResidual Std. Error          0.019 (df = 273)        37.199 (df = 276)   \nF Statistic              274.118*** (df = 12; 273) 8.648*** (df = 8; 276)\n=========================================================================\nNote:                                         *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\n\n\nWe can see, that different referral sources contribute to users\nengagement. While all readers'engagement (measured with exit rate) is\ninfluenced by interaction of referrals from Google and Direct and\npopularity, internal bdc referrals and somewhat referrals from other web\nsources, loyal readers' engagement is highly impacted by the mood of the\npost, internal page referrals, social referrals. They also show some\ndirect referrals' impact, but very small in compare with its influence\non all users' engagement.\n\nWe also see significant contribution of day of the week on readers\nengagement. Specifically, Monday's engagement of all readers is\nsignificantly lower than any other day. For loyal readers, Wednesday\nshowing thee lowest engagement.\n\nIt also important to point out, that popularity of the post (Uniques)\nonly plays a role for all user's engagement. Loyal readers appear not\nbeing impacted by popularity. It is moderated by Google and direct referrals, where the posts with higher amounts of referrals show overall better engagement. \n\nTo conclude,  we found significant connection between the referral source and readers engagement. Most metrics related to the post discussion appeared non-relvent, with the exception of post mood impacting loyal readers engagement. \n\n### Limitations: \nThe role of Google referrals needs to be explored further, to identify how posts with high level of Google referrals contibute to this model. Also, finding out a cause of some pots having high Google referral rate would be beneficial for the blog development. \n\n\n\n\n\n\n\n",
    "supporting": [
      "Final_Project_check_in_5_Diana_Rinker_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}