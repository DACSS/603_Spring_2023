{
  "hash": "953bceeffcd414dea9a4031f364f4a24",
  "result": {
    "markdown": "---\ntitle: \"Check in 1 and 2 \"\nauthor: \"Paritosh G\"\ndescription: \"Template of course blog qmd file\"\ndate: \"04/05/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw1\n  - Paritosh G\n\n---\n\n\n## Research Question\n\nIdentifying the Factors which makes Students most vulnerable to be a victim of Bullying.\n\nCalling the libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──\n✔ dplyr     1.1.1     ✔ readr     2.1.4\n✔ forcats   1.0.0     ✔ stringr   1.5.0\n✔ ggplot2   3.4.2     ✔ tibble    3.2.1\n✔ lubridate 1.9.2     ✔ tidyr     1.3.0\n✔ purrr     1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\nℹ Use the \u001b]8;;http://conflicted.r-lib.org/\u0007conflicted package\u001b]8;;\u0007 to force all conflicts to become errors\n```\n:::\n\n```{.r .cell-code}\nlibrary(stringr)\nlibrary(rmarkdown)\nlibrary(knitr)\n```\n:::\n\n\nReading the data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- read.csv(\"_data/Bullying_2018.csv\", sep = \";\")\n```\n:::\n\n\nReplacing the White Spaces with \"NA\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata[data == \" \"] <- NA\n```\n:::\n\n\nreturning Sub-Strings of **\"years old\"** from Column \"Custom *Age\" && **\"time\" , \"times\", \" or...\" f**rom Column \"Physically\\_* attacked\", \"Physical_fighting\", \"Close_friends\" && **\"day\", \"days\", \" \\-\\--to....\", \"\\--or...\"** from the column Miss_school_no_permission.\n\nUsing both str_sub and sub\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata$Custom_Age <- str_sub(data$Custom_Age,1,2)\ndata$Physically_attacked <- sub(\" .*\", \"\", data$Physically_attacked)\ndata$Physical_fighting <- sub(\" .*\",\"\",data$Physical_fighting)\ndata$Close_friends <- str_sub(data$Close_friends,1,2)\ndata$Miss_school_no_permission <- sub(\" .*\",\"\",data$Miss_school_no_permission)\n```\n:::\n\n\nColumns Such as \"Felt_lonely\", \"Other_students_kind_and_helpful\", \"Parents_understand_problems\" have 5 level of text responses which are replaced into numeric as follows:\n\n1\\) \"Never\" \\<-1,\n\n2\\) \"Rarely\" \\<- 2,\n\n3\\) \"Sometimes\" \\<- 3,\n\n4\\) \"Most of the time\" \\<- 4,\n\n5\\) \"Always\" \\<- 5.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata[data == \"Never\"] <- 1\ndata[data == \"Rarely\"] <- 2\ndata[data == \"Sometimes\"] <- 3\ndata[data == \"Most of the time\"] <- 4\ndata[data == \"Always\"] <- 5\n```\n:::\n\n\nReplacing ***\"YES\" with 1*** and ***\"No\" with 0*** in the columns \"Bullied_on_school_property_in_past_12_months\" , \"Bullied_not_on_school_property_in_past_12_months\", \"Cyber_bullied_in_past_12_months\" , \"Most_of_the_time_or_always_felt_lonely\", \"Missed_classes_or_school_without_permission\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata[data == \"Yes\"] <- 1\ndata[data == \"No\"] <- 0\n```\n:::\n\n\nAssigning data-types into Factors depending upon the requirement of the model\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata$Bullied_on_school_property_in_past_12_months <- as.factor(data$Bullied_on_school_property_in_past_12_months)\ndata$Bullied_not_on_school_property_in_past_12_months <- as.factor(data$Bullied_not_on_school_property_in_past_12_months)\ndata$Cyber_bullied_in_past_12_months <- as.factor(data$Cyber_bullied_in_past_12_months)\ndata$Sex <- as.factor(data$Sex)\ndata$Felt_lonely <- as.factor(data$Felt_lonely)\ndata$Other_students_kind_and_helpful <- as.factor(data$Other_students_kind_and_helpful)\ndata$Parents_understand_problems <- as.factor(data$Parents_understand_problems)\ndata$Most_of_the_time_or_always_felt_lonely <- as.factor(data$Most_of_the_time_or_always_felt_lonely)\ndata$Missed_classes_or_school_without_permission <- as.factor(data$Missed_classes_or_school_without_permission)\n```\n:::\n\n\nAssigning the data-types into integers depending upon the requirement of the model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata$Custom_Age <- as.integer(data$Custom_Age)\ndata$Physically_attacked <- as.integer(data$Physically_attacked)\ndata$Physical_fighting <- as.integer(data$Physical_fighting)\ndata$Close_friends <- as.integer(data$Close_friends)\ndata$Miss_school_no_permission <- as.integer(data$Miss_school_no_permission)\n```\n:::\n\n\nDeleting the columns which seems irrelevant to the model or they have high number of missing values\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data[, -c(16:18)]\n```\n:::\n\n\nDeleting \"NA\" from columns 2 to 15\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata <- data[complete.cases(data),]\n```\n:::\n\n\nCoding the Logistic Regression Model\n\nNull Hypothesis :- Factors such as:\n\n1)Custom_Age\n\n2\\) Sex\n\n3)Degree to which the student was feeling lonely there are 5 levels in the dataset related to it\n\n4\\) Number of Close friends the student has\n\n5\\) Number of days the student missed school without permission there are 5 levels mentioned in the dataset related to it\n\n6\\) Degree to which other students are kind and helpful\n\n7\\) Degree to which parents understand their problems\n\n8\\) Whether they felt lonely Most of the time or always.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogistic <- glm(Bullied_on_school_property_in_past_12_months ~ Custom_Age + Sex + Felt_lonely + Close_friends + Miss_school_no_permission + Other_students_kind_and_helpful + Parents_understand_problems + Most_of_the_time_or_always_felt_lonely, family = binomial, data = data)\nsummary(logistic)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = Bullied_on_school_property_in_past_12_months ~ \n    Custom_Age + Sex + Felt_lonely + Close_friends + Miss_school_no_permission + \n        Other_students_kind_and_helpful + Parents_understand_problems + \n        Most_of_the_time_or_always_felt_lonely, family = binomial, \n    data = data)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.3730  -0.7089  -0.5708  -0.4277   2.3740  \n\nCoefficients: (1 not defined because of singularities)\n                                         Estimate Std. Error z value Pr(>|z|)\n(Intercept)                              0.473860   0.135779   3.490 0.000483\nCustom_Age                              -0.134201   0.008496 -15.796  < 2e-16\nSexMale                                 -0.018558   0.023605  -0.786 0.431765\nFelt_lonely2                             0.356116   0.034118  10.438  < 2e-16\nFelt_lonely3                             0.784856   0.033078  23.728  < 2e-16\nFelt_lonely4                             1.226552   0.039477  31.070  < 2e-16\nFelt_lonely5                             1.427658   0.048959  29.160  < 2e-16\nClose_friends                           -0.048507   0.012657  -3.832 0.000127\nMiss_school_no_permission                0.035849   0.005614   6.385 1.71e-10\nOther_students_kind_and_helpful2        -0.055115   0.043260  -1.274 0.202643\nOther_students_kind_and_helpful3        -0.267550   0.042871  -6.241 4.35e-10\nOther_students_kind_and_helpful4        -0.544506   0.043769 -12.440  < 2e-16\nOther_students_kind_and_helpful5        -0.707908   0.048992 -14.450  < 2e-16\nParents_understand_problems2             0.057328   0.034318   1.670 0.094825\nParents_understand_problems3             0.115074   0.035805   3.214 0.001310\nParents_understand_problems4             0.084336   0.037303   2.261 0.023770\nParents_understand_problems5             0.046950   0.035758   1.313 0.189177\nMost_of_the_time_or_always_felt_lonely1        NA         NA      NA       NA\n                                           \n(Intercept)                             ***\nCustom_Age                              ***\nSexMale                                    \nFelt_lonely2                            ***\nFelt_lonely3                            ***\nFelt_lonely4                            ***\nFelt_lonely5                            ***\nClose_friends                           ***\nMiss_school_no_permission               ***\nOther_students_kind_and_helpful2           \nOther_students_kind_and_helpful3        ***\nOther_students_kind_and_helpful4        ***\nOther_students_kind_and_helpful5        ***\nParents_understand_problems2            .  \nParents_understand_problems3            ** \nParents_understand_problems4            *  \nParents_understand_problems5               \nMost_of_the_time_or_always_felt_lonely1    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 52207  on 50753  degrees of freedom\nResidual deviance: 49317  on 50737  degrees of freedom\nAIC: 49351\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n\nModel-2 deleting variable Sex from the previous variable\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogistic_2 <- glm(Bullied_on_school_property_in_past_12_months ~ Custom_Age  + Felt_lonely + Close_friends + Miss_school_no_permission + Other_students_kind_and_helpful + Parents_understand_problems + Most_of_the_time_or_always_felt_lonely, family = binomial, data = data)\nsummary(logistic_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = Bullied_on_school_property_in_past_12_months ~ \n    Custom_Age + Felt_lonely + Close_friends + Miss_school_no_permission + \n        Other_students_kind_and_helpful + Parents_understand_problems + \n        Most_of_the_time_or_always_felt_lonely, family = binomial, \n    data = data)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.3705  -0.7091  -0.5708  -0.4275   2.3716  \n\nCoefficients: (1 not defined because of singularities)\n                                         Estimate Std. Error z value Pr(>|z|)\n(Intercept)                              0.464436   0.135246   3.434 0.000595\nCustom_Age                              -0.134425   0.008491 -15.831  < 2e-16\nFelt_lonely2                             0.358841   0.033941  10.572  < 2e-16\nFelt_lonely3                             0.790375   0.032326  24.450  < 2e-16\nFelt_lonely4                             1.233638   0.038438  32.094  < 2e-16\nFelt_lonely5                             1.434696   0.048137  29.804  < 2e-16\nClose_friends                           -0.048548   0.012656  -3.836 0.000125\nMiss_school_no_permission                0.035705   0.005612   6.363 1.98e-10\nOther_students_kind_and_helpful2        -0.054129   0.043241  -1.252 0.210650\nOther_students_kind_and_helpful3        -0.267190   0.042868  -6.233 4.58e-10\nOther_students_kind_and_helpful4        -0.544039   0.043765 -12.431  < 2e-16\nOther_students_kind_and_helpful5        -0.706932   0.048975 -14.434  < 2e-16\nParents_understand_problems2             0.057627   0.034315   1.679 0.093084\nParents_understand_problems3             0.115107   0.035805   3.215 0.001305\nParents_understand_problems4             0.084713   0.037299   2.271 0.023136\nParents_understand_problems5             0.047617   0.035746   1.332 0.182829\nMost_of_the_time_or_always_felt_lonely1        NA         NA      NA       NA\n                                           \n(Intercept)                             ***\nCustom_Age                              ***\nFelt_lonely2                            ***\nFelt_lonely3                            ***\nFelt_lonely4                            ***\nFelt_lonely5                            ***\nClose_friends                           ***\nMiss_school_no_permission               ***\nOther_students_kind_and_helpful2           \nOther_students_kind_and_helpful3        ***\nOther_students_kind_and_helpful4        ***\nOther_students_kind_and_helpful5        ***\nParents_understand_problems2            .  \nParents_understand_problems3            ** \nParents_understand_problems4            *  \nParents_understand_problems5               \nMost_of_the_time_or_always_felt_lonely1    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 52207  on 50753  degrees of freedom\nResidual deviance: 49318  on 50738  degrees of freedom\nAIC: 49350\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n\nModel-3 generating model to learn about the factors affecting cyber bullying\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlogistic3 <- glm(Cyber_bullied_in_past_12_months ~ Custom_Age + Sex + Felt_lonely + Close_friends + Miss_school_no_permission + Other_students_kind_and_helpful + Parents_understand_problems + Most_of_the_time_or_always_felt_lonely, family = binomial, data = data)\nsummary(logistic3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nglm(formula = Cyber_bullied_in_past_12_months ~ Custom_Age + \n    Sex + Felt_lonely + Close_friends + Miss_school_no_permission + \n    Other_students_kind_and_helpful + Parents_understand_problems + \n    Most_of_the_time_or_always_felt_lonely, family = binomial, \n    data = data)\n\nDeviance Residuals: \n    Min       1Q   Median       3Q      Max  \n-1.4350  -0.7279  -0.5546  -0.4073   2.3254  \n\nCoefficients: (1 not defined because of singularities)\n                                         Estimate Std. Error z value Pr(>|z|)\n(Intercept)                             -2.098113   0.136725 -15.345  < 2e-16\nCustom_Age                               0.030872   0.008399   3.675 0.000237\nSexMale                                 -0.461395   0.023888 -19.315  < 2e-16\nFelt_lonely2                             0.455650   0.034863  13.070  < 2e-16\nFelt_lonely3                             0.832488   0.033747  24.668  < 2e-16\nFelt_lonely4                             1.264661   0.039855  31.732  < 2e-16\nFelt_lonely5                             1.466739   0.049311  29.745  < 2e-16\nClose_friends                            0.004034   0.012881   0.313 0.754136\nMiss_school_no_permission                0.059858   0.005422  11.040  < 2e-16\nOther_students_kind_and_helpful2        -0.052590   0.045070  -1.167 0.243270\nOther_students_kind_and_helpful3        -0.167107   0.044545  -3.751 0.000176\nOther_students_kind_and_helpful4        -0.205658   0.044745  -4.596 4.30e-06\nOther_students_kind_and_helpful5        -0.361692   0.049508  -7.306 2.76e-13\nParents_understand_problems2             0.083632   0.033838   2.472 0.013455\nParents_understand_problems3             0.101362   0.035462   2.858 0.004259\nParents_understand_problems4            -0.029512   0.037313  -0.791 0.428983\nParents_understand_problems5            -0.126788   0.036233  -3.499 0.000467\nMost_of_the_time_or_always_felt_lonely1        NA         NA      NA       NA\n                                           \n(Intercept)                             ***\nCustom_Age                              ***\nSexMale                                 ***\nFelt_lonely2                            ***\nFelt_lonely3                            ***\nFelt_lonely4                            ***\nFelt_lonely5                            ***\nClose_friends                              \nMiss_school_no_permission               ***\nOther_students_kind_and_helpful2           \nOther_students_kind_and_helpful3        ***\nOther_students_kind_and_helpful4        ***\nOther_students_kind_and_helpful5        ***\nParents_understand_problems2            *  \nParents_understand_problems3            ** \nParents_understand_problems4               \nParents_understand_problems5            ***\nMost_of_the_time_or_always_felt_lonely1    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 52664  on 50753  degrees of freedom\nResidual deviance: 49297  on 50737  degrees of freedom\nAIC: 49331\n\nNumber of Fisher Scoring iterations: 4\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#render(\"Check_in_1&2.qmd\", output_file = \"my_document.html\", output_format = \"html_document\")\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}