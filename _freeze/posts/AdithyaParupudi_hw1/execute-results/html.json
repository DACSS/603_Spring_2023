{
  "hash": "68e69daa87f32d4665de1e390c16333d",
  "result": {
    "markdown": "---\ntitle: \"Homework1 - EDA of LungCap Data\"\nauthor: \"Adithya Parpudi\"\ndescription: \"HW1 submission\"\ndate: \"02/23/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw1\n  - Adithya Parupudi\n---\n\n\n# Libraries\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.1     ✔ purrr   0.3.4\n✔ tibble  3.1.8     ✔ dplyr   1.0.9\n✔ tidyr   1.2.1     ✔ stringr 1.4.1\n✔ readr   2.1.3     ✔ forcats 0.5.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.2.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(hrbrthemes)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNOTE: Either Arial Narrow or Roboto Condensed fonts are required to use these themes.\n      Please use hrbrthemes::import_roboto_condensed() to install Roboto Condensed and\n      if Arial Narrow is not on your system, please see https://bit.ly/arialnarrow\n```\n:::\n\n```{.r .cell-code}\nlibrary(viridis)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'viridis' was built under R version 4.2.2\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: viridisLite\n```\n:::\n\n```{.r .cell-code}\nlibrary(readxl)\n```\n:::\n\n\n\n# Read data\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read_excel(\"_data/LungCapData.xls\")\n```\n:::\n\n\n\n# Answering Questions\n## Question 1\n\n### 1a) The distribution of LungCap looks as follows:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(df$LungCap)\n```\n\n::: {.cell-output-display}\n![](AdithyaParupudi_hw1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nThe histogram suggests that the distribution is close to a normal distribution. Most of the observations are close to the mean. Very few observations are close to the margins (0 and 15).\n\n### 1b) Compare the probability distribution of the LungCap with respect to Males and Females? (Hint:make boxplots separated by gender using the boxplot() function)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#boxplot code\n\ndf %>%\n  ggplot( aes(x=Gender, y=LungCap, fill=Gender)) +\n    geom_boxplot() +\n    theme_ipsum() +\n    theme(\n      legend.position=\"none\",\n      plot.title = element_text(size=12)\n    ) +\n    ggtitle(\"Lungcap vs Gender\") +\n    xlab(\"Gender\") +\n  ylab(\"Lung Cap\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family not\nfound in Windows font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family not\nfound in Windows font database\n\nWarning in grid.Call(C_stringMetric, as.graphicsAnnot(x$label)): font family not\nfound in Windows font database\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in grid.Call.graphics(C_text, as.graphicsAnnot(x$label), x$x, x$y, :\nfont family not found in Windows font database\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in grid.Call(C_textBounds, as.graphicsAnnot(x$label), x$x, x$y, : font\nfamily not found in Windows font database\n```\n:::\n\n::: {.cell-output-display}\n![](AdithyaParupudi_hw1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n### c) Compare the mean lung capacities for smokers and non-smokers. Does it make sense?\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_smoke <- df %>%\n  group_by(Smoke) %>%\n  summarise(mean = mean(LungCap))\nmean_smoke\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  Smoke  mean\n  <chr> <dbl>\n1 no     7.77\n2 yes    8.65\n```\n:::\n:::\n\nAccording to this mean, it doesn't make sense that lung capacities of smokers is greater than that of non-smokers. \n\n\n### d) Examine the relationship between Smoking and Lung Capacity within age groups: “less than or\nequal to 13”, “14 to 15”, “16 to 17”, and “greater than or equal to 18”.\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- mutate(df, AgeGrp = case_when(Age <= 13 ~ \"less than or equal to 13\",\n                                    Age == 14 | Age == 15 ~ \"14 to 15\",\n                                    Age == 16 | Age == 17 ~ \"16 to 17\",\n                                    Age >= 18 ~ \"greater than or equal to 18\"))\n\ndf %>%\n  ggplot(aes(y = LungCap, color = Smoke)) +\n  geom_histogram(bins = 25) +\n  facet_wrap(vars(AgeGrp)) +\n  labs(title = \"Relationship of LungCap and Smoke based on Age\", y = \"Lung Capacity\", x = \"Frequency\")\n```\n\n::: {.cell-output-display}\n![](AdithyaParupudi_hw1_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n\n### e) Compare the lung capacities for smokers and non-smokers within each age group. Is your answer different from the one in part c. What could possibly be going on here?\n\n::: {.cell}\n\n```{.r .cell-code}\ndf %>%\n  ggplot(aes(x = Age, y = LungCap, color = Smoke)) +\n  geom_line() +\n  theme_classic() + \n  facet_wrap(vars(Smoke)) +\n  labs(title = \"Relationship of LungCap and Smoke v/s Age\", y = \"Lung Capacity\", x = \"Age\")\n```\n\n::: {.cell-output-display}\n![](AdithyaParupudi_hw1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n\n## Question 2\n\n### Reading the table\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPrior_convitions <- c(0:4)\nInmate_count <- c(128, 434, 160, 64, 24)\nPc <- data_frame(Prior_convitions, Inmate_count)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: `data_frame()` was deprecated in tibble 1.1.0.\nℹ Please use `tibble()` instead.\n```\n:::\n\n```{.r .cell-code}\nPc\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 2\n  Prior_convitions Inmate_count\n             <int>        <dbl>\n1                0          128\n2                1          434\n3                2          160\n4                3           64\n5                4           24\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nPc <- mutate(Pc, Probability = Inmate_count/sum(Inmate_count))\nPc\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 5 × 3\n  Prior_convitions Inmate_count Probability\n             <int>        <dbl>       <dbl>\n1                0          128      0.158 \n2                1          434      0.536 \n3                2          160      0.198 \n4                3           64      0.0790\n5                4           24      0.0296\n```\n:::\n:::\n\n\n\n### 2a - Probability that a randomly selected inmate has exactly 2 prior convictions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPc %>%\n  filter(Prior_convitions == 2) %>%\n  select(Probability)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  Probability\n        <dbl>\n1       0.198\n```\n:::\n:::\n\n\n### 2b - Probability that a randomly selected inmate has fewer than 2 convictions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp <- Pc %>%\n  filter(Prior_convitions < 2)\nsum(temp$Probability)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6938272\n```\n:::\n:::\n\n\n### 2c - Probability that a randomly selected inmate has 2 or fewer prior convictions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp <- Pc %>%\n  filter(Prior_convitions <= 2)\nsum(temp$Probability)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.891358\n```\n:::\n:::\n\n\n### 2d - Probability that a randomly selected inmate has more than 2 prior convictions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntemp <- Pc %>%\n  filter(Prior_convitions > 2)\nsum(temp$Probability)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.108642\n```\n:::\n:::\n\n\n### 2e - Expected value for the number of prior convictions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nPc <- mutate(Pc, Wm = Prior_convitions*Probability)\ne <- sum(Pc$Wm)\ne\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.28642\n```\n:::\n:::\n\n\n### 2f - Variance for the Prior Convictions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nv <-sum(((Pc$Prior_convitions-e)^2)*Pc$Probability)\nv\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8562353\n```\n:::\n:::\n\n\nstandard deviation for the Prior Convictions:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsqrt(v)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9253298\n```\n:::\n:::\n",
    "supporting": [
      "AdithyaParupudi_hw1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}