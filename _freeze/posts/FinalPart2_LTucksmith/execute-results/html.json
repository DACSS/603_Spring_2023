{
  "hash": "3a0b3c2d60e2a2d868dc7574fc6ded5c",
  "result": {
    "markdown": "---\ntitle: \"FinalPart2\"\nauthor: \"Liam Tucksmith\"\ndesription: \"FinalPart2\"\ndate: \"05/02/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - finalpart2\n  - Liam Tucksmith\n  - tidyverse\n  - readxl\n  - ggplot2\n  - dplyr\n  - tidyr\n  - janitor\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nlibrary(janitor)\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\nNote: I slightly changed my final project to be looking at sports betting rather than media. The media portion was too ambitious so I pivoted to something more straightforward. Please let me know if that is an issue. \n\nThe most profitable sports league in the world, the National Football League, generated $18 billion in revenue in 2021 according to sportico.com. This total represents national media rights, league sponsorships with gambling companies, news outlets, and other companies, and shared revenue and royalties from the league’s various affiliates and subsidiaries, such as NFL Enterprises, NFL Properties, and NFL International. Sports betting, an industry linked to the NFL, generated $7.5 in revenue in 2021. As money is what keeps the NFL afloat and allows teams to competitively pay for top players and coaches, NFL teams benefit from sports betting engagement and vice versa. What I plan to analyze how the win-rate of a team relates to the ratio of correct money line predictions for that team, season by season. My hypothesis is that teams with higher win ratios will have higher correct money-line prediction ratios, both when they are favored, not favored, and in total. \n\nThe first dataset is a collection of all the matchups and scores that occurred in the NFL since 1966. The matchup information includes the names of the two teams competing, home/away team status, the match site, the weather on game day, and the final score for each team. Sports betting data for each game since 1977 is also included, and includes who was favored (money line), the point spread (point differential), and the over/under line. The dataset is from https://www.kaggle.com/datasets/tobycrabtree/nfl-scores-and-betting-data and was created from a variety of sources including games and scores from public websites such as ESPN, NFL.com, and Pro Football Reference. Weather information is from NOAA data, cross-referenced with NFLweather.com. Betting data reflects lines available at sportsline.com and aussportsbetting.com. For the analysis, I will limit the data to the data collected from the previous 5 years. \n\nData import and clean-up\n\n::: {.cell}\n\n```{.r .cell-code}\n#read in data\n\nscores <- read.csv(\"~/Documents/GitHub/603_Spring_2023/posts/_data/spreadspoke_scores.csv\")\ncolnames(scores)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"schedule_date\"       \"schedule_season\"     \"schedule_week\"      \n [4] \"schedule_playoff\"    \"team_home\"           \"score_home\"         \n [7] \"score_away\"          \"team_away\"           \"team_favorite_id\"   \n[10] \"spread_favorite\"     \"over_under_line\"     \"stadium\"            \n[13] \"stadium_neutral\"     \"weather_temperature\" \"weather_wind_mph\"   \n[16] \"weather_humidity\"    \"weather_detail\"     \n```\n:::\n\n```{.r .cell-code}\nscores <- scores[scores$schedule_season >= 2018, ]\nsummary(scores)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n schedule_date      schedule_season schedule_week      schedule_playoff\n Length:1372        Min.   :2018    Length:1372        Mode :logical   \n Class :character   1st Qu.:2019    Class :character   FALSE:1311      \n Mode  :character   Median :2020    Mode  :character   TRUE :61        \n                    Mean   :2020                                       \n                    3rd Qu.:2021                                       \n                    Max.   :2022                                       \n                                                                       \n  team_home           score_home      score_away     team_away        \n Length:1372        Min.   : 0.00   Min.   : 0.00   Length:1372       \n Class :character   1st Qu.:17.00   1st Qu.:16.00   Class :character  \n Mode  :character   Median :24.00   Median :23.00   Mode  :character  \n                    Mean   :23.82   Mean   :22.52                     \n                    3rd Qu.:30.25   3rd Qu.:30.00                     \n                    Max.   :56.00   Max.   :59.00                     \n                                                                      \n team_favorite_id   spread_favorite   over_under_line   stadium         \n Length:1372        Min.   :-21.500   Min.   :32.00   Length:1372       \n Class :character   1st Qu.: -7.000   1st Qu.:43.00   Class :character  \n Mode  :character   Median : -4.500   Median :46.00   Mode  :character  \n                    Mean   : -5.476   Mean   :46.12                     \n                    3rd Qu.: -3.000   3rd Qu.:49.00                     \n                    Max.   : -1.000   Max.   :63.50                     \n                                                                        \n stadium_neutral weather_temperature weather_wind_mph weather_humidity\n Mode :logical   Min.   : 7.0        Min.   : 0.000   Min.   :  8.00  \n FALSE:1350      1st Qu.:59.0        1st Qu.: 0.000   1st Qu.: 54.00  \n TRUE :22        Median :72.0        Median : 0.000   Median : 67.00  \n                 Mean   :64.8        Mean   : 3.219   Mean   : 66.59  \n                 3rd Qu.:72.0        3rd Qu.: 6.000   3rd Qu.: 80.25  \n                 Max.   :97.0        Max.   :33.000   Max.   :100.00  \n                 NA's   :695         NA's   :695      NA's   :1292    \n weather_detail    \n Length:1372       \n Class :character  \n Mode  :character  \n                   \n                   \n                   \n                   \n```\n:::\n\n```{.r .cell-code}\nglimpse(scores)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 1,372\nColumns: 17\n$ schedule_date       <chr> \"9/6/2018\", \"9/9/2018\", \"9/9/2018\", \"9/9/2018\", \"9…\n$ schedule_season     <int> 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 20…\n$ schedule_week       <chr> \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", \"1\", …\n$ schedule_playoff    <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, F…\n$ team_home           <chr> \"Philadelphia Eagles\", \"Arizona Cardinals\", \"Balti…\n$ score_home          <int> 18, 6, 47, 16, 21, 27, 24, 23, 28, 27, 24, 27, 40,…\n$ score_away          <int> 12, 24, 3, 8, 21, 24, 23, 34, 38, 20, 16, 20, 48, …\n$ team_away           <chr> \"Atlanta Falcons\", \"Washington Redskins\", \"Buffalo…\n$ team_favorite_id    <chr> \"PHI\", \"ARI\", \"BAL\", \"CAR\", \"PIT\", \"DEN\", \"GB\", \"C…\n$ spread_favorite     <dbl> -1.0, -2.0, -7.5, -2.5, -3.5, -3.0, -6.5, -1.0, -3…\n$ over_under_line     <dbl> 44.5, 43.5, 39.0, 42.5, 41.0, 42.5, 45.0, 47.5, 48…\n$ stadium             <chr> \"Lincoln Financial Field\", \"University of Phoenix …\n$ stadium_neutral     <lgl> FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, F…\n$ weather_temperature <int> 81, 72, 61, 81, 58, 84, 62, 72, 84, 89, 72, 62, 72…\n$ weather_wind_mph    <int> 8, 0, 12, 9, 11, 5, 10, 0, 8, 7, 0, 10, 0, 7, 0, 1…\n$ weather_humidity    <int> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n$ weather_detail      <chr> \"rain\", \"indoor\", \"rain\", \"rain\", \"rain\", \"\", \"\", …\n```\n:::\n:::\n\n\nData cleanup and descriptive analytics\n\n::: {.cell}\n\n```{.r .cell-code}\n#map team names to abbreviations\nunique(scores$team_home)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Philadelphia Eagles\"      \"Arizona Cardinals\"       \n [3] \"Baltimore Ravens\"         \"Carolina Panthers\"       \n [5] \"Cleveland Browns\"         \"Denver Broncos\"          \n [7] \"Green Bay Packers\"        \"Indianapolis Colts\"      \n [9] \"Los Angeles Chargers\"     \"Miami Dolphins\"          \n[11] \"Minnesota Vikings\"        \"New England Patriots\"    \n[13] \"New Orleans Saints\"       \"New York Giants\"         \n[15] \"Detroit Lions\"            \"Oakland Raiders\"         \n[17] \"Cincinnati Bengals\"       \"Atlanta Falcons\"         \n[19] \"Buffalo Bills\"            \"Dallas Cowboys\"          \n[21] \"Jacksonville Jaguars\"     \"Los Angeles Rams\"        \n[23] \"New York Jets\"            \"Pittsburgh Steelers\"     \n[25] \"San Francisco 49ers\"      \"Tampa Bay Buccaneers\"    \n[27] \"Tennessee Titans\"         \"Washington Redskins\"     \n[29] \"Chicago Bears\"            \"Houston Texans\"          \n[31] \"Kansas City Chiefs\"       \"Seattle Seahawks\"        \n[33] \"Washington Football Team\" \"Las Vegas Raiders\"       \n[35] \"Washington Commanders\"   \n```\n:::\n\n```{.r .cell-code}\nunique(scores$team_favorite_id)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"PHI\" \"ARI\" \"BAL\" \"CAR\" \"PIT\" \"DEN\" \"GB\"  \"CIN\" \"LAC\" \"TEN\" \"MIN\" \"NE\" \n[13] \"NO\"  \"JAX\" \"DET\" \"LAR\" \"ATL\" \"DAL\" \"NYJ\" \"SF\"  \"HOU\" \"WAS\" \"CHI\" \"CLE\"\n[25] \"KC\"  \"MIA\" \"SEA\" \"IND\" \"LVR\" \"TB\"  \"NYG\" \"BUF\"\n```\n:::\n\n```{.r .cell-code}\n#rewrite team_home and team_away to use IDs\nscores$team_home[scores$team_home==\"Philadelphia Eagles\"] <- \"PHI\"\nscores$team_home[scores$team_home==\"Arizona Cardinals\"] <- \"ARI\"\nscores$team_home[scores$team_home==\"Baltimore Ravens\"] <- \"BAL\"\nscores$team_home[scores$team_home==\"Carolina Panthers\"] <- \"CAR\"\nscores$team_home[scores$team_home==\"Cleveland Browns\"] <- \"CLE\"\nscores$team_home[scores$team_home==\"Denver Broncos\"] <- \"DEN\"\nscores$team_home[scores$team_home==\"Green Bay Packers\"] <- \"GB\"\nscores$team_home[scores$team_home==\"Indianapolis Colts\"] <- \"IND\"\nscores$team_home[scores$team_home==\"Los Angeles Chargers\"] <- \"LAC\"\nscores$team_home[scores$team_home==\"Miami Dolphins\"] <- \"MIA\"\nscores$team_home[scores$team_home==\"Minnesota Vikings\"] <- \"MIN\"\nscores$team_home[scores$team_home==\"New England Patriots\"] <- \"NE\"\nscores$team_home[scores$team_home==\"New Orleans Saints\"] <- \"NO\"\nscores$team_home[scores$team_home==\"New York Giants\"] <- \"NYG\"\nscores$team_home[scores$team_home==\"Detroit Lions\"] <- \"DET\"\nscores$team_home[scores$team_home==\"Oakland Raiders\" | \n                 scores$team_home==\"Las Vegas Raiders\"] <- \"LVR\"\nscores$team_home[scores$team_home==\"Cincinnati Bengals\"] <- \"CIN\"\nscores$team_home[scores$team_home==\"Atlanta Falcons\"] <- \"ATL\"\nscores$team_home[scores$team_home==\"Buffalo Bills\"] <- \"BUF\"\nscores$team_home[scores$team_home==\"Dallas Cowboys\"] <- \"DAL\"\nscores$team_home[scores$team_home==\"Jacksonville Jaguars\"] <- \"JAX\"\nscores$team_home[scores$team_home==\"Los Angeles Rams\"] <- \"LAR\"\nscores$team_home[scores$team_home==\"New York Jets\"] <- \"NYJ\"\nscores$team_home[scores$team_home==\"Pittsburgh Steelers\"] <- \"PIT\"\nscores$team_home[scores$team_home==\"San Francisco 49ers\"] <- \"SF\"\nscores$team_home[scores$team_home==\"Tampa Bay Buccaneers\"] <- \"TB\"\nscores$team_home[scores$team_home==\"Tennessee Titans\"] <- \"TEN\"\nscores$team_home[scores$team_home==\"Washington Redskins\" | \n                 scores$team_home==\"Washington Football Team\"|\n                 scores$team_home==\"Washington Commanders\"] <- \"WAS\"\nscores$team_home[scores$team_home==\"Chicago Bears\"] <- \"CHI\"\nscores$team_home[scores$team_home==\"Houston Texans\"] <- \"HOU\"\nscores$team_home[scores$team_home==\"Kansas City Chiefs\"] <- \"KC\"\nscores$team_home[scores$team_home==\"Seattle Seahawks\"] <- \"SEA\"\n\nscores$team_away[scores$team_away==\"Philadelphia Eagles\"] <- \"PHI\"\nscores$team_away[scores$team_away==\"Arizona Cardinals\"] <- \"ARI\"\nscores$team_away[scores$team_away==\"Baltimore Ravens\"] <- \"BAL\"\nscores$team_away[scores$team_away==\"Carolina Panthers\"] <- \"CAR\"\nscores$team_away[scores$team_away==\"Cleveland Browns\"] <- \"CLE\"\nscores$team_away[scores$team_away==\"Denver Broncos\"] <- \"DEN\"\nscores$team_away[scores$team_away==\"Green Bay Packers\"] <- \"GB\"\nscores$team_away[scores$team_away==\"Indianapolis Colts\"] <- \"IND\"\nscores$team_away[scores$team_away==\"Los Angeles Chargers\"] <- \"LAC\"\nscores$team_away[scores$team_away==\"Miami Dolphins\"] <- \"MIA\"\nscores$team_away[scores$team_away==\"Minnesota Vikings\"] <- \"MIN\"\nscores$team_away[scores$team_away==\"New England Patriots\"] <- \"NE\"\nscores$team_away[scores$team_away==\"New Orleans Saints\"] <- \"NO\"\nscores$team_away[scores$team_away==\"New York Giants\"] <- \"NYG\"\nscores$team_away[scores$team_away==\"Detroit Lions\"] <- \"DET\"\nscores$team_away[scores$team_away==\"Oakland Raiders\" | \n                 scores$team_away==\"Las Vegas Raiders\"] <- \"LVR\"\nscores$team_away[scores$team_away==\"Cincinnati Bengals\"] <- \"CIN\"\nscores$team_away[scores$team_away==\"Atlanta Falcons\"] <- \"ATL\"\nscores$team_away[scores$team_away==\"Buffalo Bills\"] <- \"BUF\"\nscores$team_away[scores$team_away==\"Dallas Cowboys\"] <- \"DAL\"\nscores$team_away[scores$team_away==\"Jacksonville Jaguars\"] <- \"JAX\"\nscores$team_away[scores$team_away==\"Los Angeles Rams\"] <- \"LAR\"\nscores$team_away[scores$team_away==\"New York Jets\"] <- \"NYJ\"\nscores$team_away[scores$team_away==\"Pittsburgh Steelers\"] <- \"PIT\"\nscores$team_away[scores$team_away==\"San Francisco 49ers\"] <- \"SF\"\nscores$team_away[scores$team_away==\"Tampa Bay Buccaneers\"] <- \"TB\"\nscores$team_away[scores$team_away==\"Tennessee Titans\"] <- \"TEN\"\nscores$team_away[scores$team_away==\"Washington Redskins\" | \n                 scores$team_away==\"Washington Football Team\"|\n                 scores$team_away==\"Washington Commanders\"] <- \"WAS\"\nscores$team_away[scores$team_away==\"Chicago Bears\"] <- \"CHI\"\nscores$team_away[scores$team_away==\"Houston Texans\"] <- \"HOU\"\nscores$team_away[scores$team_away==\"Kansas City Chiefs\"] <- \"KC\"\nscores$team_away[scores$team_away==\"Seattle Seahawks\"] <- \"SEA\"\n\nunique(scores$team_home)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"PHI\" \"ARI\" \"BAL\" \"CAR\" \"CLE\" \"DEN\" \"GB\"  \"IND\" \"LAC\" \"MIA\" \"MIN\" \"NE\" \n[13] \"NO\"  \"NYG\" \"DET\" \"LVR\" \"CIN\" \"ATL\" \"BUF\" \"DAL\" \"JAX\" \"LAR\" \"NYJ\" \"PIT\"\n[25] \"SF\"  \"TB\"  \"TEN\" \"WAS\" \"CHI\" \"HOU\" \"KC\"  \"SEA\"\n```\n:::\n\n```{.r .cell-code}\nn_distinct(scores$team_home)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 32\n```\n:::\n\n```{.r .cell-code}\nunique(scores$team_away)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"ATL\" \"WAS\" \"BUF\" \"DAL\" \"PIT\" \"SEA\" \"CHI\" \"CIN\" \"KC\"  \"TEN\" \"SF\"  \"HOU\"\n[13] \"TB\"  \"JAX\" \"NYJ\" \"LAR\" \"BAL\" \"CAR\" \"LAC\" \"NYG\" \"LVR\" \"MIN\" \"NE\"  \"ARI\"\n[25] \"CLE\" \"MIA\" \"DET\" \"PHI\" \"IND\" \"NO\"  \"DEN\" \"GB\" \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#add column for game winner\nscores$score_home = as.integer(scores$score_home)\nscores$score_away = as.integer(scores$score_away)\n\nscores$winner = ifelse(scores$score_home == scores$score_away, \"TIE\", ifelse(scores$score_home > scores$score_away, scores$team_home, scores$team_away))\n\n#add column for if money line prediction is true\nscores$mlTF = ifelse(scores$winner == scores$team_favorite_id, TRUE, FALSE)\nscores$mlHomeAway = ifelse(scores$team_home == scores$team_favorite_id, \"Home\", \"Away\")\n\n#get counts for wins and losses, correct and incorrect moneyline predictions when favored and not favored, for away and home games\nhome_team <- scores %>% group_by(team_home, schedule_season) %>% \n                  summarise(home_wins = sum(team_home == winner),\n                            home_losses = sum(team_away == winner),\n                            ml_incorr_favored_h = sum(mlTF == FALSE & mlHomeAway == \"Home\"),\n                            ml_incorr_unfavored_h = sum(mlTF == FALSE & mlHomeAway == \"Away\"),\n                            ml_corr_favored_h = sum(mlTF == TRUE & mlHomeAway == \"Home\"),\n                            ml_corr_unfavored_h = sum(mlTF == TRUE & mlHomeAway == \"Away\"),\n                            .groups = 'drop')\n\naway_team <- scores %>% group_by(team_away, schedule_season) %>% \n                  summarise(away_wins = sum(team_away == winner),\n                            away_losses = sum(team_home == winner),\n                            ml_incorr_favored_a = sum(mlTF == FALSE & mlHomeAway == \"Away\"),\n                            ml_incorr_unfavored_a = sum(mlTF == FALSE & mlHomeAway == \"Home\"),\n                            ml_corr_favored_a = sum(mlTF == TRUE & mlHomeAway == \"Away\"),\n                            ml_corr_unfavored_a = sum(mlTF == TRUE & mlHomeAway == \"Home\"),\n                            .groups = 'drop')\n\n#merge home and away data\nteams <- merge(home_team, away_team, \n               by.x = c(\"team_home\",\"schedule_season\"), \n               by.y = c(\"team_away\",\"schedule_season\"))\n\ncolnames(teams)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"team_home\"             \"schedule_season\"       \"home_wins\"            \n [4] \"home_losses\"           \"ml_incorr_favored_h\"   \"ml_incorr_unfavored_h\"\n [7] \"ml_corr_favored_h\"     \"ml_corr_unfavored_h\"   \"away_wins\"            \n[10] \"away_losses\"           \"ml_incorr_favored_a\"   \"ml_incorr_unfavored_a\"\n[13] \"ml_corr_favored_a\"     \"ml_corr_unfavored_a\"  \n```\n:::\n\n```{.r .cell-code}\nteams <- teams %>% \n       rename(\"team\" = \"team_home\")\n\n#combine home and away fields \nteams$total_wins <- teams$home_wins + teams$away_wins\nteams$total_losses <- teams$home_losses + teams$away_losses\nteams$total_home_games <- teams$home_wins + teams$home_losses\n\n#combine favored and unfavored, correct and incorrect data\nteams$ml_corr_favored <- teams$ml_corr_favored_h + teams$ml_corr_favored_a \nteams$ml_corr_unfavored <- teams$ml_corr_unfavored_h + teams$ml_corr_unfavored_a\nteams$ml_corr_total <- teams$ml_corr_favored + teams$ml_corr_unfavored \nteams$ml_incorr_favored <- teams$ml_incorr_favored_h + teams$ml_incorr_favored_a\nteams$ml_incorr_unfavored <- teams$ml_incorr_unfavored_h + teams$ml_incorr_unfavored_a\nteams$ml_incorr_total <- teams$ml_incorr_favored + teams$ml_incorr_unfavored \n\n#calculate win, correct, uncorrect, and total money line predictions\nteams$win_ratio = teams$total_wins/(teams$total_wins + teams$total_losses)\nteams$ratio_corr_favored = teams$ml_corr_favored/(teams$ml_corr_favored + teams$ml_incorr_favored)\nteams$ratio_corr_unfavored = teams$ml_corr_unfavored/(teams$ml_corr_unfavored + teams$ml_incorr_unfavored)\nteams$ratio_corr_total = teams$ml_corr_total/(teams$ml_corr_total + teams$ml_incorr_total)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(teams, 50)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   team schedule_season home_wins home_losses ml_incorr_favored_h\n1   ARI            2018         1           7                   2\n2   ARI            2019         2           5                   1\n3   ARI            2020         4           4                   3\n4   ARI            2021         3           5                   5\n5   ARI            2022         1           8                   1\n6   ATL            2018         4           4                   4\n7   ATL            2019         3           5                   2\n8   ATL            2020         2           6                   3\n9   ATL            2021         2           6                   2\n10  ATL            2022         6           3                   0\n11  BAL            2018         6           3                   3\n12  BAL            2019         7           2                   2\n13  BAL            2020         5           3                   3\n14  BAL            2021         5           4                   2\n15  BAL            2022         5           3                   2\n16  BUF            2018         4           4                   1\n17  BUF            2019         4           4                   1\n18  BUF            2020         9           1                   0\n19  BUF            2021         7           3                   3\n20  BUF            2022         8           2                   2\n21  CAR            2018         5           3                   1\n22  CAR            2019         2           6                   3\n23  CAR            2020         2           6                   3\n24  CAR            2021         2           6                   3\n25  CAR            2022         5           4                   3\n26  CHI            2018         7           2                   1\n27  CHI            2019         4           4                   3\n28  CHI            2020         3           5                   1\n29  CHI            2021         3           5                   0\n30  CHI            2022         2           7                   1\n31  CIN            2018         4           4                   1\n32  CIN            2019         2           6                   2\n33  CIN            2020         3           5                   0\n34  CIN            2021         6           5                   2\n35  CIN            2022         7           1                   1\n36  CLE            2018         5           2                   1\n37  CLE            2019         4           4                   2\n38  CLE            2020         6           2                   1\n39  CLE            2021         6           3                   2\n40  CLE            2022         4           4                   3\n41  DAL            2018         8           1                   1\n42  DAL            2019         5           3                   3\n43  DAL            2020         4           4                   2\n44  DAL            2021         5           4                   4\n45  DAL            2022         8           1                   0\n46  DEN            2018         3           5                   2\n47  DEN            2019         5           3                   1\n48  DEN            2020         2           6                   0\n49  DEN            2021         4           5                   4\n50  DEN            2022         4           4                   2\n   ml_incorr_unfavored_h ml_corr_favored_h ml_corr_unfavored_h away_wins\n1                      0                 1                   5         2\n2                      3                 0                   4         3\n3                      1                 3                   1         4\n4                      0                 3                   0         8\n5                      0                 1                   7         3\n6                      0                 4                   0         3\n7                      1                 2                   3         4\n8                      1                 1                   3         2\n9                      0                 2                   4         5\n10                     2                 4                   3         1\n11                     0                 6                   0         4\n12                     2                 5                   0         7\n13                     0                 5                   0         7\n14                     1                 4                   2         3\n15                     0                 5                   1         5\n16                     2                 2                   3         2\n17                     0                 4                   3         6\n18                     2                 7                   1         6\n19                     0                 7                   0         5\n20                     0                 8                   0         6\n21                     1                 4                   2         2\n22                     0                 2                   3         3\n23                     2                 0                   3         3\n24                     1                 1                   3         3\n25                     5                 0                   1         2\n26                     1                 6                   1         5\n27                     1                 3                   1         4\n28                     2                 1                   4         5\n29                     0                 3                   5         3\n30                     1                 1                   6         1\n31                     0                 4                   3         2\n32                     2                 0                   4         0\n33                     2                 1                   5         1\n34                     2                 4                   3         7\n35                     1                 6                   0         7\n36                     4                 2                   1         2\n37                     0                 4                   2         2\n38                     0                 6                   1         6\n39                     0                 6                   1         2\n40                     2                 2                   1         3\n41                     2                 6                   0         3\n42                     1                 4                   0         3\n43                     2                 2                   2         2\n44                     0                 5                   0         7\n45                     1                 7                   1         5\n46                     1                 2                   3         3\n47                     2                 3                   2         2\n48                     2                 0                   6         3\n49                     1                 3                   1         3\n50                     1                 3                   2         1\n   away_losses ml_incorr_favored_a ml_incorr_unfavored_a ml_corr_favored_a\n1            6                   0                     2                 0\n2            5                   0                     3                 0\n3            4                   2                     1                 3\n4            2                   1                     6                 2\n5            5                   1                     3                 0\n6            5                   1                     1                 2\n7            4                   1                     4                 0\n8            6                   0                     2                 0\n9            4                   0                     3                 2\n10           7                   1                     1                 0\n11           4                   2                     3                 1\n12           1                   0                     1                 6\n13           3                   1                     0                 7\n14           5                   3                     1                 2\n15           5                   2                     2                 3\n16           6                   0                     2                 0\n17           3                   0                     4                 2\n18           3                   1                     1                 5\n19           4                   2                     2                 3\n20           2                   2                     0                 6\n21           6                   4                     2                 0\n22           5                   0                     2                 1\n23           5                   0                     2                 1\n24           6                   2                     2                 1\n25           6                   1                     2                 0\n26           3                   2                     1                 4\n27           4                   1                     0                 4\n28           4                   0                     4                 1\n29           6                   0                     2                 1\n30           7                   0                     1                 0\n31           6                   0                     1                 1\n32           8                   1                     0                 0\n33           6                   0                     2                 0\n34           3                   1                     5                 2\n35           4                   2                     1                 6\n36           6                   0                     1                 1\n37           6                   4                     1                 1\n38           4                   1                     3                 3\n39           6                   0                     1                 1\n40           6                   1                     2                 1\n41           6                   1                     3                 0\n42           5                   4                     0                 3\n43           6                   2                     1                 1\n44           2                   0                     2                 5\n45           5                   3                     2                 3\n46           5                   2                     1                 2\n47           6                   1                     2                 0\n48           5                   0                     3                 0\n49           5                   2                     1                 2\n50           8                   3                     1                 0\n   ml_corr_unfavored_a total_wins total_losses total_home_games ml_corr_favored\n1                    6          3           13                8               1\n2                    5          5           10                7               0\n3                    2          8            8                8               6\n4                    1         11            7                8               5\n5                    4          4           13                9               1\n6                    4          7            9                8               6\n7                    3          7            9                8               2\n8                    6          4           12                8               1\n9                    4          7           10                8               4\n10                   6          7           10                9               4\n11                   2         10            7                9               7\n12                   1         14            3                9              11\n13                   2         12            6                8              12\n14                   2          8            9                9               6\n15                   3         10            8                8               8\n16                   6          6           10                8               2\n17                   3         10            7                8               6\n18                   2         15            4               10              12\n19                   2         12            7               10              10\n20                   0         14            4               10              14\n21                   2          7            9                8               4\n22                   5          5           11                8               3\n23                   5          5           11                8               1\n24                   4          5           12                8               2\n25                   5          7           10                9               0\n26                   1         12            5                9              10\n27                   3          8            8                8               7\n28                   4          8            9                8               2\n29                   6          6           11                8               4\n30                   7          3           14                9               1\n31                   6          6           10                8               5\n32                   7          2           14                8               0\n33                   6          4           11                8               1\n34                   2         13            8               11               6\n35                   2         14            5                8              12\n36                   6          7            8                7               3\n37                   2          6           10                8               5\n38                   3         12            6                8               9\n39                   6          8            9                9               7\n40                   5          7           10                8               3\n41                   5         11            7                9               6\n42                   1          8            8                8               7\n43                   4          6           10                8               3\n44                   2         12            6                9              10\n45                   2         13            6                9              10\n46                   3          6           10                8               4\n47                   5          7            9                8               3\n48                   5          5           11                8               0\n49                   3          7           10                9               5\n50                   5          5           12                8               3\n   ml_corr_unfavored ml_corr_total ml_incorr_favored ml_incorr_unfavored\n1                 11            12                 2                   2\n2                  9             9                 1                   6\n3                  3             9                 5                   2\n4                  1             6                 6                   6\n5                 11            12                 2                   3\n6                  4            10                 5                   1\n7                  6             8                 3                   5\n8                  9            10                 3                   3\n9                  8            12                 2                   3\n10                 9            13                 1                   3\n11                 2             9                 5                   3\n12                 1            12                 2                   3\n13                 2            14                 4                   0\n14                 4            10                 5                   2\n15                 4            12                 4                   2\n16                 9            11                 1                   4\n17                 6            12                 1                   4\n18                 3            15                 1                   3\n19                 2            12                 5                   2\n20                 0            14                 4                   0\n21                 4             8                 5                   3\n22                 8            11                 3                   2\n23                 8             9                 3                   4\n24                 7             9                 5                   3\n25                 6             6                 4                   7\n26                 2            12                 3                   2\n27                 4            11                 4                   1\n28                 8            10                 1                   6\n29                11            15                 0                   2\n30                13            14                 1                   2\n31                 9            14                 1                   1\n32                11            11                 3                   2\n33                11            12                 0                   4\n34                 5            11                 3                   7\n35                 2            14                 3                   2\n36                 7            10                 1                   5\n37                 4             9                 6                   1\n38                 4            13                 2                   3\n39                 7            14                 2                   1\n40                 6             9                 4                   4\n41                 5            11                 2                   5\n42                 1             8                 7                   1\n43                 6             9                 4                   3\n44                 2            12                 4                   2\n45                 3            13                 3                   3\n46                 6            10                 4                   2\n47                 7            10                 2                   4\n48                11            11                 0                   5\n49                 4             9                 6                   2\n50                 7            10                 5                   2\n   ml_incorr_total win_ratio ratio_corr_favored ratio_corr_unfavored\n1                4 0.1875000          0.3333333            0.8461538\n2                7 0.3333333          0.0000000            0.6000000\n3                7 0.5000000          0.5454545            0.6000000\n4               12 0.6111111          0.4545455            0.1428571\n5                5 0.2352941          0.3333333            0.7857143\n6                6 0.4375000          0.5454545            0.8000000\n7                8 0.4375000          0.4000000            0.5454545\n8                6 0.2500000          0.2500000            0.7500000\n9                5 0.4117647          0.6666667            0.7272727\n10               4 0.4117647          0.8000000            0.7500000\n11               8 0.5882353          0.5833333            0.4000000\n12               5 0.8235294          0.8461538            0.2500000\n13               4 0.6666667          0.7500000            1.0000000\n14               7 0.4705882          0.5454545            0.6666667\n15               6 0.5555556          0.6666667            0.6666667\n16               5 0.3750000          0.6666667            0.6923077\n17               5 0.5882353          0.8571429            0.6000000\n18               4 0.7894737          0.9230769            0.5000000\n19               7 0.6315789          0.6666667            0.5000000\n20               4 0.7777778          0.7777778                  NaN\n21               8 0.4375000          0.4444444            0.5714286\n22               5 0.3125000          0.5000000            0.8000000\n23               7 0.3125000          0.2500000            0.6666667\n24               8 0.2941176          0.2857143            0.7000000\n25              11 0.4117647          0.0000000            0.4615385\n26               5 0.7058824          0.7692308            0.5000000\n27               5 0.5000000          0.6363636            0.8000000\n28               7 0.4705882          0.6666667            0.5714286\n29               2 0.3529412          1.0000000            0.8461538\n30               3 0.1764706          0.5000000            0.8666667\n31               2 0.3750000          0.8333333            0.9000000\n32               5 0.1250000          0.0000000            0.8461538\n33               4 0.2666667          1.0000000            0.7333333\n34              10 0.6190476          0.6666667            0.4166667\n35               5 0.7368421          0.8000000            0.5000000\n36               6 0.4666667          0.7500000            0.5833333\n37               7 0.3750000          0.4545455            0.8000000\n38               5 0.6666667          0.8181818            0.5714286\n39               3 0.4705882          0.7777778            0.8750000\n40               8 0.4117647          0.4285714            0.6000000\n41               7 0.6111111          0.7500000            0.5000000\n42               8 0.5000000          0.5000000            0.5000000\n43               7 0.3750000          0.4285714            0.6666667\n44               6 0.6666667          0.7142857            0.5000000\n45               6 0.6842105          0.7692308            0.5000000\n46               6 0.3750000          0.5000000            0.7500000\n47               6 0.4375000          0.6000000            0.6363636\n48               5 0.3125000                NaN            0.6875000\n49               8 0.4117647          0.4545455            0.6666667\n50               7 0.2941176          0.3750000            0.7777778\n   ratio_corr_total\n1         0.7500000\n2         0.5625000\n3         0.5625000\n4         0.3333333\n5         0.7058824\n6         0.6250000\n7         0.5000000\n8         0.6250000\n9         0.7058824\n10        0.7647059\n11        0.5294118\n12        0.7058824\n13        0.7777778\n14        0.5882353\n15        0.6666667\n16        0.6875000\n17        0.7058824\n18        0.7894737\n19        0.6315789\n20        0.7777778\n21        0.5000000\n22        0.6875000\n23        0.5625000\n24        0.5294118\n25        0.3529412\n26        0.7058824\n27        0.6875000\n28        0.5882353\n29        0.8823529\n30        0.8235294\n31        0.8750000\n32        0.6875000\n33        0.7500000\n34        0.5238095\n35        0.7368421\n36        0.6250000\n37        0.5625000\n38        0.7222222\n39        0.8235294\n40        0.5294118\n41        0.6111111\n42        0.5000000\n43        0.5625000\n44        0.6666667\n45        0.6842105\n46        0.6250000\n47        0.6250000\n48        0.6875000\n49        0.5294118\n50        0.5882353\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#plot correct and incorrect moneyline prediction ratio for each team by season\nagg_tbl <- teams %>% group_by(team, schedule_season) %>% \n  summarise(corr_ratio = (sum(ml_corr_total)/(sum(ml_corr_total + ml_incorr_total))),\n            incorr_ratio = (sum(ml_incorr_total)/(sum(ml_corr_total + ml_incorr_total))),\n            sum = sum(ml_corr_total + ml_incorr_total),\n            .groups = 'drop')\n\nggplot(agg_tbl, aes(factor(team), fill=factor(corr_ratio))) +     \n  geom_bar()\n```\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(agg_tbl, aes(x=schedule_season, y=corr_ratio)) +     \n  geom_col() + \n  facet_wrap(~team)\n```\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#plot correct moneyline prediction ratio for each team by season, facet  by team\nagg_tbl2 <- teams %>% group_by(team, schedule_season) %>% \n  summarise(ratio = (sum(ml_corr_favored)/(sum(ml_corr_favored + ml_incorr_favored))),\n            .groups = 'drop')\n\nggplot(agg_tbl2, aes(x=schedule_season, y=ratio)) +     \n  geom_col() + \n  facet_wrap(~team)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing missing values (`position_stack()`).\n```\n:::\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#plot win ratio of each team by season \nagg_tbl3 <- teams %>% group_by(team, schedule_season) %>% \n  summarise(ratio = total_wins/(total_wins + total_losses),\n            .groups = 'drop')\n\nggplot(agg_tbl3, aes(x=schedule_season, y=ratio)) +     \n  geom_point(aes(colour = factor(team))) \n```\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nregFavored <- lm(teams$ratio_corr_favored ~ teams$win_ratio)\nprint(summary(regFavored))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = teams$ratio_corr_favored ~ teams$win_ratio)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.52819 -0.06854 -0.01043  0.07007  0.61637 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      0.19088    0.04002    4.77 4.24e-06 ***\nteams$win_ratio  0.81917    0.07578   10.81  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1685 on 154 degrees of freedom\n  (4 observations deleted due to missingness)\nMultiple R-squared:  0.4314,\tAdjusted R-squared:  0.4277 \nF-statistic: 116.9 on 1 and 154 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nregUnfavored <- lm(teams$ratio_corr_unfavored ~ teams$win_ratio)\nprint(summary(regUnfavored))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = teams$ratio_corr_unfavored ~ teams$win_ratio)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.44543 -0.07571 -0.01488  0.05314  0.59908 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      0.96472    0.03471   27.79   <2e-16 ***\nteams$win_ratio -0.70474    0.06720  -10.49   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1496 on 154 degrees of freedom\n  (4 observations deleted due to missingness)\nMultiple R-squared:  0.4167,\tAdjusted R-squared:  0.4129 \nF-statistic:   110 on 1 and 154 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nregTotal <- lm(teams$ratio_corr_total ~ teams$win_ratio)\nprint(summary(regTotal))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = teams$ratio_corr_total ~ teams$win_ratio)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.31798 -0.09001  0.01632  0.08683  0.23861 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      0.657053   0.026274  25.008   <2e-16 ***\nteams$win_ratio -0.009385   0.050237  -0.187    0.852    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1145 on 158 degrees of freedom\nMultiple R-squared:  0.0002208,\tAdjusted R-squared:  -0.006107 \nF-statistic: 0.0349 on 1 and 158 DF,  p-value: 0.8521\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nregFavoredTeam <- lm(teams$ratio_corr_favored ~ teams$win_ratio + teams$team)\nprint(summary(regFavoredTeam))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = teams$ratio_corr_favored ~ teams$win_ratio + teams$team)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.48798 -0.07169 -0.00507  0.08247  0.58378 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      0.04455    0.08219   0.542  0.58875    \nteams$win_ratio  0.77329    0.09733   7.945 1.05e-12 ***\nteams$teamATL    0.18652    0.10426   1.789  0.07607 .  \nteams$teamBAL    0.15363    0.10699   1.436  0.15358    \nteams$teamBUF    0.24468    0.10725   2.281  0.02424 *  \nteams$teamCAR   -0.02201    0.10426  -0.211  0.83314    \nteams$teamCHI    0.32875    0.10445   3.147  0.00207 ** \nteams$teamCIN    0.28718    0.10436   2.752  0.00683 ** \nteams$teamCLE    0.23153    0.10474   2.210  0.02892 *  \nteams$teamDAL    0.14911    0.10594   1.407  0.16182    \nteams$teamDEN    0.14430    0.11057   1.305  0.19432    \nteams$teamDET    0.18153    0.11058   1.642  0.10324    \nteams$teamGB     0.15153    0.10719   1.414  0.15998    \nteams$teamHOU    0.09757    0.11074   0.881  0.38000    \nteams$teamIND    0.16508    0.10491   1.573  0.11819    \nteams$teamJAX   -0.03209    0.10456  -0.307  0.75941    \nteams$teamKC     0.16428    0.11153   1.473  0.14331    \nteams$teamLAC    0.15644    0.10511   1.488  0.13921    \nteams$teamLAR    0.17190    0.10663   1.612  0.10949    \nteams$teamLVR    0.15414    0.10434   1.477  0.14214    \nteams$teamMIA    0.27068    0.11152   2.427  0.01667 *  \nteams$teamMIN    0.23795    0.10573   2.250  0.02619 *  \nteams$teamNE     0.19991    0.10619   1.883  0.06212 .  \nteams$teamNO     0.16083    0.10745   1.497  0.13703    \nteams$teamNYG    0.26148    0.10428   2.507  0.01346 *  \nteams$teamNYJ    0.18972    0.10455   1.815  0.07201 .  \nteams$teamPHI    0.18542    0.10536   1.760  0.08090 .  \nteams$teamPIT    0.12113    0.10604   1.142  0.25553    \nteams$teamSEA    0.15109    0.10607   1.424  0.15685    \nteams$teamSF     0.09851    0.10570   0.932  0.35319    \nteams$teamTB     0.20718    0.10544   1.965  0.05168 .  \nteams$teamTEN    0.13301    0.10605   1.254  0.21213    \nteams$teamWAS    0.28505    0.10426   2.734  0.00718 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1648 on 123 degrees of freedom\n  (4 observations deleted due to missingness)\nMultiple R-squared:  0.5654,\tAdjusted R-squared:  0.4523 \nF-statistic:     5 on 32 and 123 DF,  p-value: 4.13e-11\n```\n:::\n\n```{.r .cell-code}\nregUnfavoredTeam <- lm(teams$ratio_corr_unfavored ~ teams$win_ratio + teams$team)\nprint(summary(regUnfavoredTeam))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = teams$ratio_corr_unfavored ~ teams$win_ratio + teams$team)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.39959 -0.08608 -0.00109  0.05211  0.47492 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      0.88605    0.07398  11.976  < 2e-16 ***\nteams$win_ratio -0.77952    0.08754  -8.905 5.81e-15 ***\nteams$teamATL    0.13227    0.09387   1.409  0.16133    \nteams$teamBAL    0.19463    0.09633   2.020  0.04551 *  \nteams$teamBUF    0.15167    0.10144   1.495  0.13744    \nteams$teamCAR    0.02957    0.09388   0.315  0.75331    \nteams$teamCHI    0.17470    0.09405   1.858  0.06562 .  \nteams$teamCIN    0.12409    0.09397   1.321  0.18910    \nteams$teamCLE    0.17261    0.09431   1.830  0.06962 .  \nteams$teamDAL    0.08958    0.09538   0.939  0.34952    \nteams$teamDEN    0.10305    0.09386   1.098  0.27441    \nteams$teamDET    0.07868    0.09397   0.837  0.40410    \nteams$teamGB     0.06812    0.09650   0.706  0.48159    \nteams$teamHOU    0.07793    0.09387   0.830  0.40802    \nteams$teamIND    0.17593    0.09446   1.862  0.06493 .  \nteams$teamJAX    0.03949    0.09414   0.419  0.67562    \nteams$teamKC     0.15497    0.10636   1.457  0.14765    \nteams$teamLAC    0.14119    0.09464   1.492  0.13827    \nteams$teamLAR    0.18399    0.09600   1.916  0.05763 .  \nteams$teamLVR    0.07405    0.09395   0.788  0.43207    \nteams$teamMIA    0.11852    0.09433   1.256  0.21133    \nteams$teamMIN    0.28559    0.09520   3.000  0.00327 ** \nteams$teamNE     0.08791    0.10075   0.873  0.38458    \nteams$teamNO     0.01032    0.09674   0.107  0.91522    \nteams$teamNYG    0.09764    0.09389   1.040  0.30043    \nteams$teamNYJ    0.06975    0.09413   0.741  0.46009    \nteams$teamPHI    0.26264    0.09486   2.769  0.00650 ** \nteams$teamPIT    0.02303    0.09547   0.241  0.80977    \nteams$teamSEA    0.19750    0.09550   2.068  0.04072 *  \nteams$teamSF     0.07878    0.09517   0.828  0.40936    \nteams$teamTB     0.18519    0.10004   1.851  0.06656 .  \nteams$teamTEN    0.01980    0.09548   0.207  0.83605    \nteams$teamWAS    0.09817    0.09387   1.046  0.29772    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1484 on 123 degrees of freedom\n  (4 observations deleted due to missingness)\nMultiple R-squared:  0.5417,\tAdjusted R-squared:  0.4225 \nF-statistic: 4.543 on 32 and 123 DF,  p-value: 5.815e-10\n```\n:::\n\n```{.r .cell-code}\nregTotalTeam <- lm(teams$ratio_corr_total ~ teams$win_ratio + teams$team)\nprint(summary(regTotalTeam))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = teams$ratio_corr_total ~ teams$win_ratio + teams$team)\n\nResiduals:\n      Min        1Q    Median        3Q       Max \n-0.258170 -0.066978 -0.001225  0.071344  0.231886 \n\nCoefficients:\n                 Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      0.611871   0.055371  11.050  < 2e-16 ***\nteams$win_ratio -0.077729   0.064578  -1.204  0.23096    \nteams$teamATL    0.062538   0.070497   0.887  0.37670    \nteams$teamBAL    0.089987   0.072278   1.245  0.21542    \nteams$teamBUF    0.155729   0.072445   2.150  0.03348 *  \nteams$teamCAR   -0.057909   0.070500  -0.821  0.41295    \nteams$teamCHI    0.159921   0.070624   2.264  0.02525 *  \nteams$teamCIN    0.135756   0.070566   1.924  0.05661 .  \nteams$teamCLE    0.077827   0.070812   1.099  0.27382    \nteams$teamDAL    0.037130   0.071593   0.519  0.60492    \nteams$teamDEN    0.027621   0.070490   0.392  0.69583    \nteams$teamDET    0.096159   0.070570   1.363  0.17542    \nteams$teamGB     0.079802   0.072405   1.102  0.27248    \nteams$teamHOU    0.102134   0.070494   1.449  0.14984    \nteams$teamIND    0.073257   0.070925   1.033  0.30362    \nteams$teamJAX    0.036101   0.070692   0.511  0.61046    \nteams$teamKC     0.209051   0.075236   2.779  0.00629 ** \nteams$teamLAC    0.037932   0.071050   0.534  0.59436    \nteams$teamLAR    0.128579   0.072042   1.785  0.07668 .  \nteams$teamLVR    0.015484   0.070551   0.219  0.82663    \nteams$teamMIA    0.086864   0.070829   1.226  0.22232    \nteams$teamMIN    0.156510   0.071457   2.190  0.03033 *  \nteams$teamNE     0.133633   0.071755   1.862  0.06486 .  \nteams$teamNO     0.069993   0.072578   0.964  0.33669    \nteams$teamNYG    0.113411   0.070512   1.608  0.11023    \nteams$teamNYJ    0.093907   0.070685   1.329  0.18638    \nteams$teamPHI    0.107276   0.071213   1.506  0.13445    \nteams$teamPIT   -0.009167   0.071656  -0.128  0.89841    \nteams$teamSEA    0.055007   0.071675   0.767  0.44423    \nteams$teamSF     0.050447   0.071435   0.706  0.48136    \nteams$teamTB     0.115514   0.071269   1.621  0.10754    \nteams$teamTEN   -0.013591   0.071662  -0.190  0.84988    \nteams$teamWAS    0.092685   0.070497   1.315  0.19096    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1115 on 127 degrees of freedom\nMultiple R-squared:  0.2389,\tAdjusted R-squared:  0.04718 \nF-statistic: 1.246 on 32 and 127 DF,  p-value: 0.196\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nregCorrFavplot <- ggplot(teams, aes(x=win_ratio, y=ratio_corr_favored)) +     \n            geom_point(aes(colour = team)) +   \n            stat_smooth(method = \"lm\",\n                        formula = y ~ x,\n                        geom = \"smooth\")\n\nregCorrFavplot2 <- ggplot(teams, aes(x=win_ratio, y=ratio_corr_favored)) +     \n            geom_point(aes(colour = team)) + \n            stat_smooth(method = \"lm\",\n                        formula = y ~ x,\n                        geom = \"smooth\") + facet_wrap(~schedule_season)\n\nregCorrFavplot3 <- ggplot(teams, aes(x=win_ratio, y=ratio_corr_favored)) +     \n            geom_point(aes(colour = team)) + \n            stat_smooth(method = \"lm\",\n                        formula = y ~ x,\n                        geom = \"smooth\") + facet_wrap(~team)\n\nregCorrUnplot <- ggplot(teams, aes(x=win_ratio, y=ratio_corr_unfavored)) +     \n            geom_point(aes(colour = team)) +   \n            stat_smooth(method = \"lm\",\n                        formula = y ~ x,\n                        geom = \"smooth\")\n\nregCorrUnplot2 <- ggplot(teams, aes(x=win_ratio, y=ratio_corr_unfavored)) +     \n            geom_point(aes(colour = team)) + \n            stat_smooth(method = \"lm\",\n                        formula = y ~ x,\n                        geom = \"smooth\") + facet_wrap(~schedule_season)\n\nregTotalplot <- ggplot(teams, aes(x=win_ratio, y=ratio_corr_total)) +     \n            geom_point(aes(colour = team)) + \n            stat_smooth(method = \"lm\",\n                        formula = y ~ x,\n                        geom = \"smooth\") + facet_wrap(~schedule_season)\n\nregTotalplot2 <- ggplot(teams, aes(x=win_ratio, y=ratio_corr_total)) +     \n            geom_point(aes(colour = team)) + \n            stat_smooth(method = \"lm\",\n                        formula = y ~ x,\n                        geom = \"smooth\") + facet_wrap(~team)\n\nregCorrFavplot\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing non-finite values (`stat_smooth()`).\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\nregCorrFavplot2\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing non-finite values (`stat_smooth()`).\nRemoved 4 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\nregCorrFavplot3\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing non-finite values (`stat_smooth()`).\nRemoved 4 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n\n```{.r .cell-code}\nregCorrUnplot\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing non-finite values (`stat_smooth()`).\nRemoved 4 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-4.png){width=672}\n:::\n\n```{.r .cell-code}\nregCorrUnplot2\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 4 rows containing non-finite values (`stat_smooth()`).\nRemoved 4 rows containing missing values (`geom_point()`).\n```\n:::\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-5.png){width=672}\n:::\n\n```{.r .cell-code}\nregTotalplot\n```\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-6.png){width=672}\n:::\n\n```{.r .cell-code}\nregTotalplot2\n```\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-7.png){width=672}\n:::\n:::\n\n\nAfter looking through the regression models and diagnostics, the best performing model I found is (teams$ratio_corr_favored ~ teams$win_ratio). It makes sense that this model is well-performing because if you are a team with a high win_ratio across multiple years, you will inherently be favored more often and correctly favored more often. Looking at the regression lines by team is helpful for determining which teams are performing the best in the league, but ultimately that regression is not helpful as a general regression tool as it ultimately just shows the team with the highest win_ratio. \n\n::: {.cell}\n\n```{.r .cell-code}\nplot(regFavoredTeam)\n```\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-11-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-11-4.png){width=672}\n:::\n:::\n",
    "supporting": [
      "FinalPart2_LTucksmith_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}