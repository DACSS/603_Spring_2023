{
  "hash": "e23c7cc6f7d92ad5ef60ddc1456ea7ee",
  "result": {
    "markdown": "---\ntitle: \"Homework 1\"\nauthor: \"Asch Harwood\"\ndescription: \"Homework 1\"\ndate: \"02/28/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\n\ncategories:\n  - hw1\n  - desriptive statistics \n  - probability\n  \n---\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(knitr)\nlibrary(kableExtra)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\ndf <- read_excel(\"_data/LungCapData.xls\")\n```\n:::\n\n\n# Question 1\n\n### a\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#calc mean of lung cap\nlc_mean <- mean(df$LungCap)\n\n#calc sd\nlc_sd <- sd(df$LungCap)\n\n#use denorm to generate array of probabilities associated with each value of lung cap\ndf['probs'] <- dnorm(x=df$LungCap, mean=lc_mean, sd = lc_sd)\n\n#plot histogram\nggplot(df, aes(x = LungCap)) + \n  geom_histogram(aes(y=..density..), binwidth=1, color=\"black\", fill=\"white\") +\n  stat_function(fun=dnorm, args=list(mean=lc_mean, sd=lc_sd), color=\"red\") +\n  xlab(\"Lung Capacity\") + ylab(\"Density\")\n```\n\n::: {.cell-output-display}\n![](hw1_asch_harwood_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### b\n\nCompare the probability distribution of the LungCap with respect to Males and Females? \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = Gender, y = LungCap)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](hw1_asch_harwood_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\nMales have higher mean lung capacity, a slightly wider interquartile range, and a slightly higher standard deviation.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nIQR(df$LungCap[df$Gender=='male'])\nIQR(df$LungCap[df$Gender=='female'])\nsd(df$LungCap[df$Gender=='male'])\nsd(df$LungCap[df$Gender=='female'])\n```\n:::\n\n\n\n### c\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmean_df <- df %>%\n  group_by(Smoke) %>%\n  summarise(mean(LungCap))\n\nkable(mean_df, format='simple')\n```\n\n::: {.cell-output-display}\nSmoke    mean(LungCap)\n------  --------------\nno            7.770188\nyes           8.645454\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = Smoke, y = LungCap)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](hw1_asch_harwood_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nThe average lung capacity for non-smokers is 7.77 compared to 8.65 for smokers, which does not make sense. I would assume that smokers would have a lower average lung capacity than non-smokers. However, we can see that there is more variance in LungCapacity for non-smokers, which likely explains this finding.\n\n\n## d\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$AgeGroup <- cut(df$Age, breaks = c(0, 13, 15, 17, Inf),\n                    labels = c(\"<=13\", \"14 to 15\", \"16 to 17\", \">=18\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nage_group_mean <- df %>%\n  group_by(AgeGroup) %>%\n  summarise(mean(LungCap))\nkable(age_group_mean)\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> AgeGroup </th>\n   <th style=\"text-align:right;\"> mean(LungCap) </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> &lt;=13 </td>\n   <td style=\"text-align:right;\"> 6.411932 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 14 to 15 </td>\n   <td style=\"text-align:right;\"> 9.045417 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> 16 to 17 </td>\n   <td style=\"text-align:right;\"> 10.245876 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> &gt;=18 </td>\n   <td style=\"text-align:right;\"> 10.964688 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = AgeGroup, y = LungCap)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](hw1_asch_harwood_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\nThere appears to be a relationship between age and lung capacity, where as age group increases, lung capacity increases as well. This is understandable given that developmentally a younger child would have a lower lung capacity than a young adult.\n\n\n## e\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = AgeGroup, y = LungCap, fill=Smoke)) +\n  geom_boxplot() \n```\n\n::: {.cell-output-display}\n![](hw1_asch_harwood_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x = LungCap, fill = Smoke)) +\n  geom_histogram(alpha = 0.5, bins = 10, position = \"identity\") +\n  facet_wrap(~AgeGroup, nrow = 2, scales = \"free\") +\n  labs(x = \"Lung Capacity\", y = \"Frequency\") +\n  ggtitle(\"Distribution of Lung Capacity by Age Group, by Smoking Status\")\n```\n\n::: {.cell-output-display}\n![](hw1_asch_harwood_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nWhen controlling for age, average smoker lung capacity is lower across the board for all age groups except \"13 <=\". In the later group, there are far fewer smokers, as one would (hope to) expect, which explains the slightly higher mean lung capacity for smokers. \n\n\n# Question 2\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#loading data into dataframe\nprisoners <- data.frame(convictions = c(0, 1, 2, 3, 4), num_prisoners = c(128, 434, 160, 64, 24))\n\n#calculating total prisoners\ntotal_prisoners <- prisoners %>%\n  summarise(sum(num_prisoners)) %>%\n  as.numeric()\n```\n:::\n\n### a \n\n\n::: {.cell}\n\n```{.r .cell-code}\nprob_2_convictions <- round(prisoners$num_prisoners[prisoners$convictions==2]/ total_prisoners,2)\n```\n:::\n\n\nProbability of exactly 2 convictions: 0.2\n\n### b\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum_prisoner_lessthan_2 <- sum(prisoners$num_prisoners[prisoners$convictions<2])\nprob_lessthan_2_convictions <- round(sum_prisoner_lessthan_2/total_prisoners, 2)\n```\n:::\n\n\nProbability of less than 2 convictions: 0.69\n\n### c\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum_prisoner_2_orless <- sum(prisoners$num_prisoners[prisoners$convictions<=2])\nprob_2_orless_convictions <- round(sum_prisoner_2_orless/total_prisoners, 2)\n```\n:::\n\n\nProbability of 2 or fewer convictions: 0.89\n\n### d\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsum_prisoner_morethan_2 <- sum(prisoners$num_prisoners[prisoners$convictions>2])\nprob_morethan_2_convictions <- round(sum_prisoner_morethan_2/total_prisoners,2)\n```\n:::\n\n\nProbability of more than 2 convictions: 0.11\n\n### e\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_prob <- function(num_prisoners, total_prisoners) {\n  num_convictions <- prisoners$num_prisoners[prisoners$convictions== num_prisoners]\n  prob_convictions <- num_convictions/total_prisoners\n  return(prob_convictions)\n}\n\nprisoners$prob <- apply(prisoners, 1, function(x) get_prob(x['convictions'], 810))\nexpected_value <- sum(prisoners$convictions * prisoners$prob)\n```\n:::\n\n\nExpected value of number of convictions for any random prisoners: 1.2864198\n\n### f\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstd_convictions <-sd(prisoners$num_prisoners)\nvar_convictions <- var(prisoners$num_prisoners)\n```\n:::\n\n\nStandard deviation: 161.0838291\n\nVariance: 2.5948\\times 10^{4}\n\n",
    "supporting": [
      "hw1_asch_harwood_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}