{
  "hash": "df557956f3b97beb6ad5236b58d7c065",
  "result": {
    "markdown": "---\ntitle: \"Homework 5\"\nauthor: \"Liam Tucksmith\"\ndescription: \"HW5\"\ndate: \"05/13/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw5\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smss)\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: effects\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n:::\n\n\n1. \n\nA. For backward elimination, which variable would be deleted first? Why?\n\nBeds would be the first variable removed because it has the highest p-value. \n\nB. For forward selection, which variable would be added first? Why?\n\nSize would be the first variable added because in the correlation matrix it has the highest correlation with Price which translates to the lowest p-value.\n\nC. Why do you think that BEDS has such a large P-value in the multiple regression model,\neven though it has a substantial correlation with PRICE?\n\nEven though Beds has a substantial correlation with price, it could be that there is a confounding variable that is raising the correlation. Beds has the highest correlation with Size, which has the highest correlation with Price, so it could be that the Size variable is interfering with the true correlation between Beds and Price. \n\nD. Using software with these four predictors, find the model that would be selected using each\ncriterion:\n\n1. R2 - S + New + Ba + Be\n2. Adjusted R2 - S + New + Ba\n3. PRESS - S + New + Ba\n4. AIC - S + New + Ba\n5. BIC - S + New + Ba\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(formula = P ~ S, data = house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'house.selling.price.2' not found\n```\n:::\n\n```{.r .cell-code}\nm2 <- lm(formula = P ~ S + New, data = house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'house.selling.price.2' not found\n```\n:::\n\n```{.r .cell-code}\nm3 <- lm(formula = P ~ S + New + Ba, data = house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'house.selling.price.2' not found\n```\n:::\n\n```{.r .cell-code}\nm4 <- lm(formula = P ~ S + New + Ba + Be, data = house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'house.selling.price.2' not found\n```\n:::\n\n```{.r .cell-code}\nprint(\"M1\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"M1\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m1)$r.squared\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(m1): object 'm1' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(m1)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(m1): object 'm1' not found\n```\n:::\n\n```{.r .cell-code}\nprint(PRESS(m1))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(m1): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nprint(AIC(m1))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in AIC(m1): object 'm1' not found\n```\n:::\n\n```{.r .cell-code}\nprint(BIC(m1))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in BIC(m1): object 'm1' not found\n```\n:::\n\n```{.r .cell-code}\nprint(\"M2\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"M2\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m2)$r.squared\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(m2): object 'm2' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(m2)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(m2): object 'm2' not found\n```\n:::\n\n```{.r .cell-code}\nprint(PRESS(m2))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(m2): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nprint(AIC(m2))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in AIC(m2): object 'm2' not found\n```\n:::\n\n```{.r .cell-code}\nprint(BIC(m2))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in BIC(m2): object 'm2' not found\n```\n:::\n\n```{.r .cell-code}\nprint(\"M3\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"M3\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m3)$r.squared\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(m3): object 'm3' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(m3)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(m3): object 'm3' not found\n```\n:::\n\n```{.r .cell-code}\nprint(PRESS(m3))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(m3): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nprint(AIC(m3))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in AIC(m3): object 'm3' not found\n```\n:::\n\n```{.r .cell-code}\nprint(BIC(m3))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in BIC(m3): object 'm3' not found\n```\n:::\n\n```{.r .cell-code}\nprint(\"M4\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"M4\"\n```\n:::\n\n```{.r .cell-code}\nsummary(m4)$r.squared\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(m4): object 'm4' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(m4)$adj.r.squared\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(m4): object 'm4' not found\n```\n:::\n\n```{.r .cell-code}\nprint(PRESS(m4))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in PRESS(m4): could not find function \"PRESS\"\n```\n:::\n\n```{.r .cell-code}\nprint(AIC(m4))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in AIC(m4): object 'm4' not found\n```\n:::\n\n```{.r .cell-code}\nprint(BIC(m4))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in BIC(m4): object 'm4' not found\n```\n:::\n:::\n\nE. Explain which model you prefer and why.\nI prefer the model that uses Size, New, and Bath. Given the original correlation matrix, and observing the p-values of the different models has shown these three variables to have high correlation to price. \n\n2.\n\nA. Fit a multiple regression model with the Volume as the outcome and Girth and Height as\nthe explanatory variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(formula = Volume ~ Girth + Height, data = trees)\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Volume ~ Girth + Height, data = trees)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4065 -2.6493 -0.2876  2.2003  8.4847 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***\nGirth         4.7082     0.2643  17.816  < 2e-16 ***\nHeight        0.3393     0.1302   2.607   0.0145 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.882 on 28 degrees of freedom\nMultiple R-squared:  0.948,\tAdjusted R-squared:  0.9442 \nF-statistic:   255 on 2 and 28 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\nB. Run regression diagnostic plots on the model. Based on the plots, do you think any of the\nregression assumptions is violated?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(m1)\n```\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-4-4.png){width=672}\n:::\n:::\n\nWe can see from the Scale-Location plot that the assumption of equal variance plot is likely not met, as the line deviates on the plot rather than remaining generally horizontal throughout. Additionally, there is one overly influential data point in the model, as shown by the Residuals vs Leverage plot. \n\n3.\n\nA. Run a simple linear regression model where the Buchanan vote is the outcome and the\nBush vote is the explanatory variable. Produce the regression diagnostic plots. Is Palm Beach\nCounty an outlier based on the diagnostic plots? Why or why not?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"florida\")\nm1 <- lm(Buchanan ~ Bush, data = florida)\nplot(m1)\n```\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-5-4.png){width=672}\n:::\n:::\n\nPalm Beach is an outlier based on the diagnostic plots because the plots show Palm Beach plotted far outside the average line on all 4 plots. \n\nB. Take the log of both variables (Bush vote and Buchanan Vote) and repeat the analysis in\n(A.) Does your findings change?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- lm(log(Buchanan) ~ log(Bush), data = florida)\nplot(m1)\n```\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](HW5_LTucksmith_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n:::\n\nTaking the log of both variables does place Palm Beach outside Cook's distance, but it' otherwise it's still close to it. Given the nearness to Cook's distance and otherwise still being plotted far outside the average on all plots, I would still consider Palm Beach an outlier. \n\n",
    "supporting": [
      "HW5_LTucksmith_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}