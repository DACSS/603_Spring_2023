{
  "hash": "0ac8b52f63dd673801b1c2444cba7405",
  "result": {
    "markdown": "---\ntitle: \"Homework 2\"\nauthor: \"Rosemary Pang\"\ndescription: \"The second homework on hypothesis testing and confidence intervals\"\ndate: \"03/29/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: false \n    code-copy: true\n    code-tools: true\ncategories:\n  - hw2\n  - hypothesis testing\n  - confidence intervals\n---\n\n\nPlease check your answers against the solutions.\n\n## Question 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbypass_n = 539\nangio_n = 847\n\nbypass_sample_mean = 19\nangio_sample_mean = 18\n\nbypass_sample_sd = 10\nangio_sample_sd = 9\n\nbypass_se = bypass_sample_sd/sqrt(bypass_n)\nangio_se = angio_sample_sd/sqrt(angio_n)\n\nbypass_me = qt(0.95, df = bypass_n - 1)*bypass_se\nangio_me = qt(0.95, df = angio_n - 1)*angio_se\n```\n:::\n\n\nThe confidence intervals:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprint(bypass_sample_mean + c(-bypass_me, bypass_me))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 18.29029 19.70971\n```\n:::\n\n```{.r .cell-code}\nprint(angio_sample_mean + c(-angio_me, angio_me))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 17.49078 18.50922\n```\n:::\n:::\n\n\nThe size of the confidence intervals, which is twice the margin of error:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n2 * bypass_me\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.419421\n```\n:::\n\n```{.r .cell-code}\n2 * angio_me\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.018436\n```\n:::\n:::\n\n\nThe confidence interval for angiography is narrower.\n\n## Question 2\n\none-step solution:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 1031\nk = 567\nprop.test(k, n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\t1-sample proportions test with continuity correction\n\ndata:  k out of n, null probability 0.5\nX-squared = 10.091, df = 1, p-value = 0.00149\nalternative hypothesis: true p is not equal to 0.5\n95 percent confidence interval:\n 0.5189682 0.5805580\nsample estimates:\n        p \n0.5499515 \n```\n:::\n:::\n\n\nAlternatively:\n\n\n::: {.cell}\n\n```{.r .cell-code}\np_hat <- k/n # point estimate\nse = sqrt((p_hat*(1-p_hat))/n) # standard error\ne = qnorm(0.975)*se # margin of error\np_hat + c(-e, e) # confidence interval \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.5195839 0.5803191\n```\n:::\n:::\n\n\nAlternatively, we can use the exact binomial test. In large samples like the one we have, the results should essentially be the same as prop.test().\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbinom.test(k, n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tExact binomial test\n\ndata:  k and n\nnumber of successes = 567, number of trials = 1031, p-value = 0.001478\nalternative hypothesis: true probability of success is not equal to 0.5\n95 percent confidence interval:\n 0.5189927 0.5806243\nsample estimates:\nprobability of success \n             0.5499515 \n```\n:::\n:::\n\n\n## Question 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrange = 200-30\npopulation_sd = range/4\n```\n:::\n\n\nRemember:\n\n$$CI_{95} = \\bar x \\pm z \\frac{s}{\\sqrt n}$$\n(We can use $z$ because we assume population standard deviation is known.)\n\nWe want the number $n$ that ensures:\n\n$$ z \\frac{s}{\\sqrt n} = 5 $$\n$$ zs = 5 \\sqrt n$$\n$$ \\frac{zs}{5} = \\sqrt n$$\n$$  (\\frac{zs}{5})^2 = n$$\n\nIn our case:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nz = qnorm(.975)\ns = population_sd\nn = ((z *s) / 5)^2\nprint(n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 277.5454\n```\n:::\n:::\n\n\nRounding up, we need a sample of 278.\n\n## Question 4\n\nWe can write a function to find the t-statistic, and then do all the tests in a, b, and c using that.\n\n$$t = \\frac{\\bar x - \\mu}{s / \\sqrt n}$$\n\nwhere $\\bar x$ is them sample mean, $\\mu$ is the hypothesizes population mean, $s$ is the sample standard deviation, and $n$ is the sample size.\n\nWriting this in R:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nget_t_stat <- function(x_bar, mu, sd, n){\n  return((x_bar - mu) / (sd / sqrt(n)))\n}\n```\n:::\n\n\n\nFind the t-statistic:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt_stat <- get_t_stat(x_bar = 410, mu = 500, sd = 90, n = 9)\n```\n:::\n\n\n### A\n\nTwo-tailed test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nn = 9\npval_two_tail = 2*pt(t_stat, df = n-1)\npval_two_tail\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.01707168\n```\n:::\n:::\n\n\nWe can reject the hypothesis that population mean is 500.\n\n### B\n\n\n::: {.cell}\n\n```{.r .cell-code}\npval_lower_tail = pt(t_stat, df = n-1)\npval_lower_tail\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.008535841\n```\n:::\n:::\n\n\nWe can reject the hypothesis that population mean is greater than 500.\n\n### C\n\n\n::: {.cell}\n\n```{.r .cell-code}\npval_upper_tail = pt(t_stat, df = n-1, lower.tail=FALSE)\npval_upper_tail\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9914642\n```\n:::\n:::\n\n\nWe fail to reject the hypothesis that population mean is less than 500.\n\nAlternatively for C, we could just subtract the answer in B from 1:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n1 - pval_lower_tail\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9914642\n```\n:::\n:::\n\n\n\n## Question 5\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt_jones = ((519.5 - 500)/ 10)\nt_smith = ((519.7 - 500)/ 10)\ncat(\"t value for Jones:\", t_jones, '\\n')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nt value for Jones: 1.95 \n```\n:::\n\n```{.r .cell-code}\ncat(\"t value for Smith:\", t_smith, '\\n')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nt value for Smith: 1.97 \n```\n:::\n\n```{.r .cell-code}\ncat('p value for Jones:', round(2*pt(t_jones, df = 999, lower.tail=FALSE), 4), '\\n')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\np value for Jones: 0.0515 \n```\n:::\n\n```{.r .cell-code}\ncat('p value for Smith:', round(2*pt(t_smith, df = 999, lower.tail=FALSE), 4), '\\n')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\np value for Smith: 0.0491 \n```\n:::\n:::\n\n\nAt 0.05 level Smith's result is statistically significant but Jones's is not.\nThe result show the arbitrariness of the 0.05 demarcation line and the importance of reporting actual p-values to better make sense of results.\n\n## Question 6:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Creating the dataframe\ngrade_level <- c(rep(\"6th grade\", 100), rep(\"7th grade\", 100), rep(\"8th grade\", 100))\nsnack <- c(rep(\"healthy snack\", 31), rep(\"unhealthy snack\", 69), rep(\"healthy snack\", 43),\n           rep(\"unhealthy snack\", 57), rep(\"healthy snack\", 51), rep(\"unhealthy snack\", 49))\nsnack_data <- data.frame(grade_level, snack)\n```\n:::\n\n\nWe are conducting a Chi-square test in this question since we are testing the association between two categorical variables.  \n\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(snack_data$snack,snack_data$grade_level)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                 \n                  6th grade 7th grade 8th grade\n  healthy snack          31        43        51\n  unhealthy snack        69        57        49\n```\n:::\n\n```{.r .cell-code}\nchisq.test(snack_data$snack,snack_data$grade_level,correct = FALSE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's Chi-squared test\n\ndata:  snack_data$snack and snack_data$grade_level\nX-squared = 8.3383, df = 2, p-value = 0.01547\n```\n:::\n:::\n\n\nA p-value smaller than 0.05 indicates that there is a relationship between grade level and the choice of snack. \n\n## Question 7:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Creating the dataframe\nArea <- c(rep(\"Area1\", 6), rep(\"Area2\", 6), rep(\"Area3\", 6))\ncost <- c(6.2, 9.3, 6.8, 6.1, 6.7, 7.5, 7.5, 8.2, 8.5, 8.2, 7.0, 9.3,\n          5.8, 6.4, 5.6, 7.1, 3.0, 3.5)\nArea_cost <- data.frame(Area,cost)\n```\n:::\n\n\nSince we are comparing the means of more than two groups, we are using the ANOVA test in this question. \n\n\n::: {.cell}\n\n```{.r .cell-code}\none.way <- aov(cost ~ Area, data = Area_cost)\nsummary(one.way)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)   \nArea         2  25.66  12.832   8.176 0.00397 **\nResiduals   15  23.54   1.569                   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\nThe small p-value tells us that the three areas have a difference in means. ",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}