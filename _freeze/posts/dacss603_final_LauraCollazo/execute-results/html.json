{
  "hash": "4abbbcc1ccd0899e74b5417f8356016b",
  "result": {
    "markdown": "---\ntitle: \"Proposal for DACSS 603 Final Project\"\nauthor: \"Laura Collazo\"\ndesription: \"\"\ndate: \"2023-04-13\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - finalpart1\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(psych)\nlibrary(lattice)\nlibrary(FSA)\nlibrary(kableExtra)\n\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n# Research Question\n\nMany studies exist on how belonging influences in-person students yet there is an absence of literature related to this topic for online learners. This is surprising given that even before the COVID-19 pandemic students studying exclusively online experienced year-over-year growth since at least 2016 (National Center for Educational Statistics, n.d.). High levels of social belonging have repeatedly being found to influence the persistence of in-person students (Fleming et al., 2017; Johnson et al., 2007; Sriram, 2017). With this in mind, the role belonging plays among online students should not be overlooked.\n\nThere is no universal definition of belonging, but one way to think about it is a \"students' sense of being accepted, valued, included, and encouraged by others (teacher and peers) in the academic classroom setting and of feeling oneself to be an important part of the life and activity of the class\" (Goodenow, 1993). In studies of in-person students, it has been found that not all students experience belonging equally. Some of the student populations that report lower levels of belonging include:\n\n* students of color compared to their White peers (Johnson et al., 2007)\n* women and students of color studying in STEM (Thacker et al., 2022)\n* first-generation students (Longwell-Grice et al., 2016)\n* students with disabilities (Fleming et al., 2017).\n\nExperiencing a lack of belonging is not innate to these students, though, but rather a reflection of social structural inequalities present in educational systems (Brock, 2019). This reality makes belonging important to explore among students not just generally, but specifically, and is why this study will ask:\n\n**How do gender and race influence social belonging of online students?**\n\n# Hypothesis\n\nLiterature on how demographics influence the social belonging of online students is elusive making it difficult to develop a hypothesis rooted in previous literature. Therefore, since the data for this study comes from online statistics students, the hypotheses for this study will be based on the notion that underrepresented minorities in STEM experience a lower sense of belonging (Thacker et al., 2022). \n\nTo understand representation in STEM jobs by race it is helpful to examine this table which shows the breakdown of workers in all jobs compared to all STEM jobs (Fry et al., 2021).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrace <- c(\"Black\", \"Hispanic\", \"Asian\", \"Other\", \"White\")\n\nall_jobs <- c(\"11%\", \"17%\", \"6%\", \"3%\", \"63%\")\n\nall_stem_jobs <- c(\"9%\", \"8%\", \"13%\", \"3%\", \"67%\")\n\njobs <- data.frame(race, all_jobs, all_stem_jobs)\n\nkable(jobs, caption = \"Employed adults age 25+ in the 2017-19 American Community Survey\") %>% \n  kable_styling(\"striped\")\n```\n\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"margin-left: auto; margin-right: auto;\">\n<caption>Employed adults age 25+ in the 2017-19 American Community Survey</caption>\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> race </th>\n   <th style=\"text-align:left;\"> all_jobs </th>\n   <th style=\"text-align:left;\"> all_stem_jobs </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Black </td>\n   <td style=\"text-align:left;\"> 11% </td>\n   <td style=\"text-align:left;\"> 9% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Hispanic </td>\n   <td style=\"text-align:left;\"> 17% </td>\n   <td style=\"text-align:left;\"> 8% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Asian </td>\n   <td style=\"text-align:left;\"> 6% </td>\n   <td style=\"text-align:left;\"> 13% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Other </td>\n   <td style=\"text-align:left;\"> 3% </td>\n   <td style=\"text-align:left;\"> 3% </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> White </td>\n   <td style=\"text-align:left;\"> 63% </td>\n   <td style=\"text-align:left;\"> 67% </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\nEmployees who are White make up the majority of workers in STEM, yet employees who are Asian hold more than double the percentage of STEM jobs compared to the percentage of all jobs held by workers who are Asian (Fry et al., 2021). For this reason, Asian students will not be included as an underrepresented minority group in STEM. However, it is important to be mindful that many ethnic groups fall under a racial category and not all are equally represented in STEM. For instance, although Asians as a whole racial group are not underrepresented in STEM, those who are from Southeast Asia are underrepresented (Shirvaram, 2021). Future studies should be mindful of this and seek to ask for both racial and ethnic demographic data.    \n\n**Hypothesis**\n\n* Students who are part of an underrepresented racial minority group in STEM (Black or Hispanic) will report lower levels of social belonging than students who are not part of an underrepresented racial minority group in STEM (White or Asian).\n\n# Descriptive Statistics\n\n## Dataset\n\nThe data for this study was collected during the last month of the Fall 2021 semester at a large public university in the mid-west of the United States (Jeng et al., 2023). Students were recruited through voluntary response sampling in an online introduction to statistics course and received extra credit for participating in the study. The instructor of this course was not a member of the research team. A total of 240 students completed the survey and responses from 17 students were removed due to either missing demographics, the same rating for every example, or identical response made to more than 50% of open-ended questions. In total, responses from 223 students are included.\n\nThe full dataset can be found [here](https://databank.illinois.edu/datasets/IDB-2872989).\n\n### Variables\n\nTo answer the research question for the present study, the following variables have been selected. Details on these variables are included in following sections.\n\n* `gender`\n* `race`\n* `bel_1`\n* `bel_2`\n* `bel_2_r`\n* `bel_3`\n* `bel_4`\n* `bel_4_r`\n* `bel_5`\n* `bel_5_r`\n* `bel_6`\n\nUsing the above variables, additional variables were created to aid in analysis. The variable `bel_sum` was created to sum an overall belonging score for each participant. In addition, the variable `urm` was created to indicate if a student belongs to an underrepresented racial minority in STEM or not.\n\n<<<<<<< HEAD\n#### Race/Ethnicity\n\nThe response options for `race` include \"Asian or Asian American\" (1), \"Black or African American\" (2), \"Hispanic or Latino\" (3), \"White\" (4), and \"Other\" (5). Students who reported their race as \"Other\" (n = 10) have been removed from this analysis as it cannot be determined if they belong to an underrepresented minority group or not.\n\n=======\n>>>>>>> bed92586ab2f5a79ef0d32a22e813dea4708c900\n#### Gender\n\nThe responses for `gender` include \"Man\" (2) and \"Woman or non-binary\" (1). The researchers who collected this data explain that their were so few students who identified as non-binary that the sample was too small for a separate analysis (Jeng et al., 2023). What they did do was run all analysis twice, once with non-binary students excluded and once with this group combine with respondents who identified as women. They found their findings to be the same in both instances and therefore choose to combine these two groups. For the purpose of this study, this variable will be coded as \"Male\" and \"Female.\"\n\n#### Race/Ethnicity\n\nThe response options for `race` include \"Asian or Asian American\" (1), \"Black or African American\" (2), \"Hispanic or Latino\" (3), \"White\" (4), and \"Other\" (5).\n\nThe variable `year` includes four response options: 1, 2, 3 or 4. These correspond to being a Freshman, Sophomore, Junior, or Senior, and values have been coded as such.\n\n#### Belonging\n\nA total of 6 Likert questions were asked to measure social belonging which were adapted from Goodenow's (1993) Psychological Sense of School Membership (PSSM) scale. Five response options (\"Not at all true\", \"Slightly true\", \"Moderately true\", \"Mostly true\", and \"Completely true\") were provided to students to answer the below questions. Questions 2, 4, and 5 were reversed scored which is why 2 variables exist for each of these questions.\n\n<<<<<<< HEAD\n1. I feel like a real part of this class (`bel_1`)\n2. Sometimes I feel as if I don’t belong in this class(`bel_2`/`bel_2_r`)\n3. I am included in lots of activities in this class(`bel_3`)\n4. I feel very different from most other students in this class (`bel_4`/ `bel_4_r`)\n5. I wish I were in a different class (`bel_5`/`bel_5_r`)\n6. I feel proud of belonging to this class (`bel_6`)\n=======\n1. I feel like a real part of this class\n2. Sometimes I feel as if I don’t belong in this class\n3. I am included in lots of activities in this class\n4. I feel very different from most other students in this class\n5. I wish I were in a different class\n6. I feel proud of belonging to this class\n>>>>>>> bed92586ab2f5a79ef0d32a22e813dea4708c900\n\n#### Explore Data\n\n##### Prepare Data\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# read in data\n\nbelonging_data <- read_csv(\"_data/belonging_survey_2022-07-08.csv\", show_col_types = FALSE)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: '_data/belonging_survey_2022-07-08.csv' does not exist in current working directory ('C:/Users/tlcol/OneDrive/Desktop/R Directory/Repos/603_Spring_2023_new/posts').\n```\n:::\n\n```{.r .cell-code}\n# tidy data\n\ndata <- belonging_data %>%\n  \n# filter to include only 1 set of student belonging responses\n  \n  filter(example_num == 1) %>% \n  \n# filter to include remove the racial category \"Other\"\n  \n  filter(race != 5) %>% \n  \n# select needed columns\n  \n  select(gender, race, bel_1, bel_2, bel_2_r, bel_3, bel_4, bel_4_r, bel_5, bel_5_r, bel_6) %>%\n\n# create variable bel_sum which sums all belonging responses\n  \n  mutate(bel_sum = rowSums(across(c(bel_1, bel_2_r, bel_3, bel_4_r, bel_5_r, bel_6)))) %>% \n\n# create variable is_urm which turns race into a binary variable\n\n  mutate(urm = case_when(race == 1 ~ \"not underrepresented\",\n                         race == 2 ~ \"underrepresented\",\n                         race == 3 ~ \"not underrepresented\",\n                         race == 4 ~ \"underrepresented\",))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(., example_num == 1): object 'belonging_data' not found\n```\n:::\n\n```{.r .cell-code}\n### Create new variables with Likert scores as an ordered factor\n\ndata$f_bel_1 = factor(data$bel_1,\n                       ordered = TRUE,\n                       levels = c(\"1\", \"2\", \"3\", \"4\", \"5\")\n                       )\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_1: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\ndata$f_bel_2 = factor(data$bel_2,\n                       ordered = TRUE,\n                       levels = c(\"1\", \"2\", \"3\", \"4\", \"5\")\n                       )\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_2: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\ndata$f_bel_3 = factor(data$bel_3,\n                       ordered = TRUE,\n                       levels = c(\"1\", \"2\", \"3\", \"4\", \"5\")\n                       )\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_3: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\ndata$f_bel_4 = factor(data$bel_4,\n                       ordered = TRUE,\n                       levels = c(\"1\", \"2\", \"3\", \"4\", \"5\")\n                       )\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_4: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\ndata$f_bel_5 = factor(data$bel_5,\n                       ordered = TRUE,\n                       levels = c(\"1\", \"2\", \"3\", \"4\", \"5\")\n                       )\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_5: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\ndata$f_bel_6 = factor(data$bel_6,\n                       ordered = TRUE,\n                       levels = c(\"1\", \"2\", \"3\", \"4\", \"5\")\n                       )\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_6: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\n# recode data\n  \ndata <- data %>% \n  mutate(gender = recode(gender,\n                            `1` = \"Female\",\n                            `2` = \"Male\")) %>%\n  mutate(race = recode(race,\n                            `1` = \"Asian\",\n                            `2` = \"Black\",\n                            `3` = \"Hispanic\",\n                            `4` = \"White\")) %>%\n  mutate(across(bel_1:bel_6, \n                ~ recode(.x, `1` = \"Not at all true\",\n                             `2` = \"Slightly true\",\n                             `3` = \"Moderately true\",\n                             `4` = \"Mostly true\",\n                             `5` = \"Completely true\"))) %>% \n  mutate(year = recode(year,\n                        `1` = \"Freshman\",\n                        `2` = \"Sophmore\",\n                        `3` = \"Junior\",\n                        `4` = \"Senior\")) \n```\n\n::: {.cell-output .cell-output-error}\n```\nError in UseMethod(\"mutate\"): no applicable method for 'mutate' applied to an object of class \"function\"\n```\n:::\n:::\n\n##### Examine Data\n\n::: {.cell}\n\n```{.r .cell-code}\n# examine data\n\ndescribe_data <- describe(x=data) %>% \n  select(c(vars, n, mean, sd, median, min, max, range))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in is.na(x): is.na() applied to non-(list or vector) of type 'closure'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in mean.default(x, na.rm = na.rm): argument is not numeric or logical:\nreturning NA\n```\n:::\n\n::: {.cell-output .cell-output-error}\n```\nError in as.double(x): cannot coerce type 'closure' to vector of type 'double'\n```\n:::\n\n```{.r .cell-code}\nkable(describe_data) %>% \n  kable_styling(\"striped\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in kable(describe_data): object 'describe_data' not found\n```\n:::\n\n```{.r .cell-code}\nstr(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nfunction (..., list = character(), package = NULL, lib.loc = NULL, verbose = getOption(\"verbose\"), \n    envir = .GlobalEnv, overwrite = TRUE)  \n```\n:::\n:::\n\n##### Examine Variables\n\n\n::: {.cell}\n\n```{.r .cell-code}\n\n# create xtabs and bar plot to visualize variables\n\n<<<<<<< HEAD\n# race\n\nxt_race <- xtabs(~race, data = data)\n\nkable(xt_race) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_race, \n        xlab = \"Race\",\n        ylab = \"Frequency\")\n\n# urm\n\nxt_urm <- xtabs(~urm, data = data)\n\nkable(xt_urm) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_urm, \n        xlab = \"URM\",\n        ylab = \"Frequency\")\n\n=======\n>>>>>>> bed92586ab2f5a79ef0d32a22e813dea4708c900\n# gender\n\nxt_gender <- xtabs(~gender, data = data)\n\nkable(xt_gender) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_gender, \n        xlab = \"Gender\",\n        ylab = \"Frequency\")\n\n# race\n\nxt_race <- xtabs(~race, data = data)\n\nkable(xt_race) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_race, \n        xlab = \"Race\",\n        ylab = \"Frequency\")\n\n# bel_sum\n\nxt_sum <- xtabs(~bel_sum, data = data)\n\nkable(xt_sum) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_sum, \n        xlab = \"Belonging\",\n        ylab = \"Frequency\")\n\n# f_bel_1\n\nxt_1 <- xtabs(~f_bel_1, data = data)\n\nkable(xt_1) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_1, \n        xlab = \"I feel like a real part of this class\",\n        ylab = \"Frequency\")\n\n# f_bel_2\n\nxt_2 <- xtabs(~f_bel_2, data = data)\n\nkable(xt_2) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_2, \n        xlab = \"Sometimes I feel as if I don’t belong in this class\",\n        ylab = \"Frequency\")\n\n# f_bel_3\n\nxt_3 <- xtabs(~f_bel_3, data = data)\n\nkable(xt_3) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_3, \n        xlab = \"I am included in lots of activities in this class\",\n        ylab = \"Frequency\")\n\n# f_bel_4\n\nxt_4 <- xtabs(~f_bel_4, data = data)\n\nkable(xt_4) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_4, \n        xlab = \"I feel very different from most other students in this class\",\n        ylab = \"Frequency\")\n\n# f_bel_5\n\nxt_5 <- xtabs(~f_bel_5, data = data)\n\nkable(xt_5) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_5, \n        xlab = \"I wish I were in a different class\",\n        ylab = \"Frequency\")\n\n# f_bel_6\n\nxt_6 <- xtabs(~f_bel_6, data = data)\n\nkable(xt_6) %>% \n  kable_styling(\"striped\")\n\nbarplot(xt_6, \n        xlab = \"I feel proud of belonging to this class\",\n        ylab = \"Frequency\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError: <text>:4:1: unexpected input\n3: \n4: <<\n   ^\n```\n:::\n:::\n\n\n# Analysis\n\n<<<<<<< HEAD\n=======\nBelow are some preliminary visualizations for analysis. This section will be modified in the coming weeks before check-in two.\n\n##### Histograms\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# histograms\n\nhistogram(~ bel_sum | gender,\n          data=data,\n          layout=c(1,2))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(substitute(groups), data, environment(formula)): invalid 'envir' argument of type 'closure'\n```\n:::\n\n```{.r .cell-code}\nhistogram(~ bel_sum | race,\n          data=data,\n          layout=c(2,5))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(substitute(groups), data, environment(formula)): invalid 'envir' argument of type 'closure'\n```\n:::\n:::\n\n\n>>>>>>> bed92586ab2f5a79ef0d32a22e813dea4708c900\n##### Boxplots\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# bel_sum, urm\n\nggplot(data, aes(x = urm, y = bel_sum, color = urm))+\n    geom_boxplot()+\n    ylab(\"Belonging\")+xlab(\"URM\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `ggplot()`:\n! `data` cannot be a function.\nℹ Have you misspelled the `data` argument in `ggplot()`\n```\n:::\n\n```{.r .cell-code}\n# bel_sum, urm, gender\n\nggplot(data, aes(x = urm, y = bel_sum, color = gender))+\n    geom_boxplot()+\n    ylab(\"Belonging\")+xlab(\"URM\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `ggplot()`:\n! `data` cannot be a function.\nℹ Have you misspelled the `data` argument in `ggplot()`\n```\n:::\n\n```{.r .cell-code}\n# bel_sum, urm, year\n\ndata %>% \n  mutate(year = as.factor(year)) %>% \nggplot(aes(x = urm, y = bel_sum, color = year))+\n    geom_boxplot()+\n    ylab(\"Belonging\")+xlab(\"URM\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in UseMethod(\"mutate\"): no applicable method for 'mutate' applied to an object of class \"function\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nbel_plot <-function(myxvar, myxlabel) {\n  data %>%\n    group_by({{myxvar}}, urm) %>%\n  summarise(count = n()) %>%\n    mutate(percent = count/sum(count) * 100) %>% \n    ggplot(aes(x = factor ({{myxvar}}, levels = c(\"Not at all true\", \"Slightly true\", \"Moderately true\", \"Mostly true\", \"Completely true\")),\n             y = percent, \n             fill = urm)) + \n    geom_bar(stat = \"identity\", position = \"fill\") + \n    labs(y = \"Frequency\", \n         x = myxlabel,\n         title = \"Sense of belonging by whether students' race is underrepresented in STEM \" )\n}\n\nbel_plot(bel_1, \"I feel like a real part of this class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in UseMethod(\"group_by\"): no applicable method for 'group_by' applied to an object of class \"function\"\n```\n:::\n\n```{.r .cell-code}\nbel_plot(bel_2, \"Sometimes I feel as if I don’t belong in this class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in UseMethod(\"group_by\"): no applicable method for 'group_by' applied to an object of class \"function\"\n```\n:::\n\n```{.r .cell-code}\nbel_plot(bel_3, \"I am included in lots of activities in this class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in UseMethod(\"group_by\"): no applicable method for 'group_by' applied to an object of class \"function\"\n```\n:::\n\n```{.r .cell-code}\nbel_plot(bel_4, \"I feel very different from most other students in this class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in UseMethod(\"group_by\"): no applicable method for 'group_by' applied to an object of class \"function\"\n```\n:::\n\n```{.r .cell-code}\nbel_plot(bel_5, \"I wish I were in a different class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in UseMethod(\"group_by\"): no applicable method for 'group_by' applied to an object of class \"function\"\n```\n:::\n\n```{.r .cell-code}\nbel_plot(bel_6, \"I feel proud of belonging to this class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in UseMethod(\"group_by\"): no applicable method for 'group_by' applied to an object of class \"function\"\n```\n:::\n:::\n\n\n# Hypothesis Testing\n\nThe explanatory variable in this study is `urm`. It is a categorical variable.\n\nThe response variables in this study include `bel_1`, `bel_2`, `bel_3`, `bel_4`, `bel_5`, and `bel_6`, which are ordinal variables, and `bel_sum`, which is a ratio variable. \n\nThe control variables in this study are `gender` and `year`. These variables are categorical.\n\n## ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# https://www.scribbr.com/statistics/anova-in-r/\n\nfit_sum <- aov(bel_sum ~ urm, data = data)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in as.data.frame.default(data, optional = TRUE): cannot coerce class '\"function\"' to a data.frame\n```\n:::\n\n```{.r .cell-code}\nsummary(fit_sum)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(fit_sum): object 'fit_sum' not found\n```\n:::\n\n```{.r .cell-code}\nplot(fit_sum)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(fit_sum): object 'fit_sum' not found\n```\n:::\n\n```{.r .cell-code}\n# this has a small F value indicating variation is more likely due to chance, not the independent variable.\n\n# The Pr(>F) value is not low so it appears URM doesn't impact belonging\n```\n:::\n\n\n## Chi-squared\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchi_bel_plot <- function(mydata, myxvar, mytitle) {\n  ggplot({{mydata}}, aes(x=factor ({{myxvar}}, levels = c(\"Not at all true\", \"Slightly true\", \"Moderately true\", \"Mostly true\", \"Completely true\")),y=Freq, fill=urm)) +\n  geom_bar(stat=\"identity\",position=\"dodge\") +\n  labs(x = mytitle)\n}\n\n# chisq and bel_1\n\nchisq.test(data$bel_1, data$urm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_1: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\nbel_1_urm <- data.frame(with(data, table(bel_1,urm)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(substitute(expr), data, enclos = parent.frame()): invalid 'envir' argument of type 'closure'\n```\n:::\n\n```{.r .cell-code}\nchi_bel_plot(bel_1_urm, bel_1, \"I feel like a real part of this class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot({: object 'bel_1_urm' not found\n```\n:::\n\n```{.r .cell-code}\n# chisq and bel_2\n\nchisq.test(data$bel_2, data$urm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_2: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\nbel_2_urm <- data.frame(with(data, table(bel_2,urm)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(substitute(expr), data, enclos = parent.frame()): invalid 'envir' argument of type 'closure'\n```\n:::\n\n```{.r .cell-code}\nchi_bel_plot(bel_2_urm, bel_2, \"Sometimes I feel as if I don’t belong in this class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot({: object 'bel_2_urm' not found\n```\n:::\n\n```{.r .cell-code}\n# chisq and bel_3 (SIGNIFICANT P)\n\nchisq.test(data$bel_3, data$urm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_3: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\nbel_3_urm <- data.frame(with(data, table(bel_3,urm)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(substitute(expr), data, enclos = parent.frame()): invalid 'envir' argument of type 'closure'\n```\n:::\n\n```{.r .cell-code}\nchi_bel_plot(bel_3_urm, bel_3, \"I am included in lots of activities in this class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot({: object 'bel_3_urm' not found\n```\n:::\n\n```{.r .cell-code}\n# chisq and bel_4\n\nchisq.test(data$bel_4, data$urm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_4: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\nbel_4_urm <- data.frame(with(data, table(bel_4,urm)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(substitute(expr), data, enclos = parent.frame()): invalid 'envir' argument of type 'closure'\n```\n:::\n\n```{.r .cell-code}\nchi_bel_plot(bel_4_urm, bel_4, \"I feel very different from most other students in this class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot({: object 'bel_4_urm' not found\n```\n:::\n\n```{.r .cell-code}\n# chisq and bel_5 (SIGNIFICANT P)\n\nchisq.test(data$bel_5, data$urm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_5: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\nbel_5_urm <- data.frame(with(data, table(bel_5,urm)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(substitute(expr), data, enclos = parent.frame()): invalid 'envir' argument of type 'closure'\n```\n:::\n\n```{.r .cell-code}\nchi_bel_plot(bel_5_urm, bel_5, \"I wish I were in a different class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot({: object 'bel_5_urm' not found\n```\n:::\n\n```{.r .cell-code}\n# chisq and bel_6\n\nchisq.test(data$bel_6, data$urm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$bel_6: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\nbel_6_urm <- data.frame(with(data, table(bel_6,urm)))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(substitute(expr), data, enclos = parent.frame()): invalid 'envir' argument of type 'closure'\n```\n:::\n\n```{.r .cell-code}\nchi_bel_plot(bel_6_urm, bel_6, \"I feel proud of belonging to this class\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot({: object 'bel_6_urm' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data, aes(x = race, y = bel_sum, color = gender))+\n    geom_boxplot()+\n    ylab(\"Belonging\")+xlab(\"Race\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `ggplot()`:\n! `data` cannot be a function.\nℹ Have you misspelled the `data` argument in `ggplot()`\n```\n:::\n\n```{.r .cell-code}\ndata %>% \n  mutate(year = as.factor(year)) %>% \nggplot(aes(x = race, y = bel_sum, color = year))+\n    geom_boxplot()+\n    ylab(\"Belonging\")+xlab(\"Race\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in UseMethod(\"mutate\"): no applicable method for 'mutate' applied to an object of class \"function\"\n```\n:::\n:::\n\n\n## Regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# https://rpubs.com/mpfoley73/493677\n\nggplot(data, aes(y = bel_sum, x = urm, color = gender)) +\n  geom_point() + \n  geom_smooth(formula = bel_sum~ urm + gender, method = \"lm\", se = FALSE) +\n  ggtitle(\"Belonging vs URM\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `ggplot()`:\n! `data` cannot be a function.\nℹ Have you misspelled the `data` argument in `ggplot()`\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(car)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'car' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 methods overwritten by 'car':\n  method       from\n  hist.boot    FSA \n  confint.boot FSA \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:FSA':\n\n    bootCase\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:psych':\n\n    logit\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    some\n```\n:::\n\n```{.r .cell-code}\ndata$race <- data$race\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data$race: object of type 'closure' is not subsettable\n```\n:::\n\n```{.r .cell-code}\nmodel_sum <- lm(bel_sum ~ race + gender + year + race * gender + race * year, data = data)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(formula = bel_sum ~ race + gender + year + : 'data' must be a data.frame, environment, or list\n```\n:::\n\n```{.r .cell-code}\nsummary(model_sum)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(model_sum): object 'model_sum' not found\n```\n:::\n\n```{.r .cell-code}\nmodel_sum_urm <- lm(bel_sum ~ urm + gender + year + urm * gender + urm * year, data = data)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(formula = bel_sum ~ urm + gender + year + : 'data' must be a data.frame, environment, or list\n```\n:::\n\n```{.r .cell-code}\nsummary(model_sum_urm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(model_sum_urm): object 'model_sum_urm' not found\n```\n:::\n\n```{.r .cell-code}\nAnova(model_sum)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in Anova(model_sum): object 'model_sum' not found\n```\n:::\n\n```{.r .cell-code}\nmodel_sum_interaction <- lm(bel_sum ~ race * gender * year, data = data)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(formula = bel_sum ~ race * gender * year, : 'data' must be a data.frame, environment, or list\n```\n:::\n\n```{.r .cell-code}\nsummary(model_sum_interaction)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(model_sum_interaction): object 'model_sum_interaction' not found\n```\n:::\n\n```{.r .cell-code}\nmodel_sum_interaction_urm <- lm(bel_sum ~ urm * gender * year, data = data)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in model.frame.default(formula = bel_sum ~ urm * gender * year, : 'data' must be a data.frame, environment, or list\n```\n:::\n\n```{.r .cell-code}\nsummary(model_sum_interaction_urm)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(model_sum_interaction_urm): object 'model_sum_interaction_urm' not found\n```\n:::\n\n```{.r .cell-code}\nAnova(model_sum_interaction)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in Anova(model_sum_interaction): object 'model_sum_interaction' not found\n```\n:::\n\n```{.r .cell-code}\nggplot(data, aes(x = race, y = bel_sum, group = gender, color = gender)) +\n  geom_jitter()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `ggplot()`:\n! `data` cannot be a function.\nℹ Have you misspelled the `data` argument in `ggplot()`\n```\n:::\n\n```{.r .cell-code}\nggplot(data, aes(x = race, y = bel_sum, group = year, color = year)) +\n  geom_jitter()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `ggplot()`:\n! `data` cannot be a function.\nℹ Have you misspelled the `data` argument in `ggplot()`\n```\n:::\n:::\n\n\n## correlation\n\n\n\n\n=======\n# sum of bel\n\nsum_bel <- Summarize(bel_sum ~ race + gender,\n                data=data,\n                digits=3)\n\nkable(sum_bel) %>% \n  kable_styling(\"striped\")\n\n\nggplot(sum_bel, aes(x = race,\n                y = mean,\n                color = gender)) +\n    geom_errorbar(aes(ymin = Q1,\n                      ymax = Q3),\n                   width=.2, size=0.7, position = (position_dodge(.2))) +\n    geom_point(shape=15, size=4, position = (position_dodge(.2))) +\n    theme_bw() +\n    theme(axis.title = element_text(face = \"bold\")) +\n    ylab(\"Belonging\") +\n    xlab(\"Race\") +\n    labs(color = \"Gender\")\n\nboxplot(bel_sum ~ gender + race,\n        data=data,\n        names=c(\"a.f\", \"a.m\", \"b.f\", \"b.m\", \"h.f\", \"h.m\", \"o.f\", \"o.m\", \"w.f\", \"w.m\"),\n        ylab=\"Value\",\n        xlab= \"Belonging\")\n\n```\n\n>>>>>>> bed92586ab2f5a79ef0d32a22e813dea4708c900\n# References\n\nBorck, C.R. (2020). “I belong here.”: Culturally sustaining pedagogical praxes from an alternative high school in Brooklyn. The Urban Review, 52(2), 376-391. [https://doi.org/10.1007/s11256-019-00536-z](https://doi.org/10.1007/s11256-019-00536-z)\n\nFleming, A.R., Oertle, K.M., Plotner, A.J., & Hakun, J.G. (2017). Influence of social factors on student satisfaction among college students with disabilities. Journal of College Student Development, 58(2), 215-228. [https://doi.org/10.1353/csd.2017.0016](https://doi.org/10.1353/csd.2017.0016)\n\nFry, R., Kennedy, B., & Funk, C. (2021, April 1). STEM jobs see uneven progress in increasing gender, racial and ethnic diversity. Pew Research Center. [https://www.pewresearch.org/science/2021/04/01/stem-jobs-see-uneven-progress-in-increasing-gender-racial-and-ethnic-diversity](https://www.pewresearch.org/science/2021/04/01/stem-jobs-see-uneven-progress-in-increasing-gender-racial-and-ethnic-diversity) \n\nGoodenow. (1993). Classroom belonging among early adolescent students: relationships to\nmotivation and achievement. The Journal of Early Adolescence, 13(1), 21–43.\n[https://doi.org/10.1177/0272431693013001002](https://doi.org/10.1177/0272431693013001002)\n\nJeng, A., Bosch, N., & Perry, M. (2023). Sense of belonging predicts perceived helpfulness in online peer help-giving interactions. The Internet and Higher Education, 57, 100901. [https://doi.org/10.1016/j.iheduc.2022.100901](https://doi.org/10.1016/j.iheduc.2022.100901) \n\nJohnson, D.R., Soldner, M., Leonard, J. B., Alvarez, P., Inkelas, K. K., Rowan-Kenyon, H., & Longerbeam, S. (2007). Examining sense of belonging among first-year undergraduates from different racial/ethnic groups. Journal of College Student Development, 48(5), 525–542. [https://doi.org/10.1353/csd.2007.0054](https://doi.org/10.1353/csd.2007.0054)\n\nLongwell-Grice, R., Adsitt, N.Z., Mullins, K., & Serrata, W. (2016). The first ones: Three studies\non first-generation college students. NACADA Journal, 36(2), 34-46.\n\nNational Center for Educational Statistics. (n.d.). IPEDS Data Explorer.\n[https://nces.ed.gov/ipeds/search/ViewTable?tableId=29450](https://nces.ed.gov/ipeds/search/ViewTable?tableId=29450) \n\nShivaram, D. (2021, December 12). Southeast Asians are underrepresented in STEM. The label 'Asian' boxes them out more. NPR. [https://www.npr.org/2021/12/12/1054933519/southeast-asian-representation-science](https://www.npr.org/2021/12/12/1054933519/southeast-asian-representation-science)\n\nSriram, R. (2017). Student affairs by the numbers: Quantitative research and statistics for professionals. Stylus Publishing, LLC.\n\nThacker, I., Seyranian, V., Madva, A., Duong, N.T., & Beardsley, P. (2022). Social connectedness in physical isolation: Online teaching practices that support under-represented undergraduate students’ feelings of belonging and engagement in STEM. Education Sciences, 12(2), 61-83. [https://doi.org/10.3390/educsci12020061](https://doi.org/10.3390/educsci12020061)\n\n\n\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\r\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}