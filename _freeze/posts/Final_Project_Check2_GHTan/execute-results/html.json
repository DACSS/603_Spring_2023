{
  "hash": "43e9eaf202e1968bb83a3c7e499cab7c",
  "result": {
    "markdown": "---\ntitle: \"Final Project Check 2\"\nauthor: \"Guanhua Tan\"\ndescription: \"Final Project Check 2\"\ndate: \"April 4 2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - fpc2\n  - research question\n  - desriptive statistics\n  - model\n---\n\n\nMy final project will be a further investigation on digital devices in schools that I have submitted as the final project for DACSS 601. I still explore the data from the survey \"Programme for International Student Assessment\" in 2018. In this assignment, I will propose my hypothesis, and present the descriptive statistics with minor changes base on my last project.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dbplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dbplyr'\n\nThe following objects are masked from 'package:dplyr':\n\n    ident, sql\n```\n:::\n\n```{.r .cell-code}\nlibrary(stargazer)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nPlease cite as: \n\n Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.\n R package version 5.2.3. https://CRAN.R-project.org/package=stargazer \n```\n:::\n\n```{.r .cell-code}\nlibrary(misty)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n|-------------------------------------|\n| misty 0.4.8 (2023-03-10)            |\n| Miscellaneous Functions T. Yanagida |\n|-------------------------------------|\n```\n:::\n\n```{.r .cell-code}\npisa <- read_csv('_data/CY07_MSU_SCH_QQQ.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\nRows: 21903 Columns: 198\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(8): CNT, CYC, NatCen, STRATUM, SUBNATIO, SC053D11TA, PRIVATESCH, VER_DAT dbl\n(189): ...1, CNTRYID, CNTSCHID, Region, OECD, ADMINMODE, LANGTEST, SC001... lgl\n(1): BOOKID\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...1`\n```\n:::\n:::\n\n\n# Research Questions\n\nMy final project will probe into what factors contribute to the accessibility to and human resources' support for digital devices in schools. Additionally, I will explore if there is a correlations between career guidance and digital devices? I will conduct this research based on the data \"Programme for International Student Assessment\" (PISA) collected by the The Organization for Economic Co-operation and Development (OECD) in 2018.\n\n# Hpyotheis\n\nI propose that the size of urban population primarily contributes to the conditions of digital device. \"OECD or Non-OECD\" and \"public or private schools\" may be two cofounders, which is suppose to be incorporated into the regression analysis. Also, I hypothesize that the higher score a school report regarding career guidance, the higher score a school reports in terms of digital divices.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a data frame\n#view(pisa)\n# select related variable\npisa_selected <- select(pisa,starts_with(c(\"SC001\", \"SC013\", \"SC016\", \"SC161\",\"SC155\")))\npisa2018_joint <-cbind(pisa[, 1:12], pisa_selected)\n# pisa_SC155\npisa2018_joint$Digitals=rowMeans(pisa2018_joint[,c(\"SC155Q01HA\",\"SC155Q02HA\",                                                  \"SC155Q03HA\",\"SC155Q04HA\",\"SC155Q05HA\",\"SC155Q06HA\", \"SC155Q07HA\",\"SC155Q08HA\",\"SC155Q09HA\", \"SC155Q10HA\", \"SC155Q11HA\")])\npisa2018_joint$Career_Guidance=rowSums(pisa2018_joint[, c(\"SC161Q02SA\",\"SC161Q03SA\",\"SC161Q04SA\",\"SC161Q04SA\")])\npisa_SC155 <- pisa2018_joint %>%\n  select(CNT, STRATUM, OECD, Career_Guidance,Digitals, SC001Q01TA, SC013Q01TA) %>%\n  mutate(Urban=SC001Q01TA, Public_or_Private=SC013Q01TA) %>%\n  select(-c(SC001Q01TA, SC013Q01TA)) %>%\n  select(c(CNT,STRATUM,OECD,Urban, Public_or_Private,Career_Guidance,Digitals))\npisa_SC155\n```\n:::\n\n\n# Descriptive Statistics\n\nThis original OECD PISA 2018 School Questionnaire Dataset is one part of PISA 2018 dataset with a focus on schools. It covers 80 countries and regions all over the world. The dataset documents 21,903 schools' responses regarding 187 questions.After cleaning the data, the dataset includes 8 variables: CNT identifies countries. STRATUM identifies schools. OECD indicates if a school locates in a OECD country or not. Urban describes different conditions of urban communities where a school locates. Public_or_Private presents if a school is public or private. Career_Guidance demonstrates the score a school reports in terms of career guidance. Accessibility demonstrates the score a school reports in terms of accessibility to digital devices. Human_Resource_Support suggests the score a school reports in terms of human ressource support for digital devices.\n\nAfter using the summary function and visualization, I have already show the descriptive statistics. A large number of NA stands out. I will figure out how to deal with them properly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pisa_SC155)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     CNT              STRATUM               OECD            Urban      \n Length:21903       Length:21903       Min.   :0.0000   Min.   :1.000  \n Class :character   Class :character   1st Qu.:0.0000   1st Qu.:2.000  \n Mode  :character   Mode  :character   Median :1.0000   Median :3.000  \n                                       Mean   :0.5171   Mean   :3.007  \n                                       3rd Qu.:1.0000   3rd Qu.:4.000  \n                                       Max.   :1.0000   Max.   :5.000  \n                                                        NA's   :1363   \n Public_or_Private Career_Guidance    Digitals    \n Min.   :1.00      Min.   :0.000   Min.   :1.000  \n 1st Qu.:1.00      1st Qu.:1.000   1st Qu.:2.273  \n Median :1.00      Median :1.000   Median :2.636  \n Mean   :1.19      Mean   :1.518   Mean   :2.664  \n 3rd Qu.:1.00      3rd Qu.:2.000   3rd Qu.:3.000  \n Max.   :2.00      Max.   :4.000   Max.   :4.000  \n NA's   :2092      NA's   :1499    NA's   :1399   \n```\n:::\n\n```{.r .cell-code}\npisa_SC155_boxplot<-pisa_SC155 %>%\n  select(STRATUM, Career_Guidance, Digitals) %>% \n  pivot_longer(cols=c(Career_Guidance, Digitals), \n               names_to = \"Group\", values_to = \"Evaluation\")\n\nggplot(pisa_SC155_boxplot,aes(Evaluation, fill=Group))+\n  stat_boxplot(geom = \"errorbar\", # Error bars\n               width = 0.2)+\n  geom_boxplot()+\n  facet_wrap(~Group)+\n  labs(title=\"Pisa2018 Evaluation\")+\n  coord_flip()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 2898 rows containing non-finite values (`stat_boxplot()`).\nRemoved 2898 rows containing non-finite values (`stat_boxplot()`).\n```\n:::\n\n::: {.cell-output-display}\n![](Final_Project_Check2_GHTan_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n# Analysis\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pisa_SC155)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n     CNT              STRATUM               OECD            Urban      \n Length:21903       Length:21903       Min.   :0.0000   Min.   :1.000  \n Class :character   Class :character   1st Qu.:0.0000   1st Qu.:2.000  \n Mode  :character   Mode  :character   Median :1.0000   Median :3.000  \n                                       Mean   :0.5171   Mean   :3.007  \n                                       3rd Qu.:1.0000   3rd Qu.:4.000  \n                                       Max.   :1.0000   Max.   :5.000  \n                                                        NA's   :1363   \n Public_or_Private Career_Guidance    Digitals    \n Min.   :1.00      Min.   :0.000   Min.   :1.000  \n 1st Qu.:1.00      1st Qu.:1.000   1st Qu.:2.273  \n Median :1.00      Median :1.000   Median :2.636  \n Mean   :1.19      Mean   :1.518   Mean   :2.664  \n 3rd Qu.:1.00      3rd Qu.:2.000   3rd Qu.:3.000  \n Max.   :2.00      Max.   :4.000   Max.   :4.000  \n NA's   :2092      NA's   :1499    NA's   :1399   \n```\n:::\n:::\n\n\n## model evaluation\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel_1 <-lm(Career_Guidance~Urban+Public_or_Private+Digitals+Urban*Digitals, data = pisa_SC155)\nsummary(model_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Career_Guidance ~ Urban + Public_or_Private + Digitals + \n    Urban * Digitals, data = pisa_SC155)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.0225 -0.5833 -0.3219  0.5482  2.8554 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       0.788183   0.082837   9.515  < 2e-16 ***\nUrban             0.005856   0.024580   0.238   0.8117    \nPublic_or_Private 0.134161   0.019114   7.019 2.31e-12 ***\nDigitals          0.161945   0.030173   5.367 8.09e-08 ***\nUrban:Digitals    0.015535   0.009013   1.724   0.0848 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9751 on 18558 degrees of freedom\n  (3340 observations deleted due to missingness)\nMultiple R-squared:  0.02977,\tAdjusted R-squared:  0.02956 \nF-statistic: 142.3 on 4 and 18558 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nmodel_2 <-lm(Career_Guidance~Urban+Public_or_Private+Public_or_Private*Digitals, data = pisa_SC155)\nsummary(model_2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Career_Guidance ~ Urban + Public_or_Private + Public_or_Private * \n    Digitals, data = pisa_SC155)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.9430 -0.5968 -0.3169  0.5416  2.8959 \n\nCoefficients:\n                            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                 0.472735   0.110481   4.279 1.89e-05 ***\nUrban                       0.047179   0.005769   8.178 3.06e-16 ***\nPublic_or_Private           0.297148   0.090982   3.266  0.00109 ** \nDigitals                    0.276078   0.038819   7.112 1.19e-12 ***\nPublic_or_Private:Digitals -0.056165   0.031141  -1.804  0.07131 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9751 on 18558 degrees of freedom\n  (3340 observations deleted due to missingness)\nMultiple R-squared:  0.02978,\tAdjusted R-squared:  0.02957 \nF-statistic: 142.4 on 4 and 18558 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nmodel_3 <-lm(Career_Guidance~Urban+Public_or_Private+Digitals, data = pisa_SC155)\nsummary(model_3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Career_Guidance ~ Urban + Public_or_Private + Digitals, \n    data = pisa_SC155)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.9883 -0.5860 -0.3205  0.5462  2.8801 \n\nCoefficients:\n                  Estimate Std. Error t value Pr(>|t|)    \n(Intercept)       0.660470   0.037034  17.834  < 2e-16 ***\nUrban             0.047037   0.005768   8.154 3.74e-16 ***\nPublic_or_Private 0.136695   0.019058   7.173 7.64e-13 ***\nDigitals          0.209566   0.012125  17.284  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.9751 on 18559 degrees of freedom\n  (3340 observations deleted due to missingness)\nMultiple R-squared:  0.02961,\tAdjusted R-squared:  0.02946 \nF-statistic: 188.8 on 3 and 18559 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nstargazer(model_1,model_2, model_3,  type = 'text')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n===========================================================================================================\n                                                         Dependent variable:                               \n                           --------------------------------------------------------------------------------\n                                                           Career_Guidance                                 \n                                      (1)                        (2)                        (3)            \n-----------------------------------------------------------------------------------------------------------\nUrban                                0.006                     0.047***                   0.047***         \n                                    (0.025)                    (0.006)                    (0.006)          \n                                                                                                           \nPublic_or_Private                   0.134***                   0.297***                   0.137***         \n                                    (0.019)                    (0.091)                    (0.019)          \n                                                                                                           \nDigitals                            0.162***                   0.276***                   0.210***         \n                                    (0.030)                    (0.039)                    (0.012)          \n                                                                                                           \nUrban:Digitals                       0.016*                                                                \n                                    (0.009)                                                                \n                                                                                                           \nPublic_or_Private:Digitals                                     -0.056*                                     \n                                                               (0.031)                                     \n                                                                                                           \nConstant                            0.788***                   0.473***                   0.660***         \n                                    (0.083)                    (0.110)                    (0.037)          \n                                                                                                           \n-----------------------------------------------------------------------------------------------------------\nObservations                         18,563                     18,563                     18,563          \nR2                                   0.030                      0.030                      0.030           \nAdjusted R2                          0.030                      0.030                      0.029           \nResidual Std. Error            0.975 (df = 18558)         0.975 (df = 18558)         0.975 (df = 18559)    \nF Statistic                142.347*** (df = 4; 18558) 142.420*** (df = 4; 18558) 188.786*** (df = 3; 18559)\n===========================================================================================================\nNote:                                                                           *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\n\n\n\nAfter the model comparison, model_3 presents statistical significance on all independent variables. The career gudience depends on urban situations, school styles and the access to digital devices.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit<-lm(Career_Guidance~Urban+Public_or_Private+Digitals, data = pisa_SC155)\npar(mfrow=c(2,3))\nplot(fit, which= 1:6)\n```\n\n::: {.cell-output-display}\n![](Final_Project_Check2_GHTan_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\nThe model diagnostic demonstrates that model_3 is the fittest model without significant errors.\n\n\n## Discussion on NA\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(naniar)\npisa_SC115_nonOECD <- filter(pisa_SC155, OECD == \"0\")\npisa_SC115_OECD <- filter(pisa_SC155, OECD == \"1\")\nvis_miss(pisa_SC155)\n```\n\n::: {.cell-output-display}\n![](Final_Project_Check2_GHTan_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nvis_miss(pisa_SC115_nonOECD)\n```\n\n::: {.cell-output-display}\n![](Final_Project_Check2_GHTan_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\nvis_miss(pisa_SC115_OECD)\n```\n\n::: {.cell-output-display}\n![](Final_Project_Check2_GHTan_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n:::\n\nThe graphics has suggested that OECD countries reported more NAs than non-OECD countries. This opens more space to further investigate why developed countries reported more NAs.\n\n\n",
    "supporting": [
      "Final_Project_Check2_GHTan_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}