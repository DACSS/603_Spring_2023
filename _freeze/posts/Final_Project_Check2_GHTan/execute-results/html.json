{
  "hash": "bc8d3f8f9d7ccc851a8ae738f55561b8",
  "result": {
    "markdown": "---\ntitle: \"Final Project Check 2\"\nauthor: \"Guanhua Tan\"\ndescription: \"Final Project Check 2\"\ndate: \"April 4 2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - \n  - research question\n  - desriptive statistics\n  - model\n---\n\n\nMy final project will be a further investigation on digital devices in schools that I have submitted as the final project for DACSS 601. I still explore the data from the survey \"Programme for International Student Assessment\" in 2018. In this assignment, I will propose my hypothesis, and present the descriptive statistics with minor changes base on my last project.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(dbplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dbplyr'\n\nThe following objects are masked from 'package:dplyr':\n\n    ident, sql\n```\n:::\n\n```{.r .cell-code}\nlibrary(stargazer)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nPlease cite as: \n\n Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.\n R package version 5.2.3. https://CRAN.R-project.org/package=stargazer \n```\n:::\n\n```{.r .cell-code}\nlibrary(misty)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n|-------------------------------------|\n| misty 0.4.8 (2023-03-10)            |\n| Miscellaneous Functions T. Yanagida |\n|-------------------------------------|\n```\n:::\n\n```{.r .cell-code}\nlibrary(MASS)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'MASS'\n\nThe following object is masked from 'package:dplyr':\n\n    select\n```\n:::\n\n```{.r .cell-code}\nlibrary(reshape2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'reshape2'\n\nThe following object is masked from 'package:tidyr':\n\n    smiths\n```\n:::\n\n```{.r .cell-code}\npisa <- read_csv('_data/CY07_MSU_SCH_QQQ.csv')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nNew names:\nRows: 21903 Columns: 198\n── Column specification\n──────────────────────────────────────────────────────── Delimiter: \",\" chr\n(8): CNT, CYC, NatCen, STRATUM, SUBNATIO, SC053D11TA, PRIVATESCH, VER_DAT dbl\n(189): ...1, CNTRYID, CNTSCHID, Region, OECD, ADMINMODE, LANGTEST, SC001... lgl\n(1): BOOKID\nℹ Use `spec()` to retrieve the full column specification for this data. ℹ\nSpecify the column types or set `show_col_types = FALSE` to quiet this message.\n• `` -> `...1`\n```\n:::\n:::\n\n\n# Research Questions\n\nMy final project will probe into what factors contribute to the accessibility to and human resources' support for digital devices in schools. Additionally, I will explore if there is a correlations between career guidance and digital devices? I will conduct this research based on the data \"Programme for International Student Assessment\" (PISA) collected by the The Organization for Economic Co-operation and Development (OECD) in 2018.\n\n# Hpyotheis\n\nI propose that the size of urban population primarily contributes to the conditions of digital device. \"OECD or Non-OECD\" and \"public or private schools\" may be two cofounders, which is suppose to be incorporated into the regression analysis. Also, I hypothesize that the higher score a school report regarding career guidance, the higher score a school reports in terms of digital divices.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create a data frame\n#view(pisa)\n# select related variable\npisa_selected <- select(pisa,starts_with(c(\"SC001\", \"SC013\", \"SC016\", \"SC161\",\"SC155\")))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(pisa, starts_with(c(\"SC001\", \"SC013\", \"SC016\", \"SC161\", : unused argument (starts_with(c(\"SC001\", \"SC013\", \"SC016\", \"SC161\", \"SC155\")))\n```\n:::\n\n```{.r .cell-code}\npisa2018_joint <-cbind(pisa[, 1:12], pisa_selected)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in data.frame(..., check.names = FALSE): object 'pisa_selected' not found\n```\n:::\n\n```{.r .cell-code}\n# pisa_SC155\npisa2018_joint$Digitals=rowMeans(pisa2018_joint[,c(\"SC155Q01HA\",\"SC155Q02HA\",                                                  \"SC155Q03HA\",\"SC155Q04HA\",\"SC155Q05HA\",\"SC155Q06HA\", \"SC155Q07HA\",\"SC155Q08HA\",\"SC155Q09HA\", \"SC155Q10HA\", \"SC155Q11HA\")])\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(x): object 'pisa2018_joint' not found\n```\n:::\n\n```{.r .cell-code}\npisa2018_joint$Career_Guidance=rowSums(pisa2018_joint[, c(\"SC161Q02SA\",\"SC161Q03SA\",\"SC161Q04SA\",\"SC161Q04SA\")])\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(x): object 'pisa2018_joint' not found\n```\n:::\n\n```{.r .cell-code}\npisa_SC155 <- pisa2018_joint %>%\n  select(CNT, STRATUM, OECD, Career_Guidance,Digitals, SC001Q01TA, SC013Q01TA) %>%\n  mutate(Urban=SC001Q01TA, Public_or_Private=SC013Q01TA) %>%\n  select(-c(SC001Q01TA, SC013Q01TA)) %>%\n  select(c(CNT,STRATUM,OECD,Urban, Public_or_Private,Career_Guidance,Digitals))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., c(CNT, STRATUM, OECD, Urban, Public_or_Private, Career_Guidance, : unused argument (c(CNT, STRATUM, OECD, Urban, Public_or_Private, Career_Guidance, Digitals))\n```\n:::\n\n```{.r .cell-code}\npisa_SC155\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'pisa_SC155' not found\n```\n:::\n:::\n\n\n# Descriptive Statistics\n\nThis original OECD PISA 2018 School Questionnaire Dataset is one part of PISA 2018 dataset with a focus on schools. It covers 80 countries and regions all over the world. The dataset documents 21,903 schools' responses regarding 187 questions.After cleaning the data, the dataset includes 8 variables: CNT identifies countries. STRATUM identifies schools. OECD indicates if a school locates in a OECD country or not. Urban describes different conditions of urban communities where a school locates. Public_or_Private presents if a school is public or private. Career_Guidance demonstrates the score a school reports in terms of career guidance. Accessibility demonstrates the score a school reports in terms of accessibility to digital devices. Human_Resource_Support suggests the score a school reports in terms of human ressource support for digital devices.\n\nAfter using the summary function and visualization, I have already show the descriptive statistics. A large number of NA stands out. I will figure out how to deal with them properly.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(pisa_SC155)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(pisa_SC155): object 'pisa_SC155' not found\n```\n:::\n\n```{.r .cell-code}\npisa_SC155_boxplot<-pisa_SC155 %>%\n  select(STRATUM, Career_Guidance, Digitals) %>% \n  pivot_longer(cols=c(Career_Guidance, Digitals), \n               names_to = \"Group\", values_to = \"Evaluation\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in select(., STRATUM, Career_Guidance, Digitals): unused arguments (STRATUM, Career_Guidance, Digitals)\n```\n:::\n\n```{.r .cell-code}\nggplot(pisa_SC155_boxplot,aes(Evaluation, fill=Group))+\n  stat_boxplot(geom = \"errorbar\", # Error bars\n               width = 0.2)+\n  geom_boxplot()+\n  facet_wrap(~Group)+\n  labs(title=\"Pisa2018 Evaluation\")+\n  coord_flip()\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ggplot(pisa_SC155_boxplot, aes(Evaluation, fill = Group)): object 'pisa_SC155_boxplot' not found\n```\n:::\n:::\n\n# Analysis\n\n## Discussion on NA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# missing data\nlibrary(naniar)\npisa_SC115_nonOECD <- filter(pisa_SC155, OECD == \"0\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(pisa_SC155, OECD == \"0\"): object 'pisa_SC155' not found\n```\n:::\n\n```{.r .cell-code}\npisa_SC115_OECD <- filter(pisa_SC155, OECD == \"1\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in filter(pisa_SC155, OECD == \"1\"): object 'pisa_SC155' not found\n```\n:::\n\n```{.r .cell-code}\nvis_miss(pisa_SC155)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in test_if_dataframe(x): object 'pisa_SC155' not found\n```\n:::\n\n```{.r .cell-code}\nvis_miss(pisa_SC115_nonOECD)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in test_if_dataframe(x): object 'pisa_SC115_nonOECD' not found\n```\n:::\n\n```{.r .cell-code}\nvis_miss(pisa_SC115_OECD)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in test_if_dataframe(x): object 'pisa_SC115_OECD' not found\n```\n:::\n:::\n\nThe graphics have disclose that compared with NON-OECD countries, OECD countries missed more data in terms of school type and career guidance. I believe that missing data are not caused by the poor technological condition in non-OECD countries. So missing data is random.\n\n## model evaluation\n\n::: {.cell}\n\n```{.r .cell-code}\npisa_SC155_NoNA <- drop_na(pisa_SC155)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in drop_na(pisa_SC155): object 'pisa_SC155' not found\n```\n:::\n\n```{.r .cell-code}\n#summary(pisa_SC155_NoNA)\n\nmodel_1 <-lm(Career_Guidance~Urban+Public_or_Private+Digitals+Urban*Digitals, data = pisa_SC155_NoNA)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'pisa_SC155_NoNA' not found\n```\n:::\n\n```{.r .cell-code}\n#summary(model_1)\n\nmodel_2 <-lm(Career_Guidance~Urban+Public_or_Private+Public_or_Private*Digitals, data = pisa_SC155_NoNA)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'pisa_SC155_NoNA' not found\n```\n:::\n\n```{.r .cell-code}\n#summary(model_2)\n\nmodel_3 <-lm(Career_Guidance~Urban+Public_or_Private+Digitals, data = pisa_SC155_NoNA)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.data.frame(data): object 'pisa_SC155_NoNA' not found\n```\n:::\n\n```{.r .cell-code}\n#summary(model_3)\n\n\nstargazer(model_1, model_2, model_3,  type = 'text')\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in .stargazer.wrap(..., type = type, title = title, style = style, : object 'model_1' not found\n```\n:::\n:::\n\n\nAfter the model comparison, model_3 presents statistical significance on all independent variables. The career gudience depends on urban situations, school styles and the access to digital devices.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# diagnostics\npar(mfrow=c(2,3))\nplot(model_3, which= 1:6)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in plot(model_3, which = 1:6): object 'model_3' not found\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# log-git model\npisa_SC155_NoNA$Career_Guidance_Ordinal <- as.factor(pisa_SC155_NoNA$Career_Guidance)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in is.factor(x): object 'pisa_SC155_NoNA' not found\n```\n:::\n\n```{.r .cell-code}\nclass(pisa_SC155_NoNA$Career_Guidance_Ordinal)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, envir, enclos): object 'pisa_SC155_NoNA' not found\n```\n:::\n\n```{.r .cell-code}\ntable(pisa_SC155_NoNA$Career_Guidance_Ordinal)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in table(pisa_SC155_NoNA$Career_Guidance_Ordinal): object 'pisa_SC155_NoNA' not found\n```\n:::\n\n```{.r .cell-code}\nfit2<-polr(Career_Guidance_Ordinal~Urban+Public_or_Private+Digitals, data = pisa_SC155_NoNA, Hess=T)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in eval(expr, p): object 'pisa_SC155_NoNA' not found\n```\n:::\n\n```{.r .cell-code}\nsummary(fit2)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in summary(fit2): object 'fit2' not found\n```\n:::\n\n```{.r .cell-code}\nbroom::glance(model_3)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in broom::glance(model_3): object 'model_3' not found\n```\n:::\n:::\n\n\nBut model_3 still shows the relative lower R squared. In addition, the diagnostics plots show certain patterns. Both remind me of further exploring a different model. So I plan to try log-git model and calculate the AICs for this two models. Final the log-git model (fit2) has a lower AIC.\n\n\n\n\n## Interpret the Model\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#ctable <- coef(summary(fit2))\n#p <- pnorm(abs(ctable[, \"t value\"]), lower.tail = FALSE) * 2\n#ctable <- cbind(ctable, \"p value\" = p)\n#ctable\n#exp(coef(fit2))\n\nnewdat <- data.frame(\n  Urban = rep(1:5, 3712),\n  Public_or_Private = rep(1:2, each = 9280 ),\n  Digitals = rep(1:4, 4640))\n\nnewdat <- cbind(newdat, predict(fit2, newdat, type = \"probs\"))\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in predict(fit2, newdat, type = \"probs\"): object 'fit2' not found\n```\n:::\n\n```{.r .cell-code}\nlnewdat <- melt(newdat, id.vars = c(\"Urban\", \"Public_or_Private\", \"Digitals\"),\n                variable.name = \"Level\", value.name=\"Probability\")\n\nggplot(lnewdat, aes(x = Digitals, y = Probability, colour = Level))+\n  geom_line() + \n  facet_grid(Urban ~ Public_or_Private , labeller=\"label_both\")\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in `geom_line()`:\n! Problem while computing aesthetics.\nℹ Error occurred in the 1st layer.\nCaused by error in `FUN()`:\n! object 'Probability' not found\n```\n:::\n:::\n",
    "supporting": [
      "Final_Project_Check2_GHTan_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}