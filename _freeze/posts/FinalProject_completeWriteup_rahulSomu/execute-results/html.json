{
  "hash": "e5a033ad51c5d8cac56606e9099ba01a",
  "result": {
    "markdown": "---\ntitle: \"Final Project\"\nauthor: \"Rahul Somu\"\ndesription: \"Quantitative Analysis of the Relationship between COVID-19 Mortality Rate and Socioeconomic Factors\"\ndate: \"05/23/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - FinalProject\n  - Rahul Somu\n\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(magrittr)\nlibrary(corrplot)\nlibrary(lmtest)\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(dplyr)\nlibrary(ggplot2)\nlibrary(naniar)\nlibrary(car)\nlibrary(ggcorrplot)\nlibrary(caret)\nlibrary(glmnet)\nlibrary(leaps)\nlibrary(gridExtra)\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n## Overview\n\nThe disastrous effects that a highly contagious disease can have on the world have been strongly illustrated by the COVID-19 pandemic. Millions of people have passed away as a consequence of the pandemic and also impacted the lives of billions of people around the world. Current state of affairs has brought to light the necessity for research on factor and tactics to effectively combat pandemics in the future.\n\nIt's critical to comprehend the variables affecting COVID-19 mortality as the pandemic spreads further. The goal of this study is to look at the correlations between a nation's COVID-19 mortality rate and its population density, median age, GDP per-capita, prevalence of diabetes, hospital beds per 1,000 people, and human development index.\n\nIn this project I'm aiming to research To what extent do these socioeconomic factors contribute to the variation in COVID-19 mortality rate across the world and derive the relationship of COVID-19 mortality rate with population density,median age, GDP per capita, diabetes prevalence, hospital beds per thousand people and human development index.\n\n##Research Question:\nWhat factors did mainly influence the covid mortality rate?\nDid economic factors completely influence covid mortality?\n\n\n##DataSet\n\nThe data set contains time series data of around 193 countries around the world. There are around 84,000 records for daily data of the countries over the period of time since 2020-03 to 2021-06 which is around 465 records per country.\n\nDatasource: https://www.kaggle.com/datasets/fedesoriano/coronavirus-covid19-vaccinations-data\n\n##Methodology:\n\nMultiple linear regression models will be used to carry out the analysis. The socioeconomic determinants will be the independent variables, where as the COVID-19 mortality rate will be the dependent variable.\n\n##Expected Results:\n\nThe findings of this investigation will aid in understanding the variables affecting the COVID-19 mortality rate. Population density, median age, diabetes prevalence, and hospital beds per thousand people are anticipated to have a positive correlation with the COVID-19 mortality rate, whereas GDP per capita and the human development index are anticipated to have a negative correlation. Planning public health policies and actions to lessen the effects of COVID-19 will benefit from the findings.\n\n##Goal:\n\nThe goal of this study is to understand the relationship between socioeconomic factors and the COVID-19 mortality rate. The results will be helpful in planning public health policy and initiatives and will shed light on the factors that affect the COVID-19 death rate.\n\n\n##Code\n\nLoad the dataset and check for the missing value patterns.\nRemove rows with missing values after reviewing.\nAfter going through the rows with empty values, it has been evident that rows with continent-wise data and worldwide data has empty cells. Therefore removing the rows with empty values will leave us with country specific data.\n\nAfter going through multiple articles, there are five factors that have been very influential during the covid-19 crisis such as gdp per capita, median age, hospital beds availability, diabetic prevalence and stringency index.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read_excel(\"_data/COVID_Data.xlsx\")%>%rename_all(~trimws(.))\n\ncovid_data_subset <- df %>%\n  select( total_deaths_per_million,total_cases_per_million,gdp_per_capita, median_age,\n         stringency_index, diabetes_prevalence,hospital_beds_per_thousand)\n\nvis_miss(covid_data_subset)\n```\n\n::: {.cell-output-display}\n![](FinalProject_completeWriteup_rahulSomu_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nmiss_var_summary(covid_data_subset)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 7 Ã— 3\n  variable                   n_miss pct_miss\n  <chr>                       <int>    <dbl>\n1 hospital_beds_per_thousand  12687 15.0    \n2 stringency_index            10327 12.2    \n3 gdp_per_capita               6696  7.90   \n4 median_age                   5783  6.82   \n5 diabetes_prevalence          4872  5.75   \n6 total_cases_per_million         1  0.00118\n7 total_deaths_per_million        0  0      \n```\n:::\n\n```{.r .cell-code}\n# Remove rows with missing values\ndata <- na.omit(covid_data_subset)\ndata <- unique(data)\nsummary(data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n total_deaths_per_million total_cases_per_million gdp_per_capita    \n Min.   :   0.001         Min.   :     0.02       Min.   :   661.2  \n 1st Qu.:  10.356         1st Qu.:   627.90       1st Qu.:  7292.5  \n Median :  68.378         Median :  3794.89       Median : 15847.4  \n Mean   : 309.301         Mean   : 15095.14       Mean   : 22175.7  \n 3rd Qu.: 363.305         3rd Qu.: 18926.86       3rd Qu.: 32605.9  \n Max.   :5810.533         Max.   :155658.77       Max.   :116935.6  \n   median_age    stringency_index diabetes_prevalence\n Min.   :15.10   Min.   :  0.00   Min.   : 0.990     \n 1st Qu.:25.70   1st Qu.: 50.93   1st Qu.: 5.500     \n Median :32.20   Median : 64.35   Median : 7.110     \n Mean   :32.58   Mean   : 62.80   Mean   : 7.763     \n 3rd Qu.:41.20   3rd Qu.: 76.85   3rd Qu.: 9.740     \n Max.   :48.20   Max.   :100.00   Max.   :22.020     \n hospital_beds_per_thousand\n Min.   : 0.100            \n 1st Qu.: 1.300            \n Median : 2.500            \n Mean   : 3.099            \n 3rd Qu.: 4.485            \n Max.   :13.050            \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(car)\nlibrary(ggplot2)\n\ndata_select <- df\n\ndata_select$total_deaths_per_million <- data_select$total_deaths_per_million\n\ndata_select$total_cases_per_million <- data_select$total_cases_per_million\ndata_select$gdp_per_capita <- data_select$gdp_per_capita\ndata_select$median_age <- data_select$median_age\ndata_select$stringency_index <- data_select$stringency_index\ndata_select$diabetes_prevalence <- df$diabetes_prevalence / 100\ndata_select$hospital_beds_per_thousand <- data_select$hospital_beds_per_thousand\n```\n:::\n\n\nBelow Visualisations show that the data is diverse in terms of countries and conditions.\nWidespread of stringecy index shows that the data has covered all the stages of pandemic. While the other visualisations show that data has covered diverse countries in terms of economic strength.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data_select, aes(x = gdp_per_capita)) +\n  geom_histogram() +\n  labs(title = \"GDP Per Capita\", x = \"GDP Per Capita\", y = \"Count\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 6696 rows containing non-finite values (`stat_bin()`).\n```\n:::\n\n::: {.cell-output-display}\n![](FinalProject_completeWriteup_rahulSomu_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data_select, aes(x = stringency_index)) +\n  geom_histogram() +\n  labs(title = \"Stringency Index\", x = \"Stringency Index\", y = \"Count\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 10327 rows containing non-finite values (`stat_bin()`).\n```\n:::\n\n::: {.cell-output-display}\n![](FinalProject_completeWriteup_rahulSomu_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data_select, aes(x = hospital_beds_per_thousand)) +\n  geom_histogram() +\n  labs(title = \"Hospital Beds Per Thousand\", x = \"Hospital Beds Per Thousand\", y = \"Count\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Removed 12687 rows containing non-finite values (`stat_bin()`).\n```\n:::\n\n::: {.cell-output-display}\n![](FinalProject_completeWriteup_rahulSomu_files/figure-html/unnamed-chunk-4-3.png){width=672}\n:::\n:::\n\n\nBelow we create different models to choose IVs and confounders using r-squared, AIC, BIC\n\n::: {.cell}\n\n```{.r .cell-code}\nmodels <- list()\nmodels[[1]] <- lm(total_deaths_per_million ~ total_cases_per_million, data = data_select)\nmodels[[2]] <- lm(total_deaths_per_million ~ total_cases_per_million + gdp_per_capita, data = data_select)\nmodels[[3]] <- lm(total_deaths_per_million ~ total_cases_per_million + gdp_per_capita + median_age, data = data_select)\nmodels[[4]] <- lm(total_deaths_per_million ~ total_cases_per_million + gdp_per_capita + median_age + stringency_index, data = data_select)\nmodels[[5]] <- lm(total_deaths_per_million ~ total_cases_per_million + gdp_per_capita + median_age + stringency_index + diabetes_prevalence, data = data_select)\nmodels[[6]] <- lm(total_deaths_per_million ~ total_cases_per_million + gdp_per_capita + median_age + stringency_index + diabetes_prevalence + hospital_beds_per_thousand, data = data_select)\n\n#sapply(models, summary)\n\n\n\nadjusted_r_squared <- sapply(models, function(x) summary(x)$adj.r.squared)\naic <- sapply(models, function(x) AIC(x))\nbic <- sapply(models, function(x) BIC(x))\nadjusted_r_squared\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.6268869 0.6221057 0.6317514 0.6254968 0.6308300 0.6274194\n```\n:::\n\n```{.r .cell-code}\naic\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1217256.2 1122042.4 1102850.7 1009135.6 1008122.7  917006.7\n```\n:::\n\n```{.r .cell-code}\nbic\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1217284.2 1122079.4 1102896.9 1009190.6 1008186.8  917079.2\n```\n:::\n:::\n\n\nBelow is the best model, we calculate P-Values and Beta Values and plot residuals\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(total_deaths_per_million ~ total_cases_per_million + gdp_per_capita + median_age + stringency_index + diabetes_prevalence + hospital_beds_per_thousand, data)\n\npar(mfrow = c(2, 3))\nplot(models[[6]])\n\nresiduals <- residuals(model)\nplot(residuals)\nqqnorm(residuals)\n```\n\n::: {.cell-output-display}\n![](FinalProject_completeWriteup_rahulSomu_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(residuals)\n\np_values <- coef(summary(model))[, 4]\nbeta_values <- coef(summary(model))[, 1]\np_values\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               (Intercept)    total_cases_per_million \n             4.282063e-119               0.000000e+00 \n            gdp_per_capita                 median_age \n              0.000000e+00               0.000000e+00 \n          stringency_index        diabetes_prevalence \n              3.597272e-34              2.566947e-286 \nhospital_beds_per_thousand \n             3.891411e-169 \n```\n:::\n\n```{.r .cell-code}\nbeta_values\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               (Intercept)    total_cases_per_million \n             -1.870911e+02               1.715446e-02 \n            gdp_per_capita                 median_age \n             -4.959435e-03               1.433782e+01 \n          stringency_index        diabetes_prevalence \n              9.449889e-01              -1.434194e+01 \nhospital_beds_per_thousand \n             -2.184356e+01 \n```\n:::\n\n```{.r .cell-code}\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = total_deaths_per_million ~ total_cases_per_million + \n    gdp_per_capita + median_age + stringency_index + diabetes_prevalence + \n    hospital_beds_per_thousand, data = data)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1907.7  -115.1   -42.9    60.2  4625.1 \n\nCoefficients:\n                             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)                -1.871e+02  8.044e+00  -23.26   <2e-16 ***\ntotal_cases_per_million     1.715e-02  6.173e-05  277.90   <2e-16 ***\ngdp_per_capita             -4.959e-03  8.763e-05  -56.60   <2e-16 ***\nmedian_age                  1.434e+01  2.667e-01   53.77   <2e-16 ***\nstringency_index            9.450e-01  7.748e-02   12.20   <2e-16 ***\ndiabetes_prevalence        -1.434e+01  3.943e-01  -36.37   <2e-16 ***\nhospital_beds_per_thousand -2.184e+01  7.853e-01  -27.82   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 324.1 on 56428 degrees of freedom\nMultiple R-squared:  0.6249,\tAdjusted R-squared:  0.6249 \nF-statistic: 1.567e+04 on 6 and 56428 DF,  p-value: < 2.2e-16\n```\n:::\n\n::: {.cell-output-display}\n![](FinalProject_completeWriteup_rahulSomu_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\n\nBelow, we split the data to training and test data.Later we check for the collinearity for the variables.\nthe collinearity matrix, suggests that the variables are important. Looking at the matrix, we can see a strongest positive correlations with total deaths per million are observed for median age and total cases per million, indicating that countries with higher median age and higher total cases per million tend to have higher total deaths per million.\n\nOn the other hand, it is evident that there is a strongest negative correlations for hospital beds per thousand, indicating that countries with higher hospital beds per thousand tend to have lower total deaths per million.\n\nAlso there's some moderate positive correlations for certain predictor variables, such as gdp per capita, diabetic prevalance and stringency index.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Split data into training and testing sets\nset.seed(123)\ntrainingIndex <- createDataPartition(data$total_deaths_per_million, p = 0.8, list = FALSE)\ntrainingData <- data[trainingIndex, ]\ntestingData <- data[-trainingIndex, ]\n\n# Check for collinearity\ncorMat <- cor(trainingData[, -1])\nprint(corMat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                           total_cases_per_million gdp_per_capita median_age\ntotal_cases_per_million                 1.00000000    0.300206016 0.32231281\ngdp_per_capita                          0.30020602    1.000000000 0.59690777\nmedian_age                              0.32231281    0.596907772 1.00000000\nstringency_index                        0.04435618   -0.000590973 0.00699285\ndiabetes_prevalence                     0.05860837    0.223658992 0.04501672\nhospital_beds_per_thousand              0.16635623    0.283140632 0.68271094\n                           stringency_index diabetes_prevalence\ntotal_cases_per_million         0.044356176          0.05860837\ngdp_per_capita                 -0.000590973          0.22365899\nmedian_age                      0.006992850          0.04501672\nstringency_index                1.000000000          0.13183820\ndiabetes_prevalence             0.131838198          1.00000000\nhospital_beds_per_thousand     -0.109037946         -0.11705428\n                           hospital_beds_per_thousand\ntotal_cases_per_million                     0.1663562\ngdp_per_capita                              0.2831406\nmedian_age                                  0.6827109\nstringency_index                           -0.1090379\ndiabetes_prevalence                        -0.1170543\nhospital_beds_per_thousand                  1.0000000\n```\n:::\n\n```{.r .cell-code}\ncorPlot <- corrplot(corMat, method = \"color\", type = \"lower\", order = \"hclust\", tl.col = \"black\", tl.srt = 45)\n```\n\n::: {.cell-output-display}\n![](FinalProject_completeWriteup_rahulSomu_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nLet's try to build a prediction model.\nIn the below code chunk, the training and test data has been loaded to different models.\nI have picked Simple linear model and to compare the results and pick the best out of them, i have went for ridge regression and lasso regression.\n\nAs we are training with huge dataset, i have gone for ridge as helps to prevent overfitting by adding a penalty term to the least squares equation. This penalty term will be added as constraint on the magnitude of the coefficients, which reduces complexity of the model and prevents overfitting. Ridge regression is particularly useful as there are many independent variables and multicollinearity is present.\n\nOn the other hand Lasso is similar to Ridge which is another regularization technique that adds a penalty term to the least squares equation, but it has a different effect on the coefficients than ridge regression. It also encourages sparsity in the coefficients by shrinking some of them to zero and effective removing some of the independent variables from the model which is useful as there are many independent variables and it is suspected that only a subset of them are important for predicting the dependent variable.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Define models\n\nlinearModel <- train(total_deaths_per_million ~ ., data = trainingData, method = \"lm\")\n\nridgeFitControl <- trainControl(method = \"cv\", number = 10, savePredictions = TRUE, classProbs = TRUE)\ntuneGrid <- expand.grid(alpha = 0, lambda = seq(0.1, 1, 0.1))\nridgeModel <- train(total_deaths_per_million ~ ., data = trainingData, method = \"glmnet\", trControl = ridgeFitControl, tuneGrid = tuneGrid)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in train.default(x, y, weights = w, ...): cannnot compute class\nprobabilities for regression\n```\n:::\n\n```{.r .cell-code}\nlassoFitControl <- trainControl(method = \"cv\", number = 10, savePredictions = TRUE, classProbs = TRUE)\ntuneGrid <- expand.grid(alpha = 1, lambda = seq(0.1, 1, 0.1))\nlassoModel <- train(total_deaths_per_million ~ ., data = trainingData, method = \"glmnet\", trControl = lassoFitControl, tuneGrid = tuneGrid)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in train.default(x, y, weights = w, ...): cannnot compute class\nprobabilities for regression\n```\n:::\n\n```{.r .cell-code}\nmodelsList <- list(linearModel, ridgeModel, lassoModel)\nmodelNames <- c(\"Linear\", \"Ridge\", \"Lasso\")\n```\n:::\n\n\nTo pick the best model, RMSE (Root Mean Squared Error) has been calculated for each model. The model with least RMSE has been chosen as the final model.\n\nAlso the Variable Importance matrix has also been generated to get the weights for each variable which will help us get the influence of each variable\n\nAlso as we are dealing with multiple variables, ANOVA test has been run to check if all the variables are significant.\nBelow ANOVA table suggests that all predictor variables have a statistically significant impact on the response variable at a significance level of 0.05, as indicated by the very low p-values (<2.2e-16) for all variables. This means that all the variables are useful in predicting the response variable (total_deaths_per_million). \n\nThe F-value suggests that total_cases_per_million, gdp_per_capita, and median_age have the strongest impact on the response variable, while stringency_index and diabetes_prevalence have a weaker impact, and hospital_beds_per_thousand has a relatively moderate impact.\n\nThe R-squared value of 0.5999854 indicates that around 60% of the variance in the target variable can be explained by the independent variables included in the model. This suggests that the model is a moderately good fit for the data, but there may be other important factors that are not included in the model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nRMSEs <- sapply(modelsList, function(x) {RMSE(predict(x, newdata = testingData), testingData$total_deaths_per_million, na.rm = TRUE)})\nresultsDF <- data.frame(Model = modelNames, RMSE = RMSEs)\nresultsDF[order(resultsDF$RMSE), ]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Model     RMSE\n1 Linear 341.8495\n3  Lasso 341.8918\n2  Ridge 344.0509\n```\n:::\n\n```{.r .cell-code}\n# Check variable importance in the best model\nbestModel <- linearModel\nvarImp(bestModel)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nlm variable importance\n\n                           Overall\ntotal_cases_per_million    100.000\ngdp_per_capita              16.880\nmedian_age                  15.867\ndiabetes_prevalence          9.072\nhospital_beds_per_thousand   6.129\nstringency_index             0.000\n```\n:::\n\n```{.r .cell-code}\n# ANOVA\n# Extract the model objects\nlm_obj <- linearModel$finalModel\nridge_obj <- ridgeModel$finalModel\nlasso_obj <- lassoModel$finalModel\n\nanova(lm_obj, ridge_obj, lasso_obj)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in anova.lmlist(object, ...): models with response 'c(\"NULL\", \"NULL\")'\nremoved because response differs from model 1\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: .outcome\n                              Df     Sum Sq    Mean Sq  F value    Pr(>F)    \ntotal_cases_per_million        1 7372662747 7372662747 72226.46 < 2.2e-16 ***\ngdp_per_capita                 1  140632662  140632662  1377.71 < 2.2e-16 ***\nmedian_age                     1  220801732  220801732  2163.09 < 2.2e-16 ***\nstringency_index               1   10744021   10744021   105.25 < 2.2e-16 ***\ndiabetes_prevalence            1   86779962   86779962   850.14 < 2.2e-16 ***\nhospital_beds_per_thousand     1   65275964   65275964   639.48 < 2.2e-16 ***\nResiduals                  45143 4608063387     102077                       \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n# Calculate model accuracy metrics\n\npred <- predict(bestModel, newdata = testingData)\nactual <- testingData$total_deaths_per_million\n\n#RMSE <- RMSE(pred, actual)\n#MAE <- MAE(pred, actual)\nR2 <- R2(pred, actual)\ncat(\"R-squared:\", R2, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nR-squared: 0.5999854 \n```\n:::\n:::\n\nBelow are few visualizations for predictor variable and response variables. Plots to visualise predicted vs actual and residuals vs predicted.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Visualize the relationship between predictor variables and response variable\nlibrary(ggplot2)\nggplot(data, aes(x = total_cases_per_million, y = total_deaths_per_million)) +\n  geom_point() +\n  labs(x = \"Total Cases per Million\", y = \"Total Deaths per Million\", title = \"Relationship between Total Cases and Total Deaths per Million\")\n```\n\n::: {.cell-output-display}\n![](FinalProject_completeWriteup_rahulSomu_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Check for missing or infinite values in the data\nmissing_vals <- apply(testingData, 2, function(x) any(is.na(x) | is.infinite(x)))\ntestingData <- testingData[, !missing_vals]\n\n# Plot predicted vs actual values for the best model\nplot(pred, actual, xlab = \"Predicted Values\", ylab = \"Actual Values\", main = \"Predicted vs Actual Values\")\n```\n\n::: {.cell-output-display}\n![](FinalProject_completeWriteup_rahulSomu_files/figure-html/unnamed-chunk-10-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Plot residuals vs predicted values for the best model\nresiduals <- actual - pred\nplot(pred, residuals, xlab = \"Predicted Values\", ylab = \"Residuals\", main = \"Residuals vs Predicted Values\")\n```\n\n::: {.cell-output-display}\n![](FinalProject_completeWriteup_rahulSomu_files/figure-html/unnamed-chunk-10-3.png){width=672}\n:::\n:::\n\n\n##Conclusion:\n\nThe COVID-19 pandemic has affected entire world in many ways which resulted in not just health problems but also economic and social disruptions. Various measures have been implemented to contain the spread of the virus, such as lockdowns, social distancing guidelines, and mask mandates.\n\nTo understand the impact of different factors related to COVID-19 mortality rates, linear, ridge, and lasso regression models have been used to analyze data from different countries. The models included variables such as total cases per million, GDP per capita, median age, diabetes prevalence, hospital beds per thousand, and stringency index which are considered major factors for mortality rate.\n\nThe results showed that all these variables had a significant impact on the COVID-19 mortality rate. Total cases per million which is obvious is the most deciding variable and followed by GDP per capita and median age had bigger influence. Diabetes prevalence and hospital beds per thousand had a comparatively lesser effect. As per our results The stringency index, which measures the strictness of measures taken by governments to control the spread of the virus, had least effect on mortality rates.\n\nOverall, the results suggest that the COVID-19 mortality rate has been affected by a combination of factors, including the majorly by the economic and infrastructure condition of a country (measured by GDP per capita and Hospital beds per thousand), and the age distribution of the population as well as diabetic prevalance. Governments may need to take into account these factors when formulating policies and measures to contain the virus and reduce mortality rates. It is also essential to continue monitoring other factors and analyze the data to understand the impact of different variables on the pandemic impact and mortality rates which will help us be prepared for any future pandemic.",
    "supporting": [
      "FinalProject_completeWriteup_rahulSomu_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}