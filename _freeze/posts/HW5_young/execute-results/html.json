{
  "hash": "831e5bd5e6b97c6959c69bb297c18478",
  "result": {
    "markdown": "---\ntitle: \"Homework 5\"\nauthor: \"Young Soo Choi\"\ndescription: \"hw5\"\ndate: \"05/08/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw5\n---\n\n\n# Question 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(smss)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'smss' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\ndata(house.selling.price.2)\n\ncor<-cor(house.selling.price.2)\nreg_tot<-lm(P~., house.selling.price.2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ncor\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            P         S        Be        Ba       New\nP   1.0000000 0.8988136 0.5902675 0.7136960 0.3565540\nS   0.8988136 1.0000000 0.6691137 0.6624828 0.1762879\nBe  0.5902675 0.6691137 1.0000000 0.3337966 0.2672091\nBa  0.7136960 0.6624828 0.3337966 1.0000000 0.1820651\nNew 0.3565540 0.1762879 0.2672091 0.1820651 1.0000000\n```\n:::\n\n```{.r .cell-code}\nsummary(reg_tot)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ ., data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.212  -9.546   1.277   9.406  71.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -41.795     12.104  -3.453 0.000855 ***\nS             64.761      5.630  11.504  < 2e-16 ***\nBe            -2.766      3.960  -0.698 0.486763    \nBa            19.203      5.650   3.399 0.001019 ** \nNew           18.984      3.873   4.902  4.3e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.36 on 88 degrees of freedom\nMultiple R-squared:  0.8689,\tAdjusted R-squared:  0.8629 \nF-statistic: 145.8 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n## (A)\n\nThe backward elimation method is a method of excluding the highest p value from the model while including all variables. According to this, the \"Beds(Be)\" variable, which is the variable with the highest p value in the regression model above, becomes the first variable to be deleted.\n\n## (B)\n\nThe forward selection method starts with a model that does not include any variables and fits the dependent variable and the regression equation one by one for all variables, and among them, the variable with the lowest p value is included in the regression model one by one.\n\nTo this end, the p value of each variable was derived through Pearson's correlation analysis between each independent variable in this model and the dependent variable P.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlapply(house.selling.price.2[, -1], function(x) cor.test(house.selling.price.2$P, x))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n$S\n\n\tPearson's product-moment correlation\n\ndata:  house.selling.price.2$P and x\nt = 19.561, df = 91, p-value < 2.2e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.8509019 0.9318957\nsample estimates:\n      cor \n0.8988136 \n\n\n$Be\n\n\tPearson's product-moment correlation\n\ndata:  house.selling.price.2$P and x\nt = 6.9756, df = 91, p-value = 4.759e-10\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.4393929 0.7087536\nsample estimates:\n      cor \n0.5902675 \n\n\n$Ba\n\n\tPearson's product-moment correlation\n\ndata:  house.selling.price.2$P and x\nt = 9.7197, df = 91, p-value = 9.839e-16\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.5967461 0.8009566\nsample estimates:\n     cor \n0.713696 \n\n\n$New\n\n\tPearson's product-moment correlation\n\ndata:  house.selling.price.2$P and x\nt = 3.6406, df = 91, p-value = 0.0004515\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n 0.1648168 0.5223243\nsample estimates:\n     cor \n0.356554 \n```\n:::\n:::\n\n\nAs a result, it may be seen that the p value of the independent variable size(S) is the smallest(2.2e-16). Therefore, the first variable to be added is the size.\n\n\n## (C)\n\nIt is likely that the Beds variable has high multicollinearity, contains outliers, or distortion due to small samples.\nLooking at one by one, according to the correlation matrix seen earlier, the Beds variable shows a correlation coefficient of .6 or more with some variables, but it is difficult to judge that it has particular multicollinearity.\nNext, I checked out the outliers.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(house.selling.price.2$Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. \n  1.000   3.000   3.000   3.183   4.000   5.000 \n```\n:::\n\n```{.r .cell-code}\ntable(house.selling.price.2$Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n 1  2  3  4  5 \n 1  6 62 23  1 \n```\n:::\n:::\n\nIt has a range from a minimum value of 1 to a maximum value of 5, and among them, more than half are 3. Therefore, it cannot be said to be an outlier problem.\n\nThe multicollinearity of the Beds variable is not high and no special abnormal values are included.\nSo I think that this result is due to bias due to small sample numbers.\n\n## (D)\n\n### forward selection\n\nI proceeded to select a model according to each criterion using forward selection.\n\nFirst, four models including only one variable were created and each value was compared.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1st step: fitting 4 models with one variable\nreg_S<-lm(P~S, house.selling.price.2)\nreg_Be<-lm(P~Be, house.selling.price.2)\nreg_Ba<-lm(P~Ba, house.selling.price.2)\nreg_New<-lm(P~New, house.selling.price.2)\n\n# model with S\nsummary(reg_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-56.407 -10.656   2.126  11.412  85.091 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -25.194      6.688  -3.767 0.000293 ***\nS             75.607      3.865  19.561  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.47 on 91 degrees of freedom\nMultiple R-squared:  0.8079,\tAdjusted R-squared:  0.8058 \nF-statistic: 382.6 on 1 and 91 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nprice<-house.selling.price.2$P\nsum((price - predict(reg_S, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 34508.4\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 820.1439\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 827.7417\n```\n:::\n\n```{.r .cell-code}\n# model with Be\nsummary(reg_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ Be, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-72.079 -19.679  -3.779  14.352 174.752 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   -37.23      19.95  -1.866   0.0653 .  \nBe             42.97       6.16   6.976 4.76e-10 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 35.86 on 91 degrees of freedom\nMultiple R-squared:  0.3484,\tAdjusted R-squared:  0.3413 \nF-statistic: 48.66 on 1 and 91 DF,  p-value: 4.759e-10\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_Be, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 117028.4\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 933.7168\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 941.3146\n```\n:::\n\n```{.r .cell-code}\n# model with Ba\nsummary(reg_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ Ba, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-52.903 -21.003  -2.703  12.197 130.571 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -49.248     15.644  -3.148  0.00222 ** \nBa            76.026      7.822   9.720 9.84e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 31.12 on 91 degrees of freedom\nMultiple R-squared:  0.5094,\tAdjusted R-squared:  0.504 \nF-statistic: 94.47 on 1 and 91 DF,  p-value: 9.839e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_Ba, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 88121.47\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 907.3327\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 914.9305\n```\n:::\n\n```{.r .cell-code}\n# model with New\nsummary(reg_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-71.749 -21.249  -7.449  17.251 190.751 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   89.249      5.148  17.336  < 2e-16 ***\nNew           34.158      9.383   3.641 0.000451 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 41.51 on 91 degrees of freedom\nMultiple R-squared:  0.1271,\tAdjusted R-squared:  0.1175 \nF-statistic: 13.25 on 1 and 91 DF,  p-value: 0.0004515\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_New, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 156772.4\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 960.908\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 968.5058\n```\n:::\n:::\n\n\nModels including S show the best performance on all criteria. So in step 1, S is included in the model.\n\nSecond, a regression model including one variable was fitted again to a model containing S(Size) and compared according to each criterion.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 2nd step: fitting 3 models with two variables\nreg_S_Be<-lm(P~S+Be, house.selling.price.2)\nreg_S_Ba<-lm(P~S+Ba, house.selling.price.2)\nreg_S_New<-lm(P~S+New, house.selling.price.2)\n\n# model with S and Be\nsummary(reg_S_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Be, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-56.797 -11.751   2.859  10.817  84.417 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -22.393     10.937  -2.048   0.0435 *  \nS             76.742      5.227  14.682   <2e-16 ***\nBe            -1.468      4.523  -0.325   0.7462    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.57 on 90 degrees of freedom\nMultiple R-squared:  0.8081,\tAdjusted R-squared:  0.8038 \nF-statistic: 189.5 on 2 and 90 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_S_Be, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 34468.04\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_S_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 822.0351\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_S_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 832.1655\n```\n:::\n\n```{.r .cell-code}\n# model with S and Ba\nsummary(reg_S_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Ba, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-41.158 -10.984   1.658  12.792  81.058 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -49.752      9.183  -5.418    5e-07 ***\nS             63.863      4.840  13.194  < 2e-16 ***\nBa            22.448      6.130   3.662 0.000422 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 18.27 on 90 degrees of freedom\nMultiple R-squared:  0.8328,\tAdjusted R-squared:  0.8291 \nF-statistic: 224.1 on 2 and 90 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_S_Ba, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 30032.81\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_S_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 809.2251\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_S_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 819.3555\n```\n:::\n\n```{.r .cell-code}\n# model with S and New\nsummary(reg_S_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-47.207  -9.763  -0.091   9.984  76.405 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -26.089      5.977  -4.365 3.39e-05 ***\nS             72.575      3.508  20.690  < 2e-16 ***\nNew           19.587      3.995   4.903 4.16e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 17.4 on 90 degrees of freedom\nMultiple R-squared:  0.8484,\tAdjusted R-squared:  0.845 \nF-statistic: 251.8 on 2 and 90 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_S_New, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 27233.66\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_S_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 800.1262\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_S_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 810.2566\n```\n:::\n:::\n\n\nIn addition to \"S\", the model with \"New\" performs best on all criteria, so I included the \"New\" variable in the model at this stage.\n\nThird, the model containing the remaining \"Be\" and \"Ba\" in the model containing \"S\" and \"New\" is compared by fitting.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 3rd step: fitting 2 models with three variables\nreg_S_N_Be<-lm(P~S+New+Be, house.selling.price.2)\nreg_S_N_Ba<-lm(P~S+New+Ba, house.selling.price.2)\n\n# model with S and New and Be\nsummary(reg_S_N_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + New + Be, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-47.184  -8.815   1.550   9.943  73.261 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -15.215      9.771  -1.557    0.123    \nS             76.825      4.621  16.624  < 2e-16 ***\nNew           20.749      4.059   5.112 1.81e-06 ***\nBe            -5.729      4.085  -1.402    0.164    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 17.3 on 89 degrees of freedom\nMultiple R-squared:  0.8516,\tAdjusted R-squared:  0.8466 \nF-statistic: 170.3 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_S_N_Be, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 26644.82\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_S_N_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 800.0934\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_S_N_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 812.7564\n```\n:::\n\n```{.r .cell-code}\n# model with S and New and Ba\nsummary(reg_S_N_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + New + Ba, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.804  -9.496   0.917   7.931  73.338 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -47.992      8.209  -5.847 8.15e-08 ***\nS             62.263      4.335  14.363  < 2e-16 ***\nNew           18.371      3.761   4.885 4.54e-06 ***\nBa            20.072      5.495   3.653 0.000438 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.31 on 89 degrees of freedom\nMultiple R-squared:  0.8681,\tAdjusted R-squared:  0.8637 \nF-statistic: 195.3 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_S_N_Ba, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 23683.53\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_S_N_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 789.1366\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_S_N_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 801.7996\n```\n:::\n:::\n\n\nThis time, the model with \"Ba\" is superior to the model with \"Be\" in all criteria. So, in this step, \"Ba\" is included in the model.\n\nFinally, I compared this third model with a model including \"Be\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 4th step: fitting 1 models with every variables\nsummary(reg_tot)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ ., data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.212  -9.546   1.277   9.406  71.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -41.795     12.104  -3.453 0.000855 ***\nS             64.761      5.630  11.504  < 2e-16 ***\nBe            -2.766      3.960  -0.698 0.486763    \nBa            19.203      5.650   3.399 0.001019 ** \nNew           18.984      3.873   4.902  4.3e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.36 on 88 degrees of freedom\nMultiple R-squared:  0.8689,\tAdjusted R-squared:  0.8629 \nF-statistic: 145.8 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_tot, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 23552.98\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_tot)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 790.6225\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_tot)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 805.8181\n```\n:::\n:::\n\n\nAll analysis is now complete. The model to be selected according to each criterion is as follows,\n\n1. R-squared: Since the R-squared value of the model including all variables is the highest, by this criterion the model including all variables is selected.\n\n2. Adj. R-squared: Since the adj. R-squared value of the model including three variables(excluding \"Be\") is the highest, by this criterion the model including three variables(\"S\",\"Ba\",\"New\") is selected.\n\n3. PRESS: Since the PRESS value of the model including all variables is the lowest, by this criterion the model including all variables is selected.\n\n4. AIC: Since the AIC value of the model including three variables(excluding \"Be\") is the lowest, by this criterion the model including three variables(\"S\",\"Ba\",\"New\") is selected.\n\n5. BIC: Since the BIC value of the model including three variables(excluding \"Be\") is the lowest, by this criterion the model including three variables(\"S\",\"Ba\",\"New\") is selected.\n\nOverall, the model including every variables is selected according to the R-squared and PRESS criteria, and the model including \"S\", \"New\", \"Ba\" variables is selected according to the adj. R-squared, AIC, and BIC.\n\n### backward method\n\nIn the same way, I proceeded with model selection using the backward method.\n\nFour models in which variables were omitted one by one from a model including all variables were fitted and compared.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1st step: fitting 4 models without one variable\nreg_no_S<-lm(P~.-S, house.selling.price.2)\nreg_no_Be<-lm(P~.-Be, house.selling.price.2)\nreg_no_Ba<-lm(P~.-Ba, house.selling.price.2)\nreg_no_New<-lm(P~.-New, house.selling.price.2)\n\n# model without S\nsummary(reg_no_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ . - S, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-46.066 -17.066  -4.607   9.384 115.151 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -106.101     16.892  -6.281 1.21e-08 ***\nBe            26.175      4.811   5.440 4.63e-07 ***\nBa            60.184      6.900   8.722 1.41e-13 ***\nNew           15.099      6.070   2.487   0.0147 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 25.74 on 89 degrees of freedom\nMultiple R-squared:  0.6717,\tAdjusted R-squared:  0.6606 \nF-statistic: 60.69 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_no_S, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 58971.87\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_no_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 873.9787\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_no_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 886.6417\n```\n:::\n\n```{.r .cell-code}\n# model without Be\nsummary(reg_no_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ . - Be, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.804  -9.496   0.917   7.931  73.338 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -47.992      8.209  -5.847 8.15e-08 ***\nS             62.263      4.335  14.363  < 2e-16 ***\nBa            20.072      5.495   3.653 0.000438 ***\nNew           18.371      3.761   4.885 4.54e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.31 on 89 degrees of freedom\nMultiple R-squared:  0.8681,\tAdjusted R-squared:  0.8637 \nF-statistic: 195.3 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_no_Be, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 23683.53\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_no_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 789.1366\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_no_Be)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 801.7996\n```\n:::\n\n```{.r .cell-code}\n# model without Ba\nsummary(reg_no_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ . - Ba, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-47.184  -8.815   1.550   9.943  73.261 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -15.215      9.771  -1.557    0.123    \nS             76.825      4.621  16.624  < 2e-16 ***\nBe            -5.729      4.085  -1.402    0.164    \nNew           20.749      4.059   5.112 1.81e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 17.3 on 89 degrees of freedom\nMultiple R-squared:  0.8516,\tAdjusted R-squared:  0.8466 \nF-statistic: 170.3 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_no_Ba, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 26644.82\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_no_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 800.0934\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_no_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 812.7564\n```\n:::\n\n```{.r .cell-code}\n# model without New\nsummary(reg_no_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ . - New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-40.199 -10.462   1.167  12.612  81.724 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -53.382     13.319  -4.008 0.000127 ***\nS             62.354      6.292   9.910 4.91e-16 ***\nBe             1.636      4.327   0.378 0.706299    \nBa            22.915      6.282   3.648 0.000445 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 18.36 on 89 degrees of freedom\nMultiple R-squared:  0.8331,\tAdjusted R-squared:  0.8274 \nF-statistic:   148 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_no_New, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 29984.66\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_no_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 811.0758\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_no_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 823.7388\n```\n:::\n:::\n\n\nThe performance of the model without \"Be\" is the best in all criteria. However, according to the R-squared and PRESS criteria, the performance of the model without \"Be\" falls short of that of the model with all variables.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 2nd step: fitting 3 models without two variable\nreg_no_Be_S<-lm(P~.-Be-S, house.selling.price.2)\nreg_no_Be_Ba<-lm(P~.-Be-Ba, house.selling.price.2)\nreg_no_Be_New<-lm(P~.-Be-New, house.selling.price.2)\n\n# model without Be and S\nsummary(reg_no_Be_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ . - Be - S, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-45.947 -22.301  -7.501  14.153 119.618 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -47.113     14.869  -3.169  0.00209 ** \nBa            71.480      7.553   9.463 3.74e-15 ***\nNew           22.454      6.793   3.305  0.00136 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 29.55 on 90 degrees of freedom\nMultiple R-squared:  0.5625,\tAdjusted R-squared:  0.5528 \nF-statistic: 57.85 on 2 and 90 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_no_Be_S, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 78581.72\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_no_Be_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 898.677\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_no_Be_S)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 908.8074\n```\n:::\n\n```{.r .cell-code}\n# model without Be and Ba\nsummary(reg_no_Be_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ . - Be - Ba, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-47.207  -9.763  -0.091   9.984  76.405 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -26.089      5.977  -4.365 3.39e-05 ***\nS             72.575      3.508  20.690  < 2e-16 ***\nNew           19.587      3.995   4.903 4.16e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 17.4 on 90 degrees of freedom\nMultiple R-squared:  0.8484,\tAdjusted R-squared:  0.845 \nF-statistic: 251.8 on 2 and 90 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_no_Be_Ba, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 27233.66\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_no_Be_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 800.1262\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_no_Be_Ba)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 810.2566\n```\n:::\n\n```{.r .cell-code}\n# model without Be and New\nsummary(reg_no_Be_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ . - Be - New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-41.158 -10.984   1.658  12.792  81.058 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -49.752      9.183  -5.418    5e-07 ***\nS             63.863      4.840  13.194  < 2e-16 ***\nBa            22.448      6.130   3.662 0.000422 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 18.27 on 90 degrees of freedom\nMultiple R-squared:  0.8328,\tAdjusted R-squared:  0.8291 \nF-statistic: 224.1 on 2 and 90 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nsum((price - predict(reg_no_Be_New, newdata = house.selling.price.2))^2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 30032.81\n```\n:::\n\n```{.r .cell-code}\nAIC(reg_no_Be_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 809.2251\n```\n:::\n\n```{.r .cell-code}\nBIC(reg_no_Be_New)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 819.3555\n```\n:::\n:::\n\n\nThere is no model that improves performance compared to the existing model that includes four or three variables.So there are no more variables to exclude.\n\nIn other words, the results of model selection using the backward method are as follows.\n\n1. R-squared: Since the R-squared value of the model including all variables is the highest, by this criterion the model including all variables is selected.\n\n2. Adj. R-squared: Since the adj. R-squared value of the model including three variables(excluding \"Be\") is the highest, by this criterion the model including three variables(\"S\",\"Ba\",\"New\") is selected.\n\n3. PRESS: Since the PRESS value of the model including all variables is the lowest, by this criterion the model including all variables is selected.\n\n4. AIC: Since the AIC value of the model including three variables(excluding \"Be\") is the lowest, by this criterion the model including three variables(\"S\",\"Ba\",\"New\") is selected.\n\n5. BIC: Since the BIC value of the model including three variables(excluding \"Be\") is the lowest, by this criterion the model including three variables(\"S\",\"Ba\",\"New\") is selected.\n\nOverall, the results were the same as the forward method.\n\n## (E)\n\nIt is natural that the explanatory power of the model increases as the number of variables included in the model increases. However, as the number of variables increases, it becomes difficult to understand the model, and overfitting may occur, which increases errors when applied to new data. Therefore, when selecting a model, indicators have been released to correct the explanatory power that increases due to the increase in the number of variables, and these are adj. R-squared, AIC, and BIC. From this point of view, I prefer models that include \"S\", \"Ba\", and \"New\", which are selected according to these criteria.\n\n# Question 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(trees)\nnames(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Girth\"  \"Height\" \"Volume\"\n```\n:::\n\n```{.r .cell-code}\nnames(trees)[1] <- \"Diameter\"\nnames(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"Diameter\" \"Height\"   \"Volume\"  \n```\n:::\n\n```{.r .cell-code}\nnrow(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 31\n```\n:::\n:::\n\n\n## (A)\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_reg<-lm(Volume~., trees)\nsummary(tree_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Volume ~ ., data = trees)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4065 -2.6493 -0.2876  2.2003  8.4847 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***\nDiameter      4.7082     0.2643  17.816  < 2e-16 ***\nHeight        0.3393     0.1302   2.607   0.0145 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.882 on 28 degrees of freedom\nMultiple R-squared:  0.948,\tAdjusted R-squared:  0.9442 \nF-statistic:   255 on 2 and 28 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nVolume = -57.9877 + 4.7082*Diameter + 0.3393*Height\n\n## (B)\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow=c(2:3))\nplot(tree_reg, which=1:6)\n```\n\n::: {.cell-output-display}\n![](HW5_young_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n\n\n\"Residuals vs. Since the fitted values plot\" is curved, it can be seen that the linearity assumption of this model is violated. In addition, the shape of the \"Scale Location Plot\" is rapidly changing, indicating that the homoskedasticity assumption is violated. Normality is satisfied according to \"Normal Q-Q plot\". According to the rest of the plot, some variables have a high influence on the model but are not considered problematic (3 out of 31 observations)\n\nNext, I checked the residual plot to check the independence of the error.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nres<-trees$Volume-predict(tree_reg, newdata = trees)\nplot(res)\n```\n\n::: {.cell-output-display}\n![](HW5_young_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nSince no unusual pattern is seen, the assumption of the independence of the error is satisfied.\n\n# Question 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'alr4' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: effects\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'effects' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\ndata(\"florida\")\nflorida[\"PALM BEACH\",]\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Gore   Bush Buchanan\nPALM BEACH 268945 152846     3407\n```\n:::\n:::\n\n\n## (A)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreg_vote<-lm(Buchanan~Bush, florida)\nsummary(reg_vote)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Buchanan ~ Bush, data = florida)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-907.50  -46.10  -29.19   12.26 2610.19 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 4.529e+01  5.448e+01   0.831    0.409    \nBush        4.917e-03  7.644e-04   6.432 1.73e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 353.9 on 65 degrees of freedom\nMultiple R-squared:  0.3889,\tAdjusted R-squared:  0.3795 \nF-statistic: 41.37 on 1 and 65 DF,  p-value: 1.727e-08\n```\n:::\n\n```{.r .cell-code}\npar(mfrow=c(2:3))\nplot(reg_vote, which=1:6)\n```\n\n::: {.cell-output-display}\n![](HW5_young_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\nAccording to these graphs, Palm Beach corresponds to an outlier, and in all graphs, the data of Palm Beach is not on the trend line, but is far from it.\n\n## (B)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# logarithm\nflorida$log_Buchanan<-log(florida$Buchanan)\nflorida$log_Bush<-log(florida$Bush)\n\n# fitting\nlog_reg<-lm(log_Buchanan~log_Bush, florida)\nsummary(log_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log_Buchanan ~ log_Bush, data = florida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.96075 -0.25949  0.01282  0.23826  1.66564 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2.57712    0.38919  -6.622 8.04e-09 ***\nlog_Bush     0.75772    0.03936  19.251  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4673 on 65 degrees of freedom\nMultiple R-squared:  0.8508,\tAdjusted R-squared:  0.8485 \nF-statistic: 370.6 on 1 and 65 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\n# diagnosis\npar(mfrow=c(2:3))\nplot(log_reg, which=1:6)\n```\n\n::: {.cell-output-display}\n![](HW5_young_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\nAlthough the fluctuation of the data has been reduced through logarithm, it still has high leverage and the cook's distance still exceeds the 4/n standard, so I think it is an outlier.\n",
    "supporting": [
      "HW5_young_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}