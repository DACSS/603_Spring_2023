{
  "hash": "7a5d3a159053fb078df915243ab44e5c",
  "result": {
    "markdown": "---\ntitle: \"HW1\"\nauthor: \"Liam Tucksmith\"\ndesription: \"FinishedHW1\"\ndate: \"02/20/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw1\n  - Liam Tucksmith\n  - LungCapData\n  - tidyverse\n  - readxl\n  - ggplot2\n  - dplyr\n  - tidyr\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(readxl)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(tidyr)\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- read_excel(\"_data/LungCapData.xls\")\n```\n:::\n\n\n1.\n\na. What does the distribution of LungCap look like?\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(df$LungCap)\n```\n\n::: {.cell-output-display}\n![](HW1_LTucksmith_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\nThe distribution looks normal, the observations are centered around the mean with minimal outliers.\n\nb) Compare the probability distribution of the LungCap with respect to Males and Females?\n\n::: {.cell}\n\n```{.r .cell-code}\nlungCapP <- pnorm(df$LungCap, mean(df$LungCap), sd(df$LungCap))\nboxplot(lungCapP~df$Gender)\n```\n\n::: {.cell-output-display}\n![](HW1_LTucksmith_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\nFor both male and female, the probability distribution of the LungCap is similiar. For male, the median line is slightly higher than female, suggesting that their average lungCap is slightly higher for males than females. Also, for male the median is directly in the middle, suggesting that the data isn't particularly skewed. For female the split appears to have more values fall below the mean than above, telling us that the data skews moreso than for male. \n\nc) Compare the mean lung capacities for smokers and non-smokers. Does it make sense?\n\n::: {.cell}\n\n```{.r .cell-code}\ndfSmokeLungCap <- df %>% group_by(Smoke) %>% \n    summarise(mean_LungCap=mean(LungCap))\n\nprint(dfSmokeLungCap)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  Smoke mean_LungCap\n  <chr>        <dbl>\n1 no            7.77\n2 yes           8.65\n```\n:::\n:::\n\nNo, the lungCap average does not make sense. We would expect that the lung capacity for smokers would be lower than it is for non-smokers, but we are seeing the opposite, as the lungCap for smokers is higher than it is for non-smokers. \n\nd) Examine the relationship between Smoking and Lung Capacity within age groups: “less than or\nequal to 13”, “14 to 15”, “16 to 17”, and “greater than or equal to 18”.\n\n::: {.cell}\n\n```{.r .cell-code}\ndfAgeRanges <- df %>% \n  mutate(ageRange = case_when(\n    df$Age<=13 ~ \"A\",\n    between(df$Age, 14, 15) ~ \"B\",\n    between(df$Age, 16, 17) ~ \"C\",\n    df$Age>=18 ~ \"D\"\n  ))\n\nprint(dfAgeRanges)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 725 × 7\n   LungCap   Age Height Smoke Gender Caesarean ageRange\n     <dbl> <dbl>  <dbl> <chr> <chr>  <chr>     <chr>   \n 1    6.48     6   62.1 no    male   no        A       \n 2   10.1     18   74.7 yes   female no        D       \n 3    9.55    16   69.7 no    female yes       C       \n 4   11.1     14   71   no    male   no        B       \n 5    4.8      5   56.9 no    male   no        A       \n 6    6.22    11   58.7 no    female no        A       \n 7    4.95     8   63.3 no    male   yes       A       \n 8    7.32    11   70.4 no    male   no        A       \n 9    8.88    15   70.5 no    male   no        B       \n10    6.8     11   59.2 no    male   no        A       \n# … with 715 more rows\n```\n:::\n:::\n\n\ne) Compare the lung capacities for smokers and non-smokers within each age group. Is your answer\ndifferent from the one in part c. What could possibly be going on here?\n\n::: {.cell}\n\n```{.r .cell-code}\ndfMeanAgeRanges <- dfAgeRanges %>% group_by(ageRange, Smoke) %>% \n    summarise(mean_LungCap=mean(LungCap))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'ageRange'. You can override using the\n`.groups` argument.\n```\n:::\n\n```{.r .cell-code}\nprint(dfMeanAgeRanges)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 8 × 3\n# Groups:   ageRange [4]\n  ageRange Smoke mean_LungCap\n  <chr>    <chr>        <dbl>\n1 A        no            6.36\n2 A        yes           7.20\n3 B        no            9.14\n4 B        yes           8.39\n5 C        no           10.5 \n6 C        yes           9.38\n7 D        no           11.1 \n8 D        yes          10.5 \n```\n:::\n:::\n\nHere, there is a more varied relationship between smoking and lung capacity due to age as a mitigating variable. Here, the lung capacity for non-smokers is higher than the lung capacity for smokers in youngest age range, but the other age ranges display the opposite relationship. This may be due to the possibility that smoking has a stronger influence on lungCapacity the longer you smoke. So younger folks may have only smoked for a year or so, while folks in the older age ranges have spent many more years smoking. While there still isn't a clear indirect or direct relationship between smoking and lung capacity with this view, adding the ageRange variable showed that there is more to the relationship than was found in part C. \n\n2.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nx <- c(0,1,2,3,4)\nfrequency <- c(128,434,160,64,24)\ndf_2 <- data.frame(x, frequency)\n```\n:::\n\n\n\na) What is the probability that a randomly selected inmate has exactly 2 prior convictions?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprob_a = dpois(df_2[3,1], df_2[3,2]/(sum(df_2$frequency)))\nprint(prob_a)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.01601229\n```\n:::\n:::\n\n\nb) What is the probability that a randomly selected inmate has fewer than 2 prior convictions?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprob_b = ppois(df_2[2,1], (df_2[2,2]+df_2[1,2])/(sum(df_2$frequency)))\nprint(prob_b)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8463379\n```\n:::\n:::\n\n\nc) What is the probability that a randomly selected inmate has 2 or fewer prior convictions?\n\n::: {.cell}\n\n```{.r .cell-code}\nprob_c = ppois(df_2[3,1], (df_2[3,2]+df_2[2,2]+df_2[1,2])/(sum(df_2$frequency)))\nprint(prob_c)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9385585\n```\n:::\n:::\n\n\nd) What is the probability that a randomly selected inmate has more than 2 prior convictions?\n\n::: {.cell}\n\n```{.r .cell-code}\ndf_2d <- df_2[4:5,]\nprob_d = 1 - (ppois(df_2d[2,1],(df_2[4,2]+df_2[5,2])/(sum(df_2$frequency))))\nprint(prob_d)              \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.15223e-07\n```\n:::\n:::\n\ne) What is the expected value1 for the number of prior convictions?\n\n::: {.cell}\n\n```{.r .cell-code}\nprobs_e = dpois(df_2$x, df_2$frequency/(sum(df_2$frequency)))\neval = sum(df_2$x*probs_e)\nprint(eval)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.3458039\n```\n:::\n:::\n\n\n\nf) Calculate the variance and the standard deviation for the Prior Convictions.\n\n::: {.cell}\n\n```{.r .cell-code}\nvar_f <- var(rep(df_2$x, df_2$frequency))\nprint(var_f)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8572937\n```\n:::\n\n```{.r .cell-code}\nsd_f <- sd(rep(df_2$x, df_2$frequency))\nprint(sd_f)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9259016\n```\n:::\n:::",
    "supporting": [
      "HW1_LTucksmith_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}