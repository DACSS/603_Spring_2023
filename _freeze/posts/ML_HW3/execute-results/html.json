{
  "hash": "11b68e62d9e5fdc19774ae07c8d1411b",
  "result": {
    "markdown": "---\ntitle: \"ML_HW3\"\nauthor: \"Niharika Pola\"\ndescription: \"Homework - 3\"\ndate: \"05/17/2022\"\nformat: html\neditor: visual\n---\n\n\n## Homework - 5\n\n### Motivation:\n\nContext: In my previous semester (Fall 2022), as part of courework for DACSS 603: Introduction to Quantitative analysis, I worked on identifying the variables or factors that are affecting a country's happiness and used linear regression models to fit/accurately predict the happiness scores of each country.\n\nIn this study, I have found out that Life Expectancy, GDP per capita and Urbanization rate are significatly associated with happiness scores and among these three Life Expectancy proved to be the most strongly associated variable/factor that can effect a country's happiness.\n\nHence, In this course, I have decided to use the machine learning techniques/models I have learnt to identfy the predicting variables that are actually affecting the Life Expectancy along with other research questions.\n\nAbout the Data:\n\nIn this project, I have considered Life Expectancy data from 2000-2015 for 193 countries collected from the Global Health Obervatory(GHO) repository under World Health Organization(WHO). The dataset is made available to public for the purpose of health data analysis. It consists of 22 Columns and 2938 rows which meant 20 predicting variables. All predicting variables was then divided into several broad categories: Immunization related factors, Mortality factors, Economical factors and Social factors.\n\nDespite numerous previous studies examining various factors that influence life expectancy, such as demographic variables, income composition, and mortality rates, the impact of immunization and the human development index has been largely overlooked. Additionally, previous research has predominantly relied on a single-year dataset for all countries, utilizing multiple linear regression. Consequently, there is a compelling need to address these aforementioned factors by developing a regression model based on a combination of mixed effects modeling and multiple linear regression. Moreover, this study aims to incorporate data spanning from 2000 to 2015 across all countries, while specifically considering crucial immunizations like Hepatitis B, Polio, and Diphtheria. In summary, this study will encompass the examination of immunization factors, mortality factors, economic factors, social factors, and other health-related variables. Given that the dataset comprises observations from diverse countries, it becomes more feasible for each country to identify the significant predictive factors contributing to lower life expectancy. Consequently, this research will provide valuable insights for countries to prioritize particular areas and effectively enhance the life expectancy of their populations.\n\nThis study aims to answer the following research questions:\n\n1.  a\\) What are the predicting variables/factors actually affecting the life expectancy?\n\n    b\\) How are these variables/factors in predicting the life expectancy?\n\n2.  Can we predict the likelihood of a country being classified as a 'Developed' or 'Developing' country based on various health and socioeconomic factors?\n\n#### Exploratory Data Analysis\n\nInstalling required packages\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.2     ✔ purrr   1.0.1\n✔ tibble  3.1.8     ✔ dplyr   1.1.0\n✔ tidyr   1.3.0     ✔ stringr 1.5.0\n✔ readr   2.1.4     ✔ forcats 1.0.0\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggplot2' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(readr)\nlibrary(corrplot)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'corrplot' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\ncorrplot 0.92 loaded\n```\n:::\n\n```{.r .cell-code}\nlibrary(reshape2)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'reshape2'\n\nThe following object is masked from 'package:tidyr':\n\n    smiths\n```\n:::\n\n```{.r .cell-code}\nlibrary(corrgram)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'corrgram' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggpubr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggpubr' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(caTools)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'caTools' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\nlibrary(GGally)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'GGally' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRegistered S3 method overwritten by 'GGally':\n  method from   \n  +.gg   ggplot2\n```\n:::\n\n```{.r .cell-code}\nlibrary(stats)\nlibrary(ggsci)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'ggsci' was built under R version 4.2.3\n```\n:::\n:::\n\n\nReading & Preparing the dataset\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#reading the data\nLife_Expectancy_Data <- read_csv(\"Life Expectancy Data.csv\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 2938 Columns: 22\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (2): Country, Status\ndbl (20): Year, Life expectancy, Adult Mortality, infant deaths, Alcohol, pe...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\nhead(Life_Expectancy_Data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 22\n  Country      Year Status   `Life expectancy` `Adult Mortality` `infant deaths`\n  <chr>       <dbl> <chr>                <dbl>             <dbl>           <dbl>\n1 Afghanistan  2015 Develop…              65                 263              62\n2 Afghanistan  2014 Develop…              59.9               271              64\n3 Afghanistan  2013 Develop…              59.9               268              66\n4 Afghanistan  2012 Develop…              59.5               272              69\n5 Afghanistan  2011 Develop…              59.2               275              71\n6 Afghanistan  2010 Develop…              58.8               279              74\n# ℹ 16 more variables: Alcohol <dbl>, `percentage expenditure` <dbl>,\n#   `Hepatitis B` <dbl>, Measles <dbl>, BMI <dbl>, `under-five deaths` <dbl>,\n#   Polio <dbl>, `Total expenditure` <dbl>, Diphtheria <dbl>, `HIV/AIDS` <dbl>,\n#   GDP <dbl>, Population <dbl>, `thinness  1-19 years` <dbl>,\n#   `thinness 5-9 years` <dbl>, `Income composition of resources` <dbl>,\n#   Schooling <dbl>\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# View the structure of the dataset\nstr(Life_Expectancy_Data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nspc_tbl_ [2,938 × 22] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Country                        : chr [1:2938] \"Afghanistan\" \"Afghanistan\" \"Afghanistan\" \"Afghanistan\" ...\n $ Year                           : num [1:2938] 2015 2014 2013 2012 2011 ...\n $ Status                         : chr [1:2938] \"Developing\" \"Developing\" \"Developing\" \"Developing\" ...\n $ Life expectancy                : num [1:2938] 65 59.9 59.9 59.5 59.2 58.8 58.6 58.1 57.5 57.3 ...\n $ Adult Mortality                : num [1:2938] 263 271 268 272 275 279 281 287 295 295 ...\n $ infant deaths                  : num [1:2938] 62 64 66 69 71 74 77 80 82 84 ...\n $ Alcohol                        : num [1:2938] 0.01 0.01 0.01 0.01 0.01 0.01 0.01 0.03 0.02 0.03 ...\n $ percentage expenditure         : num [1:2938] 71.3 73.5 73.2 78.2 7.1 ...\n $ Hepatitis B                    : num [1:2938] 65 62 64 67 68 66 63 64 63 64 ...\n $ Measles                        : num [1:2938] 1154 492 430 2787 3013 ...\n $ BMI                            : num [1:2938] 19.1 18.6 18.1 17.6 17.2 16.7 16.2 15.7 15.2 14.7 ...\n $ under-five deaths              : num [1:2938] 83 86 89 93 97 102 106 110 113 116 ...\n $ Polio                          : num [1:2938] 6 58 62 67 68 66 63 64 63 58 ...\n $ Total expenditure              : num [1:2938] 8.16 8.18 8.13 8.52 7.87 9.2 9.42 8.33 6.73 7.43 ...\n $ Diphtheria                     : num [1:2938] 65 62 64 67 68 66 63 64 63 58 ...\n $ HIV/AIDS                       : num [1:2938] 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 0.1 ...\n $ GDP                            : num [1:2938] 584.3 612.7 631.7 670 63.5 ...\n $ Population                     : num [1:2938] 33736494 327582 31731688 3696958 2978599 ...\n $ thinness  1-19 years           : num [1:2938] 17.2 17.5 17.7 17.9 18.2 18.4 18.6 18.8 19 19.2 ...\n $ thinness 5-9 years             : num [1:2938] 17.3 17.5 17.7 18 18.2 18.4 18.7 18.9 19.1 19.3 ...\n $ Income composition of resources: num [1:2938] 0.479 0.476 0.47 0.463 0.454 0.448 0.434 0.433 0.415 0.405 ...\n $ Schooling                      : num [1:2938] 10.1 10 9.9 9.8 9.5 9.2 8.9 8.7 8.4 8.1 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Country = col_character(),\n  ..   Year = col_double(),\n  ..   Status = col_character(),\n  ..   `Life expectancy` = col_double(),\n  ..   `Adult Mortality` = col_double(),\n  ..   `infant deaths` = col_double(),\n  ..   Alcohol = col_double(),\n  ..   `percentage expenditure` = col_double(),\n  ..   `Hepatitis B` = col_double(),\n  ..   Measles = col_double(),\n  ..   BMI = col_double(),\n  ..   `under-five deaths` = col_double(),\n  ..   Polio = col_double(),\n  ..   `Total expenditure` = col_double(),\n  ..   Diphtheria = col_double(),\n  ..   `HIV/AIDS` = col_double(),\n  ..   GDP = col_double(),\n  ..   Population = col_double(),\n  ..   `thinness  1-19 years` = col_double(),\n  ..   `thinness 5-9 years` = col_double(),\n  ..   `Income composition of resources` = col_double(),\n  ..   Schooling = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# column names\ncolnames(Life_Expectancy_Data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"Country\"                         \"Year\"                           \n [3] \"Status\"                          \"Life expectancy\"                \n [5] \"Adult Mortality\"                 \"infant deaths\"                  \n [7] \"Alcohol\"                         \"percentage expenditure\"         \n [9] \"Hepatitis B\"                     \"Measles\"                        \n[11] \"BMI\"                             \"under-five deaths\"              \n[13] \"Polio\"                           \"Total expenditure\"              \n[15] \"Diphtheria\"                      \"HIV/AIDS\"                       \n[17] \"GDP\"                             \"Population\"                     \n[19] \"thinness  1-19 years\"            \"thinness 5-9 years\"             \n[21] \"Income composition of resources\" \"Schooling\"                      \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# summary statistics\nsummary(Life_Expectancy_Data)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   Country               Year         Status          Life expectancy\n Length:2938        Min.   :2000   Length:2938        Min.   :36.30  \n Class :character   1st Qu.:2004   Class :character   1st Qu.:63.10  \n Mode  :character   Median :2008   Mode  :character   Median :72.10  \n                    Mean   :2008                      Mean   :69.22  \n                    3rd Qu.:2012                      3rd Qu.:75.70  \n                    Max.   :2015                      Max.   :89.00  \n                                                      NA's   :10     \n Adult Mortality infant deaths       Alcohol        percentage expenditure\n Min.   :  1.0   Min.   :   0.0   Min.   : 0.0100   Min.   :    0.000     \n 1st Qu.: 74.0   1st Qu.:   0.0   1st Qu.: 0.8775   1st Qu.:    4.685     \n Median :144.0   Median :   3.0   Median : 3.7550   Median :   64.913     \n Mean   :164.8   Mean   :  30.3   Mean   : 4.6029   Mean   :  738.251     \n 3rd Qu.:228.0   3rd Qu.:  22.0   3rd Qu.: 7.7025   3rd Qu.:  441.534     \n Max.   :723.0   Max.   :1800.0   Max.   :17.8700   Max.   :19479.912     \n NA's   :10                       NA's   :194                             \n  Hepatitis B       Measles              BMI        under-five deaths\n Min.   : 1.00   Min.   :     0.0   Min.   : 1.00   Min.   :   0.00  \n 1st Qu.:77.00   1st Qu.:     0.0   1st Qu.:19.30   1st Qu.:   0.00  \n Median :92.00   Median :    17.0   Median :43.50   Median :   4.00  \n Mean   :80.94   Mean   :  2419.6   Mean   :38.32   Mean   :  42.04  \n 3rd Qu.:97.00   3rd Qu.:   360.2   3rd Qu.:56.20   3rd Qu.:  28.00  \n Max.   :99.00   Max.   :212183.0   Max.   :87.30   Max.   :2500.00  \n NA's   :553                        NA's   :34                       \n     Polio       Total expenditure   Diphtheria       HIV/AIDS     \n Min.   : 3.00   Min.   : 0.370    Min.   : 2.00   Min.   : 0.100  \n 1st Qu.:78.00   1st Qu.: 4.260    1st Qu.:78.00   1st Qu.: 0.100  \n Median :93.00   Median : 5.755    Median :93.00   Median : 0.100  \n Mean   :82.55   Mean   : 5.938    Mean   :82.32   Mean   : 1.742  \n 3rd Qu.:97.00   3rd Qu.: 7.492    3rd Qu.:97.00   3rd Qu.: 0.800  \n Max.   :99.00   Max.   :17.600    Max.   :99.00   Max.   :50.600  \n NA's   :19      NA's   :226       NA's   :19                      \n      GDP              Population        thinness  1-19 years\n Min.   :     1.68   Min.   :3.400e+01   Min.   : 0.10       \n 1st Qu.:   463.94   1st Qu.:1.958e+05   1st Qu.: 1.60       \n Median :  1766.95   Median :1.387e+06   Median : 3.30       \n Mean   :  7483.16   Mean   :1.275e+07   Mean   : 4.84       \n 3rd Qu.:  5910.81   3rd Qu.:7.420e+06   3rd Qu.: 7.20       \n Max.   :119172.74   Max.   :1.294e+09   Max.   :27.70       \n NA's   :448         NA's   :652         NA's   :34          \n thinness 5-9 years Income composition of resources   Schooling    \n Min.   : 0.10      Min.   :0.0000                  Min.   : 0.00  \n 1st Qu.: 1.50      1st Qu.:0.4930                  1st Qu.:10.10  \n Median : 3.30      Median :0.6770                  Median :12.30  \n Mean   : 4.87      Mean   :0.6276                  Mean   :11.99  \n 3rd Qu.: 7.20      3rd Qu.:0.7790                  3rd Qu.:14.30  \n Max.   :28.60      Max.   :0.9480                  Max.   :20.70  \n NA's   :34         NA's   :167                     NA's   :163    \n```\n:::\n\n```{.r .cell-code}\nLife_Expectancy_Data <- na.omit(Life_Expectancy_Data)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Find countries with the lowest and highest life expectancy\nlowest_life_expectancy <- Life_Expectancy_Data[which.min(Life_Expectancy_Data$`Life expectancy`), c(\"Country\", \"Life expectancy\", \"Status\")]\nhighest_life_expectancy <- Life_Expectancy_Data[which.max(Life_Expectancy_Data$`Life expectancy`), c(\"Country\", \"Life expectancy\", \"Status\")]\n\n# Print the countries with their life expectancy values\ncat(\"Country with the lowest life expectancy:\", lowest_life_expectancy$Country, lowest_life_expectancy$Status, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCountry with the lowest life expectancy: Malawi Developing \n```\n:::\n\n```{.r .cell-code}\ncat(\"Lowest Life Expectancy:\", lowest_life_expectancy$`Life expectancy`, \"\\n\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLowest Life Expectancy: 44 \n```\n:::\n\n```{.r .cell-code}\ncat(\"Country with the highest life expectancy:\", highest_life_expectancy$Country, highest_life_expectancy$Status, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCountry with the highest life expectancy: Belgium Developed \n```\n:::\n\n```{.r .cell-code}\ncat(\"Highest Life Expectancy:\", highest_life_expectancy$`Life expectancy`, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nHighest Life Expectancy: 89 \n```\n:::\n:::\n\n\nUndoubtedly the country with lowest life expectancy is a developing country - \"Haiti\" with 36.3 and the country with highest life expectancy is a developed country - \"Belgium\" with 89.\n\nNow lets understand the average life expectancy of developing and developed countries and the difference between them.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(Life_Expectancy_Data, aes(x = Status, y = `Life expectancy`, fill = Status)) +\n  geom_bar(stat = \"summary\", fun = \"mean\") +\n  geom_text(stat = \"summary\", fun = \"mean\", aes(label = round(..y.., digits = 2)), vjust = -0.2, color = \"black\") +\n  labs(x = \"Status\", y = \"Mean Life Expectancy\") +\n  ggtitle(\"Mean Life Expectancy by Status\") +\n  theme(legend.position = \"none\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: The dot-dot notation (`..y..`) was deprecated in ggplot2 3.4.0.\nℹ Please use `after_stat(y)` instead.\n```\n:::\n\n::: {.cell-output-display}\n![](ML_HW3_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nNow let's try to understand the factors/variables that are affecting Life Expectancy by correlation matrix.\n\n##### Research Question - 1a\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Select columns for correlation analysis\nselected_cols <- c(\"Life expectancy\", \"Adult Mortality\", \"infant deaths\", \"Alcohol\", \n                   \"percentage expenditure\", \"Hepatitis B\", \"Measles\", \"BMI\",\n                   \"under-five deaths\", \"Polio\", \"Total expenditure\", \"Diphtheria\",\n                   \"HIV/AIDS\", \"GDP\", \"Population\", \"thinness  1-19 years\",\n                   \"thinness 5-9 years\", \"Income composition of resources\", \"Schooling\")\n\n# Subset the data with selected columns\nsubset_data <- Life_Expectancy_Data[, selected_cols]\n\ncorrelation_matrix <- cor(subset_data)\n\ncorrplot(correlation_matrix, method = \"circle\", type = \"upper\", tl.cex = 0.8)\n```\n\n::: {.cell-output-display}\n![](ML_HW3_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nAs you can notice in the above plot, the significant variables with blue color are associated with the Life Expectancy which are Alcohol, Percentage Expenditure, Hepatitis B, BMI, Polio, Total Expenditure, Diphtheria, GDP, Income composition of resources and Schooling.\n\nLeast significant associated variables are Adult Mortality, Infant Deaths, Under - Five deaths, HIV/AIDS, thinness 1-9 years and thinness 5-9 years.\n\nNow let's plot another correlation matrix of these variables to identify the order of significant association.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncorr_cols <- c(\"Life expectancy\", \"Alcohol\", \n                   \"percentage expenditure\", \"Hepatitis B\", \"BMI\",\n                    \"Polio\", \"Total expenditure\", \"Diphtheria\",\n                   \"HIV/AIDS\", \"GDP\", \"Income composition of resources\", \"Schooling\")\n\n# Subset the data with selected columns\ncorr_subset_data <- Life_Expectancy_Data[, corr_cols]\n\nggcorr(corr_subset_data, label = TRUE, label_round = 2, label_size = 3.5, size = 4, hjust = 1) +\n  theme(plot.title = element_text(hjust = 0.5))\n```\n\n::: {.cell-output-display}\n![](ML_HW3_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nAs you can see schooling \\> Income composition of resources \\> BMI \\> GDP \\> Percentage Expenditure, Alcohol is the order.\n\nGoing further, I will be considering these 6 variables for the prediction models.\n\n#### Evaluation Metrics\n\nI will be using a different evaluation metric for each of my research questions separately.\n\nFor research question 1b) How are these variables/factors in predicting the life expectancy? I will be using R-squared. This will help me assess how well the predictors (such as schooling, income composition of resources, BMI, GDP, percentage expenditure, and alcohol) explain the variability in life expectancy. A higher R-squared value indicates that a larger proportion of the variation in life expectancy is accounted for by the predictors, suggesting a better fit of the model.\n\nFor the second research question 2) \"Can we predict the likelihood of a country being classified as a 'Developed' or 'Developing' country based on various health and socioeconomic factors?\", choosing the F1 score is a good decision. F1 score is a balanced metric that takes into account both precision and recall, making it suitable for assessing the performance of models when dealing with imbalanced classes. The F1 score provides a single measure that balances the trade-off between correctly predicting positive instances and avoiding false positives or false negatives. Higher F1 scores indicate better model performance in correctly classifying countries as 'Developed' or 'Developing'.\n\nBy selecting R-squared for the first research question and F1 score for the second research question, I will be able to evaluate the performance and effectiveness of the prediction models in addressing each specific research question.\n\n#### Data Pre-processing\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Let's create a new dataset with the 6 variables\nmodel_cols <- c(\"Life expectancy\", \"Alcohol\", \n                   \"percentage expenditure\", \"BMI\",\n                    \"GDP\", \"Income composition of resources\", \"Schooling\")\n\n# Subset the data with selected columns, data1 will be used for research question- 1b\ndata1 <- Life_Expectancy_Data[, model_cols]\n\n#let's change the column names\ncolnames(data1) <- c(\"Life.expectancy\", \"Alcohol\", \n                   \"percentage.expenditure\", \"BMI\",\n                    \"GDP\", \"Income.composition.of.resources\", \"Schooling\")\n\n#checking for missing data\ncolSums(is.na(data1)) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                Life.expectancy                         Alcohol \n                              0                               0 \n         percentage.expenditure                             BMI \n                              0                               0 \n                            GDP Income.composition.of.resources \n                              0                               0 \n                      Schooling \n                              0 \n```\n:::\n:::\n\n\nThere is no missing data\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel2_cols <- c(\"Status\",\"Life expectancy\", \"Alcohol\", \n                   \"percentage expenditure\", \"BMI\",\n                    \"GDP\", \"Income composition of resources\", \"Schooling\")\n\n# Subset the data with selected columns, data2 will be used for research question-2\ndata2 <- Life_Expectancy_Data[, model2_cols]\n\n#checking for missing data\ncolSums(is.na(data2)) \n```\n\n::: {.cell-output .cell-output-stdout}\n```\n                         Status                 Life expectancy \n                              0                               0 \n                        Alcohol          percentage expenditure \n                              0                               0 \n                            BMI                             GDP \n                              0                               0 \nIncome composition of resources                       Schooling \n                              0                               0 \n```\n:::\n\n```{.r .cell-code}\n#Replacing the values of the Status column with 1 and 0\ndata2$Status <- ifelse(data2$Status == \"Developing\", 0, 1)\n```\n:::\n\n\nI have created two separate datasets for each of the research questions with the selected variables, checked for missing values in the columns (there aren't any), and also changed the categorical values in Status column of the second dataset with 1 and 0 (1 indicates developed and 0 indicates developing) .\n\n#### Fitting a model\n\n##### Research question 1b\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load required packages\nlibrary(caret)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'caret' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: lattice\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'lattice'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:corrgram':\n\n    panel.fill\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'caret'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:purrr':\n\n    lift\n```\n:::\n\n```{.r .cell-code}\nlibrary(Metrics)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'Metrics' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'Metrics'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:caret':\n\n    precision, recall\n```\n:::\n\n```{.r .cell-code}\nlibrary(randomForest)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'randomForest' was built under R version 4.2.3\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nrandomForest 4.7-1.1\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nType rfNews() to see new features/changes/bug fixes.\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'randomForest'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    combine\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:ggplot2':\n\n    margin\n```\n:::\n\n```{.r .cell-code}\nlibrary(e1071)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: package 'e1071' was built under R version 4.2.3\n```\n:::\n\n```{.r .cell-code}\n# Define the predictors and target variable\npredictors <- c(\"Schooling\", \"Income.composition.of.resources\", \"BMI\", \"GDP\", \"percentage.expenditure\", \"Alcohol\")\ntarget <- \"Life.expectancy\"  # Update target variable name\n\n# Clean column names by removing leading and trailing spaces\ncolnames(data1) <- trimws(colnames(data1))\n\n\n# Create a formula for the models\nformula_str <- paste(target, paste(predictors, collapse = \" + \"), sep = \" ~ \")\nformula <- as.formula(formula_str)\n\n# Split the data into training and test sets\nset.seed(123)  # For reproducibility\ntrain_indices <- sample(1:nrow(data1), 0.7 * nrow(data1))\ntrain_data <- data1[train_indices, ]\ntest_data <- data1[-train_indices, ]\n\n# Convert data to data.frame format\ntrain_data <- as.data.frame(train_data)\ntest_data <- as.data.frame(test_data)\n\n# Linear Regression\nlinear_model <- lm(formula, data = train_data)\nlinear_r_squared <- summary(linear_model)$r.squared\n\n# Random Forest\nrf_model <- randomForest(formula, data = train_data)\nrf_predictions <- predict(rf_model, newdata = test_data)\nrf_r_squared <- 1 - MAE(rf_predictions, test_data$Life.expectancy) / mean(test_data$Life.expectancy)\n\n\n# SVM\nsvm_model <- svm(formula, data = train_data)\nsvm_predictions <- predict(svm_model, newdata = test_data)\nsvm_r_squared <- 1 - MAE(svm_predictions, test_data$Life.expectancy) / mean(test_data$Life.expectancy)\n\n# Print the R-squared values\ncat(\"Linear Regression R-squared:\", linear_r_squared, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLinear Regression R-squared: 0.6178792 \n```\n:::\n\n```{.r .cell-code}\ncat(\"Random Forest R-squared:\", rf_r_squared, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRandom Forest R-squared: 0.9692845 \n```\n:::\n\n```{.r .cell-code}\ncat(\"SVM R-squared:\", svm_r_squared, \"\\n\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nSVM R-squared: 0.9610103 \n```\n:::\n:::\n",
    "supporting": [
      "ML_HW3_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}