{
  "hash": "a9dcbb8c593a9af1bbf277b5b2110581",
  "result": {
    "markdown": "---\ntitle: \"Homework 1\"\nauthor: \"Diana Rinker\"\ndescription: \"Homework 1\"\ndate: \"02/17/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw1\n  - desriptive statistics \n  - probability\n---\n\n\n# Question 1\n\nFirst, let's read in the data from the Excel file:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readxl)\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(tidyr)\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2\n──\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n✔ ggplot2 3.4.1     ✔ purrr   1.0.1\n✔ tibble  3.1.8     ✔ stringr 1.5.0\n✔ readr   2.1.4     ✔ forcats 1.0.0\n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\ndf <- read_excel(\"_data/LungCapData.xls\")\n```\n:::\n\n\n#### a) What does the distribution of LungCap look like? (Hint: Plot a histogram with probability density on the y axis)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhist(df$LungCap)\n```\n\n::: {.cell-output-display}\n![](HW_test_name_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nThe histogram suggests that the distribution is close to a normal distribution. Most of the observations are close to the mean. Very few observations are close to the margins (0 and 15).\n\n#### b) Compare the probability distribution of the LungCap with respect to Males and Females? (Hint: make boxplots separated by gender using the boxplot() function)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot( LungCap ~ Gender , data =df)\n```\n\n::: {.cell-output-display}\n![](HW_test_name_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n#### c) Compare the mean lung capacities for smokers and non-smokers. Does it make sense?\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf.grouped<- df %>%\n  group_by(Smoke)%>%\n  summarize (mean.Lunc.Cap = mean (LungCap))\nknitr::kable(df.grouped)\n```\n\n::: {.cell-output-display}\n|Smoke | mean.Lunc.Cap|\n|:-----|-------------:|\n|no    |      7.770188|\n|yes   |      8.645454|\n:::\n:::\n\n\nIt is surprising that smoker's lung capacity mean is larger than for nonsmokers. T o understand the reason, I would need to break up the data into subgroups.\n\n#### d) Examine the relationship between Smoking and Lung Capacity within age groups: \"less than or equal to 13\", \"14 to 15\", \"16 to 17\", and \"greater than or equal to 18\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$age.group <- NA  \ndf$age.group<- ifelse(df$Age <=13, \"under13\" , df$age.group )\ndf$age.group<- ifelse(df$Age >=14 & df$Age <=15, \"14-15\" , df$age.group )\ndf$age.group<- ifelse(df$Age >=16 & df$Age <=17, \"16-17\" , df$age.group )\ndf$age.group<- ifelse(df$Age >=18, \"18+\" , df$age.group )\ndf$age.group <-factor (df$age.group, levels = c(\"under13\",  \"14-15\", \"16-17\", \"18+\") )\n\ndf.grouped\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 2 × 2\n  Smoke mean.Lunc.Cap\n  <chr>         <dbl>\n1 no             7.77\n2 yes            8.65\n```\n:::\n\n```{.r .cell-code}\nggplot (df, mapping=aes(y=LungCap, x = Smoke ))+\n  geom_boxplot()+\n  facet_wrap (~ age.group)\n```\n\n::: {.cell-output-display}\n![](HW_test_name_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n#### d) Compare the lung capacities for smokers and non-smokers within each age group. Is your answer different from the one in part c. What could possibly be going on here?\n\nIn the table of counts within each age group we can see that the group 'under 13\" is over 50 of the records. Within this group, there is no difference between smokers and non-smokers (probably because of the length of smoking and the fact that only 7% are smokers), which contibutes to overall sample mean.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf.grouped<-df%>%\n  group_by(age.group, Smoke)%>%\nsummarize (count=n())\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`summarise()` has grouped output by 'age.group'. You can override using the\n`.groups` argument.\n```\n:::\n:::\n\n\nTo compare smokers and non-smokers accurately, we could exclude the group \"under 13\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf.filtered<- df %>%\n  filter(age.group != \"under13\")\n\nggplot (df.filtered, mapping=aes(y=LungCap, x = Smoke ))+\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](HW_test_name_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nNow we can see the difference between mean, where smokers have smaller Lung capacity.\n\n# Question 2\n\nLet X = number of prior convictions for prisoners at a state prison at which there are 810 prisoners.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nX <- c(0, 1, 2, 3, 4)\nFrequency <- c(128,434, 160, 64, 24)\n\ndf<-tibble (X, Frequency) \ndf$Probabilty <- Frequency/sum(Frequency)\nknitr::kable(df)\n```\n\n::: {.cell-output-display}\n|  X| Frequency| Probabilty|\n|--:|---------:|----------:|\n|  0|       128|  0.1580247|\n|  1|       434|  0.5358025|\n|  2|       160|  0.1975309|\n|  3|        64|  0.0790123|\n|  4|        24|  0.0296296|\n:::\n:::\n\n\n#### a) What is the probability that a randomly selected inmate has exactly 2 prior convictions?\n\nNumber of prior convictions of inmates has Poisson distribution. \nProbability of X = is 0.197\n\n\n::: {.cell}\n\n```{.r .cell-code}\nchances.of.2<- df$Probabilty[3]\nknitr::kable(chances.of.2)\n```\n\n::: {.cell-output-display}\n|         x|\n|---------:|\n| 0.1975309|\n:::\n:::\n\n\n#### b) What is the probability that a randomly selected inmate has **fewer than 2** prior convictions?\n\nTo calculate \"fewer than2\", we will use cumulative probability for Poisson distribution with default \"lower.tail =T\", for value \"1\" to exclude value \"2\".\n\n\n::: {.cell}\n\n```{.r .cell-code}\nprob.under.2 <- sum(df$Probabilty[1:2])\nknitr::kable(prob.under.2   )\n```\n\n::: {.cell-output-display}\n|         x|\n|---------:|\n| 0.6938272|\n:::\n:::\n\n\n#### c) What is the probability that a randomly selected inmate has **2 or fewer** prior convictions?\n\nTo calculate \"fewer than2\", we will use cumulative probability for Poisson distribution with default \"lower.tail =T\":\nIt will include value of \"2\".\n\n::: {.cell}\n\n```{.r .cell-code}\nprob.under.and.2 <- sum(df$Probabilty[1:3])\nknitr::kable(prob.under.and.2)\n```\n\n::: {.cell-output-display}\n|        x|\n|--------:|\n| 0.891358|\n:::\n:::\n\n\n#### d) What is the probability that a randomly selected inmate has **over 2** prior convictions?\n\nTo calculate \"over than 2\", we will use cumulative probability for Poisson distribution with \"lower.tail =F\":\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlambda<- mean (df$X)\nprob.over.2 <- sum(df$Probabilty[4:5] )\nknitr::kable(prob.over.2  )\n```\n\n::: {.cell-output-display}\n|        x|\n|--------:|\n| 0.108642|\n:::\n:::\n\n\n\n\n\n#### e) What is the expected value for the number of prior convictions\n\n$$\nE(X) = \\sum_{all x} x  \\cdot p(x) = \\mu  \n$$\n\n::: {.cell}\n\n```{.r .cell-code}\ndf$Probabilty <- Frequency/sum(Frequency)\n(expected.value.of.X <- sum(df$X * df$Probabilty ))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 1.28642\n```\n:::\n\n```{.r .cell-code}\nknitr::kable(expected.value.of.X )\n```\n\n::: {.cell-output-display}\n|       x|\n|-------:|\n| 1.28642|\n:::\n:::\n\n\n#### f) Calculate the variance and the standard deviation for the Prior Convictions.\nVariance of a random variable: \n$$\n\\sigma^2 = E[(X-\\mu)^2] = \\sum_{all x}(x-\\mu)^2 \\cdot p(x)\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(variance.X <- sum (((df$X - expected.value.of.X )^2) * df$Probabilty  ))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8562353\n```\n:::\n:::\n\n\nAlternatively: \n$$\n\\sigma^2 = E(X^2)-[E(X)]^2 = E(X^2)-\\mu^2\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\n(variance <- (sum((df$X^2) * df$Probabilty )) - ((expected.value.of.X)^2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.8562353\n```\n:::\n:::\n\nStandard deviation is a square root of variance: \n$$\n\\sigma = \\sqrt variance\n$$\n\n::: {.cell}\n\n```{.r .cell-code}\n(sd<- sqrt(variance))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 0.9253298\n```\n:::\n:::\n",
    "supporting": [
      "HW_test_name_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}