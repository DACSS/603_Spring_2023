{
  "hash": "a29adb84a1732cfd65243cd9445f9832",
  "result": {
    "markdown": "::: {.cell}\n\n```{.r .cell-code}\nibrary(smss)\n```\n\n::: {.cell-output .cell-output-error}\n```\nError in ibrary(smss): could not find function \"ibrary\"\n```\n:::\n\n```{.r .cell-code}\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: effects\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\nlibrary(magrittr)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(house.selling.price.2, package=\"smss\")\ndata1 <- house.selling.price.2\nhead(house.selling.price.2,10)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       P    S Be Ba New\n1   48.5 1.10  3  1   0\n2   55.0 1.01  3  2   0\n3   68.0 1.45  3  2   0\n4  137.0 2.40  3  3   0\n5  309.4 3.30  4  3   1\n6   17.5 0.40  1  1   0\n7   19.6 1.28  3  1   0\n8   24.5 0.74  3  1   0\n9   34.8 0.78  2  1   0\n10  32.0 0.97  3  1   0\n```\n:::\n\n```{.r .cell-code}\nnames(data1) <- c('Price', 'Size', 'Beds', 'Baths', 'New')\n```\n:::\n\n1A:\n\n::: {.cell}\n\n```{.r .cell-code}\nhouse_price_2<-house.selling.price.2\n\n# Calculate the correlation matrix\ncorrelation_matrix <- cor(house_price_2)\n\nprint(correlation_matrix, border = TRUE, lwd = 2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            P         S        Be        Ba       New\nP   1.0000000 0.8988136 0.5902675 0.7136960 0.3565540\nS   0.8988136 1.0000000 0.6691137 0.6624828 0.1762879\nBe  0.5902675 0.6691137 1.0000000 0.3337966 0.2672091\nBa  0.7136960 0.6624828 0.3337966 1.0000000 0.1820651\nNew 0.3565540 0.1762879 0.2672091 0.1820651 1.0000000\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfit <- lm(P ~ ., data = house_price_2)\nbackward <- step(fit, direction = \"backward\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStart:  AIC=524.7\nP ~ S + Be + Ba + New\n\n       Df Sum of Sq   RSS    AIC\n- Be    1       131 23684 523.21\n<none>              23553 524.70\n- Ba    1      3092 26645 534.17\n- New   1      6432 29985 545.15\n- S     1     35419 58972 608.06\n\nStep:  AIC=523.21\nP ~ S + Ba + New\n\n       Df Sum of Sq   RSS    AIC\n<none>              23684 523.21\n- Ba    1      3550 27234 534.20\n- New   1      6349 30033 543.30\n- S     1     54898 78582 632.75\n```\n:::\n\n```{.r .cell-code}\nsummary(backward)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Ba + New, data = house_price_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.804  -9.496   0.917   7.931  73.338 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -47.992      8.209  -5.847 8.15e-08 ***\nS             62.263      4.335  14.363  < 2e-16 ***\nBa            20.072      5.495   3.653 0.000438 ***\nNew           18.371      3.761   4.885 4.54e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.31 on 89 degrees of freedom\nMultiple R-squared:  0.8681,\tAdjusted R-squared:  0.8637 \nF-statistic: 195.3 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\nThe variable to be deleted first in backward elimination would be \"Beds\" since it has the highest p-value of 0.487.\n\n1B:\n\n::: {.cell}\n\n```{.r .cell-code}\nforward_dir <- step(fit, direction = \"forward\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nStart:  AIC=524.7\nP ~ S + Be + Ba + New\n```\n:::\n\n```{.r .cell-code}\nsummary(forward_dir)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + Be + Ba + New, data = house_price_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.212  -9.546   1.277   9.406  71.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -41.795     12.104  -3.453 0.000855 ***\nS             64.761      5.630  11.504  < 2e-16 ***\nBe            -2.766      3.960  -0.698 0.486763    \nBa            19.203      5.650   3.399 0.001019 ** \nNew           18.984      3.873   4.902  4.3e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.36 on 88 degrees of freedom\nMultiple R-squared:  0.8689,\tAdjusted R-squared:  0.8629 \nF-statistic: 145.8 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\nIn forward selection, the variable with the lowest p-value is added first, indicating a stronger evidence of its influence on the response variable. \n\nConsidering the full model, we observe that the variable \"S\" has the lowest p-value (< 2e-16), demonstrating its high significance in predicting the house price. Therefore, if we were to employ forward selection based on p-values, the variable \"S\" would be added first to the model. Subsequently, \"Ba\" would be added, followed by \"New,\" and finally \"Be.\" It is worth noting that none of the other variables exhibit p-values lower than \"S,\" justifying their addition order.\n\nC:\nWhen additional variables are included in the regression model, the predictive power of \"Beds\" in determining the \"Price\" diminishes. This could be attributed to the fact that \"Baths\" and \"Size\" have a strong correlation with \"Price,\" indicating that they might already account for some of the influence that \"Beds\" has on the outcome. Furthermore, a high correlation between \"Size\" and \"Beds\" suggests the presence of multicollinearity, where these variables provide redundant information to the model.\n\nD:\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(P ~ S, data = house_price_2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S, data = house_price_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-56.407 -10.656   2.126  11.412  85.091 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -25.194      6.688  -3.767 0.000293 ***\nS             75.607      3.865  19.561  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 19.47 on 91 degrees of freedom\nMultiple R-squared:  0.8079,\tAdjusted R-squared:  0.8058 \nF-statistic: 382.6 on 1 and 91 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(P ~ S+New, data = house_price_2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ S + New, data = house_price_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-47.207  -9.763  -0.091   9.984  76.405 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -26.089      5.977  -4.365 3.39e-05 ***\nS             72.575      3.508  20.690  < 2e-16 ***\nNew           19.587      3.995   4.903 4.16e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 17.4 on 90 degrees of freedom\nMultiple R-squared:  0.8484,\tAdjusted R-squared:  0.845 \nF-statistic: 251.8 on 2 and 90 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(P ~ ., data = house_price_2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ ., data = house_price_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.212  -9.546   1.277   9.406  71.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -41.795     12.104  -3.453 0.000855 ***\nS             64.761      5.630  11.504  < 2e-16 ***\nBe            -2.766      3.960  -0.698 0.486763    \nBa            19.203      5.650   3.399 0.001019 ** \nNew           18.984      3.873   4.902  4.3e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.36 on 88 degrees of freedom\nMultiple R-squared:  0.8689,\tAdjusted R-squared:  0.8629 \nF-statistic: 145.8 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(P ~ . -Be, data = house_price_2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ . - Be, data = house_price_2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-34.804  -9.496   0.917   7.931  73.338 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -47.992      8.209  -5.847 8.15e-08 ***\nS             62.263      4.335  14.363  < 2e-16 ***\nBa            20.072      5.495   3.653 0.000438 ***\nNew           18.371      3.761   4.885 4.54e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.31 on 89 degrees of freedom\nMultiple R-squared:  0.8681,\tAdjusted R-squared:  0.8637 \nF-statistic: 195.3 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nfull_model <- lm(P ~ ., data = house.selling.price.2)\nmodel_noBeds <- lm(P ~ .-Be, data = house.selling.price.2)\nmodel_noBeds_noBaths <- lm(P ~ S + New, data = house.selling.price.2)\nmodel_size_only <- lm(P ~ S, data = house.selling.price.2)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nrsquared <- function(fit) summary(fit)$r.squared\nadj_rsquared <- function(fit) summary(fit)$adj.r.squared\nPRESS <- function(fit) {\n  pr <- residuals(fit)/(1-lm.influence(fit)$hat)\n  sum(pr^2)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmodels <- list(full_model, model_noBeds, model_noBeds_noBaths, model_size_only)\ndata.frame(models = c('full_model', 'model_noBeds', 'model_noBeds&Baths', 'model_only_size'),\n           rSquared = sapply(models, rsquared),\n           adj_rSquared = sapply(models, adj_rsquared),\n           PRESS = sapply(models, PRESS),\n           AIC = sapply(models, AIC),\n           BIC = sapply(models, BIC)) |>\n  print()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n              models  rSquared adj_rSquared    PRESS      AIC      BIC\n1         full_model 0.8688630    0.8629022 28390.22 790.6225 805.8181\n2       model_noBeds 0.8681361    0.8636912 27860.05 789.1366 801.7996\n3 model_noBeds&Baths 0.8483699    0.8450003 31066.00 800.1262 810.2566\n4    model_only_size 0.8078660    0.8057546 38203.29 820.1439 827.7417\n```\n:::\n:::\n\nIt is important to note that when evaluating the models based on R-squared and Adjusted R-squared, higher values indicate better model fit. However, in the case of PRESS, AIC, and BIC, lower values indicate better performance. Considering these criteria, the model that does not include the variable \"Beds\" is considered better. This conclusion is supported by the higher adjusted R-squared value and lower values of PRESS, AIC, and BIC for the model without \"Beds\".\n\nE:\nSelect model with no bed variable.\n\n2A:\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Girth Height Volume\n1   8.3     70   10.3\n2   8.6     65   10.3\n3   8.8     63   10.2\n4  10.5     72   16.4\n5  10.7     81   18.8\n6  10.8     83   19.7\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_model <- lm(Volume ~ Girth + Height, data = trees)\nsummary(tree_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Volume ~ Girth + Height, data = trees)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4065 -2.6493 -0.2876  2.2003  8.4847 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***\nGirth         4.7082     0.2643  17.816  < 2e-16 ***\nHeight        0.3393     0.1302   2.607   0.0145 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.882 on 28 degrees of freedom\nMultiple R-squared:  0.948,\tAdjusted R-squared:  0.9442 \nF-statistic:   255 on 2 and 28 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\nB:\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2,3))\nplot(tree_model, which = 1:6)\n```\n\n::: {.cell-output-display}\n![](Homework5_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\nThe violation that stands out the most from the first plot is the violation of the linearity assumption. In the plot of fitted values vs. residuals, the expected pattern is a relatively straight line along the horizontal axis. However, in this case, the red line follows a U-shaped pattern. This violation can be attributed to the relationship between the volume and the square of the diameter. The current model uses only the diameter (Girth) as a predictor, failing to capture the quadratic nature of the relationship. To address this issue, we can explore the inclusion of a quadratic term in the model.\n\n3A:\n\n::: {.cell}\n\n```{.r .cell-code}\nmodel <- lm(Buchanan ~ Bush, data = florida)\n\npar(mfrow = c(2, 2))\nplot(model)\n```\n\n::: {.cell-output-display}\n![](Homework5_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n3B:\n\n::: {.cell}\n\n```{.r .cell-code}\nflorida$log_Bush <- log(florida$Bush)\nflorida$log_Buchanan <- log(florida$Buchanan)\n\n# Perform simple linear regression with log-transformed variables\nmodel <- lm(log_Buchanan ~ log_Bush, data = florida)\n\n# Generate regression diagnostic plots\npar(mfrow = c(2, 2))\nplot(model)\n```\n\n::: {.cell-output-display}\n![](Homework5_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::",
    "supporting": [
      "Homework5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}