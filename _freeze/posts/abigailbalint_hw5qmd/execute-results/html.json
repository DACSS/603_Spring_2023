{
  "hash": "514a5b91c7a6b551ad7595fba2cc4664",
  "result": {
    "markdown": "---\ntitle: \"Homework 5\"\nauthor: \"Abigail Balint\"\ndesription: \"HW5 Responses\"\ndate: \"05/08/23\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw5\n  - homework5\n  - abigailbalint\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(ggplot2)\nlibrary(dplyr)\nlibrary(readxl)\nlibrary(alr4)\nlibrary(smss)\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n# Question 1\n\n\na) With backward elimination we would remove Beds variable first because the p value is highest at .487.\nb) With forward selection we would add New first because the opposite is true, the p value is lowest for this at 0.000.\nc) Beds likely has a high p value because there are other confounding variables contributing to the correlation with Price, but Beds alone isn't significant. I can see from the correlation table that Size and Baths are more strongly correlated with Price anyways so these likely may be the confounding variables.\n\nExploring variables and fitting models for d):\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"house.selling.price.2\")\nhead(house.selling.price.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      P    S Be Ba New\n1  48.5 1.10  3  1   0\n2  55.0 1.01  3  2   0\n3  68.0 1.45  3  2   0\n4 137.0 2.40  3  3   0\n5 309.4 3.30  4  3   1\n6  17.5 0.40  1  1   0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nm1 <- (lm(P ~ New, data=house.selling.price.2))\nm2 <- (lm(P ~ New + Ba, data=house.selling.price.2))\nm3 <- (lm(P ~ New + Ba + Be, data=house.selling.price.2))\nm4 <- (lm(P ~ New + Ba + Be + S, data=house.selling.price.2))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ New, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-71.749 -21.249  -7.449  17.251 190.751 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   89.249      5.148  17.336  < 2e-16 ***\nNew           34.158      9.383   3.641 0.000451 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 41.51 on 91 degrees of freedom\nMultiple R-squared:  0.1271,\tAdjusted R-squared:  0.1175 \nF-statistic: 13.25 on 1 and 91 DF,  p-value: 0.0004515\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ New + Ba, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-45.947 -22.301  -7.501  14.153 119.618 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -47.113     14.869  -3.169  0.00209 ** \nNew           22.454      6.793   3.305  0.00136 ** \nBa            71.480      7.553   9.463 3.74e-15 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 29.55 on 90 degrees of freedom\nMultiple R-squared:  0.5625,\tAdjusted R-squared:  0.5528 \nF-statistic: 57.85 on 2 and 90 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ New + Ba + Be, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-46.066 -17.066  -4.607   9.384 115.151 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -106.101     16.892  -6.281 1.21e-08 ***\nNew           15.099      6.070   2.487   0.0147 *  \nBa            60.184      6.900   8.722 1.41e-13 ***\nBe            26.175      4.811   5.440 4.63e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 25.74 on 89 degrees of freedom\nMultiple R-squared:  0.6717,\tAdjusted R-squared:  0.6606 \nF-statistic: 60.69 on 3 and 89 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ New + Ba + Be + S, data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.212  -9.546   1.277   9.406  71.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -41.795     12.104  -3.453 0.000855 ***\nNew           18.984      3.873   4.902  4.3e-06 ***\nBa            19.203      5.650   3.399 0.001019 ** \nBe            -2.766      3.960  -0.698 0.486763    \nS             64.761      5.630  11.504  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.36 on 88 degrees of freedom\nMultiple R-squared:  0.8689,\tAdjusted R-squared:  0.8629 \nF-statistic: 145.8 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\nd) Best model fit for each of the following:\n1. R2: m4 ( using all four variables)\n2. Adjusted R2: m4 ( using all four variables)\n3. PRESS: m4 ( using all four variables)\n4. AIC: m4 ( using all four variables)\n5. BIC: m4 ( using all four variables)\n\nI generated a model with an additional variable added each time and then ran the above five stats on all and got that the model with all four variables included would be the best fit every time so that is the one I would go with here. \n\n::: {.cell}\n\n```{.r .cell-code}\nPRESS <- function(linear.model) \n  {pr <- residuals(linear.model)/(1-lm.influence(linear.model)$hat)\n  PRESS <- sum(pr^2)\n  \n  return(PRESS)}\n\npressm1 <- PRESS(m1)\npressm2 <- PRESS(m2)\npressm3 <- PRESS(m3)\npressm4 <- PRESS(m4)\n\nprint(pressm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 164039.3\n```\n:::\n\n```{.r .cell-code}\nprint(pressm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 87677.82\n```\n:::\n\n```{.r .cell-code}\nprint(pressm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 67942.88\n```\n:::\n\n```{.r .cell-code}\nprint(pressm4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 28390.22\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nAIC(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 960.908\n```\n:::\n\n```{.r .cell-code}\nAIC(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 898.677\n```\n:::\n\n```{.r .cell-code}\nAIC(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 873.9787\n```\n:::\n\n```{.r .cell-code}\nAIC(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 790.6225\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nBIC(m1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 968.5058\n```\n:::\n\n```{.r .cell-code}\nBIC(m2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 908.8074\n```\n:::\n\n```{.r .cell-code}\nBIC(m3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 886.6417\n```\n:::\n\n```{.r .cell-code}\nBIC(m4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 805.8181\n```\n:::\n:::\n\n\n\n# Question 2\n\n\nBelow I have fit a model for Volume with the two predictor variables of Height and Girth, then run diagnostics on it. All looks normal with the exception of the first graph, Residual vs Fitted. Instead of being a relatively straight line with a random distribution around the line, the line is instead curved, so this would be the regression assumption that was violated.\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Girth Height Volume\n1   8.3     70   10.3\n2   8.6     65   10.3\n3   8.8     63   10.2\n4  10.5     72   16.4\n5  10.7     81   18.8\n6  10.8     83   19.7\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ntree1 <- (lm(Volume ~ Girth + Height, data=trees))\nsummary(tree1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Volume ~ Girth + Height, data = trees)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4065 -2.6493 -0.2876  2.2003  8.4847 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***\nGirth         4.7082     0.2643  17.816  < 2e-16 ***\nHeight        0.3393     0.1302   2.607   0.0145 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.882 on 28 degrees of freedom\nMultiple R-squared:  0.948,\tAdjusted R-squared:  0.9442 \nF-statistic:   255 on 2 and 28 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(tree1)\n```\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-13-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-13-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-13-4.png){width=672}\n:::\n:::\n\n\n# Question 3\n\na) I ran the regression and diagnostic below and Palm Beach is definitely an outlier. In every plot including residuals, normal distribution, and scale, Palm Beach is a clear outlier compared to the other counties.\n\nb) As shown in my second model and diagnostics, taking the log definitely helps but it still doesn't bring Palm Beach in line with the other counties enough to make it no longer look like an outlier which indicates that this county actually was an outlier in this dataset.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(florida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Gore   Bush Buchanan\nALACHUA   47300  34062      262\nBAKER      2392   5610       73\nBAY       18850  38637      248\nBRADFORD   3072   5413       65\nBREVARD   97318 115185      570\nBROWARD  386518 177279      789\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nflorida1 <- (lm(Buchanan ~ Bush, data=florida))\nsummary(florida1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Buchanan ~ Bush, data = florida)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-907.50  -46.10  -29.19   12.26 2610.19 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 4.529e+01  5.448e+01   0.831    0.409    \nBush        4.917e-03  7.644e-04   6.432 1.73e-08 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 353.9 on 65 degrees of freedom\nMultiple R-squared:  0.3889,\tAdjusted R-squared:  0.3795 \nF-statistic: 41.37 on 1 and 65 DF,  p-value: 1.727e-08\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(florida1)\n```\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-16-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-16-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-16-4.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nflorida2 <- (lm(log(Buchanan) ~ log(Bush), data=florida))\nsummary(florida2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log(Buchanan) ~ log(Bush), data = florida)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.96075 -0.25949  0.01282  0.23826  1.66564 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -2.57712    0.38919  -6.622 8.04e-09 ***\nlog(Bush)    0.75772    0.03936  19.251  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4673 on 65 degrees of freedom\nMultiple R-squared:  0.8508,\tAdjusted R-squared:  0.8485 \nF-statistic: 370.6 on 1 and 65 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(florida2)\n```\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-18-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-18-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](abigailbalint_hw5qmd_files/figure-html/unnamed-chunk-18-4.png){width=672}\n:::\n:::\n",
    "supporting": [
      "abigailbalint_hw5qmd_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}