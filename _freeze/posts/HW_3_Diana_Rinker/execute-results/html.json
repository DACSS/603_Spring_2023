{
  "hash": "1c445cbaadd9a91a64a4013adee41935",
  "result": {
    "markdown": "---\ntitle: \"Homework 3\"\nauthor: \"Diana Rinker\"\ndescription: \"HW3\"\ndate: \"4/11/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\neditor: \n  markdown: \n    wrap: 72\n---\n\n\n# DACSS 603, spring 2023\n\n# Homework 3, Diana Rinker.\n\nLoading necessary libraries:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'dplyr'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:stats':\n\n    filter, lag\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following objects are masked from 'package:base':\n\n    intersect, setdiff, setequal, union\n```\n:::\n\n```{.r .cell-code}\nlibrary(ggplot2)\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: carData\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n\nAttaching package: 'car'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nThe following object is masked from 'package:dplyr':\n\n    recode\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: effects\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\nlibrary(smss)\n```\n:::\n\n\n# Question 1\n\n**United Nations (Data file: UN11 in alr4) The data in the file UN11\ncontains several variables, including ppgdp, the gross national product\nper person in U.S. dollars, and fertility, the birth rate per 1000\nfemales, both from the year 2009. The data are for 199 localities,\nmostly UN member countries, but also other areas such as Hong Kong that\nare not independent countries. The data were collected from the United\nNations (2011). [We will study the dependence of fertility on\nppgdp.]{.underline}**\n\n(a) **Identify the predictor and the response.**\n\n    DV/response: fertility\n\n    IV/predictor: ppgdp\n\n(b) **Draw the scatterplot of fertility on the vertical axis versus\n    ppgdp on the horizontal axis and summarize the information in this\n    graph. Does a straight-line mean function seem to be plausible for a\n    summary of this graph?**\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(UN11)\nstr(UN11)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t199 obs. of  6 variables:\n $ region   : Factor w/ 8 levels \"Africa\",\"Asia\",..: 2 4 1 1 3 5 2 3 8 4 ...\n $ group    : Factor w/ 3 levels \"oecd\",\"other\",..: 2 2 3 3 2 2 2 2 1 1 ...\n $ fertility: num  5.97 1.52 2.14 5.13 2 ...\n $ ppgdp    : num  499 3677 4473 4322 13750 ...\n $ lifeExpF : num  49.5 80.4 75 53.2 81.1 ...\n $ pctUrban : num  23 53 67 59 100 93 64 47 89 68 ...\n - attr(*, \"na.action\")= 'omit' Named int [1:34] 4 5 8 28 41 67 68 72 79 83 ...\n  ..- attr(*, \"names\")= chr [1:34] \"Am Samoa\" \"Andorra\" \"Antigua and Barbuda\" \"Br Virigin Is\" ...\n```\n:::\n\n```{.r .cell-code}\n    ggplot(data=UN11, mapping= aes(x=ppgdp, y =fertility ))+\n      geom_point()+\n      stat_smooth(method = \"lm\", se = T)+\n      geom_hline(yintercept = mean(UN11$fertility), color = \"red\")+\n      labs(title=\"Scatterplot of fertility by ppgdp\")+\n      stat_smooth(method = \"lm\", se = T)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n:::\n\n\nFrom the graph above it is obvious, that the straight line mean is not\nrepresentative of the data. Even if be draw a linear model with\n\"stat_smooth(method =\"lm\", se = T)\", the line is still far from most\ndatapoints ( which indicate high value of error in the model)\n\n(c) **Draw the scatterplot of log(fertility) versus log(ppgdp) using\n    natural logarithms. Does the simple linear regression model seem\n    plausible for a summary of this graph? If you use a different base\n    of logarithms, the shape of the graph won't change, but the values\n    on the axes will change.**\n\n\n::: {.cell}\n\n```{.r .cell-code}\n   ggplot(data=UN11, mapping= aes(x=log(ppgdp), y =log(fertility) ))+\n      geom_point()+\n      stat_smooth(method = \"lm\", se = T)+\n      geom_hline(yintercept = mean(log(UN11$fertility)), color = \"red\")+\n      labs(title=\"Scatterplot of log(fertility) by log(ppgdp) \")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\nSimple linear regression seems much more plausible on this logged\nscatter plot.\n\nBelow, I am using different bases (5 and 7) of the logarithms. The shape\nof a line doesn't change, only x-scale limits change:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(data=UN11, mapping= aes(x=log(ppgdp, base =5), y =log(fertility), base =5 ))+\n      geom_point()+\n      stat_smooth(method = \"lm\", se = T)+\n      geom_hline(yintercept = mean(log(UN11$fertility),  base =5), color = \"red\")+\n      labs(title=\"Scatterplot of log(fertility) by log(ppgdp) base =5 \")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(data=UN11, mapping= aes(x=log(ppgdp, base =7), y =log(fertility), base =7))+\n      geom_point()+\n      stat_smooth(method = \"lm\", se = T)+\n      geom_hline(yintercept = mean(log(UN11$fertility),  base =7), color = \"red\")+\n      labs(title=\"Scatterplot of log(fertility) by log(ppgdp), base =7 \")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n\n# Question 2\n\n**Annual income, in dollars, is an explanatory variable in a regression\nanalysis. For a British version of the report on the analysis, all\nresponses are converted to British pounds sterling (1 pound equals about\n1.33 dollars, as of 2016).**\n\n**(a) How, if at all, does the slope of the prediction equation\nchange?**\n\n**(b) How, if at all, does the correlation change?**\n\nTo answer these questions, I will run linear regressions for the ppgpd\nin dollars and pounds and compare results.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nUN11$ppgdp.pound<-UN11$ppgdp*1.33\nfit1<- lm(lifeExpF ~ ppgdp, data = UN11)\nsummary(fit1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = lifeExpF ~ ppgdp, data = UN11)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-20.825  -4.889   2.618   6.619  11.299 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 6.837e+01  7.370e-01  92.762   <2e-16 ***\nppgdp       3.018e-04  3.274e-05   9.218   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.483 on 197 degrees of freedom\nMultiple R-squared:  0.3014,\tAdjusted R-squared:  0.2978 \nF-statistic: 84.98 on 1 and 197 DF,  p-value: < 2.2e-16\n```\n:::\n\n```{.r .cell-code}\nfit2<- lm(lifeExpF ~ ppgdp.pound, data = UN11)\nsummary(fit2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = lifeExpF ~ ppgdp.pound, data = UN11)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-20.825  -4.889   2.618   6.619  11.299 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 6.837e+01  7.370e-01  92.762   <2e-16 ***\nppgdp.pound 2.269e-04  2.462e-05   9.218   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 8.483 on 197 degrees of freedom\nMultiple R-squared:  0.3014,\tAdjusted R-squared:  0.2978 \nF-statistic: 84.98 on 1 and 197 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nVisualizing the model with both variables (ppgdp and ppgdp.pound )\nproduces the same model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot( data=UN11, mapping=aes(x= ppgdp , y=lifeExpF))+\n  geom_point() +\n  geom_smooth(method = 'lm')+\n      labs(title=\"Scatterplot of Female life expectancy by annual income \", x=\"PPGDP in US dollars\", y=\"Life expectancy\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot( data=UN11, mapping=aes(x= ppgdp.pound , y=lifeExpF))+\n  geom_point() +\n  geom_smooth(method = 'lm')+\n      labs(title=\"Scatterplot of Female life expectancy by annual income \", x=\"PPGDP in British pounds\", y=\"Life expectancy\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\nVisualizing logged variables ( for the US dollars and British pounds) :\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot( data=UN11, mapping=aes(x= log(ppgdp) , y=lifeExpF   )     )+\n  geom_point() +\n  geom_smooth(method = 'lm')+\n      labs(title=\"Scatterplot of Female life expectancy by annual income \", x=\"Logged PPGDP in US dollars\", y=\"Life expectancy\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot( data=UN11, mapping=aes(x= log(ppgdp.pound) , y=lifeExpF    )     )+\n  geom_point() +\n  geom_smooth(method = 'lm')+\n      labs(title=\"Scatterplot of Female life expectancy by annual income \", x=\"Logged PPGDP in British pounds\", y=\"Life expectancy\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n:::\n\n\nThere is no change in slope and correlation between variablle in US\ndollars and British pounds.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_logged<- lm(lifeExpF~ log(ppgdp), data = UN11)\n\nsummary(fit_logged)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = lifeExpF ~ log(ppgdp), data = UN11)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-25.749  -2.879   1.280   3.987  12.345 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  29.8148     2.5314   11.78   <2e-16 ***\nlog(ppgdp)    5.0188     0.2942   17.06   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.448 on 197 degrees of freedom\nMultiple R-squared:  0.5964,\tAdjusted R-squared:  0.5943 \nF-statistic: 291.1 on 1 and 197 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nHowever, using log() function on x variable allowed us to build a better\nfitted model with R\\^2 increased from 0.30 to 0.60. I can conclude that\n1% change in PPGDP correspons with 5 % increase in Life expectancy.\n\n# Question 3\n\nWater runoff in the Sierras (Data file: water in alr4) Can Southern\nCalifornia's water supply in future years be predicted from past data?\nOne factor affecting water availability is stream runoff. If runoff\ncould be predicted, engineers, planners, and policy makers could do\ntheir jobs\n\nmore efficiently. The data file contains 43 years' worth of\nprecipitation measurements taken at six sites in the Sierra Nevada\nmountains (labeled APMAM, APSAB, APSLAKE, OPBPC, OPRC, and OPSLAKE) and\nstream runoff volume at a site near Bishop, California, labeled BSAAM.\nDraw the scatterplot matrix for these data and summarize the information\navailable from these plots. (Hint: Use the pairs() function.)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(alr4)\ndata(water)\nstr(water)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t43 obs. of  8 variables:\n $ Year   : int  1948 1949 1950 1951 1952 1953 1954 1955 1956 1957 ...\n $ APMAM  : num  9.13 5.28 4.2 4.6 7.15 9.7 5.02 6.7 10.5 9.1 ...\n $ APSAB  : num  3.58 4.82 3.77 4.46 4.99 5.65 1.45 7.44 5.85 6.13 ...\n $ APSLAKE: num  3.91 5.2 3.67 3.93 4.88 4.91 1.77 6.51 3.38 4.08 ...\n $ OPBPC  : num  4.1 7.55 9.52 11.14 16.34 ...\n $ OPRC   : num  7.43 11.11 12.2 15.15 20.05 ...\n $ OPSLAKE: num  6.47 10.26 11.35 11.13 22.81 ...\n $ BSAAM  : int  54235 67567 66161 68094 107080 67594 65356 67909 92715 70024 ...\n```\n:::\n\n```{.r .cell-code}\nhead(water)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Year APMAM APSAB APSLAKE OPBPC  OPRC OPSLAKE  BSAAM\n1 1948  9.13  3.58    3.91  4.10  7.43    6.47  54235\n2 1949  5.28  4.82    5.20  7.55 11.11   10.26  67567\n3 1950  4.20  3.77    3.67  9.52 12.20   11.35  66161\n4 1951  4.60  4.46    3.93 11.14 15.15   11.13  68094\n5 1952  7.15  4.99    4.88 16.34 20.05   22.81 107080\n6 1953  9.70  5.65    4.91  8.88  8.15    7.41  67594\n```\n:::\n\n```{.r .cell-code}\nwater$Year <-as.factor(water$Year)\nlevels(water$Year)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] \"1948\" \"1949\" \"1950\" \"1951\" \"1952\" \"1953\" \"1954\" \"1955\" \"1956\" \"1957\"\n[11] \"1958\" \"1959\" \"1960\" \"1961\" \"1962\" \"1963\" \"1964\" \"1965\" \"1966\" \"1967\"\n[21] \"1968\" \"1969\" \"1970\" \"1971\" \"1972\" \"1973\" \"1974\" \"1975\" \"1976\" \"1977\"\n[31] \"1978\" \"1979\" \"1980\" \"1981\" \"1982\" \"1983\" \"1984\" \"1985\" \"1986\" \"1987\"\n[41] \"1988\" \"1989\" \"1990\"\n```\n:::\n\n```{.r .cell-code}\npairs(subset (water, select = c(APMAM : BSAAM)))\n```\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\nFrom the scatter plot matrix above I can see that some sources of water\nwell correlated to each other, as their scatter plots are very close to\na straight line. Moreover, there are two groups of water sources that\ndemonstrate being inter-connected. The first group is APMAM, APSAB and\nAPSLAKE. The second group is OPBPC, OPRC, OPLAKE and BSAAM. It is\npossible that the sites within a grouop share a water source or\nseparated from each other (may be by mountains).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(water)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Year APMAM APSAB APSLAKE OPBPC  OPRC OPSLAKE  BSAAM\n1 1948  9.13  3.58    3.91  4.10  7.43    6.47  54235\n2 1949  5.28  4.82    5.20  7.55 11.11   10.26  67567\n3 1950  4.20  3.77    3.67  9.52 12.20   11.35  66161\n4 1951  4.60  4.46    3.93 11.14 15.15   11.13  68094\n5 1952  7.15  4.99    4.88 16.34 20.05   22.81 107080\n6 1953  9.70  5.65    4.91  8.88  8.15    7.41  67594\n```\n:::\n\n```{.r .cell-code}\npairs(subset (water, select = c(APMAM : APSLAKE)))\n```\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nhead(water)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Year APMAM APSAB APSLAKE OPBPC  OPRC OPSLAKE  BSAAM\n1 1948  9.13  3.58    3.91  4.10  7.43    6.47  54235\n2 1949  5.28  4.82    5.20  7.55 11.11   10.26  67567\n3 1950  4.20  3.77    3.67  9.52 12.20   11.35  66161\n4 1951  4.60  4.46    3.93 11.14 15.15   11.13  68094\n5 1952  7.15  4.99    4.88 16.34 20.05   22.81 107080\n6 1953  9.70  5.65    4.91  8.88  8.15    7.41  67594\n```\n:::\n\n```{.r .cell-code}\npairs(subset (water, select = c(OPBPC : BSAAM)))\n```\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n# Question 4\n\nProfessor ratings (Data file: Rateprof in alr4) In the website and\nonline forum RateMyProfessors.com, students rate and comment on their\ninstructors. Launched in 1999, the site includes millions of ratings on\nthousands of instructors. The data file includes the summaries of the\nratings of 364 instructors at a large campus in the Midwest\n(Bleske-Rechek and Fritsch, 2011). Each instructor included in the data\nhad at least 10 ratings over a several year period. Students provided\nratings of 1--5 on quality, helpfulness, clarity, easiness of\ninstructor's courses, and rater Interest in the subject matter covered\nin the instructor's courses. The data file provides the averages of\nthese five ratings. Create a scatter plot matrix of these five\nvariables. Provide a brief description of the relationships between the\nfive ratings.\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(Rateprof)\nstr(Rateprof)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t366 obs. of  17 variables:\n $ gender         : Factor w/ 2 levels \"female\",\"male\": 2 2 2 2 2 2 2 2 2 2 ...\n $ numYears       : int  7 6 10 11 11 10 7 11 11 7 ...\n $ numRaters      : int  11 11 43 24 19 15 17 16 12 18 ...\n $ numCourses     : int  5 5 2 5 7 9 3 3 4 4 ...\n $ pepper         : Factor w/ 2 levels \"no\",\"yes\": 1 1 1 1 1 1 1 1 1 1 ...\n $ discipline     : Factor w/ 4 levels \"Hum\",\"SocSci\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ dept           : Factor w/ 48 levels \"Accounting\",\"Anthropology\",..: 17 42 3 17 45 45 45 17 34 17 ...\n $ quality        : num  4.64 4.32 4.79 4.25 4.68 ...\n $ helpfulness    : num  4.64 4.55 4.72 4.46 4.68 ...\n $ clarity        : num  4.64 4.09 4.86 4.04 4.68 ...\n $ easiness       : num  4.82 4.36 4.6 2.79 4.47 ...\n $ raterInterest  : num  3.55 4 3.43 3.18 4.21 ...\n $ sdQuality      : num  0.552 0.902 0.453 0.933 0.65 ...\n $ sdHelpfulness  : num  0.674 0.934 0.666 0.932 0.82 ...\n $ sdClarity      : num  0.505 0.944 0.413 0.999 0.582 ...\n $ sdEasiness     : num  0.405 0.505 0.541 0.588 0.612 ...\n $ sdRaterInterest: num  1.128 1.074 1.237 1.332 0.975 ...\n```\n:::\n\n```{.r .cell-code}\nhead(Rateprof)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  gender numYears numRaters numCourses pepper discipline              dept\n1   male        7        11          5     no        Hum           English\n2   male        6        11          5     no        Hum Religious Studies\n3   male       10        43          2     no        Hum               Art\n4   male       11        24          5     no        Hum           English\n5   male       11        19          7     no        Hum           Spanish\n6   male       10        15          9     no        Hum           Spanish\n   quality helpfulness  clarity easiness raterInterest sdQuality sdHelpfulness\n1 4.636364    4.636364 4.636364 4.818182      3.545455 0.5518564     0.6741999\n2 4.318182    4.545455 4.090909 4.363636      4.000000 0.9020179     0.9341987\n3 4.790698    4.720930 4.860465 4.604651      3.432432 0.4529343     0.6663898\n4 4.250000    4.458333 4.041667 2.791667      3.181818 0.9325048     0.9315329\n5 4.684211    4.684211 4.684211 4.473684      4.214286 0.6500112     0.8200699\n6 4.233333    4.266667 4.200000 4.533333      3.916667 0.8632717     1.0327956\n  sdClarity sdEasiness sdRaterInterest\n1 0.5045250  0.4045199       1.1281521\n2 0.9438798  0.5045250       1.0744356\n3 0.4129681  0.5407021       1.2369438\n4 0.9990938  0.5882300       1.3322506\n5 0.5823927  0.6117753       0.9749613\n6 0.7745967  0.6399405       0.6685579\n```\n:::\n\n```{.r .cell-code}\npairs(subset (Rateprof, select =c(quality : raterInterest)))\n```\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\nAs we can see from the scatter plot above, three variables are clearly\nhighly correlated: quality, helpfulness and clarity. Particularly,\nquality highly correlated with both helpfulness and clarity. I suspect,\nthese variables might create multicollinearity problem if used together\nin multiple regression model.\n\nConnection between clarity and helpfulness is also very distinct, but\nthe variability seems bigger.\n\nEasiness variable appears positively correlated with the first three\n(quality, helpfulness and clarity), however there is much higher\nvariability.\n\nRater's interest appears less connected with the other variables, and\nmight demonstrate a smaller slope of a regression line when calculated.\n\n------------------------------------------------------------------------\n\n# Question 5\n\nFor the student.survey data file in the smss package, conduct regression\nanalyses relating (by convention, y denotes the outcome variable, x\ndenotes the explanatory variable)\n\n\\(i\\) y = political ideology and x = religiosity,\n\n\\(ii\\) y = high school GPA and x = hours of TV watching. (You can use\n?student.survey in the R console, after loading the package, to see what\neach variable means.)\n\n\\(a\\) Graphically portray how the explanatory variable relates to the\noutcome variable in each of the two cases\n\n\\(b\\) Summarize and interpret results of inferential analyses.\n\n#### i. y = political ideology and x = religiosity\n\nBy using ?student.survey function, I found out that : Political ideology\nis stored as `PI` variable, Religiosity doesn't have its own variable,\nbut can be represented as \"how often you attend religious services\" from\nthis data set, variable `RE`\n\nTherefore , my model can be presented as\n\n$$\nPI =\\beta_o +\\beta_1*RE\n$$\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(student.survey)\n?student.survey\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nstarting httpd help server ... done\n```\n:::\n\n```{.r .cell-code}\nstr(student.survey)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n'data.frame':\t60 obs. of  18 variables:\n $ subj: int  1 2 3 4 5 6 7 8 9 10 ...\n $ ge  : Factor w/ 2 levels \"f\",\"m\": 2 1 1 1 2 2 2 1 2 2 ...\n $ ag  : int  32 23 27 35 23 39 24 31 34 28 ...\n $ hi  : num  2.2 2.1 3.3 3.5 3.1 3.5 3.6 3 3 4 ...\n $ co  : num  3.5 3.5 3 3.2 3.5 3.5 3.7 3 3 3.1 ...\n $ dh  : int  0 1200 1300 1500 1600 350 0 5000 5000 900 ...\n $ dr  : num  5 0.3 1.5 8 10 3 0.2 1.5 2 2 ...\n $ tv  : num  3 15 0 5 6 4 5 5 7 1 ...\n $ sp  : int  5 7 4 5 6 5 12 3 5 1 ...\n $ ne  : int  0 5 3 6 3 7 4 3 3 2 ...\n $ ah  : int  0 6 0 3 0 0 2 1 0 1 ...\n $ ve  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...\n $ pa  : Factor w/ 3 levels \"d\",\"i\",\"r\": 3 1 1 2 2 1 2 2 2 2 ...\n $ pi  : Ord.factor w/ 7 levels \"very liberal\"<..: 6 2 2 4 1 2 2 2 1 3 ...\n $ re  : Ord.factor w/ 4 levels \"never\"<\"occasionally\"<..: 3 2 3 2 1 2 2 2 2 1 ...\n $ ab  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...\n $ aa  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...\n $ ld  : logi  FALSE NA NA FALSE FALSE NA ...\n```\n:::\n\n```{.r .cell-code}\n# head(student.survey)\nclass(student.survey$pi)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ordered\" \"factor\" \n```\n:::\n\n```{.r .cell-code}\nlevels(student.survey$pi)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"very liberal\"          \"liberal\"               \"slightly liberal\"     \n[4] \"moderate\"              \"slightly conservative\" \"conservative\"         \n[7] \"very conservative\"    \n```\n:::\n\n```{.r .cell-code}\nclass(student.survey$re)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"ordered\" \"factor\" \n```\n:::\n:::\n\n\nWe can see that both variables are ordered factor variables. We will\nneed to convert factor variables into the numeric variables for\nregression, and then use them in linear model:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nstudent.survey$pi <-as.numeric (student.survey$pi)\nstudent.survey$re <-as.numeric (student.survey$re)\nsummary(lm(pi~re, data=student.survey))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = pi ~ re, data = student.survey)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.81243 -0.87160  0.09882  1.12840  3.09882 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   0.9308     0.4252   2.189   0.0327 *  \nre            0.9704     0.1792   5.416 1.22e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.345 on 58 degrees of freedom\nMultiple R-squared:  0.3359,\tAdjusted R-squared:  0.3244 \nF-statistic: 29.34 on 1 and 58 DF,  p-value: 1.221e-06\n```\n:::\n\n```{.r .cell-code}\nggplot(data = student.survey, aes(x = re, y = pi)) +\n  geom_point() +\n  geom_smooth(method = 'lm', se=F)+\n  labs(title=\"Political ideology and religiosity\", x=\"Frequency of going to church\", y = \"level of consrvatism\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\nBased on the summary above, we can see that religiosity and political\nideology are positively related, but the religiosity only contributes\nabout 30 % of political ideology (R\\^2 =0.34). Overal w can say that\nhigher level of conservatism can be somewhat (30%) predicted by\nfrequency of church attendance.\n\n#### ii. y = high school GPA and x = hours of TV watching\n\nHigh school GPA is presented as HI variable, and hours of TV watching -\nby TV variable.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nclass(student.survey$hi)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"numeric\"\n```\n:::\n\n```{.r .cell-code}\nclass(student.survey$tv)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"numeric\"\n```\n:::\n:::\n\n\nBoth variables are numeric, which allows us to run a simple linear\nregression:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(lm(data=student.survey, hi ~tv))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = hi ~ tv, data = student.survey)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.2583 -0.2456  0.0417  0.3368  0.7051 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.441353   0.085345  40.323   <2e-16 ***\ntv          -0.018305   0.008658  -2.114   0.0388 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4467 on 58 degrees of freedom\nMultiple R-squared:  0.07156,\tAdjusted R-squared:  0.05555 \nF-statistic: 4.471 on 1 and 58 DF,  p-value: 0.03879\n```\n:::\n:::\n\n\nWe can see that the the slope of Independent variable (tv) is very small\nand negative. It's statistical significance is also very low and depends\non alpha level that we select. R squared, which indicates the proportion\nof the variance that can be explained by x (tv watching time), is very\nlow (0.072). Taking this into account, I conclude there is no\ncontribution of TV watching to GPA level.\n\nTo visualize these relationship, we can build a scatter plot and a\nfitted linear line:\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot (data=student.survey, mapping=aes(x=tv, y=hi))+\n  geom_point()+\n  stat_smooth(method = \"lm\", se = T)+\n  labs(title=\"Sctterplot between hours of TV watching and high school GPA\", y=\"High school GPA\", x=\"hours of TV watching\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n:::\n\n\nFrom the graph above we can see, that the standard error band is getting\nwider towards the right side of the chart, due to low amount of\nobservations in that part of the sample. It also adds uncertainty to a\nconclusion and calls for more data and further investigation. Since the\noverall slope does go down, I would suggest that there may be another\nfactor that contributes to the relationship between TV watching and GPA.\n\n------------------------------------------------------------------------\n",
    "supporting": [
      "HW_3_Diana_Rinker_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}