{
  "hash": "8c04908b890d5bd03e828fb933074fd2",
  "result": {
    "markdown": "---\ntitle: \"Homework 3\"\nauthor: \"Guanhua Tan\"\ndescription: \"Homework 3\"\ndate: \"04/01/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw3\n  - regression analysis\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0      ✔ purrr   0.3.5 \n✔ tibble  3.1.8      ✔ dplyr   1.0.10\n✔ tidyr   1.2.1      ✔ stringr 1.4.1 \n✔ readr   2.1.3      ✔ forcats 0.5.2 \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n```\n:::\n\n```{.r .cell-code}\nlibrary(smss)\nlibrary(alr4)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: car\nLoading required package: carData\n\nAttaching package: 'car'\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\nThe following object is masked from 'package:purrr':\n\n    some\n\nLoading required package: effects\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n```\n:::\n\n```{.r .cell-code}\ndata(UN11)\n```\n:::\n\n\n# Question 1\n\n::: {.cell}\n\n```{.r .cell-code}\nglimpse(UN11)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 199\nColumns: 6\n$ region    <fct> Asia, Europe, Africa, Africa, Caribbean, Latin Amer, Asia, C…\n$ group     <fct> other, other, africa, africa, other, other, other, other, oe…\n$ fertility <dbl> 5.968, 1.525, 2.142, 5.135, 2.000, 2.172, 1.735, 1.671, 1.94…\n$ ppgdp     <dbl> 499.0, 3677.2, 4473.0, 4321.9, 13750.1, 9162.1, 3030.7, 2285…\n$ lifeExpF  <dbl> 49.49, 80.40, 75.00, 53.17, 81.10, 79.89, 77.33, 77.75, 84.2…\n$ pctUrban  <dbl> 23, 53, 67, 59, 100, 93, 64, 47, 89, 68, 52, 84, 89, 29, 45,…\n```\n:::\n\n```{.r .cell-code}\nsummary(UN11)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n        region      group       fertility         ppgdp         \n Africa    :53   oecd  : 31   Min.   :1.134   Min.   :   114.8  \n Asia      :50   other :115   1st Qu.:1.754   1st Qu.:  1283.0  \n Europe    :39   africa: 53   Median :2.262   Median :  4684.5  \n Latin Amer:20                Mean   :2.761   Mean   : 13012.0  \n Caribbean :17                3rd Qu.:3.545   3rd Qu.: 15520.5  \n Oceania   :17                Max.   :6.925   Max.   :105095.4  \n (Other)   : 3                                                  \n    lifeExpF        pctUrban     \n Min.   :48.11   Min.   : 11.00  \n 1st Qu.:65.66   1st Qu.: 39.00  \n Median :75.89   Median : 59.00  \n Mean   :72.29   Mean   : 57.93  \n 3rd Qu.:79.58   3rd Qu.: 75.00  \n Max.   :87.12   Max.   :100.00  \n                                 \n```\n:::\n:::\n\n(1) the variable ppgdp is the predictor and the variable fertility is the response.\n\n(2)\n\n::: {.cell}\n\n```{.r .cell-code}\n# scatterplot\nggplot(UN11, aes(x=ppgdp, y=fertility))+\n  geom_point()+\n  geom_smooth(method = 'lm')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_Guanhua_Tan_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\nWhen ppgdp is lower than 25000, fertility surges. when ppgdp is greater than 25000, fertility maintains stable. I don't believe a stright-line mean function would be plausible for a summary of this graph.\n\n(3)\n\n::: {.cell}\n\n```{.r .cell-code}\n# scatterplot log(data)\nggplot(UN11, aes(x=log(ppgdp), y=fertility))+\n  geom_point()+\n  geom_smooth(method = 'lm')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_Guanhua_Tan_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nYes, the simple line regression model seem plausible for a summary of this graphic.\n\n# Question 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(UN11, aes(x=log(ppgdp), y=fertility))+\n  geom_point()+\n  geom_smooth(method=\"lm\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_Guanhua_Tan_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncor(UN11$ppgdp,UN11$fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] -0.4399891\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nUN11$income.pound=UN11$ppgdp*1.33\nggplot(UN11, aes(x=log(income.pound), y=fertility))+\n  geom_point()+\n  geom_smooth(method = 'lm')\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_Guanhua_Tan_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\ncor.test(UN11$income.pound, UN11$fertility)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  UN11$income.pound and UN11$fertility\nt = -6.877, df = 197, p-value = 7.903e-11\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.5456842 -0.3205140\nsample estimates:\n       cor \n-0.4399891 \n```\n:::\n:::\n\n(a) the slopes of the prediction equation maintain the same.\n\n(b) the correlation doesn't change.\n\n# Question 3\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"water\")\nsummary(water)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      Year          APMAM            APSAB           APSLAKE     \n Min.   :1948   Min.   : 2.700   Min.   : 1.450   Min.   : 1.77  \n 1st Qu.:1958   1st Qu.: 4.975   1st Qu.: 3.390   1st Qu.: 3.36  \n Median :1969   Median : 7.080   Median : 4.460   Median : 4.62  \n Mean   :1969   Mean   : 7.323   Mean   : 4.652   Mean   : 4.93  \n 3rd Qu.:1980   3rd Qu.: 9.115   3rd Qu.: 5.685   3rd Qu.: 5.83  \n Max.   :1990   Max.   :18.080   Max.   :11.960   Max.   :13.02  \n     OPBPC             OPRC           OPSLAKE           BSAAM       \n Min.   : 4.050   Min.   : 4.350   Min.   : 4.600   Min.   : 41785  \n 1st Qu.: 7.975   1st Qu.: 7.875   1st Qu.: 8.705   1st Qu.: 59857  \n Median : 9.550   Median :11.110   Median :12.140   Median : 69177  \n Mean   :12.836   Mean   :12.002   Mean   :13.522   Mean   : 77756  \n 3rd Qu.:16.545   3rd Qu.:14.975   3rd Qu.:16.920   3rd Qu.: 92206  \n Max.   :43.370   Max.   :24.850   Max.   :33.070   Max.   :146345  \n```\n:::\n\n```{.r .cell-code}\npairs(~APMAM+APSAB+APSLAKE+OPBPC+OPRC+OPSLAKE+BSAAM, data=water)\n```\n\n::: {.cell-output-display}\n![](HW3_Guanhua_Tan_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\nThe sctterplot martrix clearly demonstrates that there are positive correlations between any two sites.\n\n\n# Question 4\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"Rateprof\")\nsummary(Rateprof)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    gender       numYears        numRaters       numCourses     pepper   \n female:159   Min.   : 1.000   Min.   :10.00   Min.   : 1.000   no :320  \n male  :207   1st Qu.: 6.000   1st Qu.:15.00   1st Qu.: 3.000   yes: 46  \n              Median :10.000   Median :24.00   Median : 4.000            \n              Mean   : 8.347   Mean   :28.58   Mean   : 4.251            \n              3rd Qu.:11.000   3rd Qu.:37.00   3rd Qu.: 5.000            \n              Max.   :11.000   Max.   :86.00   Max.   :12.000            \n                                                                         \n    discipline          dept        quality       helpfulness   \n Hum     :134   English   : 49   Min.   :1.409   Min.   :1.364  \n SocSci  : 66   Math      : 34   1st Qu.:2.936   1st Qu.:3.069  \n STEM    :103   Biology   : 20   Median :3.612   Median :3.662  \n Pre-prof: 63   Chemistry : 20   Mean   :3.575   Mean   :3.631  \n                Psychology: 20   3rd Qu.:4.250   3rd Qu.:4.351  \n                Spanish   : 20   Max.   :4.981   Max.   :5.000  \n                (Other)   :203                                  \n    clarity         easiness     raterInterest     sdQuality      \n Min.   :1.333   Min.   :1.391   Min.   :1.098   Min.   :0.09623  \n 1st Qu.:2.871   1st Qu.:2.548   1st Qu.:2.934   1st Qu.:0.87508  \n Median :3.600   Median :3.148   Median :3.305   Median :1.15037  \n Mean   :3.525   Mean   :3.135   Mean   :3.310   Mean   :1.05610  \n 3rd Qu.:4.214   3rd Qu.:3.692   3rd Qu.:3.692   3rd Qu.:1.28730  \n Max.   :5.000   Max.   :4.900   Max.   :4.909   Max.   :1.67739  \n                                                                  \n sdHelpfulness      sdClarity        sdEasiness     sdRaterInterest \n Min.   :0.0000   Min.   :0.0000   Min.   :0.3162   Min.   :0.3015  \n 1st Qu.:0.9902   1st Qu.:0.9085   1st Qu.:0.9045   1st Qu.:1.0848  \n Median :1.2860   Median :1.1712   Median :1.0247   Median :1.2167  \n Mean   :1.1719   Mean   :1.0970   Mean   :1.0196   Mean   :1.1965  \n 3rd Qu.:1.4365   3rd Qu.:1.3328   3rd Qu.:1.1485   3rd Qu.:1.3326  \n Max.   :1.8091   Max.   :1.8091   Max.   :1.6293   Max.   :1.7246  \n                                                                    \n```\n:::\n\n```{.r .cell-code}\npairs(~quality+helpfulness+clarity+easiness+raterInterest, data=Rateprof)\n```\n\n::: {.cell-output-display}\n![](HW3_Guanhua_Tan_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\nThe sccatterplot matrix suggests that there are positive correlations between quality and helpfulness, helpfulness and clarity, quality and clarity. It also indicates that there is no strong correlation between the rest of them.\n\n\n\n# Question 5\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"student.survey\")\nsummary(student.survey)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      subj       ge           ag              hi              co       \n Min.   : 1.00   f:31   Min.   :22.00   Min.   :2.000   Min.   :2.600  \n 1st Qu.:15.75   m:29   1st Qu.:24.00   1st Qu.:3.000   1st Qu.:3.175  \n Median :30.50          Median :26.50   Median :3.350   Median :3.500  \n Mean   :30.50          Mean   :29.17   Mean   :3.308   Mean   :3.453  \n 3rd Qu.:45.25          3rd Qu.:31.00   3rd Qu.:3.625   3rd Qu.:3.725  \n Max.   :60.00          Max.   :71.00   Max.   :4.000   Max.   :4.000  \n                                                                       \n       dh             dr               tv               sp        \n Min.   :   0   Min.   : 0.200   Min.   : 0.000   Min.   : 0.000  \n 1st Qu.: 205   1st Qu.: 1.450   1st Qu.: 3.000   1st Qu.: 3.000  \n Median : 640   Median : 2.000   Median : 6.000   Median : 5.000  \n Mean   :1232   Mean   : 3.818   Mean   : 7.267   Mean   : 5.483  \n 3rd Qu.:1350   3rd Qu.: 5.000   3rd Qu.:10.000   3rd Qu.: 7.000  \n Max.   :8000   Max.   :20.000   Max.   :37.000   Max.   :16.000  \n                                                                  \n       ne               ah             ve          pa    \n Min.   : 0.000   Min.   : 0.000   Mode :logical   d:21  \n 1st Qu.: 2.000   1st Qu.: 0.000   FALSE:60        i:24  \n Median : 3.000   Median : 0.500                   r:15  \n Mean   : 4.083   Mean   : 1.433                         \n 3rd Qu.: 5.250   3rd Qu.: 2.000                         \n Max.   :14.000   Max.   :11.000                         \n                                                         \n                     pi                re         ab              aa         \n very liberal         : 8   never       :15   Mode :logical   Mode :logical  \n liberal              :24   occasionally:29   FALSE:60        FALSE:59       \n slightly liberal     : 6   most weeks  : 7                   NA's :1        \n moderate             :10   every week  : 9                                  \n slightly conservative: 6                                                    \n conservative         : 4                                                    \n very conservative    : 2                                                    \n     ld         \n Mode :logical  \n FALSE:44       \n NA's :16       \n                \n                \n                \n                \n```\n:::\n\n```{.r .cell-code}\n# (i)\nlm_ideology_religiosity <-lm(as.numeric(pi)~as.numeric(re), data=student.survey)\nsummary(lm_ideology_religiosity)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = as.numeric(pi) ~ as.numeric(re), data = student.survey)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-2.81243 -0.87160  0.09882  1.12840  3.09882 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)      0.9308     0.4252   2.189   0.0327 *  \nas.numeric(re)   0.9704     0.1792   5.416 1.22e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.345 on 58 degrees of freedom\nMultiple R-squared:  0.3359,\tAdjusted R-squared:  0.3244 \nF-statistic: 29.34 on 1 and 58 DF,  p-value: 1.221e-06\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ii\nlm_hi_tv <- lm(hi~tv, data=student.survey)\nsummary(lm_hi_tv)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = hi ~ tv, data = student.survey)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-1.2583 -0.2456  0.0417  0.3368  0.7051 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  3.441353   0.085345  40.323   <2e-16 ***\ntv          -0.018305   0.008658  -2.114   0.0388 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4467 on 58 degrees of freedom\nMultiple R-squared:  0.07156,\tAdjusted R-squared:  0.05555 \nF-statistic: 4.471 on 1 and 58 DF,  p-value: 0.03879\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(student.survey, aes(x=re, fill=pi))+\n  geom_bar(position=\"fill\")\n```\n\n::: {.cell-output-display}\n![](HW3_Guanhua_Tan_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(student.survey, aes(x=tv, y=log(hi)))+\n   geom_smooth(method=\"lm\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\n`geom_smooth()` using formula = 'y ~ x'\n```\n:::\n\n::: {.cell-output-display}\n![](HW3_Guanhua_Tan_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n:::\n\nFor the first regression analysis, the people who are very conservative come to church every week. By contrast, the people who are liberal or very liberal come to church rarely. It indicates the close relationship between political ideology and religion.\n\nFor the second regression analysis, the graphic demonstrates that students who spent more time watching TV achieve lower gpa. In other words, there is a negative association between gpa and hours of watching TV.\n\n",
    "supporting": [
      "HW3_Guanhua_Tan_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}