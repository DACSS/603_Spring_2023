{
  "hash": "10f425bd35b9ce6321df6e06ccd3247b",
  "result": {
    "markdown": "---\ntitle: \"Kristin Abijaoude_HW5\"\neditor: visual\ndate: \"05/09/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - Hw5\n  - kristin abijaoude\n---\n\n::: {.cell}\n\n```{.r .cell-code}\n# load packages\npackages <- c(\"readr\", \"readxl\", \"summarytools\", \"tidyverse\", \"dplyr\", \"smss\", \"alr4\", \"stargazer\", \"broom\", \"qpcR\")\nlapply(packages, require, character.only = TRUE)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: readr\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: readxl\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: summarytools\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nLoading required package: tidyverse\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──\n✔ ggplot2 3.4.0     ✔ dplyr   1.1.0\n✔ tibble  3.1.8     ✔ stringr 1.5.0\n✔ tidyr   1.3.0     ✔ forcats 0.5.2\n✔ purrr   1.0.1     \n── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──\n✖ dplyr::filter() masks stats::filter()\n✖ dplyr::lag()    masks stats::lag()\n✖ tibble::view()  masks summarytools::view()\nLoading required package: smss\n\nLoading required package: alr4\n\nLoading required package: car\n\nLoading required package: carData\n\n\nAttaching package: 'car'\n\n\nThe following object is masked from 'package:dplyr':\n\n    recode\n\n\nThe following object is masked from 'package:purrr':\n\n    some\n\n\nLoading required package: effects\n\nlattice theme set by effectsTheme()\nSee ?effectsTheme for details.\n\nLoading required package: stargazer\n\n\nPlease cite as: \n\n\n Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.\n\n R package version 5.2.3. https://CRAN.R-project.org/package=stargazer \n\n\nLoading required package: broom\n\nLoading required package: qpcR\n\nLoading required package: MASS\n\n\nAttaching package: 'MASS'\n\n\nThe following object is masked from 'package:dplyr':\n\n    select\n\n\nLoading required package: minpack.lm\n\nLoading required package: rgl\n\nLoading required package: robustbase\n\n\nAttaching package: 'robustbase'\n\n\nThe following object is masked from 'package:alr4':\n\n    cloud\n\n\nLoading required package: Matrix\n\n\nAttaching package: 'Matrix'\n\n\nThe following objects are masked from 'package:tidyr':\n\n    expand, pack, unpack\n```\n:::\n\n::: {.cell-output .cell-output-stdout}\n```\n[[1]]\n[1] TRUE\n\n[[2]]\n[1] TRUE\n\n[[3]]\n[1] TRUE\n\n[[4]]\n[1] TRUE\n\n[[5]]\n[1] TRUE\n\n[[6]]\n[1] TRUE\n\n[[7]]\n[1] TRUE\n\n[[8]]\n[1] TRUE\n\n[[9]]\n[1] TRUE\n\n[[10]]\n[1] TRUE\n```\n:::\n\n```{.r .cell-code}\nknitr::opts_chunk$set(echo = TRUE)\n```\n:::\n\n\n# Question 1\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(house.selling.price.2)\nhouse.selling.price.2\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n       P    S Be Ba New\n1   48.5 1.10  3  1   0\n2   55.0 1.01  3  2   0\n3   68.0 1.45  3  2   0\n4  137.0 2.40  3  3   0\n5  309.4 3.30  4  3   1\n6   17.5 0.40  1  1   0\n7   19.6 1.28  3  1   0\n8   24.5 0.74  3  1   0\n9   34.8 0.78  2  1   0\n10  32.0 0.97  3  1   0\n11  28.0 0.84  3  1   0\n12  49.9 1.08  2  2   0\n13  59.9 0.99  2  1   0\n14  61.5 1.01  3  2   0\n15  60.0 1.34  3  2   0\n16  65.9 1.22  3  1   0\n17  67.9 1.28  3  2   0\n18  68.9 1.29  3  2   0\n19  69.9 1.52  3  2   0\n20  70.5 1.25  3  2   0\n21  72.9 1.28  3  2   0\n22  72.5 1.28  3  1   0\n23  72.0 1.36  3  2   0\n24  71.0 1.20  3  2   0\n25  76.0 1.46  3  2   0\n26  72.9 1.56  4  2   0\n27  73.0 1.22  3  2   0\n28  70.0 1.40  2  2   0\n29  76.0 1.15  2  2   0\n30  69.0 1.74  3  2   0\n31  75.5 1.62  3  2   0\n32  76.0 1.66  3  2   0\n33  81.8 1.33  3  2   0\n34  84.5 1.34  3  2   0\n35  83.5 1.40  3  2   0\n36  86.0 1.15  2  2   1\n37  86.9 1.58  3  2   1\n38  86.9 1.58  3  2   1\n39  86.9 1.58  3  2   1\n40  87.9 1.71  3  2   0\n41  88.1 2.10  3  2   0\n42  85.9 1.27  3  2   0\n43  89.5 1.34  3  2   0\n44  87.4 1.25  3  2   0\n45  87.9 1.68  3  2   0\n46  88.0 1.55  3  2   0\n47  90.0 1.55  3  2   0\n48  96.0 1.36  3  2   1\n49  99.9 1.51  3  2   1\n50  95.5 1.54  3  2   1\n51  98.5 1.51  3  2   0\n52 100.1 1.85  3  2   0\n53  99.9 1.62  4  2   1\n54 101.9 1.40  3  2   1\n55 101.9 1.92  4  2   0\n56 102.3 1.42  3  2   1\n57 110.8 1.56  3  2   1\n58 105.0 1.43  3  2   1\n59  97.9 2.00  3  2   0\n60 106.3 1.45  3  2   1\n61 106.5 1.65  3  2   0\n62 116.0 1.72  4  2   1\n63 108.0 1.79  4  2   1\n64 107.5 1.85  3  2   0\n65 109.9 2.06  4  2   1\n66 110.0 1.76  4  2   0\n67 120.0 1.62  3  2   1\n68 115.0 1.80  4  2   1\n69 113.4 1.98  3  2   0\n70 114.9 1.57  3  2   0\n71 115.0 2.19  3  2   0\n72 115.0 2.07  4  2   0\n73 117.9 1.99  4  2   0\n74 110.0 1.55  3  2   0\n75 115.0 1.67  3  2   0\n76 124.0 2.40  4  2   0\n77 129.9 1.79  4  2   1\n78 124.0 1.89  3  2   0\n79 128.0 1.88  3  2   1\n80 132.4 2.00  4  2   1\n81 139.3 2.05  4  2   1\n82 139.3 2.00  4  2   1\n83 139.7 2.03  3  2   1\n84 142.0 2.12  3  3   0\n85 141.3 2.08  4  2   1\n86 147.5 2.19  4  2   0\n87 142.5 2.40  4  2   0\n88 148.0 2.40  5  2   0\n89 149.0 3.05  4  2   0\n90 150.0 2.04  3  3   0\n91 172.9 2.25  4  2   1\n92 190.0 2.57  4  3   1\n93 280.0 3.85  4  3   0\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlm(P ~ ., data = house.selling.price.2) |> summary()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = P ~ ., data = house.selling.price.2)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-36.212  -9.546   1.277   9.406  71.953 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -41.795     12.104  -3.453 0.000855 ***\nS             64.761      5.630  11.504  < 2e-16 ***\nBe            -2.766      3.960  -0.698 0.486763    \nBa            19.203      5.650   3.399 0.001019 ** \nNew           18.984      3.873   4.902  4.3e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 16.36 on 88 degrees of freedom\nMultiple R-squared:  0.8689,\tAdjusted R-squared:  0.8629 \nF-statistic: 145.8 on 4 and 88 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n## A\n\nVariable `Be` would be eliminated first using the backwards elimination because it has the largest p-value.\n\n## B\n\nVariable `S` would be added first using the forward selection because it has the smallest p-value.\n\n## C\n\n`Beds` has a high p-value despite a substantial correlation with `price` because of multicollinearity between `New` and `Size` as they have way smaller p-values and are statistically significant.\n\n## D\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm1 <- lm(P ~ ., data = house.selling.price.2)\nlm2 <- lm(P ~ S, Be, Ba, data = house.selling.price.2)\nlm3 <- lm(P ~ S, Be, data = house.selling.price.2)\nlm4 <- lm(P ~ S, data = house.selling.price.2)\n\nstargazer(lm1, lm2, lm3, lm4, type = \"text\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n===================================================================================================================\n                                                          Dependent variable:                                      \n                    -----------------------------------------------------------------------------------------------\n                                                                   P                                               \n                              (1)                     (2)                     (3)                     (4)          \n-------------------------------------------------------------------------------------------------------------------\nS                          64.761***               78.472***               77.207***               75.607***       \n                            (5.630)                 (2.672)                 (2.583)                 (3.865)        \n                                                                                                                   \nBe                          -2.766                                                                                 \n                            (3.960)                                                                                \n                                                                                                                   \nBa                         19.203***                                                                               \n                            (5.650)                                                                                \n                                                                                                                   \nNew                        18.984***                                                                               \n                            (3.873)                                                                                \n                                                                                                                   \nConstant                  -41.795***              -44.960***              -42.531***              -25.194***       \n                           (12.104)                 (4.904)                 (4.490)                 (6.688)        \n                                                                                                                   \n-------------------------------------------------------------------------------------------------------------------\nObservations                  93                      93                      93                      93           \nR2                           0.869                   0.905                   0.908                   0.808         \nAdjusted R2                  0.863                   0.904                   0.907                   0.806         \nResidual Std. Error    16.360 (df = 88)        19.719 (df = 91)        11.794 (df = 91)        19.473 (df = 91)    \nF Statistic         145.763*** (df = 4; 88) 862.682*** (df = 1; 91) 893.585*** (df = 1; 91) 382.628*** (df = 1; 91)\n===================================================================================================================\nNote:                                                                                   *p<0.1; **p<0.05; ***p<0.01\n```\n:::\n:::\n\n\nThe R^2 and Adjusted R^2 can be found with this chart above.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# create press model\nPRESS <- function(model) {\n    i <- residuals(model)/(1 - lm.influence(model)$hat)\n    sum(i^2)\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#lm1 PRESS\nPRESS(lm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 28390.22\n```\n:::\n\n```{.r .cell-code}\n#lm1 AIC\nAIC(lm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 790.6225\n```\n:::\n\n```{.r .cell-code}\n#lm1 BIC\nBIC(lm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 805.8181\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#lm2 PRESS\nPRESS(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 16270.99\n```\n:::\n\n```{.r .cell-code}\n#lm2 AIC\nAIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 748.9785\n```\n:::\n\n```{.r .cell-code}\n#lm2 BIC\nBIC(lm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 756.5763\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#lm3 PRESS\nPRESS(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 16131.45\n```\n:::\n\n```{.r .cell-code}\n#lm3 AIC\nAIC(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 726.8739\n```\n:::\n\n```{.r .cell-code}\n#lm3 BIC\nBIC(lm3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 734.4717\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n#lm4 PRESS\nPRESS(lm4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 38203.29\n```\n:::\n\n```{.r .cell-code}\n#lm4 AIC\nAIC(lm4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 820.1439\n```\n:::\n\n```{.r .cell-code}\n#lm4 BIC\nBIC(lm4)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 827.7417\n```\n:::\n:::\n\n\n## E\n\nBased on the criterion `PRESS`, `R^2`, `Adjusted R^2`, `AIC`, and `BIC`, we will go with Model 3 `lm3` since it has the highest R^2 and the lowest PRESS, AIC, and BIC values.\n\n# Question 2\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(trees)\nhead(trees)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Girth Height Volume\n1   8.3     70   10.3\n2   8.6     65   10.3\n3   8.8     63   10.2\n4  10.5     72   16.4\n5  10.7     81   18.8\n6  10.8     83   19.7\n```\n:::\n:::\n\n## A\n\n\n::: {.cell}\n\n```{.r .cell-code}\ntree_reg <- lm(Volume ~ Girth + Height, data = trees)\nsummary(tree_reg)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Volume ~ Girth + Height, data = trees)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-6.4065 -2.6493 -0.2876  2.2003  8.4847 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) -57.9877     8.6382  -6.713 2.75e-07 ***\nGirth         4.7082     0.2643  17.816  < 2e-16 ***\nHeight        0.3393     0.1302   2.607   0.0145 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.882 on 28 degrees of freedom\nMultiple R-squared:  0.948,\tAdjusted R-squared:  0.9442 \nF-statistic:   255 on 2 and 28 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n## B\n\nThere is a violation of nonlinearity since the regression line is not straight or linear.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(tree_reg)\n```\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-12-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-12-4.png){width=672}\n:::\n:::\n\n# Question 3\n\n## A\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(florida)\nhead(florida)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n           Gore   Bush Buchanan\nALACHUA   47300  34062      262\nBAKER      2392   5610       73\nBAY       18850  38637      248\nBRADFORD   3072   5413       65\nBREVARD   97318 115185      570\nBROWARD  386518 177279      789\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\ngore <- lm(Buchanan ~ Gore, data=florida)\nplot(gore)\n```\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-14-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-14-4.png){width=672}\n:::\n:::\n\nFrom the graph, Palm Beach is an outlier because Buchanan received the most votes from that county.\n\n## B\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngore_log <- lm(log(Buchanan) ~ log(Gore), data=florida)\nplot(gore_log)\n```\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-15-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-15-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](Kristin_Abijaoude_HW5_files/figure-html/unnamed-chunk-15-4.png){width=672}\n:::\n:::\n\nEven when accounting for the log() function, nothing fundamentally changes when it comes to outliers.\n",
    "supporting": [
      "Kristin_Abijaoude_HW5_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}