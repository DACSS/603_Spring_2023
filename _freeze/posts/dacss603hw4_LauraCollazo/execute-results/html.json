{
  "hash": "65e8bf732e517232bcae52b151c0b279",
  "result": {
    "markdown": "---\ntitle: \"DACSS 603 Homework 4\"\nauthor: \"Laura Collazo\"\ndescription: \"Homework 4 for DACSS 603\"\ndate: \"04/18/2023\"\nformat:\n  html:\n    toc: true\n    code-fold: true\n    code-copy: true\n    code-tools: true\ncategories:\n  - hw4\n  - regression\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(alr4)\n```\n:::\n\n\n# Question 1\n\n## a\n\n\n::: {.cell}\n\n:::\n\n\n## b\n\n\n::: {.cell}\n\n:::\n\n\n## c\n\n\n::: {.cell}\n\n:::\n\n\n# Question 2 \n\nThis question uses the \"salary\" data from the alr4 package to examine salary and characteristics of faculty in the early 1980s at a small Mid-West college. \n\n\n::: {.cell}\n\n```{.r .cell-code}\ndata(\"salary\")\n\ntail(salary)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n    degree rank    sex year ysdeg salary\n47 Masters Asst Female    2     6  16150\n48 Masters Asst Female    2     2  15350\n49 Masters Asst   Male    1     1  16244\n50 Masters Asst Female    1     1  16686\n51 Masters Asst Female    1     1  15000\n52 Masters Asst Female    0     2  20300\n```\n:::\n:::\n\n\n## a\n\nThe below tests the hypothesis that mean salary for men and women is the same.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_2a <- summary(lm(salary ~ sex, data = salary))\n\nfit_2a\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8602.8 -4296.6  -100.8  3513.1 16687.9 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    24697        938  26.330   <2e-16 ***\nsexFemale      -3340       1808  -1.847   0.0706 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 5782 on 50 degrees of freedom\nMultiple R-squared:  0.0639,\tAdjusted R-squared:  0.04518 \nF-statistic: 3.413 on 1 and 50 DF,  p-value: 0.0706\n```\n:::\n:::\n\nThis model does not allow the null hypothesis to be rejected as the p-value is not less than 0.05. The adjusted R-squared is also low and indicates this model explains only 4.52% of the variation between `salary` and `sex`. This model also shows that being female results in being paid $3,340 less than male faculty for every additional $1 males earn.\n\n## b\n\nThe below model adds in `degree`, `rank`, `year`, and `ysdeg` as additional predictors to the regression model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_2b <- summary(lm(salary ~ sex + degree + rank + year + ysdeg, data = salary))\n\nfit_2b\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + rank + year + ysdeg, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4045.2 -1094.7  -361.5   813.2  9193.1 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 15746.05     800.18  19.678  < 2e-16 ***\nsexFemale    1166.37     925.57   1.260    0.214    \ndegreePhD    1388.61    1018.75   1.363    0.180    \nrankAssoc    5292.36    1145.40   4.621 3.22e-05 ***\nrankProf    11118.76    1351.77   8.225 1.62e-10 ***\nyear          476.31      94.91   5.018 8.65e-06 ***\nysdeg        -124.57      77.49  -1.608    0.115    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2398 on 45 degrees of freedom\nMultiple R-squared:  0.855,\tAdjusted R-squared:  0.8357 \nF-statistic: 44.24 on 6 and 45 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n## c\n\nThis section interprets the findings for each predictor variable in the above model.\n\n### sex \n\nThe variable `sex` is not statistically significant in this model. It indicates that when all predictors are held constant, a $1 increase in salary for males results in a $1,166.37 increase for females.\n\n### degree\n\nThe variable `degree` is not statistically significant in this model. It indicates that when all predictors are held constant, a $1 increase in salary for those with a Master's degree results in a $1,388.61 salary increase for those with a PhD.\n\n### rank\n\nThe variable `rank` is statistically significant in this model. It indicates that when all predictors are held constant, a $1 increase in salary for Asst results in a $5,292.36 salary increase for those who are Assoc and a $11,118.76 for those who are Prof.\n\n### year\n\nThe variable `year` is statistically significant in this model. It indicates that when all predictors are held constant, for every year increase, salary is $476.31 higher.\n\n### ysdeg\n\nThe variable `ysdeg` is not statistically significant in this model. It indicates that when all predictors are held constant, for every year since the highest degree was earned, salary decreases by -$124.57.\n\n## d\n\nBelow the model is updated so that the baseline category for `rank` is \"Prof.\"\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsalary$rank <- relevel(salary$rank, ref = \"Prof\")\n\nfit_2d <- summary(lm(salary ~ sex + degree + rank + year + ysdeg, data = salary))\n\nfit_2d\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + rank + year + ysdeg, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4045.2 -1094.7  -361.5   813.2  9193.1 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  26864.81    1375.29  19.534  < 2e-16 ***\nsexFemale     1166.37     925.57   1.260    0.214    \ndegreePhD     1388.61    1018.75   1.363    0.180    \nrankAsst    -11118.76    1351.77  -8.225 1.62e-10 ***\nrankAssoc    -5826.40    1012.93  -5.752 7.28e-07 ***\nyear           476.31      94.91   5.018 8.65e-06 ***\nysdeg         -124.57      77.49  -1.608    0.115    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2398 on 45 degrees of freedom\nMultiple R-squared:  0.855,\tAdjusted R-squared:  0.8357 \nF-statistic: 44.24 on 6 and 45 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\nThis change to the model does not affect its fit or the coefficients. Notice that rankAsst shows a difference of -$11,118.76 in salary whereas in the previous model rankProf was $11,118.76.\n\n## e\n\nThis next model removes the variable `rank` from the model.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_2e <- summary(lm(salary ~ sex + degree + year + ysdeg, data = salary))\n\nfit_2e\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + year + ysdeg, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8146.9 -2186.9  -491.5  2279.1 11186.6 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 17183.57    1147.94  14.969  < 2e-16 ***\nsexFemale   -1286.54    1313.09  -0.980 0.332209    \ndegreePhD   -3299.35    1302.52  -2.533 0.014704 *  \nyear          351.97     142.48   2.470 0.017185 *  \nysdeg         339.40      80.62   4.210 0.000114 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3744 on 47 degrees of freedom\nMultiple R-squared:  0.6312,\tAdjusted R-squared:  0.5998 \nF-statistic: 20.11 on 4 and 47 DF,  p-value: 1.048e-09\n```\n:::\n:::\n\nRemoving `rank` leads to `ysdeg` and `degree` now being statistically significant. \n\n## f\n\nThis final model creates a new variable `new_hire` using `ysdeg`. Those who were hired within 15 years or less were coded as 1 and everyone else 0. To avoid multicollinearity, the variable year was removed from the model. This is because it's possible the years in faculty's current rank are the same as years since the highest degree was earned (or in other words, years since hired). \n\n\n::: {.cell}\n\n```{.r .cell-code}\nsalary$new_hire <- ifelse(salary$ysdeg <= 15, 1, 0)\n\nfit_2f <- summary(lm(salary ~ sex + degree + new_hire, data = salary))\n\nfit_2f\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = salary ~ sex + degree + new_hire, data = salary)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-8260.4 -3557.7  -462.6  3563.2 12098.5 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    28663       1155  24.821  < 2e-16 ***\nsexFemale      -2716       1433  -1.896    0.064 .  \ndegreePhD      -1227       1372  -0.895    0.375    \nnew_hire       -7418       1306  -5.679 7.74e-07 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4558 on 48 degrees of freedom\nMultiple R-squared:  0.4416,\tAdjusted R-squared:  0.4067 \nF-statistic: 12.65 on 3 and 48 DF,  p-value: 3.231e-06\n```\n:::\n:::\n\nThis model shows the null hypothesis should be rejected and indicates that it is true that faculty hired by the new dean are making a higher salary than those who were not. \n\n# Question 3\n\n## a\n\n## b\n\n## c\n\n## d\n\n## e\n\n## f\n\n## g\n\n## h\n\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}