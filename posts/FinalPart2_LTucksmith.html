<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Liam Tucksmith">
<meta name="dcterms.date" content="2023-05-02">

<title>FinalPart2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="FinalPart2">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://dacss.github.io/603_Spring_2023/posts/FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-6-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="true"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target="">
 <span class="menu-text">Spring 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">FinalPart2</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">finalpart2</div>
    <div class="quarto-category">Liam Tucksmith</div>
    <div class="quarto-category">tidyverse</div>
    <div class="quarto-category">readxl</div>
    <div class="quarto-category">ggplot2</div>
    <div class="quarto-category">dplyr</div>
    <div class="quarto-category">tidyr</div>
    <div class="quarto-category">janitor</div>
  </div>
  </div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Liam Tucksmith </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 2, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Note: I slightly changed my final project to be looking at sports betting rather than media. The media portion was too ambitious so I pivoted to something more straightforward. Please let me know if that is an issue.</p>
<p>The most profitable sports league in the world, the National Football League, generated $18 billion in revenue in 2021 according to sportico.com. This total represents national media rights, league sponsorships with gambling companies, news outlets, and other companies, and shared revenue and royalties from the league’s various affiliates and subsidiaries, such as NFL Enterprises, NFL Properties, and NFL International. Sports betting, an industry linked to the NFL, generated $7.5 in revenue in 2021. As money is what keeps the NFL afloat and allows teams to competitively pay for top players and coaches, NFL teams benefit from sports betting engagement and vice versa. What I plan to analyze how the win-rate of a team relates to the ratio of correct money line predictions for that team, season by season. My hypothesis is that teams with higher win ratios will have higher correct money-line prediction ratios, both when they are favored, not favored, and in total.</p>
<p>The first dataset is a collection of all the matchups and scores that occurred in the NFL since 1966. The matchup information includes the names of the two teams competing, home/away team status, the match site, the weather on game day, and the final score for each team. Sports betting data for each game since 1977 is also included, and includes who was favored (money line), the point spread (point differential), and the over/under line. The dataset is from https://www.kaggle.com/datasets/tobycrabtree/nfl-scores-and-betting-data and was created from a variety of sources including games and scores from public websites such as ESPN, NFL.com, and Pro Football Reference. Weather information is from NOAA data, cross-referenced with NFLweather.com. Betting data reflects lines available at sportsline.com and aussportsbetting.com. For the analysis, I will limit the data to the data collected from the previous 5 years.</p>
<p>Data import and clean-up</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#read in data</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Documents/GitHub/603_Spring_2023/posts/_data/spreadspoke_scores.csv"</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "schedule_date"       "schedule_season"     "schedule_week"      
 [4] "schedule_playoff"    "team_home"           "score_home"         
 [7] "score_away"          "team_away"           "team_favorite_id"   
[10] "spread_favorite"     "over_under_line"     "stadium"            
[13] "stadium_neutral"     "weather_temperature" "weather_wind_mph"   
[16] "weather_humidity"    "weather_detail"     </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> scores[scores<span class="sc">$</span>schedule_season <span class="sc">&gt;=</span> <span class="dv">2018</span>, ]</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> schedule_date      schedule_season schedule_week      schedule_playoff
 Length:1372        Min.   :2018    Length:1372        Mode :logical   
 Class :character   1st Qu.:2019    Class :character   FALSE:1311      
 Mode  :character   Median :2020    Mode  :character   TRUE :61        
                    Mean   :2020                                       
                    3rd Qu.:2021                                       
                    Max.   :2022                                       
                                                                       
  team_home           score_home      score_away     team_away        
 Length:1372        Min.   : 0.00   Min.   : 0.00   Length:1372       
 Class :character   1st Qu.:17.00   1st Qu.:16.00   Class :character  
 Mode  :character   Median :24.00   Median :23.00   Mode  :character  
                    Mean   :23.82   Mean   :22.52                     
                    3rd Qu.:30.25   3rd Qu.:30.00                     
                    Max.   :56.00   Max.   :59.00                     
                                                                      
 team_favorite_id   spread_favorite   over_under_line   stadium         
 Length:1372        Min.   :-21.500   Min.   :32.00   Length:1372       
 Class :character   1st Qu.: -7.000   1st Qu.:43.00   Class :character  
 Mode  :character   Median : -4.500   Median :46.00   Mode  :character  
                    Mean   : -5.476   Mean   :46.12                     
                    3rd Qu.: -3.000   3rd Qu.:49.00                     
                    Max.   : -1.000   Max.   :63.50                     
                                                                        
 stadium_neutral weather_temperature weather_wind_mph weather_humidity
 Mode :logical   Min.   : 7.0        Min.   : 0.000   Min.   :  8.00  
 FALSE:1350      1st Qu.:59.0        1st Qu.: 0.000   1st Qu.: 54.00  
 TRUE :22        Median :72.0        Median : 0.000   Median : 67.00  
                 Mean   :64.8        Mean   : 3.219   Mean   : 66.59  
                 3rd Qu.:72.0        3rd Qu.: 6.000   3rd Qu.: 80.25  
                 Max.   :97.0        Max.   :33.000   Max.   :100.00  
                 NA's   :695         NA's   :695      NA's   :1292    
 weather_detail    
 Length:1372       
 Class :character  
 Mode  :character  
                   
                   
                   
                   </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(scores)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Rows: 1,372
Columns: 17
$ schedule_date       &lt;chr&gt; "9/6/2018", "9/9/2018", "9/9/2018", "9/9/2018", "9…
$ schedule_season     &lt;int&gt; 2018, 2018, 2018, 2018, 2018, 2018, 2018, 2018, 20…
$ schedule_week       &lt;chr&gt; "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", …
$ schedule_playoff    &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, F…
$ team_home           &lt;chr&gt; "Philadelphia Eagles", "Arizona Cardinals", "Balti…
$ score_home          &lt;int&gt; 18, 6, 47, 16, 21, 27, 24, 23, 28, 27, 24, 27, 40,…
$ score_away          &lt;int&gt; 12, 24, 3, 8, 21, 24, 23, 34, 38, 20, 16, 20, 48, …
$ team_away           &lt;chr&gt; "Atlanta Falcons", "Washington Redskins", "Buffalo…
$ team_favorite_id    &lt;chr&gt; "PHI", "ARI", "BAL", "CAR", "PIT", "DEN", "GB", "C…
$ spread_favorite     &lt;dbl&gt; -1.0, -2.0, -7.5, -2.5, -3.5, -3.0, -6.5, -1.0, -3…
$ over_under_line     &lt;dbl&gt; 44.5, 43.5, 39.0, 42.5, 41.0, 42.5, 45.0, 47.5, 48…
$ stadium             &lt;chr&gt; "Lincoln Financial Field", "University of Phoenix …
$ stadium_neutral     &lt;lgl&gt; FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, FALSE, F…
$ weather_temperature &lt;int&gt; 81, 72, 61, 81, 58, 84, 62, 72, 84, 89, 72, 62, 72…
$ weather_wind_mph    &lt;int&gt; 8, 0, 12, 9, 11, 5, 10, 0, 8, 7, 0, 10, 0, 7, 0, 1…
$ weather_humidity    &lt;int&gt; NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…
$ weather_detail      &lt;chr&gt; "rain", "indoor", "rain", "rain", "rain", "", "", …</code></pre>
</div>
</div>
<p>Data cleanup and descriptive analytics</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">#map team names to abbreviations</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(scores<span class="sc">$</span>team_home)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Philadelphia Eagles"      "Arizona Cardinals"       
 [3] "Baltimore Ravens"         "Carolina Panthers"       
 [5] "Cleveland Browns"         "Denver Broncos"          
 [7] "Green Bay Packers"        "Indianapolis Colts"      
 [9] "Los Angeles Chargers"     "Miami Dolphins"          
[11] "Minnesota Vikings"        "New England Patriots"    
[13] "New Orleans Saints"       "New York Giants"         
[15] "Detroit Lions"            "Oakland Raiders"         
[17] "Cincinnati Bengals"       "Atlanta Falcons"         
[19] "Buffalo Bills"            "Dallas Cowboys"          
[21] "Jacksonville Jaguars"     "Los Angeles Rams"        
[23] "New York Jets"            "Pittsburgh Steelers"     
[25] "San Francisco 49ers"      "Tampa Bay Buccaneers"    
[27] "Tennessee Titans"         "Washington Redskins"     
[29] "Chicago Bears"            "Houston Texans"          
[31] "Kansas City Chiefs"       "Seattle Seahawks"        
[33] "Washington Football Team" "Las Vegas Raiders"       
[35] "Washington Commanders"   </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(scores<span class="sc">$</span>team_favorite_id)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "PHI" "ARI" "BAL" "CAR" "PIT" "DEN" "GB"  "CIN" "LAC" "TEN" "MIN" "NE" 
[13] "NO"  "JAX" "DET" "LAR" "ATL" "DAL" "NYJ" "SF"  "HOU" "WAS" "CHI" "CLE"
[25] "KC"  "MIA" "SEA" "IND" "LVR" "TB"  "NYG" "BUF"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">#rewrite team_home and team_away to use IDs</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Philadelphia Eagles"</span>] <span class="ot">&lt;-</span> <span class="st">"PHI"</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Arizona Cardinals"</span>] <span class="ot">&lt;-</span> <span class="st">"ARI"</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Baltimore Ravens"</span>] <span class="ot">&lt;-</span> <span class="st">"BAL"</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Carolina Panthers"</span>] <span class="ot">&lt;-</span> <span class="st">"CAR"</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Cleveland Browns"</span>] <span class="ot">&lt;-</span> <span class="st">"CLE"</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Denver Broncos"</span>] <span class="ot">&lt;-</span> <span class="st">"DEN"</span></span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Green Bay Packers"</span>] <span class="ot">&lt;-</span> <span class="st">"GB"</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Indianapolis Colts"</span>] <span class="ot">&lt;-</span> <span class="st">"IND"</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Los Angeles Chargers"</span>] <span class="ot">&lt;-</span> <span class="st">"LAC"</span></span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Miami Dolphins"</span>] <span class="ot">&lt;-</span> <span class="st">"MIA"</span></span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Minnesota Vikings"</span>] <span class="ot">&lt;-</span> <span class="st">"MIN"</span></span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"New England Patriots"</span>] <span class="ot">&lt;-</span> <span class="st">"NE"</span></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"New Orleans Saints"</span>] <span class="ot">&lt;-</span> <span class="st">"NO"</span></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"New York Giants"</span>] <span class="ot">&lt;-</span> <span class="st">"NYG"</span></span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Detroit Lions"</span>] <span class="ot">&lt;-</span> <span class="st">"DET"</span></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Oakland Raiders"</span> <span class="sc">|</span> </span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Las Vegas Raiders"</span>] <span class="ot">&lt;-</span> <span class="st">"LVR"</span></span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Cincinnati Bengals"</span>] <span class="ot">&lt;-</span> <span class="st">"CIN"</span></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Atlanta Falcons"</span>] <span class="ot">&lt;-</span> <span class="st">"ATL"</span></span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Buffalo Bills"</span>] <span class="ot">&lt;-</span> <span class="st">"BUF"</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Dallas Cowboys"</span>] <span class="ot">&lt;-</span> <span class="st">"DAL"</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Jacksonville Jaguars"</span>] <span class="ot">&lt;-</span> <span class="st">"JAX"</span></span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Los Angeles Rams"</span>] <span class="ot">&lt;-</span> <span class="st">"LAR"</span></span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"New York Jets"</span>] <span class="ot">&lt;-</span> <span class="st">"NYJ"</span></span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Pittsburgh Steelers"</span>] <span class="ot">&lt;-</span> <span class="st">"PIT"</span></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"San Francisco 49ers"</span>] <span class="ot">&lt;-</span> <span class="st">"SF"</span></span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Tampa Bay Buccaneers"</span>] <span class="ot">&lt;-</span> <span class="st">"TB"</span></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Tennessee Titans"</span>] <span class="ot">&lt;-</span> <span class="st">"TEN"</span></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Washington Redskins"</span> <span class="sc">|</span> </span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Washington Football Team"</span><span class="sc">|</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Washington Commanders"</span>] <span class="ot">&lt;-</span> <span class="st">"WAS"</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Chicago Bears"</span>] <span class="ot">&lt;-</span> <span class="st">"CHI"</span></span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Houston Texans"</span>] <span class="ot">&lt;-</span> <span class="st">"HOU"</span></span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Kansas City Chiefs"</span>] <span class="ot">&lt;-</span> <span class="st">"KC"</span></span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Seattle Seahawks"</span>] <span class="ot">&lt;-</span> <span class="st">"SEA"</span></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Philadelphia Eagles"</span>] <span class="ot">&lt;-</span> <span class="st">"PHI"</span></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Arizona Cardinals"</span>] <span class="ot">&lt;-</span> <span class="st">"ARI"</span></span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Baltimore Ravens"</span>] <span class="ot">&lt;-</span> <span class="st">"BAL"</span></span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Carolina Panthers"</span>] <span class="ot">&lt;-</span> <span class="st">"CAR"</span></span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Cleveland Browns"</span>] <span class="ot">&lt;-</span> <span class="st">"CLE"</span></span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Denver Broncos"</span>] <span class="ot">&lt;-</span> <span class="st">"DEN"</span></span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Green Bay Packers"</span>] <span class="ot">&lt;-</span> <span class="st">"GB"</span></span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Indianapolis Colts"</span>] <span class="ot">&lt;-</span> <span class="st">"IND"</span></span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Los Angeles Chargers"</span>] <span class="ot">&lt;-</span> <span class="st">"LAC"</span></span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Miami Dolphins"</span>] <span class="ot">&lt;-</span> <span class="st">"MIA"</span></span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Minnesota Vikings"</span>] <span class="ot">&lt;-</span> <span class="st">"MIN"</span></span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"New England Patriots"</span>] <span class="ot">&lt;-</span> <span class="st">"NE"</span></span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"New Orleans Saints"</span>] <span class="ot">&lt;-</span> <span class="st">"NO"</span></span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"New York Giants"</span>] <span class="ot">&lt;-</span> <span class="st">"NYG"</span></span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Detroit Lions"</span>] <span class="ot">&lt;-</span> <span class="st">"DET"</span></span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Oakland Raiders"</span> <span class="sc">|</span> </span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Las Vegas Raiders"</span>] <span class="ot">&lt;-</span> <span class="st">"LVR"</span></span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Cincinnati Bengals"</span>] <span class="ot">&lt;-</span> <span class="st">"CIN"</span></span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Atlanta Falcons"</span>] <span class="ot">&lt;-</span> <span class="st">"ATL"</span></span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Buffalo Bills"</span>] <span class="ot">&lt;-</span> <span class="st">"BUF"</span></span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Dallas Cowboys"</span>] <span class="ot">&lt;-</span> <span class="st">"DAL"</span></span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Jacksonville Jaguars"</span>] <span class="ot">&lt;-</span> <span class="st">"JAX"</span></span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Los Angeles Rams"</span>] <span class="ot">&lt;-</span> <span class="st">"LAR"</span></span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"New York Jets"</span>] <span class="ot">&lt;-</span> <span class="st">"NYJ"</span></span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Pittsburgh Steelers"</span>] <span class="ot">&lt;-</span> <span class="st">"PIT"</span></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"San Francisco 49ers"</span>] <span class="ot">&lt;-</span> <span class="st">"SF"</span></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Tampa Bay Buccaneers"</span>] <span class="ot">&lt;-</span> <span class="st">"TB"</span></span>
<span id="cb12-65"><a href="#cb12-65" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Tennessee Titans"</span>] <span class="ot">&lt;-</span> <span class="st">"TEN"</span></span>
<span id="cb12-66"><a href="#cb12-66" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Washington Redskins"</span> <span class="sc">|</span> </span>
<span id="cb12-67"><a href="#cb12-67" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Washington Football Team"</span><span class="sc">|</span></span>
<span id="cb12-68"><a href="#cb12-68" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Washington Commanders"</span>] <span class="ot">&lt;-</span> <span class="st">"WAS"</span></span>
<span id="cb12-69"><a href="#cb12-69" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Chicago Bears"</span>] <span class="ot">&lt;-</span> <span class="st">"CHI"</span></span>
<span id="cb12-70"><a href="#cb12-70" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Houston Texans"</span>] <span class="ot">&lt;-</span> <span class="st">"HOU"</span></span>
<span id="cb12-71"><a href="#cb12-71" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Kansas City Chiefs"</span>] <span class="ot">&lt;-</span> <span class="st">"KC"</span></span>
<span id="cb12-72"><a href="#cb12-72" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Seattle Seahawks"</span>] <span class="ot">&lt;-</span> <span class="st">"SEA"</span></span>
<span id="cb12-73"><a href="#cb12-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-74"><a href="#cb12-74" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(scores<span class="sc">$</span>team_home)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "PHI" "ARI" "BAL" "CAR" "CLE" "DEN" "GB"  "IND" "LAC" "MIA" "MIN" "NE" 
[13] "NO"  "NYG" "DET" "LVR" "CIN" "ATL" "BUF" "DAL" "JAX" "LAR" "NYJ" "PIT"
[25] "SF"  "TB"  "TEN" "WAS" "CHI" "HOU" "KC"  "SEA"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">n_distinct</span>(scores<span class="sc">$</span>team_home)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(scores<span class="sc">$</span>team_away)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "ATL" "WAS" "BUF" "DAL" "PIT" "SEA" "CHI" "CIN" "KC"  "TEN" "SF"  "HOU"
[13] "TB"  "JAX" "NYJ" "LAR" "BAL" "CAR" "LAC" "NYG" "LVR" "MIN" "NE"  "ARI"
[25] "CLE" "MIA" "DET" "PHI" "IND" "NO"  "DEN" "GB" </code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co">#add column for game winner</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>score_home <span class="ot">=</span> <span class="fu">as.integer</span>(scores<span class="sc">$</span>score_home)</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>score_away <span class="ot">=</span> <span class="fu">as.integer</span>(scores<span class="sc">$</span>score_away)</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>winner <span class="ot">=</span> <span class="fu">ifelse</span>(scores<span class="sc">$</span>score_home <span class="sc">==</span> scores<span class="sc">$</span>score_away, <span class="st">"TIE"</span>, <span class="fu">ifelse</span>(scores<span class="sc">$</span>score_home <span class="sc">&gt;</span> scores<span class="sc">$</span>score_away, scores<span class="sc">$</span>team_home, scores<span class="sc">$</span>team_away))</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a><span class="co">#add column for if money line prediction is true</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>mlTF <span class="ot">=</span> <span class="fu">ifelse</span>(scores<span class="sc">$</span>winner <span class="sc">==</span> scores<span class="sc">$</span>team_favorite_id, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>mlHomeAway <span class="ot">=</span> <span class="fu">ifelse</span>(scores<span class="sc">$</span>team_home <span class="sc">==</span> scores<span class="sc">$</span>team_favorite_id, <span class="st">"Home"</span>, <span class="st">"Away"</span>)</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a><span class="co">#get counts for wins and losses, correct and incorrect moneyline predictions when favored and not favored, for away and home games</span></span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>home_team <span class="ot">&lt;-</span> scores <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(team_home, schedule_season) <span class="sc">%&gt;%</span> </span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">summarise</span>(<span class="at">home_wins =</span> <span class="fu">sum</span>(team_home <span class="sc">==</span> winner),</span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a>                            <span class="at">home_losses =</span> <span class="fu">sum</span>(team_away <span class="sc">==</span> winner),</span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_incorr_favored_h =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Home"</span>),</span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_incorr_unfavored_h =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Away"</span>),</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_corr_favored_h =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Home"</span>),</span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_corr_unfavored_h =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Away"</span>),</span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a>away_team <span class="ot">&lt;-</span> scores <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(team_away, schedule_season) <span class="sc">%&gt;%</span> </span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">summarise</span>(<span class="at">away_wins =</span> <span class="fu">sum</span>(team_away <span class="sc">==</span> winner),</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>                            <span class="at">away_losses =</span> <span class="fu">sum</span>(team_home <span class="sc">==</span> winner),</span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_incorr_favored_a =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Away"</span>),</span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_incorr_unfavored_a =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Home"</span>),</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_corr_favored_a =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Away"</span>),</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_corr_unfavored_a =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Home"</span>),</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a><span class="co">#merge home and away data</span></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>teams <span class="ot">&lt;-</span> <span class="fu">merge</span>(home_team, away_team, </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>               <span class="at">by.x =</span> <span class="fu">c</span>(<span class="st">"team_home"</span>,<span class="st">"schedule_season"</span>), </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>               <span class="at">by.y =</span> <span class="fu">c</span>(<span class="st">"team_away"</span>,<span class="st">"schedule_season"</span>))</span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(teams)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "team_home"             "schedule_season"       "home_wins"            
 [4] "home_losses"           "ml_incorr_favored_h"   "ml_incorr_unfavored_h"
 [7] "ml_corr_favored_h"     "ml_corr_unfavored_h"   "away_wins"            
[10] "away_losses"           "ml_incorr_favored_a"   "ml_incorr_unfavored_a"
[13] "ml_corr_favored_a"     "ml_corr_unfavored_a"  </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>teams <span class="ot">&lt;-</span> teams <span class="sc">%&gt;%</span> </span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rename</span>(<span class="st">"team"</span> <span class="ot">=</span> <span class="st">"team_home"</span>)</span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a><span class="co">#combine home and away fields </span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>total_wins <span class="ot">&lt;-</span> teams<span class="sc">$</span>home_wins <span class="sc">+</span> teams<span class="sc">$</span>away_wins</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>total_losses <span class="ot">&lt;-</span> teams<span class="sc">$</span>home_losses <span class="sc">+</span> teams<span class="sc">$</span>away_losses</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>total_home_games <span class="ot">&lt;-</span> teams<span class="sc">$</span>home_wins <span class="sc">+</span> teams<span class="sc">$</span>home_losses</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a><span class="co">#combine favored and unfavored, correct and incorrect data</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_corr_favored <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_corr_favored_h <span class="sc">+</span> teams<span class="sc">$</span>ml_corr_favored_a </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_corr_unfavored <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_corr_unfavored_h <span class="sc">+</span> teams<span class="sc">$</span>ml_corr_unfavored_a</span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_corr_total <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_corr_favored <span class="sc">+</span> teams<span class="sc">$</span>ml_corr_unfavored </span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_incorr_favored <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_incorr_favored_h <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_favored_a</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_incorr_unfavored <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_incorr_unfavored_h <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_unfavored_a</span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_incorr_total <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_incorr_favored <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_unfavored </span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate win, correct, uncorrect, and total money line predictions</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>win_ratio <span class="ot">=</span> teams<span class="sc">$</span>total_wins<span class="sc">/</span>(teams<span class="sc">$</span>total_wins <span class="sc">+</span> teams<span class="sc">$</span>total_losses)</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ratio_corr_favored <span class="ot">=</span> teams<span class="sc">$</span>ml_corr_favored<span class="sc">/</span>(teams<span class="sc">$</span>ml_corr_favored <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_favored)</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ratio_corr_unfavored <span class="ot">=</span> teams<span class="sc">$</span>ml_corr_unfavored<span class="sc">/</span>(teams<span class="sc">$</span>ml_corr_unfavored <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_unfavored)</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ratio_corr_total <span class="ot">=</span> teams<span class="sc">$</span>ml_corr_total<span class="sc">/</span>(teams<span class="sc">$</span>ml_corr_total <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_total)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(teams, <span class="dv">50</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   team schedule_season home_wins home_losses ml_incorr_favored_h
1   ARI            2018         1           7                   2
2   ARI            2019         2           5                   1
3   ARI            2020         4           4                   3
4   ARI            2021         3           5                   5
5   ARI            2022         1           8                   1
6   ATL            2018         4           4                   4
7   ATL            2019         3           5                   2
8   ATL            2020         2           6                   3
9   ATL            2021         2           6                   2
10  ATL            2022         6           3                   0
11  BAL            2018         6           3                   3
12  BAL            2019         7           2                   2
13  BAL            2020         5           3                   3
14  BAL            2021         5           4                   2
15  BAL            2022         5           3                   2
16  BUF            2018         4           4                   1
17  BUF            2019         4           4                   1
18  BUF            2020         9           1                   0
19  BUF            2021         7           3                   3
20  BUF            2022         8           2                   2
21  CAR            2018         5           3                   1
22  CAR            2019         2           6                   3
23  CAR            2020         2           6                   3
24  CAR            2021         2           6                   3
25  CAR            2022         5           4                   3
26  CHI            2018         7           2                   1
27  CHI            2019         4           4                   3
28  CHI            2020         3           5                   1
29  CHI            2021         3           5                   0
30  CHI            2022         2           7                   1
31  CIN            2018         4           4                   1
32  CIN            2019         2           6                   2
33  CIN            2020         3           5                   0
34  CIN            2021         6           5                   2
35  CIN            2022         7           1                   1
36  CLE            2018         5           2                   1
37  CLE            2019         4           4                   2
38  CLE            2020         6           2                   1
39  CLE            2021         6           3                   2
40  CLE            2022         4           4                   3
41  DAL            2018         8           1                   1
42  DAL            2019         5           3                   3
43  DAL            2020         4           4                   2
44  DAL            2021         5           4                   4
45  DAL            2022         8           1                   0
46  DEN            2018         3           5                   2
47  DEN            2019         5           3                   1
48  DEN            2020         2           6                   0
49  DEN            2021         4           5                   4
50  DEN            2022         4           4                   2
   ml_incorr_unfavored_h ml_corr_favored_h ml_corr_unfavored_h away_wins
1                      0                 1                   5         2
2                      3                 0                   4         3
3                      1                 3                   1         4
4                      0                 3                   0         8
5                      0                 1                   7         3
6                      0                 4                   0         3
7                      1                 2                   3         4
8                      1                 1                   3         2
9                      0                 2                   4         5
10                     2                 4                   3         1
11                     0                 6                   0         4
12                     2                 5                   0         7
13                     0                 5                   0         7
14                     1                 4                   2         3
15                     0                 5                   1         5
16                     2                 2                   3         2
17                     0                 4                   3         6
18                     2                 7                   1         6
19                     0                 7                   0         5
20                     0                 8                   0         6
21                     1                 4                   2         2
22                     0                 2                   3         3
23                     2                 0                   3         3
24                     1                 1                   3         3
25                     5                 0                   1         2
26                     1                 6                   1         5
27                     1                 3                   1         4
28                     2                 1                   4         5
29                     0                 3                   5         3
30                     1                 1                   6         1
31                     0                 4                   3         2
32                     2                 0                   4         0
33                     2                 1                   5         1
34                     2                 4                   3         7
35                     1                 6                   0         7
36                     4                 2                   1         2
37                     0                 4                   2         2
38                     0                 6                   1         6
39                     0                 6                   1         2
40                     2                 2                   1         3
41                     2                 6                   0         3
42                     1                 4                   0         3
43                     2                 2                   2         2
44                     0                 5                   0         7
45                     1                 7                   1         5
46                     1                 2                   3         3
47                     2                 3                   2         2
48                     2                 0                   6         3
49                     1                 3                   1         3
50                     1                 3                   2         1
   away_losses ml_incorr_favored_a ml_incorr_unfavored_a ml_corr_favored_a
1            6                   0                     2                 0
2            5                   0                     3                 0
3            4                   2                     1                 3
4            2                   1                     6                 2
5            5                   1                     3                 0
6            5                   1                     1                 2
7            4                   1                     4                 0
8            6                   0                     2                 0
9            4                   0                     3                 2
10           7                   1                     1                 0
11           4                   2                     3                 1
12           1                   0                     1                 6
13           3                   1                     0                 7
14           5                   3                     1                 2
15           5                   2                     2                 3
16           6                   0                     2                 0
17           3                   0                     4                 2
18           3                   1                     1                 5
19           4                   2                     2                 3
20           2                   2                     0                 6
21           6                   4                     2                 0
22           5                   0                     2                 1
23           5                   0                     2                 1
24           6                   2                     2                 1
25           6                   1                     2                 0
26           3                   2                     1                 4
27           4                   1                     0                 4
28           4                   0                     4                 1
29           6                   0                     2                 1
30           7                   0                     1                 0
31           6                   0                     1                 1
32           8                   1                     0                 0
33           6                   0                     2                 0
34           3                   1                     5                 2
35           4                   2                     1                 6
36           6                   0                     1                 1
37           6                   4                     1                 1
38           4                   1                     3                 3
39           6                   0                     1                 1
40           6                   1                     2                 1
41           6                   1                     3                 0
42           5                   4                     0                 3
43           6                   2                     1                 1
44           2                   0                     2                 5
45           5                   3                     2                 3
46           5                   2                     1                 2
47           6                   1                     2                 0
48           5                   0                     3                 0
49           5                   2                     1                 2
50           8                   3                     1                 0
   ml_corr_unfavored_a total_wins total_losses total_home_games ml_corr_favored
1                    6          3           13                8               1
2                    5          5           10                7               0
3                    2          8            8                8               6
4                    1         11            7                8               5
5                    4          4           13                9               1
6                    4          7            9                8               6
7                    3          7            9                8               2
8                    6          4           12                8               1
9                    4          7           10                8               4
10                   6          7           10                9               4
11                   2         10            7                9               7
12                   1         14            3                9              11
13                   2         12            6                8              12
14                   2          8            9                9               6
15                   3         10            8                8               8
16                   6          6           10                8               2
17                   3         10            7                8               6
18                   2         15            4               10              12
19                   2         12            7               10              10
20                   0         14            4               10              14
21                   2          7            9                8               4
22                   5          5           11                8               3
23                   5          5           11                8               1
24                   4          5           12                8               2
25                   5          7           10                9               0
26                   1         12            5                9              10
27                   3          8            8                8               7
28                   4          8            9                8               2
29                   6          6           11                8               4
30                   7          3           14                9               1
31                   6          6           10                8               5
32                   7          2           14                8               0
33                   6          4           11                8               1
34                   2         13            8               11               6
35                   2         14            5                8              12
36                   6          7            8                7               3
37                   2          6           10                8               5
38                   3         12            6                8               9
39                   6          8            9                9               7
40                   5          7           10                8               3
41                   5         11            7                9               6
42                   1          8            8                8               7
43                   4          6           10                8               3
44                   2         12            6                9              10
45                   2         13            6                9              10
46                   3          6           10                8               4
47                   5          7            9                8               3
48                   5          5           11                8               0
49                   3          7           10                9               5
50                   5          5           12                8               3
   ml_corr_unfavored ml_corr_total ml_incorr_favored ml_incorr_unfavored
1                 11            12                 2                   2
2                  9             9                 1                   6
3                  3             9                 5                   2
4                  1             6                 6                   6
5                 11            12                 2                   3
6                  4            10                 5                   1
7                  6             8                 3                   5
8                  9            10                 3                   3
9                  8            12                 2                   3
10                 9            13                 1                   3
11                 2             9                 5                   3
12                 1            12                 2                   3
13                 2            14                 4                   0
14                 4            10                 5                   2
15                 4            12                 4                   2
16                 9            11                 1                   4
17                 6            12                 1                   4
18                 3            15                 1                   3
19                 2            12                 5                   2
20                 0            14                 4                   0
21                 4             8                 5                   3
22                 8            11                 3                   2
23                 8             9                 3                   4
24                 7             9                 5                   3
25                 6             6                 4                   7
26                 2            12                 3                   2
27                 4            11                 4                   1
28                 8            10                 1                   6
29                11            15                 0                   2
30                13            14                 1                   2
31                 9            14                 1                   1
32                11            11                 3                   2
33                11            12                 0                   4
34                 5            11                 3                   7
35                 2            14                 3                   2
36                 7            10                 1                   5
37                 4             9                 6                   1
38                 4            13                 2                   3
39                 7            14                 2                   1
40                 6             9                 4                   4
41                 5            11                 2                   5
42                 1             8                 7                   1
43                 6             9                 4                   3
44                 2            12                 4                   2
45                 3            13                 3                   3
46                 6            10                 4                   2
47                 7            10                 2                   4
48                11            11                 0                   5
49                 4             9                 6                   2
50                 7            10                 5                   2
   ml_incorr_total win_ratio ratio_corr_favored ratio_corr_unfavored
1                4 0.1875000          0.3333333            0.8461538
2                7 0.3333333          0.0000000            0.6000000
3                7 0.5000000          0.5454545            0.6000000
4               12 0.6111111          0.4545455            0.1428571
5                5 0.2352941          0.3333333            0.7857143
6                6 0.4375000          0.5454545            0.8000000
7                8 0.4375000          0.4000000            0.5454545
8                6 0.2500000          0.2500000            0.7500000
9                5 0.4117647          0.6666667            0.7272727
10               4 0.4117647          0.8000000            0.7500000
11               8 0.5882353          0.5833333            0.4000000
12               5 0.8235294          0.8461538            0.2500000
13               4 0.6666667          0.7500000            1.0000000
14               7 0.4705882          0.5454545            0.6666667
15               6 0.5555556          0.6666667            0.6666667
16               5 0.3750000          0.6666667            0.6923077
17               5 0.5882353          0.8571429            0.6000000
18               4 0.7894737          0.9230769            0.5000000
19               7 0.6315789          0.6666667            0.5000000
20               4 0.7777778          0.7777778                  NaN
21               8 0.4375000          0.4444444            0.5714286
22               5 0.3125000          0.5000000            0.8000000
23               7 0.3125000          0.2500000            0.6666667
24               8 0.2941176          0.2857143            0.7000000
25              11 0.4117647          0.0000000            0.4615385
26               5 0.7058824          0.7692308            0.5000000
27               5 0.5000000          0.6363636            0.8000000
28               7 0.4705882          0.6666667            0.5714286
29               2 0.3529412          1.0000000            0.8461538
30               3 0.1764706          0.5000000            0.8666667
31               2 0.3750000          0.8333333            0.9000000
32               5 0.1250000          0.0000000            0.8461538
33               4 0.2666667          1.0000000            0.7333333
34              10 0.6190476          0.6666667            0.4166667
35               5 0.7368421          0.8000000            0.5000000
36               6 0.4666667          0.7500000            0.5833333
37               7 0.3750000          0.4545455            0.8000000
38               5 0.6666667          0.8181818            0.5714286
39               3 0.4705882          0.7777778            0.8750000
40               8 0.4117647          0.4285714            0.6000000
41               7 0.6111111          0.7500000            0.5000000
42               8 0.5000000          0.5000000            0.5000000
43               7 0.3750000          0.4285714            0.6666667
44               6 0.6666667          0.7142857            0.5000000
45               6 0.6842105          0.7692308            0.5000000
46               6 0.3750000          0.5000000            0.7500000
47               6 0.4375000          0.6000000            0.6363636
48               5 0.3125000                NaN            0.6875000
49               8 0.4117647          0.4545455            0.6666667
50               7 0.2941176          0.3750000            0.7777778
   ratio_corr_total
1         0.7500000
2         0.5625000
3         0.5625000
4         0.3333333
5         0.7058824
6         0.6250000
7         0.5000000
8         0.6250000
9         0.7058824
10        0.7647059
11        0.5294118
12        0.7058824
13        0.7777778
14        0.5882353
15        0.6666667
16        0.6875000
17        0.7058824
18        0.7894737
19        0.6315789
20        0.7777778
21        0.5000000
22        0.6875000
23        0.5625000
24        0.5294118
25        0.3529412
26        0.7058824
27        0.6875000
28        0.5882353
29        0.8823529
30        0.8235294
31        0.8750000
32        0.6875000
33        0.7500000
34        0.5238095
35        0.7368421
36        0.6250000
37        0.5625000
38        0.7222222
39        0.8235294
40        0.5294118
41        0.6111111
42        0.5000000
43        0.5625000
44        0.6666667
45        0.6842105
46        0.6250000
47        0.6250000
48        0.6875000
49        0.5294118
50        0.5882353</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot correct and incorrect moneyline prediction ratio for each team by season</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>agg_tbl <span class="ot">&lt;-</span> teams <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(team, schedule_season) <span class="sc">%&gt;%</span> </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">corr_ratio =</span> (<span class="fu">sum</span>(ml_corr_total)<span class="sc">/</span>(<span class="fu">sum</span>(ml_corr_total <span class="sc">+</span> ml_incorr_total))),</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">incorr_ratio =</span> (<span class="fu">sum</span>(ml_incorr_total)<span class="sc">/</span>(<span class="fu">sum</span>(ml_corr_total <span class="sc">+</span> ml_incorr_total))),</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum =</span> <span class="fu">sum</span>(ml_corr_total <span class="sc">+</span> ml_incorr_total),</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agg_tbl, <span class="fu">aes</span>(<span class="fu">factor</span>(team), <span class="at">fill=</span><span class="fu">factor</span>(corr_ratio))) <span class="sc">+</span>     </span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agg_tbl, <span class="fu">aes</span>(<span class="at">x=</span>schedule_season, <span class="at">y=</span>corr_ratio)) <span class="sc">+</span>     </span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot correct moneyline prediction ratio for each team by season, facet  by team</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>agg_tbl2 <span class="ot">&lt;-</span> teams <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(team, schedule_season) <span class="sc">%&gt;%</span> </span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ratio =</span> (<span class="fu">sum</span>(ml_corr_favored)<span class="sc">/</span>(<span class="fu">sum</span>(ml_corr_favored <span class="sc">+</span> ml_incorr_favored))),</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agg_tbl2, <span class="fu">aes</span>(<span class="at">x=</span>schedule_season, <span class="at">y=</span>ratio)) <span class="sc">+</span>     </span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>team)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (`position_stack()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-6-3.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co">#plot win ratio of each team by season </span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>agg_tbl3 <span class="ot">&lt;-</span> teams <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(team, schedule_season) <span class="sc">%&gt;%</span> </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ratio =</span> total_wins<span class="sc">/</span>(total_wins <span class="sc">+</span> total_losses),</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agg_tbl3, <span class="fu">aes</span>(<span class="at">x=</span>schedule_season, <span class="at">y=</span>ratio)) <span class="sc">+</span>     </span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(team))) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>regFavored <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_favored <span class="sc">~</span> teams<span class="sc">$</span>win_ratio)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regFavored))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = teams$ratio_corr_favored ~ teams$win_ratio)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.52819 -0.06854 -0.01043  0.07007  0.61637 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      0.19088    0.04002    4.77 4.24e-06 ***
teams$win_ratio  0.81917    0.07578   10.81  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1685 on 154 degrees of freedom
  (4 observations deleted due to missingness)
Multiple R-squared:  0.4314,    Adjusted R-squared:  0.4277 
F-statistic: 116.9 on 1 and 154 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>regUnfavored <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_unfavored <span class="sc">~</span> teams<span class="sc">$</span>win_ratio)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regUnfavored))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = teams$ratio_corr_unfavored ~ teams$win_ratio)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.44543 -0.07571 -0.01488  0.05314  0.59908 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      0.96472    0.03471   27.79   &lt;2e-16 ***
teams$win_ratio -0.70474    0.06720  -10.49   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1496 on 154 degrees of freedom
  (4 observations deleted due to missingness)
Multiple R-squared:  0.4167,    Adjusted R-squared:  0.4129 
F-statistic:   110 on 1 and 154 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>regTotal <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_total <span class="sc">~</span> teams<span class="sc">$</span>win_ratio)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regTotal))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = teams$ratio_corr_total ~ teams$win_ratio)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.31798 -0.09001  0.01632  0.08683  0.23861 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      0.657053   0.026274  25.008   &lt;2e-16 ***
teams$win_ratio -0.009385   0.050237  -0.187    0.852    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1145 on 158 degrees of freedom
Multiple R-squared:  0.0002208, Adjusted R-squared:  -0.006107 
F-statistic: 0.0349 on 1 and 158 DF,  p-value: 0.8521</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>regFavoredTeam <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_favored <span class="sc">~</span> teams<span class="sc">$</span>win_ratio <span class="sc">+</span> teams<span class="sc">$</span>team)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regFavoredTeam))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = teams$ratio_corr_favored ~ teams$win_ratio + teams$team)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.48798 -0.07169 -0.00507  0.08247  0.58378 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      0.04455    0.08219   0.542  0.58875    
teams$win_ratio  0.77329    0.09733   7.945 1.05e-12 ***
teams$teamATL    0.18652    0.10426   1.789  0.07607 .  
teams$teamBAL    0.15363    0.10699   1.436  0.15358    
teams$teamBUF    0.24468    0.10725   2.281  0.02424 *  
teams$teamCAR   -0.02201    0.10426  -0.211  0.83314    
teams$teamCHI    0.32875    0.10445   3.147  0.00207 ** 
teams$teamCIN    0.28718    0.10436   2.752  0.00683 ** 
teams$teamCLE    0.23153    0.10474   2.210  0.02892 *  
teams$teamDAL    0.14911    0.10594   1.407  0.16182    
teams$teamDEN    0.14430    0.11057   1.305  0.19432    
teams$teamDET    0.18153    0.11058   1.642  0.10324    
teams$teamGB     0.15153    0.10719   1.414  0.15998    
teams$teamHOU    0.09757    0.11074   0.881  0.38000    
teams$teamIND    0.16508    0.10491   1.573  0.11819    
teams$teamJAX   -0.03209    0.10456  -0.307  0.75941    
teams$teamKC     0.16428    0.11153   1.473  0.14331    
teams$teamLAC    0.15644    0.10511   1.488  0.13921    
teams$teamLAR    0.17190    0.10663   1.612  0.10949    
teams$teamLVR    0.15414    0.10434   1.477  0.14214    
teams$teamMIA    0.27068    0.11152   2.427  0.01667 *  
teams$teamMIN    0.23795    0.10573   2.250  0.02619 *  
teams$teamNE     0.19991    0.10619   1.883  0.06212 .  
teams$teamNO     0.16083    0.10745   1.497  0.13703    
teams$teamNYG    0.26148    0.10428   2.507  0.01346 *  
teams$teamNYJ    0.18972    0.10455   1.815  0.07201 .  
teams$teamPHI    0.18542    0.10536   1.760  0.08090 .  
teams$teamPIT    0.12113    0.10604   1.142  0.25553    
teams$teamSEA    0.15109    0.10607   1.424  0.15685    
teams$teamSF     0.09851    0.10570   0.932  0.35319    
teams$teamTB     0.20718    0.10544   1.965  0.05168 .  
teams$teamTEN    0.13301    0.10605   1.254  0.21213    
teams$teamWAS    0.28505    0.10426   2.734  0.00718 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1648 on 123 degrees of freedom
  (4 observations deleted due to missingness)
Multiple R-squared:  0.5654,    Adjusted R-squared:  0.4523 
F-statistic:     5 on 32 and 123 DF,  p-value: 4.13e-11</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>regUnfavoredTeam <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_unfavored <span class="sc">~</span> teams<span class="sc">$</span>win_ratio <span class="sc">+</span> teams<span class="sc">$</span>team)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regUnfavoredTeam))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = teams$ratio_corr_unfavored ~ teams$win_ratio + teams$team)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.39959 -0.08608 -0.00109  0.05211  0.47492 

Coefficients:
                Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      0.88605    0.07398  11.976  &lt; 2e-16 ***
teams$win_ratio -0.77952    0.08754  -8.905 5.81e-15 ***
teams$teamATL    0.13227    0.09387   1.409  0.16133    
teams$teamBAL    0.19463    0.09633   2.020  0.04551 *  
teams$teamBUF    0.15167    0.10144   1.495  0.13744    
teams$teamCAR    0.02957    0.09388   0.315  0.75331    
teams$teamCHI    0.17470    0.09405   1.858  0.06562 .  
teams$teamCIN    0.12409    0.09397   1.321  0.18910    
teams$teamCLE    0.17261    0.09431   1.830  0.06962 .  
teams$teamDAL    0.08958    0.09538   0.939  0.34952    
teams$teamDEN    0.10305    0.09386   1.098  0.27441    
teams$teamDET    0.07868    0.09397   0.837  0.40410    
teams$teamGB     0.06812    0.09650   0.706  0.48159    
teams$teamHOU    0.07793    0.09387   0.830  0.40802    
teams$teamIND    0.17593    0.09446   1.862  0.06493 .  
teams$teamJAX    0.03949    0.09414   0.419  0.67562    
teams$teamKC     0.15497    0.10636   1.457  0.14765    
teams$teamLAC    0.14119    0.09464   1.492  0.13827    
teams$teamLAR    0.18399    0.09600   1.916  0.05763 .  
teams$teamLVR    0.07405    0.09395   0.788  0.43207    
teams$teamMIA    0.11852    0.09433   1.256  0.21133    
teams$teamMIN    0.28559    0.09520   3.000  0.00327 ** 
teams$teamNE     0.08791    0.10075   0.873  0.38458    
teams$teamNO     0.01032    0.09674   0.107  0.91522    
teams$teamNYG    0.09764    0.09389   1.040  0.30043    
teams$teamNYJ    0.06975    0.09413   0.741  0.46009    
teams$teamPHI    0.26264    0.09486   2.769  0.00650 ** 
teams$teamPIT    0.02303    0.09547   0.241  0.80977    
teams$teamSEA    0.19750    0.09550   2.068  0.04072 *  
teams$teamSF     0.07878    0.09517   0.828  0.40936    
teams$teamTB     0.18519    0.10004   1.851  0.06656 .  
teams$teamTEN    0.01980    0.09548   0.207  0.83605    
teams$teamWAS    0.09817    0.09387   1.046  0.29772    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1484 on 123 degrees of freedom
  (4 observations deleted due to missingness)
Multiple R-squared:  0.5417,    Adjusted R-squared:  0.4225 
F-statistic: 4.543 on 32 and 123 DF,  p-value: 5.815e-10</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>regTotalTeam <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_total <span class="sc">~</span> teams<span class="sc">$</span>win_ratio <span class="sc">+</span> teams<span class="sc">$</span>team)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regTotalTeam))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = teams$ratio_corr_total ~ teams$win_ratio + teams$team)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.258170 -0.066978 -0.001225  0.071344  0.231886 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)      0.611871   0.055371  11.050  &lt; 2e-16 ***
teams$win_ratio -0.077729   0.064578  -1.204  0.23096    
teams$teamATL    0.062538   0.070497   0.887  0.37670    
teams$teamBAL    0.089987   0.072278   1.245  0.21542    
teams$teamBUF    0.155729   0.072445   2.150  0.03348 *  
teams$teamCAR   -0.057909   0.070500  -0.821  0.41295    
teams$teamCHI    0.159921   0.070624   2.264  0.02525 *  
teams$teamCIN    0.135756   0.070566   1.924  0.05661 .  
teams$teamCLE    0.077827   0.070812   1.099  0.27382    
teams$teamDAL    0.037130   0.071593   0.519  0.60492    
teams$teamDEN    0.027621   0.070490   0.392  0.69583    
teams$teamDET    0.096159   0.070570   1.363  0.17542    
teams$teamGB     0.079802   0.072405   1.102  0.27248    
teams$teamHOU    0.102134   0.070494   1.449  0.14984    
teams$teamIND    0.073257   0.070925   1.033  0.30362    
teams$teamJAX    0.036101   0.070692   0.511  0.61046    
teams$teamKC     0.209051   0.075236   2.779  0.00629 ** 
teams$teamLAC    0.037932   0.071050   0.534  0.59436    
teams$teamLAR    0.128579   0.072042   1.785  0.07668 .  
teams$teamLVR    0.015484   0.070551   0.219  0.82663    
teams$teamMIA    0.086864   0.070829   1.226  0.22232    
teams$teamMIN    0.156510   0.071457   2.190  0.03033 *  
teams$teamNE     0.133633   0.071755   1.862  0.06486 .  
teams$teamNO     0.069993   0.072578   0.964  0.33669    
teams$teamNYG    0.113411   0.070512   1.608  0.11023    
teams$teamNYJ    0.093907   0.070685   1.329  0.18638    
teams$teamPHI    0.107276   0.071213   1.506  0.13445    
teams$teamPIT   -0.009167   0.071656  -0.128  0.89841    
teams$teamSEA    0.055007   0.071675   0.767  0.44423    
teams$teamSF     0.050447   0.071435   0.706  0.48136    
teams$teamTB     0.115514   0.071269   1.621  0.10754    
teams$teamTEN   -0.013591   0.071662  -0.190  0.84988    
teams$teamWAS    0.092685   0.070497   1.315  0.19096    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1115 on 127 degrees of freedom
Multiple R-squared:  0.2389,    Adjusted R-squared:  0.04718 
F-statistic: 1.246 on 32 and 127 DF,  p-value: 0.196</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>regCorrFavplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_favored)) <span class="sc">+</span>     </span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span>   </span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>)</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>regCorrFavplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_favored)) <span class="sc">+</span>     </span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span> </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>schedule_season)</span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>regCorrFavplot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_favored)) <span class="sc">+</span>     </span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span> </span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>team)</span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>regCorrUnplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_unfavored)) <span class="sc">+</span>     </span>
<span id="cb40-20"><a href="#cb40-20" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span>   </span>
<span id="cb40-21"><a href="#cb40-21" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb40-22"><a href="#cb40-22" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb40-23"><a href="#cb40-23" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>)</span>
<span id="cb40-24"><a href="#cb40-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-25"><a href="#cb40-25" aria-hidden="true" tabindex="-1"></a>regCorrUnplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_unfavored)) <span class="sc">+</span>     </span>
<span id="cb40-26"><a href="#cb40-26" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span> </span>
<span id="cb40-27"><a href="#cb40-27" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb40-28"><a href="#cb40-28" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb40-29"><a href="#cb40-29" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>schedule_season)</span>
<span id="cb40-30"><a href="#cb40-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-31"><a href="#cb40-31" aria-hidden="true" tabindex="-1"></a>regTotalplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_total)) <span class="sc">+</span>     </span>
<span id="cb40-32"><a href="#cb40-32" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span> </span>
<span id="cb40-33"><a href="#cb40-33" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb40-34"><a href="#cb40-34" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb40-35"><a href="#cb40-35" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>schedule_season)</span>
<span id="cb40-36"><a href="#cb40-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-37"><a href="#cb40-37" aria-hidden="true" tabindex="-1"></a>regTotalplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_total)) <span class="sc">+</span>     </span>
<span id="cb40-38"><a href="#cb40-38" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span> </span>
<span id="cb40-39"><a href="#cb40-39" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb40-40"><a href="#cb40-40" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb40-41"><a href="#cb40-41" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>team)</span>
<span id="cb40-42"><a href="#cb40-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-43"><a href="#cb40-43" aria-hidden="true" tabindex="-1"></a>regCorrFavplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite values (`stat_smooth()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>regCorrFavplot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite values (`stat_smooth()`).
Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>regCorrFavplot3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite values (`stat_smooth()`).
Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>regCorrUnplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite values (`stat_smooth()`).
Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>regCorrUnplot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 4 rows containing non-finite values (`stat_smooth()`).
Removed 4 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>regTotalplot</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-6.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>regTotalplot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-10-7.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>After looking through the regression models and diagnostics, the best performing model I found is (teams<span class="math inline">\(ratio_corr_favored ~ teams\)</span>win_ratio). It makes sense that this model is well-performing because if you are a team with a high win_ratio across multiple years, you will inherently be favored more often and correctly favored more often. Looking at the regression lines by team is helpful for determining which teams are performing the best in the league, but ultimately that regression is not helpful as a general regression tool as it ultimately just shows the team with the highest win_ratio.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(regFavoredTeam)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-11-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-11-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="FinalPart2_LTucksmith_files/figure-html/unnamed-chunk-11-4.png" class="img-fluid" width="672"></p>
</div>
</div>


<!-- -->


</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/603_Spring_2023" data-repo-id="R_kgDOI4oXIA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb54" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "FinalPart2"</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Liam Tucksmith"</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="an">desription:</span><span class="co"> "FinalPart2"</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "05/02/2023"</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb54-12"><a href="#cb54-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb54-13"><a href="#cb54-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - finalpart2</span></span>
<span id="cb54-14"><a href="#cb54-14" aria-hidden="true" tabindex="-1"></a><span class="co">  - Liam Tucksmith</span></span>
<span id="cb54-15"><a href="#cb54-15" aria-hidden="true" tabindex="-1"></a><span class="co">  - tidyverse</span></span>
<span id="cb54-16"><a href="#cb54-16" aria-hidden="true" tabindex="-1"></a><span class="co">  - readxl</span></span>
<span id="cb54-17"><a href="#cb54-17" aria-hidden="true" tabindex="-1"></a><span class="co">  - ggplot2</span></span>
<span id="cb54-18"><a href="#cb54-18" aria-hidden="true" tabindex="-1"></a><span class="co">  - dplyr</span></span>
<span id="cb54-19"><a href="#cb54-19" aria-hidden="true" tabindex="-1"></a><span class="co">  - tidyr</span></span>
<span id="cb54-20"><a href="#cb54-20" aria-hidden="true" tabindex="-1"></a><span class="co">  - janitor</span></span>
<span id="cb54-21"><a href="#cb54-21" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb54-22"><a href="#cb54-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-23"><a href="#cb54-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb54-24"><a href="#cb54-24" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: setup</span></span>
<span id="cb54-25"><a href="#cb54-25" aria-hidden="true" tabindex="-1"></a><span class="co">#| warning: false</span></span>
<span id="cb54-26"><a href="#cb54-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb54-27"><a href="#cb54-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb54-28"><a href="#cb54-28" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb54-29"><a href="#cb54-29" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb54-30"><a href="#cb54-30" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb54-31"><a href="#cb54-31" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(janitor)</span>
<span id="cb54-32"><a href="#cb54-32" aria-hidden="true" tabindex="-1"></a>knitr<span class="sc">::</span>opts_chunk<span class="sc">$</span><span class="fu">set</span>(<span class="at">echo =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-33"><a href="#cb54-33" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-34"><a href="#cb54-34" aria-hidden="true" tabindex="-1"></a>Note: I slightly changed my final project to be looking at sports betting rather than media. The media portion was too ambitious so I pivoted to something more straightforward. Please let me know if that is an issue. </span>
<span id="cb54-35"><a href="#cb54-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-36"><a href="#cb54-36" aria-hidden="true" tabindex="-1"></a>The most profitable sports league in the world, the National Football League, generated $18 billion in revenue in 2021 according to sportico.com. This total represents national media rights, league sponsorships with gambling companies, news outlets, and other companies, and shared revenue and royalties from the league’s various affiliates and subsidiaries, such as NFL Enterprises, NFL Properties, and NFL International. Sports betting, an industry linked to the NFL, generated $7.5 in revenue in 2021. As money is what keeps the NFL afloat and allows teams to competitively pay for top players and coaches, NFL teams benefit from sports betting engagement and vice versa. What I plan to analyze how the win-rate of a team relates to the ratio of correct money line predictions for that team, season by season. My hypothesis is that teams with higher win ratios will have higher correct money-line prediction ratios, both when they are favored, not favored, and in total. </span>
<span id="cb54-37"><a href="#cb54-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-38"><a href="#cb54-38" aria-hidden="true" tabindex="-1"></a>The first dataset is a collection of all the matchups and scores that occurred in the NFL since 1966. The matchup information includes the names of the two teams competing, home/away team status, the match site, the weather on game day, and the final score for each team. Sports betting data for each game since 1977 is also included, and includes who was favored (money line), the point spread (point differential), and the over/under line. The dataset is from https://www.kaggle.com/datasets/tobycrabtree/nfl-scores-and-betting-data and was created from a variety of sources including games and scores from public websites such as ESPN, NFL.com, and Pro Football Reference. Weather information is from NOAA data, cross-referenced with NFLweather.com. Betting data reflects lines available at sportsline.com and aussportsbetting.com. For the analysis, I will limit the data to the data collected from the previous 5 years. </span>
<span id="cb54-39"><a href="#cb54-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-40"><a href="#cb54-40" aria-hidden="true" tabindex="-1"></a>Data import and clean-up</span>
<span id="cb54-43"><a href="#cb54-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-44"><a href="#cb54-44" aria-hidden="true" tabindex="-1"></a><span class="co">#read in data</span></span>
<span id="cb54-45"><a href="#cb54-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-46"><a href="#cb54-46" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"~/Documents/GitHub/603_Spring_2023/posts/_data/spreadspoke_scores.csv"</span>)</span>
<span id="cb54-47"><a href="#cb54-47" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(scores)</span>
<span id="cb54-48"><a href="#cb54-48" aria-hidden="true" tabindex="-1"></a>scores <span class="ot">&lt;-</span> scores[scores<span class="sc">$</span>schedule_season <span class="sc">&gt;=</span> <span class="dv">2018</span>, ]</span>
<span id="cb54-49"><a href="#cb54-49" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(scores)</span>
<span id="cb54-50"><a href="#cb54-50" aria-hidden="true" tabindex="-1"></a><span class="fu">glimpse</span>(scores)</span>
<span id="cb54-51"><a href="#cb54-51" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-52"><a href="#cb54-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-53"><a href="#cb54-53" aria-hidden="true" tabindex="-1"></a>Data cleanup and descriptive analytics</span>
<span id="cb54-56"><a href="#cb54-56" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-57"><a href="#cb54-57" aria-hidden="true" tabindex="-1"></a><span class="co">#map team names to abbreviations</span></span>
<span id="cb54-58"><a href="#cb54-58" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(scores<span class="sc">$</span>team_home)</span>
<span id="cb54-59"><a href="#cb54-59" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(scores<span class="sc">$</span>team_favorite_id)</span>
<span id="cb54-60"><a href="#cb54-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-61"><a href="#cb54-61" aria-hidden="true" tabindex="-1"></a><span class="co">#rewrite team_home and team_away to use IDs</span></span>
<span id="cb54-62"><a href="#cb54-62" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Philadelphia Eagles"</span>] <span class="ot">&lt;-</span> <span class="st">"PHI"</span></span>
<span id="cb54-63"><a href="#cb54-63" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Arizona Cardinals"</span>] <span class="ot">&lt;-</span> <span class="st">"ARI"</span></span>
<span id="cb54-64"><a href="#cb54-64" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Baltimore Ravens"</span>] <span class="ot">&lt;-</span> <span class="st">"BAL"</span></span>
<span id="cb54-65"><a href="#cb54-65" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Carolina Panthers"</span>] <span class="ot">&lt;-</span> <span class="st">"CAR"</span></span>
<span id="cb54-66"><a href="#cb54-66" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Cleveland Browns"</span>] <span class="ot">&lt;-</span> <span class="st">"CLE"</span></span>
<span id="cb54-67"><a href="#cb54-67" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Denver Broncos"</span>] <span class="ot">&lt;-</span> <span class="st">"DEN"</span></span>
<span id="cb54-68"><a href="#cb54-68" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Green Bay Packers"</span>] <span class="ot">&lt;-</span> <span class="st">"GB"</span></span>
<span id="cb54-69"><a href="#cb54-69" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Indianapolis Colts"</span>] <span class="ot">&lt;-</span> <span class="st">"IND"</span></span>
<span id="cb54-70"><a href="#cb54-70" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Los Angeles Chargers"</span>] <span class="ot">&lt;-</span> <span class="st">"LAC"</span></span>
<span id="cb54-71"><a href="#cb54-71" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Miami Dolphins"</span>] <span class="ot">&lt;-</span> <span class="st">"MIA"</span></span>
<span id="cb54-72"><a href="#cb54-72" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Minnesota Vikings"</span>] <span class="ot">&lt;-</span> <span class="st">"MIN"</span></span>
<span id="cb54-73"><a href="#cb54-73" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"New England Patriots"</span>] <span class="ot">&lt;-</span> <span class="st">"NE"</span></span>
<span id="cb54-74"><a href="#cb54-74" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"New Orleans Saints"</span>] <span class="ot">&lt;-</span> <span class="st">"NO"</span></span>
<span id="cb54-75"><a href="#cb54-75" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"New York Giants"</span>] <span class="ot">&lt;-</span> <span class="st">"NYG"</span></span>
<span id="cb54-76"><a href="#cb54-76" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Detroit Lions"</span>] <span class="ot">&lt;-</span> <span class="st">"DET"</span></span>
<span id="cb54-77"><a href="#cb54-77" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Oakland Raiders"</span> <span class="sc">|</span> </span>
<span id="cb54-78"><a href="#cb54-78" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Las Vegas Raiders"</span>] <span class="ot">&lt;-</span> <span class="st">"LVR"</span></span>
<span id="cb54-79"><a href="#cb54-79" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Cincinnati Bengals"</span>] <span class="ot">&lt;-</span> <span class="st">"CIN"</span></span>
<span id="cb54-80"><a href="#cb54-80" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Atlanta Falcons"</span>] <span class="ot">&lt;-</span> <span class="st">"ATL"</span></span>
<span id="cb54-81"><a href="#cb54-81" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Buffalo Bills"</span>] <span class="ot">&lt;-</span> <span class="st">"BUF"</span></span>
<span id="cb54-82"><a href="#cb54-82" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Dallas Cowboys"</span>] <span class="ot">&lt;-</span> <span class="st">"DAL"</span></span>
<span id="cb54-83"><a href="#cb54-83" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Jacksonville Jaguars"</span>] <span class="ot">&lt;-</span> <span class="st">"JAX"</span></span>
<span id="cb54-84"><a href="#cb54-84" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Los Angeles Rams"</span>] <span class="ot">&lt;-</span> <span class="st">"LAR"</span></span>
<span id="cb54-85"><a href="#cb54-85" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"New York Jets"</span>] <span class="ot">&lt;-</span> <span class="st">"NYJ"</span></span>
<span id="cb54-86"><a href="#cb54-86" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Pittsburgh Steelers"</span>] <span class="ot">&lt;-</span> <span class="st">"PIT"</span></span>
<span id="cb54-87"><a href="#cb54-87" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"San Francisco 49ers"</span>] <span class="ot">&lt;-</span> <span class="st">"SF"</span></span>
<span id="cb54-88"><a href="#cb54-88" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Tampa Bay Buccaneers"</span>] <span class="ot">&lt;-</span> <span class="st">"TB"</span></span>
<span id="cb54-89"><a href="#cb54-89" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Tennessee Titans"</span>] <span class="ot">&lt;-</span> <span class="st">"TEN"</span></span>
<span id="cb54-90"><a href="#cb54-90" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Washington Redskins"</span> <span class="sc">|</span> </span>
<span id="cb54-91"><a href="#cb54-91" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Washington Football Team"</span><span class="sc">|</span></span>
<span id="cb54-92"><a href="#cb54-92" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Washington Commanders"</span>] <span class="ot">&lt;-</span> <span class="st">"WAS"</span></span>
<span id="cb54-93"><a href="#cb54-93" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Chicago Bears"</span>] <span class="ot">&lt;-</span> <span class="st">"CHI"</span></span>
<span id="cb54-94"><a href="#cb54-94" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Houston Texans"</span>] <span class="ot">&lt;-</span> <span class="st">"HOU"</span></span>
<span id="cb54-95"><a href="#cb54-95" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Kansas City Chiefs"</span>] <span class="ot">&lt;-</span> <span class="st">"KC"</span></span>
<span id="cb54-96"><a href="#cb54-96" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_home[scores<span class="sc">$</span>team_home<span class="sc">==</span><span class="st">"Seattle Seahawks"</span>] <span class="ot">&lt;-</span> <span class="st">"SEA"</span></span>
<span id="cb54-97"><a href="#cb54-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-98"><a href="#cb54-98" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Philadelphia Eagles"</span>] <span class="ot">&lt;-</span> <span class="st">"PHI"</span></span>
<span id="cb54-99"><a href="#cb54-99" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Arizona Cardinals"</span>] <span class="ot">&lt;-</span> <span class="st">"ARI"</span></span>
<span id="cb54-100"><a href="#cb54-100" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Baltimore Ravens"</span>] <span class="ot">&lt;-</span> <span class="st">"BAL"</span></span>
<span id="cb54-101"><a href="#cb54-101" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Carolina Panthers"</span>] <span class="ot">&lt;-</span> <span class="st">"CAR"</span></span>
<span id="cb54-102"><a href="#cb54-102" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Cleveland Browns"</span>] <span class="ot">&lt;-</span> <span class="st">"CLE"</span></span>
<span id="cb54-103"><a href="#cb54-103" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Denver Broncos"</span>] <span class="ot">&lt;-</span> <span class="st">"DEN"</span></span>
<span id="cb54-104"><a href="#cb54-104" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Green Bay Packers"</span>] <span class="ot">&lt;-</span> <span class="st">"GB"</span></span>
<span id="cb54-105"><a href="#cb54-105" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Indianapolis Colts"</span>] <span class="ot">&lt;-</span> <span class="st">"IND"</span></span>
<span id="cb54-106"><a href="#cb54-106" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Los Angeles Chargers"</span>] <span class="ot">&lt;-</span> <span class="st">"LAC"</span></span>
<span id="cb54-107"><a href="#cb54-107" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Miami Dolphins"</span>] <span class="ot">&lt;-</span> <span class="st">"MIA"</span></span>
<span id="cb54-108"><a href="#cb54-108" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Minnesota Vikings"</span>] <span class="ot">&lt;-</span> <span class="st">"MIN"</span></span>
<span id="cb54-109"><a href="#cb54-109" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"New England Patriots"</span>] <span class="ot">&lt;-</span> <span class="st">"NE"</span></span>
<span id="cb54-110"><a href="#cb54-110" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"New Orleans Saints"</span>] <span class="ot">&lt;-</span> <span class="st">"NO"</span></span>
<span id="cb54-111"><a href="#cb54-111" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"New York Giants"</span>] <span class="ot">&lt;-</span> <span class="st">"NYG"</span></span>
<span id="cb54-112"><a href="#cb54-112" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Detroit Lions"</span>] <span class="ot">&lt;-</span> <span class="st">"DET"</span></span>
<span id="cb54-113"><a href="#cb54-113" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Oakland Raiders"</span> <span class="sc">|</span> </span>
<span id="cb54-114"><a href="#cb54-114" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Las Vegas Raiders"</span>] <span class="ot">&lt;-</span> <span class="st">"LVR"</span></span>
<span id="cb54-115"><a href="#cb54-115" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Cincinnati Bengals"</span>] <span class="ot">&lt;-</span> <span class="st">"CIN"</span></span>
<span id="cb54-116"><a href="#cb54-116" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Atlanta Falcons"</span>] <span class="ot">&lt;-</span> <span class="st">"ATL"</span></span>
<span id="cb54-117"><a href="#cb54-117" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Buffalo Bills"</span>] <span class="ot">&lt;-</span> <span class="st">"BUF"</span></span>
<span id="cb54-118"><a href="#cb54-118" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Dallas Cowboys"</span>] <span class="ot">&lt;-</span> <span class="st">"DAL"</span></span>
<span id="cb54-119"><a href="#cb54-119" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Jacksonville Jaguars"</span>] <span class="ot">&lt;-</span> <span class="st">"JAX"</span></span>
<span id="cb54-120"><a href="#cb54-120" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Los Angeles Rams"</span>] <span class="ot">&lt;-</span> <span class="st">"LAR"</span></span>
<span id="cb54-121"><a href="#cb54-121" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"New York Jets"</span>] <span class="ot">&lt;-</span> <span class="st">"NYJ"</span></span>
<span id="cb54-122"><a href="#cb54-122" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Pittsburgh Steelers"</span>] <span class="ot">&lt;-</span> <span class="st">"PIT"</span></span>
<span id="cb54-123"><a href="#cb54-123" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"San Francisco 49ers"</span>] <span class="ot">&lt;-</span> <span class="st">"SF"</span></span>
<span id="cb54-124"><a href="#cb54-124" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Tampa Bay Buccaneers"</span>] <span class="ot">&lt;-</span> <span class="st">"TB"</span></span>
<span id="cb54-125"><a href="#cb54-125" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Tennessee Titans"</span>] <span class="ot">&lt;-</span> <span class="st">"TEN"</span></span>
<span id="cb54-126"><a href="#cb54-126" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Washington Redskins"</span> <span class="sc">|</span> </span>
<span id="cb54-127"><a href="#cb54-127" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Washington Football Team"</span><span class="sc">|</span></span>
<span id="cb54-128"><a href="#cb54-128" aria-hidden="true" tabindex="-1"></a>                 scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Washington Commanders"</span>] <span class="ot">&lt;-</span> <span class="st">"WAS"</span></span>
<span id="cb54-129"><a href="#cb54-129" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Chicago Bears"</span>] <span class="ot">&lt;-</span> <span class="st">"CHI"</span></span>
<span id="cb54-130"><a href="#cb54-130" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Houston Texans"</span>] <span class="ot">&lt;-</span> <span class="st">"HOU"</span></span>
<span id="cb54-131"><a href="#cb54-131" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Kansas City Chiefs"</span>] <span class="ot">&lt;-</span> <span class="st">"KC"</span></span>
<span id="cb54-132"><a href="#cb54-132" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>team_away[scores<span class="sc">$</span>team_away<span class="sc">==</span><span class="st">"Seattle Seahawks"</span>] <span class="ot">&lt;-</span> <span class="st">"SEA"</span></span>
<span id="cb54-133"><a href="#cb54-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-134"><a href="#cb54-134" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(scores<span class="sc">$</span>team_home)</span>
<span id="cb54-135"><a href="#cb54-135" aria-hidden="true" tabindex="-1"></a><span class="fu">n_distinct</span>(scores<span class="sc">$</span>team_home)</span>
<span id="cb54-136"><a href="#cb54-136" aria-hidden="true" tabindex="-1"></a><span class="fu">unique</span>(scores<span class="sc">$</span>team_away)</span>
<span id="cb54-137"><a href="#cb54-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-138"><a href="#cb54-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-141"><a href="#cb54-141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-142"><a href="#cb54-142" aria-hidden="true" tabindex="-1"></a><span class="co">#add column for game winner</span></span>
<span id="cb54-143"><a href="#cb54-143" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>score_home <span class="ot">=</span> <span class="fu">as.integer</span>(scores<span class="sc">$</span>score_home)</span>
<span id="cb54-144"><a href="#cb54-144" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>score_away <span class="ot">=</span> <span class="fu">as.integer</span>(scores<span class="sc">$</span>score_away)</span>
<span id="cb54-145"><a href="#cb54-145" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-146"><a href="#cb54-146" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>winner <span class="ot">=</span> <span class="fu">ifelse</span>(scores<span class="sc">$</span>score_home <span class="sc">==</span> scores<span class="sc">$</span>score_away, <span class="st">"TIE"</span>, <span class="fu">ifelse</span>(scores<span class="sc">$</span>score_home <span class="sc">&gt;</span> scores<span class="sc">$</span>score_away, scores<span class="sc">$</span>team_home, scores<span class="sc">$</span>team_away))</span>
<span id="cb54-147"><a href="#cb54-147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-148"><a href="#cb54-148" aria-hidden="true" tabindex="-1"></a><span class="co">#add column for if money line prediction is true</span></span>
<span id="cb54-149"><a href="#cb54-149" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>mlTF <span class="ot">=</span> <span class="fu">ifelse</span>(scores<span class="sc">$</span>winner <span class="sc">==</span> scores<span class="sc">$</span>team_favorite_id, <span class="cn">TRUE</span>, <span class="cn">FALSE</span>)</span>
<span id="cb54-150"><a href="#cb54-150" aria-hidden="true" tabindex="-1"></a>scores<span class="sc">$</span>mlHomeAway <span class="ot">=</span> <span class="fu">ifelse</span>(scores<span class="sc">$</span>team_home <span class="sc">==</span> scores<span class="sc">$</span>team_favorite_id, <span class="st">"Home"</span>, <span class="st">"Away"</span>)</span>
<span id="cb54-151"><a href="#cb54-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-152"><a href="#cb54-152" aria-hidden="true" tabindex="-1"></a><span class="co">#get counts for wins and losses, correct and incorrect moneyline predictions when favored and not favored, for away and home games</span></span>
<span id="cb54-153"><a href="#cb54-153" aria-hidden="true" tabindex="-1"></a>home_team <span class="ot">&lt;-</span> scores <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(team_home, schedule_season) <span class="sc">%&gt;%</span> </span>
<span id="cb54-154"><a href="#cb54-154" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">summarise</span>(<span class="at">home_wins =</span> <span class="fu">sum</span>(team_home <span class="sc">==</span> winner),</span>
<span id="cb54-155"><a href="#cb54-155" aria-hidden="true" tabindex="-1"></a>                            <span class="at">home_losses =</span> <span class="fu">sum</span>(team_away <span class="sc">==</span> winner),</span>
<span id="cb54-156"><a href="#cb54-156" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_incorr_favored_h =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Home"</span>),</span>
<span id="cb54-157"><a href="#cb54-157" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_incorr_unfavored_h =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Away"</span>),</span>
<span id="cb54-158"><a href="#cb54-158" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_corr_favored_h =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Home"</span>),</span>
<span id="cb54-159"><a href="#cb54-159" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_corr_unfavored_h =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Away"</span>),</span>
<span id="cb54-160"><a href="#cb54-160" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb54-161"><a href="#cb54-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-162"><a href="#cb54-162" aria-hidden="true" tabindex="-1"></a>away_team <span class="ot">&lt;-</span> scores <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(team_away, schedule_season) <span class="sc">%&gt;%</span> </span>
<span id="cb54-163"><a href="#cb54-163" aria-hidden="true" tabindex="-1"></a>                  <span class="fu">summarise</span>(<span class="at">away_wins =</span> <span class="fu">sum</span>(team_away <span class="sc">==</span> winner),</span>
<span id="cb54-164"><a href="#cb54-164" aria-hidden="true" tabindex="-1"></a>                            <span class="at">away_losses =</span> <span class="fu">sum</span>(team_home <span class="sc">==</span> winner),</span>
<span id="cb54-165"><a href="#cb54-165" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_incorr_favored_a =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Away"</span>),</span>
<span id="cb54-166"><a href="#cb54-166" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_incorr_unfavored_a =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">FALSE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Home"</span>),</span>
<span id="cb54-167"><a href="#cb54-167" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_corr_favored_a =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Away"</span>),</span>
<span id="cb54-168"><a href="#cb54-168" aria-hidden="true" tabindex="-1"></a>                            <span class="at">ml_corr_unfavored_a =</span> <span class="fu">sum</span>(mlTF <span class="sc">==</span> <span class="cn">TRUE</span> <span class="sc">&amp;</span> mlHomeAway <span class="sc">==</span> <span class="st">"Home"</span>),</span>
<span id="cb54-169"><a href="#cb54-169" aria-hidden="true" tabindex="-1"></a>                            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb54-170"><a href="#cb54-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-171"><a href="#cb54-171" aria-hidden="true" tabindex="-1"></a><span class="co">#merge home and away data</span></span>
<span id="cb54-172"><a href="#cb54-172" aria-hidden="true" tabindex="-1"></a>teams <span class="ot">&lt;-</span> <span class="fu">merge</span>(home_team, away_team, </span>
<span id="cb54-173"><a href="#cb54-173" aria-hidden="true" tabindex="-1"></a>               <span class="at">by.x =</span> <span class="fu">c</span>(<span class="st">"team_home"</span>,<span class="st">"schedule_season"</span>), </span>
<span id="cb54-174"><a href="#cb54-174" aria-hidden="true" tabindex="-1"></a>               <span class="at">by.y =</span> <span class="fu">c</span>(<span class="st">"team_away"</span>,<span class="st">"schedule_season"</span>))</span>
<span id="cb54-175"><a href="#cb54-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-176"><a href="#cb54-176" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(teams)</span>
<span id="cb54-177"><a href="#cb54-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-178"><a href="#cb54-178" aria-hidden="true" tabindex="-1"></a>teams <span class="ot">&lt;-</span> teams <span class="sc">%&gt;%</span> </span>
<span id="cb54-179"><a href="#cb54-179" aria-hidden="true" tabindex="-1"></a>       <span class="fu">rename</span>(<span class="st">"team"</span> <span class="ot">=</span> <span class="st">"team_home"</span>)</span>
<span id="cb54-180"><a href="#cb54-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-181"><a href="#cb54-181" aria-hidden="true" tabindex="-1"></a><span class="co">#combine home and away fields </span></span>
<span id="cb54-182"><a href="#cb54-182" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>total_wins <span class="ot">&lt;-</span> teams<span class="sc">$</span>home_wins <span class="sc">+</span> teams<span class="sc">$</span>away_wins</span>
<span id="cb54-183"><a href="#cb54-183" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>total_losses <span class="ot">&lt;-</span> teams<span class="sc">$</span>home_losses <span class="sc">+</span> teams<span class="sc">$</span>away_losses</span>
<span id="cb54-184"><a href="#cb54-184" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>total_home_games <span class="ot">&lt;-</span> teams<span class="sc">$</span>home_wins <span class="sc">+</span> teams<span class="sc">$</span>home_losses</span>
<span id="cb54-185"><a href="#cb54-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-186"><a href="#cb54-186" aria-hidden="true" tabindex="-1"></a><span class="co">#combine favored and unfavored, correct and incorrect data</span></span>
<span id="cb54-187"><a href="#cb54-187" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_corr_favored <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_corr_favored_h <span class="sc">+</span> teams<span class="sc">$</span>ml_corr_favored_a </span>
<span id="cb54-188"><a href="#cb54-188" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_corr_unfavored <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_corr_unfavored_h <span class="sc">+</span> teams<span class="sc">$</span>ml_corr_unfavored_a</span>
<span id="cb54-189"><a href="#cb54-189" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_corr_total <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_corr_favored <span class="sc">+</span> teams<span class="sc">$</span>ml_corr_unfavored </span>
<span id="cb54-190"><a href="#cb54-190" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_incorr_favored <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_incorr_favored_h <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_favored_a</span>
<span id="cb54-191"><a href="#cb54-191" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_incorr_unfavored <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_incorr_unfavored_h <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_unfavored_a</span>
<span id="cb54-192"><a href="#cb54-192" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ml_incorr_total <span class="ot">&lt;-</span> teams<span class="sc">$</span>ml_incorr_favored <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_unfavored </span>
<span id="cb54-193"><a href="#cb54-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-194"><a href="#cb54-194" aria-hidden="true" tabindex="-1"></a><span class="co">#calculate win, correct, uncorrect, and total money line predictions</span></span>
<span id="cb54-195"><a href="#cb54-195" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>win_ratio <span class="ot">=</span> teams<span class="sc">$</span>total_wins<span class="sc">/</span>(teams<span class="sc">$</span>total_wins <span class="sc">+</span> teams<span class="sc">$</span>total_losses)</span>
<span id="cb54-196"><a href="#cb54-196" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ratio_corr_favored <span class="ot">=</span> teams<span class="sc">$</span>ml_corr_favored<span class="sc">/</span>(teams<span class="sc">$</span>ml_corr_favored <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_favored)</span>
<span id="cb54-197"><a href="#cb54-197" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ratio_corr_unfavored <span class="ot">=</span> teams<span class="sc">$</span>ml_corr_unfavored<span class="sc">/</span>(teams<span class="sc">$</span>ml_corr_unfavored <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_unfavored)</span>
<span id="cb54-198"><a href="#cb54-198" aria-hidden="true" tabindex="-1"></a>teams<span class="sc">$</span>ratio_corr_total <span class="ot">=</span> teams<span class="sc">$</span>ml_corr_total<span class="sc">/</span>(teams<span class="sc">$</span>ml_corr_total <span class="sc">+</span> teams<span class="sc">$</span>ml_incorr_total)</span>
<span id="cb54-199"><a href="#cb54-199" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-202"><a href="#cb54-202" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-203"><a href="#cb54-203" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(teams, <span class="dv">50</span>)</span>
<span id="cb54-204"><a href="#cb54-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-205"><a href="#cb54-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-208"><a href="#cb54-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-209"><a href="#cb54-209" aria-hidden="true" tabindex="-1"></a><span class="co">#plot correct and incorrect moneyline prediction ratio for each team by season</span></span>
<span id="cb54-210"><a href="#cb54-210" aria-hidden="true" tabindex="-1"></a>agg_tbl <span class="ot">&lt;-</span> teams <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(team, schedule_season) <span class="sc">%&gt;%</span> </span>
<span id="cb54-211"><a href="#cb54-211" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">corr_ratio =</span> (<span class="fu">sum</span>(ml_corr_total)<span class="sc">/</span>(<span class="fu">sum</span>(ml_corr_total <span class="sc">+</span> ml_incorr_total))),</span>
<span id="cb54-212"><a href="#cb54-212" aria-hidden="true" tabindex="-1"></a>            <span class="at">incorr_ratio =</span> (<span class="fu">sum</span>(ml_incorr_total)<span class="sc">/</span>(<span class="fu">sum</span>(ml_corr_total <span class="sc">+</span> ml_incorr_total))),</span>
<span id="cb54-213"><a href="#cb54-213" aria-hidden="true" tabindex="-1"></a>            <span class="at">sum =</span> <span class="fu">sum</span>(ml_corr_total <span class="sc">+</span> ml_incorr_total),</span>
<span id="cb54-214"><a href="#cb54-214" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb54-215"><a href="#cb54-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-216"><a href="#cb54-216" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agg_tbl, <span class="fu">aes</span>(<span class="fu">factor</span>(team), <span class="at">fill=</span><span class="fu">factor</span>(corr_ratio))) <span class="sc">+</span>     </span>
<span id="cb54-217"><a href="#cb54-217" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>()</span>
<span id="cb54-218"><a href="#cb54-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-219"><a href="#cb54-219" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agg_tbl, <span class="fu">aes</span>(<span class="at">x=</span>schedule_season, <span class="at">y=</span>corr_ratio)) <span class="sc">+</span>     </span>
<span id="cb54-220"><a href="#cb54-220" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb54-221"><a href="#cb54-221" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>team)</span>
<span id="cb54-222"><a href="#cb54-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-223"><a href="#cb54-223" aria-hidden="true" tabindex="-1"></a><span class="co">#plot correct moneyline prediction ratio for each team by season, facet  by team</span></span>
<span id="cb54-224"><a href="#cb54-224" aria-hidden="true" tabindex="-1"></a>agg_tbl2 <span class="ot">&lt;-</span> teams <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(team, schedule_season) <span class="sc">%&gt;%</span> </span>
<span id="cb54-225"><a href="#cb54-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ratio =</span> (<span class="fu">sum</span>(ml_corr_favored)<span class="sc">/</span>(<span class="fu">sum</span>(ml_corr_favored <span class="sc">+</span> ml_incorr_favored))),</span>
<span id="cb54-226"><a href="#cb54-226" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb54-227"><a href="#cb54-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-228"><a href="#cb54-228" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agg_tbl2, <span class="fu">aes</span>(<span class="at">x=</span>schedule_season, <span class="at">y=</span>ratio)) <span class="sc">+</span>     </span>
<span id="cb54-229"><a href="#cb54-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>() <span class="sc">+</span> </span>
<span id="cb54-230"><a href="#cb54-230" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>team)</span>
<span id="cb54-231"><a href="#cb54-231" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-234"><a href="#cb54-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-235"><a href="#cb54-235" aria-hidden="true" tabindex="-1"></a><span class="co">#plot win ratio of each team by season </span></span>
<span id="cb54-236"><a href="#cb54-236" aria-hidden="true" tabindex="-1"></a>agg_tbl3 <span class="ot">&lt;-</span> teams <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(team, schedule_season) <span class="sc">%&gt;%</span> </span>
<span id="cb54-237"><a href="#cb54-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">ratio =</span> total_wins<span class="sc">/</span>(total_wins <span class="sc">+</span> total_losses),</span>
<span id="cb54-238"><a href="#cb54-238" aria-hidden="true" tabindex="-1"></a>            <span class="at">.groups =</span> <span class="st">'drop'</span>)</span>
<span id="cb54-239"><a href="#cb54-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-240"><a href="#cb54-240" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(agg_tbl3, <span class="fu">aes</span>(<span class="at">x=</span>schedule_season, <span class="at">y=</span>ratio)) <span class="sc">+</span>     </span>
<span id="cb54-241"><a href="#cb54-241" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> <span class="fu">factor</span>(team))) </span>
<span id="cb54-242"><a href="#cb54-242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-243"><a href="#cb54-243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-246"><a href="#cb54-246" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-247"><a href="#cb54-247" aria-hidden="true" tabindex="-1"></a>regFavored <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_favored <span class="sc">~</span> teams<span class="sc">$</span>win_ratio)</span>
<span id="cb54-248"><a href="#cb54-248" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regFavored))</span>
<span id="cb54-249"><a href="#cb54-249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-250"><a href="#cb54-250" aria-hidden="true" tabindex="-1"></a>regUnfavored <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_unfavored <span class="sc">~</span> teams<span class="sc">$</span>win_ratio)</span>
<span id="cb54-251"><a href="#cb54-251" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regUnfavored))</span>
<span id="cb54-252"><a href="#cb54-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-253"><a href="#cb54-253" aria-hidden="true" tabindex="-1"></a>regTotal <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_total <span class="sc">~</span> teams<span class="sc">$</span>win_ratio)</span>
<span id="cb54-254"><a href="#cb54-254" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regTotal))</span>
<span id="cb54-255"><a href="#cb54-255" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-258"><a href="#cb54-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-259"><a href="#cb54-259" aria-hidden="true" tabindex="-1"></a>regFavoredTeam <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_favored <span class="sc">~</span> teams<span class="sc">$</span>win_ratio <span class="sc">+</span> teams<span class="sc">$</span>team)</span>
<span id="cb54-260"><a href="#cb54-260" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regFavoredTeam))</span>
<span id="cb54-261"><a href="#cb54-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-262"><a href="#cb54-262" aria-hidden="true" tabindex="-1"></a>regUnfavoredTeam <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_unfavored <span class="sc">~</span> teams<span class="sc">$</span>win_ratio <span class="sc">+</span> teams<span class="sc">$</span>team)</span>
<span id="cb54-263"><a href="#cb54-263" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regUnfavoredTeam))</span>
<span id="cb54-264"><a href="#cb54-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-265"><a href="#cb54-265" aria-hidden="true" tabindex="-1"></a>regTotalTeam <span class="ot">&lt;-</span> <span class="fu">lm</span>(teams<span class="sc">$</span>ratio_corr_total <span class="sc">~</span> teams<span class="sc">$</span>win_ratio <span class="sc">+</span> teams<span class="sc">$</span>team)</span>
<span id="cb54-266"><a href="#cb54-266" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">summary</span>(regTotalTeam))</span>
<span id="cb54-267"><a href="#cb54-267" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-270"><a href="#cb54-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-271"><a href="#cb54-271" aria-hidden="true" tabindex="-1"></a>regCorrFavplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_favored)) <span class="sc">+</span>     </span>
<span id="cb54-272"><a href="#cb54-272" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span>   </span>
<span id="cb54-273"><a href="#cb54-273" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb54-274"><a href="#cb54-274" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb54-275"><a href="#cb54-275" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>)</span>
<span id="cb54-276"><a href="#cb54-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-277"><a href="#cb54-277" aria-hidden="true" tabindex="-1"></a>regCorrFavplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_favored)) <span class="sc">+</span>     </span>
<span id="cb54-278"><a href="#cb54-278" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span> </span>
<span id="cb54-279"><a href="#cb54-279" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb54-280"><a href="#cb54-280" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb54-281"><a href="#cb54-281" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>schedule_season)</span>
<span id="cb54-282"><a href="#cb54-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-283"><a href="#cb54-283" aria-hidden="true" tabindex="-1"></a>regCorrFavplot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_favored)) <span class="sc">+</span>     </span>
<span id="cb54-284"><a href="#cb54-284" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span> </span>
<span id="cb54-285"><a href="#cb54-285" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb54-286"><a href="#cb54-286" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb54-287"><a href="#cb54-287" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>team)</span>
<span id="cb54-288"><a href="#cb54-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-289"><a href="#cb54-289" aria-hidden="true" tabindex="-1"></a>regCorrUnplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_unfavored)) <span class="sc">+</span>     </span>
<span id="cb54-290"><a href="#cb54-290" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span>   </span>
<span id="cb54-291"><a href="#cb54-291" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb54-292"><a href="#cb54-292" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb54-293"><a href="#cb54-293" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>)</span>
<span id="cb54-294"><a href="#cb54-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-295"><a href="#cb54-295" aria-hidden="true" tabindex="-1"></a>regCorrUnplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_unfavored)) <span class="sc">+</span>     </span>
<span id="cb54-296"><a href="#cb54-296" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span> </span>
<span id="cb54-297"><a href="#cb54-297" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb54-298"><a href="#cb54-298" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb54-299"><a href="#cb54-299" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>schedule_season)</span>
<span id="cb54-300"><a href="#cb54-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-301"><a href="#cb54-301" aria-hidden="true" tabindex="-1"></a>regTotalplot <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_total)) <span class="sc">+</span>     </span>
<span id="cb54-302"><a href="#cb54-302" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span> </span>
<span id="cb54-303"><a href="#cb54-303" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb54-304"><a href="#cb54-304" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb54-305"><a href="#cb54-305" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>schedule_season)</span>
<span id="cb54-306"><a href="#cb54-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-307"><a href="#cb54-307" aria-hidden="true" tabindex="-1"></a>regTotalplot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(teams, <span class="fu">aes</span>(<span class="at">x=</span>win_ratio, <span class="at">y=</span>ratio_corr_total)) <span class="sc">+</span>     </span>
<span id="cb54-308"><a href="#cb54-308" aria-hidden="true" tabindex="-1"></a>            <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">colour =</span> team)) <span class="sc">+</span> </span>
<span id="cb54-309"><a href="#cb54-309" aria-hidden="true" tabindex="-1"></a>            <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>,</span>
<span id="cb54-310"><a href="#cb54-310" aria-hidden="true" tabindex="-1"></a>                        <span class="at">formula =</span> y <span class="sc">~</span> x,</span>
<span id="cb54-311"><a href="#cb54-311" aria-hidden="true" tabindex="-1"></a>                        <span class="at">geom =</span> <span class="st">"smooth"</span>) <span class="sc">+</span> <span class="fu">facet_wrap</span>(<span class="sc">~</span>team)</span>
<span id="cb54-312"><a href="#cb54-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-313"><a href="#cb54-313" aria-hidden="true" tabindex="-1"></a>regCorrFavplot</span>
<span id="cb54-314"><a href="#cb54-314" aria-hidden="true" tabindex="-1"></a>regCorrFavplot2</span>
<span id="cb54-315"><a href="#cb54-315" aria-hidden="true" tabindex="-1"></a>regCorrFavplot3</span>
<span id="cb54-316"><a href="#cb54-316" aria-hidden="true" tabindex="-1"></a>regCorrUnplot</span>
<span id="cb54-317"><a href="#cb54-317" aria-hidden="true" tabindex="-1"></a>regCorrUnplot2</span>
<span id="cb54-318"><a href="#cb54-318" aria-hidden="true" tabindex="-1"></a>regTotalplot</span>
<span id="cb54-319"><a href="#cb54-319" aria-hidden="true" tabindex="-1"></a>regTotalplot2</span>
<span id="cb54-320"><a href="#cb54-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-321"><a href="#cb54-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-322"><a href="#cb54-322" aria-hidden="true" tabindex="-1"></a>After looking through the regression models and diagnostics, the best performing model I found is (teams$ratio_corr_favored ~ teams$win_ratio). It makes sense that this model is well-performing because if you are a team with a high win_ratio across multiple years, you will inherently be favored more often and correctly favored more often. Looking at the regression lines by team is helpful for determining which teams are performing the best in the league, but ultimately that regression is not helpful as a general regression tool as it ultimately just shows the team with the highest win_ratio. </span>
<span id="cb54-325"><a href="#cb54-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb54-326"><a href="#cb54-326" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(regFavoredTeam)</span>
<span id="cb54-327"><a href="#cb54-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb54-328"><a href="#cb54-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-329"><a href="#cb54-329" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>