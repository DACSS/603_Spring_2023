<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.353">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Caitlin Rowley">
<meta name="dcterms.date" content="2023-05-25">
<meta name="description" content="This project provides a high-level overview of the data set I will be using for my final project. The data set, titled ‘Income and Democracy,’ was published by the American Economic Consortium in 2008.">

<title>Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<meta name="twitter:title" content="Final Project">
<meta name="twitter:description" content="This project provides a high-level overview of the data set I will be using for my final project. The data set, titled ‘Income and Democracy,’ was published by the American Economic Consortium in 2008.">
<meta name="twitter:image" content="https://dacss.github.io/603_Spring_2023/posts/Rowley_Final_Project_files/figure-html/unnamed-chunk-12-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="true"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target="">
 <span class="menu-text">Spring 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#background-and-research-question" id="toc-background-and-research-question" class="nav-link active" data-scroll-target="#background-and-research-question">Background and Research Question:</a></li>
  <li><a href="#hypothesis" id="toc-hypothesis" class="nav-link" data-scroll-target="#hypothesis">Hypothesis:</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics:</a></li>
  <li><a href="#data-merge" id="toc-data-merge" class="nav-link" data-scroll-target="#data-merge">Data Merge:</a></li>
  <li><a href="#visualization" id="toc-visualization" class="nav-link" data-scroll-target="#visualization">Visualization:</a></li>
  <li><a href="#analysis" id="toc-analysis" class="nav-link" data-scroll-target="#analysis">Analysis:</a></li>
  <li><a href="#sources" id="toc-sources" class="nav-link" data-scroll-target="#sources">Sources:</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">final</div>
  </div>
  </div>

<div>
  <div class="description">
    This project provides a high-level overview of the data set I will be using for my final project. The data set, titled ‘Income and Democracy,’ was published by the American Economic Consortium in 2008.
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Caitlin Rowley </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 25, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="background-and-research-question" class="level3">
<h3 class="anchored" data-anchor-id="background-and-research-question">Background and Research Question:</h3>
<p>My research question will focus on the cross-country correlation between income and democracy. A 2008 study titled “Income and Democracy,” published in the American Economic Review, argues that existing studies that establish a strong cross-country correlation between income and democracy do not control for factors that simultaneously affect both variables. Accordingly, this study, which focuses on changes in democracy over the past 500 years, controls for certain country-fixed effects—such as date of independence, constraints on the executive, and religious affiliation—thereby voiding any causal relationship between income per capita and various measures of democracy. This study is the source for my data set.</p>
<p>The authors of “Income and Democracy” included a wide range of variables in their study; specifically, they tested the significance of constraint on the executive; year of independence; settler mortality; population density; Catholic population; Muslim population; Protestant population; shift in per capita income; and shift in democracy. As noted, the authors asserted that after controlling for all the aforementioned country-fixed effects, there is no evidence of a causal relationship between income and democracy over time. Interestingly, the study also indicated that education was determined to be statistically insignificant as an independent, country-fixed effect on the correlation between income and democracy, and it was thus excluded from the study.</p>
<p>In contrast to “Income and Democracy,” a 1999 study titled “Determinants of Democracy,” authored by Robert J. Barro, indicates that additional improvements to the standard of living do, in fact, predict an increase in democracy. Barro suggests not only that education is an indicator of the correlation between income democracy, but that the pervasiveness of select religious affiliations is, as well. Specifically, Barro claimed that the negative effects from Muslim and non‐religious affiliations remain statistically significant in this association regardless of external control factors.</p>
<p>This incongruity led me to wonder whether we would see a causal relationship between income and democracy if the economic variables used in the two studies were more aligned. Specifically, I would like to examine how this change would affect both studies’ claims on the role of religious affiliation; in other words, will adding explanatory variables related to religious affiliation—specifically, non-religious affiliation—cause a shift in the lack of correlation between income and democracy? Additionally, given “Income and Democracy’s” declaration on the statistical insignificance of education as a country-fixed effect, I am also interested in seeing whether adding an interaction term—specifically, government expenditure on education—will have an effect on this relationship.</p>
<p><strong>Research question</strong>: How will adding non-religious affiliation as an additional control variable and education as an interaction term impact the lack of causal relationship between income and democracy?</p>
</section>
<section id="hypothesis" class="level3">
<h3 class="anchored" data-anchor-id="hypothesis">Hypothesis:</h3>
<p>After reviewing “Income and Democracy,” it does not appear that non-religious affiliation was integrated into the report. Further, as the authors noted its lack of statistical significance related to its causal effect on the relationship between income democracy, neither is education. However, I am curious about how the inclusion of these two variables would affect Barro’s conclusion relative to the correlation between religious affiliation and democracy. As such, by adding these variables, I will be revisiting a previously-tested hypothesis.</p>
<p>I hypothesize that adding non-religious affiliation and education as additional control variables, and education*shift in per capita income as an interaction term will lead to increased statistical significance between income and democracy.</p>
</section>
<section id="descriptive-statistics" class="level3">
<h3 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics:</h3>
<p>Data for this study was collected from the Freedom House Political Rights Index, the Polity Composite Democracy Index, and data from other studies conducted by Barro and Kenneth A. Bollen.</p>
<p>Variables I will be focusing on include:</p>
<ul>
<li>Country;</li>
<li>Constraint on the executive;</li>
<li>Year of independence;</li>
<li>Settler mortality;</li>
<li>Population density;</li>
<li>Catholic population;</li>
<li>Muslim population;</li>
<li>Protestant population;</li>
<li>Religiously-unaffiliated population;</li>
<li>Education funding;</li>
<li>Shift in per capita income; and</li>
<li>Shift in democracy.</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries:</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'tidyverse' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.3.6      ✔ purrr   0.3.4 
✔ tibble  3.1.8      ✔ dplyr   1.0.10
✔ tidyr   1.2.1      ✔ stringr 1.4.1 
✔ readr   2.1.4      ✔ forcats 0.5.2 </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readr' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'readxl' was built under R version 4.2.2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co"># read in data file:</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>data_file <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"C:/Users/caitr/OneDrive/Documents/DACSS/DACSS 603/603_Spring_2023/posts/_data/Income-Democracy.xls"</span>, <span class="at">sheet =</span> <span class="st">"500 Year Panel"</span>)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_file)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 15
  code  country     consf…¹ indcent indyear logem4 lpd15…² madid rel_c…³ rel_m…⁴
  &lt;chr&gt; &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1 ADO   Andorra      NA        18      1800  NA     NA      1001  NA      NA    
2 AFG   Afghanistan   0        19.2    1919   4.54   2.12   3002   0       0.993
3 AGO   Angola        0.333    19.8    1975   5.63   0.405  2011   0.687   0    
4 ALB   Albania       0.667    19.1    1912  NA      1.99   2009  NA      NA    
5 ARE   United Ara…   0.333    19.7    1971  NA      0      3002   0.004   0.949
6 ARG   Argentina     0        18.2    1816   4.23  -2.21   5001   0.916   0.002
# … with 5 more variables: rel_protmg80 &lt;dbl&gt;, growth &lt;dbl&gt;, democ &lt;dbl&gt;,
#   world &lt;dbl&gt;, colony &lt;dbl&gt;, and abbreviated variable names ¹​consfirstaug,
#   ²​lpd1500s, ³​rel_catho80, ⁴​rel_muslim80</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove dummy/unnecessary variables (as identified in study's variable key):</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>data_cln <span class="ot">=</span> <span class="fu">subset</span>(data_file, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(code, world, colony, indcent, madid))</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_cln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  country   consf…¹ indyear logem4 lpd15…² rel_c…³ rel_m…⁴ rel_p…⁵  growth democ
  &lt;chr&gt;       &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Andorra    NA        1800  NA     NA      NA      NA      NA      3.46   NA   
2 Afghanis…   0        1919   4.54   2.12    0       0.993   0     -0.0849  0.15
3 Angola      0.333    1975   5.63   0.405   0.687   0       0.198  0.644   0.35
4 Albania     0.667    1912  NA      1.99   NA      NA      NA      1.68    0.75
5 United A…   0.333    1971  NA      0       0.004   0.949   0.003  3.37    0.1 
6 Argentina   0        1816   4.23  -2.21    0.916   0.002   0.027  2.71    0.9 
# … with abbreviated variable names ¹​consfirstaug, ²​lpd1500s, ³​rel_catho80,
#   ⁴​rel_muslim80, ⁵​rel_protmg80</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>data_cln2 <span class="ot">&lt;-</span> data_cln <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"exec_constraint"</span><span class="ot">=</span><span class="st">"consfirstaug"</span>, <span class="st">"year_ind"</span><span class="ot">=</span><span class="st">"indyear"</span>, <span class="st">"log_settler_mort"</span><span class="ot">=</span><span class="st">"logem4"</span>, <span class="st">"log_pop_dens"</span><span class="ot">=</span><span class="st">"lpd1500s"</span>)</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_cln2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  country  exec_…¹ year_…² log_s…³ log_p…⁴ rel_c…⁵ rel_m…⁶ rel_p…⁷  growth democ
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Andorra   NA        1800   NA     NA      NA      NA      NA      3.46   NA   
2 Afghani…   0        1919    4.54   2.12    0       0.993   0     -0.0849  0.15
3 Angola     0.333    1975    5.63   0.405   0.687   0       0.198  0.644   0.35
4 Albania    0.667    1912   NA      1.99   NA      NA      NA      1.68    0.75
5 United …   0.333    1971   NA      0       0.004   0.949   0.003  3.37    0.1 
6 Argenti…   0        1816    4.23  -2.21    0.916   0.002   0.027  2.71    0.9 
# … with abbreviated variable names ¹​exec_constraint, ²​year_ind,
#   ³​log_settler_mort, ⁴​log_pop_dens, ⁵​rel_catho80, ⁶​rel_muslim80,
#   ⁷​rel_protmg80</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove duplicates:</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> <span class="fu">duplicated</span>(data_cln2)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>duplicates[<span class="st">"TRUE"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove blank observations (observations with some NAs are not removed):</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>data_blank <span class="ot">&lt;-</span> data_cln2[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(data_cln2)) <span class="sc">!=</span> <span class="fu">ncol</span>(data_cln2), ]</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_blank)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 10
  country  exec_…¹ year_…² log_s…³ log_p…⁴ rel_c…⁵ rel_m…⁶ rel_p…⁷  growth democ
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Andorra   NA        1800   NA     NA      NA      NA      NA      3.46   NA   
2 Afghani…   0        1919    4.54   2.12    0       0.993   0     -0.0849  0.15
3 Angola     0.333    1975    5.63   0.405   0.687   0       0.198  0.644   0.35
4 Albania    0.667    1912   NA      1.99   NA      NA      NA      1.68    0.75
5 United …   0.333    1971   NA      0       0.004   0.949   0.003  3.37    0.1 
6 Argenti…   0        1816    4.23  -2.21    0.916   0.002   0.027  2.71    0.9 
# … with abbreviated variable names ¹​exec_constraint, ²​year_ind,
#   ³​log_settler_mort, ⁴​log_pop_dens, ⁵​rel_catho80, ⁶​rel_muslim80,
#   ⁷​rel_protmg80</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove some NAs for description but not analysis:</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>data_NA <span class="ot">&lt;-</span> data_blank[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(data_cln2)) <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_NA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 76 10</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># confirm data frame size of clean data set:</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_cln2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 173  10</code></pre>
</div>
</div>
<p>We can see that this data set has 10 variables and 173 observations (though there will be 12 variables once I collect and add data related to education and non-religious affiliation). There are no duplicate observations, nor are there any blank observations. However, in the case that we remove observations with any missing values, the data set would only have 76 observations. Nonetheless, because the study’s authors elected to utilize incomplete observations, I will do the same.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of data (remove categorical variables):</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'summarytools' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'summarytools'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tibble':

    view</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>summary <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_cln2, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(country))</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(summary)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> exec_constraint     year_ind    log_settler_mort  log_pop_dens    
 Min.   :0.0000   Min.   :1800   Min.   :0.9361   Min.   :-3.8309  
 1st Qu.:0.0000   1st Qu.:1830   1st Qu.:4.2327   1st Qu.: 0.1911  
 Median :0.3333   Median :1947   Median :4.5099   Median : 1.0986  
 Mean   :0.3942   Mean   :1912   Mean   :4.6269   Mean   : 1.1317  
 3rd Qu.:0.6667   3rd Qu.:1964   3rd Qu.:5.5978   3rd Qu.: 2.4407  
 Max.   :1.0000   Max.   :1984   Max.   :7.9862   Max.   : 5.6426  
 NA's   :23                      NA's   :85       NA's   :22       
  rel_catho80       rel_muslim80       rel_protmg80        growth       
 Min.   :0.00000   Min.   :0.000000   Min.   :0.0000   Min.   :-0.6421  
 1st Qu.:0.00875   1st Qu.:0.000075   1st Qu.:0.0020   1st Qu.: 1.1432  
 Median :0.12600   Median :0.014500   Median :0.0230   Median : 1.8700  
 Mean   :0.31126   Mean   :0.243986   Mean   :0.1253   Mean   : 1.9514  
 3rd Qu.:0.56575   3rd Qu.:0.385750   3rd Qu.:0.1805   3rd Qu.: 2.7023  
 Max.   :0.97300   Max.   :0.998000   Max.   :0.9780   Max.   : 4.2531  
 NA's   :21        NA's   :21         NA's   :22       NA's   :1        
     democ       
 Min.   :0.0000  
 1st Qu.:0.3500  
 Median :0.8000  
 Mean   :0.6556  
 3rd Qu.:0.9250  
 Max.   :1.0000  
 NA's   :38      </code></pre>
</div>
</div>
<p>We can see here a data frame containing summary statistics for the 9 variables with numeric data, as the categorical variable simply indicates the country name. These statistics will be more meaningful upon following the addition of data related to education and non-religious affiliation.</p>
</section>
<section id="data-merge" class="level3">
<h3 class="anchored" data-anchor-id="data-merge">Data Merge:</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># import new religious affiliation variables</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>relig_1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"C:/Users/caitr/OneDrive/Documents/DACSS/DACSS 603/603_Spring_2023/posts/_data/DACSS603_religious_aff.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 1205 Columns: 11
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr (2): Region, Country
dbl (9): Year, Buddhists, Christians, Folk Religions, Hindus, Jews, Muslims,...

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
   Year Region      Country Buddh…¹ Chris…² Folk …³ Hindus  Jews Muslims Other…⁴
  &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;
1  2010 World       All Co…     7.1    31.4     5.9     15   1      23.2       1
2  2010 North Amer… All Co…     1.1    77.4     1        1   1.8     1         1
3  2010 Latin Amer… All Co…     1      90       1.7      1   1       1         1
4  2010 Europe      All Co…     1      74.5     1        1   1       5.9       1
5  2010 Middle Eas… All Co…     1       3.7     1        1   1.6    93         1
6  2010 Sub-Sahara… All Co…     1      62.9     3.3      1   1      30.2       1
# … with 1 more variable: Unaffiliated &lt;dbl&gt;, and abbreviated variable names
#   ¹​Buddhists, ²​Christians, ³​`Folk Religions`, ⁴​`Other Religions`</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="co"># convert percentages to decimals</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>relig_dec <span class="ot">&lt;-</span> <span class="fu">transform</span>(relig_1, <span class="at">rel_unaffiliated =</span> (Unaffiliated<span class="sc">/</span><span class="dv">100</span>), <span class="at">Jewish =</span> (Jews<span class="sc">/</span><span class="dv">100</span>), <span class="at">Hindu =</span> (Hindus<span class="sc">/</span><span class="dv">100</span>), <span class="at">Buddhist =</span> (Buddhists<span class="sc">/</span><span class="dv">100</span>))</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_dec)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Year                   Region       Country Buddhists Christians
1 2010                    World All Countries       7.1       31.4
2 2010            North America All Countries       1.1       77.4
3 2010  Latin America-Caribbean All Countries       1.0       90.0
4 2010                   Europe All Countries       1.0       74.5
5 2010 Middle East-North Africa All Countries       1.0        3.7
6 2010       Sub-Saharan Africa All Countries       1.0       62.9
  Folk.Religions Hindus Jews Muslims Other.Religions Unaffiliated
1            5.9     15  1.0    23.2               1         16.4
2            1.0      1  1.8     1.0               1         17.1
3            1.7      1  1.0     1.0               1          7.7
4            1.0      1  1.0     5.9               1         18.8
5            1.0      1  1.6    93.0               1          1.0
6            3.3      1  1.0    30.2               1          3.2
  rel_unaffiliated Jewish Hindu Buddhist
1            0.164  0.010  0.15    0.071
2            0.171  0.018  0.01    0.011
3            0.077  0.010  0.01    0.010
4            0.188  0.010  0.01    0.010
5            0.010  0.016  0.01    0.010
6            0.032  0.010  0.01    0.010</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove "all countries" from 'country' variable</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>relig_country <span class="ot">&lt;-</span> relig_dec[<span class="sc">!</span>(relig_dec<span class="sc">$</span>Country<span class="sc">==</span><span class="st">"All Countries"</span>),]</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_country)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Year                   Region        Country Buddhists Christians
8  2010             Asia-Pacific    Afghanistan         1        1.0
9  2010                   Europe        Albania         1       18.0
10 2010 Middle East-North Africa        Algeria         1        1.0
11 2010             Asia-Pacific American Samoa         1       98.3
12 2010                   Europe        Andorra         1       89.5
13 2010       Sub-Saharan Africa         Angola         1       90.5
   Folk.Religions Hindus Jews Muslims Other.Religions Unaffiliated
8             1.0      1    1    99.0               1          1.0
9             1.0      1    1    80.3               1          1.4
10            1.0      1    1    97.9               1          1.8
11            1.0      1    1     1.0               1          1.0
12            1.0      1    1     1.0               1          8.8
13            4.2      1    1     1.0               1          5.1
   rel_unaffiliated Jewish Hindu Buddhist
8             0.010   0.01  0.01     0.01
9             0.014   0.01  0.01     0.01
10            0.018   0.01  0.01     0.01
11            0.010   0.01  0.01     0.01
12            0.088   0.01  0.01     0.01
13            0.051   0.01  0.01     0.01</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove unneeded columns</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>relig_vars <span class="ot">&lt;-</span> <span class="fu">subset</span>(relig_country, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Region, Buddhists, Christians, Folk.Religions, Hindus, Hindu, Jews, Jewish, Buddhist, Muslims, Other.Religions, Unaffiliated))</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Year        Country rel_unaffiliated
8  2010    Afghanistan            0.010
9  2010        Albania            0.014
10 2010        Algeria            0.018
11 2010 American Samoa            0.010
12 2010        Andorra            0.088
13 2010         Angola            0.051</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use data from 2010 (comparable to base data set)</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>relig_2010 <span class="ot">&lt;-</span> relig_vars[<span class="sc">!</span>(relig_vars<span class="sc">$</span>Year<span class="sc">==</span><span class="st">"2020"</span> <span class="sc">|</span> relig_vars<span class="sc">$</span>Year<span class="sc">==</span><span class="st">"2030"</span> <span class="sc">|</span> relig_vars<span class="sc">$</span>Year<span class="sc">==</span><span class="st">"2040"</span> <span class="sc">|</span> relig_vars<span class="sc">$</span>Year<span class="sc">==</span><span class="st">"2050"</span>),]</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_2010)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   Year        Country rel_unaffiliated
8  2010    Afghanistan            0.010
9  2010        Albania            0.014
10 2010        Algeria            0.018
11 2010 American Samoa            0.010
12 2010        Andorra            0.088
13 2010         Angola            0.051</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove duplicates</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>rel_duplicates <span class="ot">&lt;-</span> <span class="fu">duplicated</span>(relig_2010)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>rel_duplicates[<span class="st">"TRUE"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove "year" column</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>relig_cln <span class="ot">&lt;-</span> <span class="fu">subset</span>(relig_2010, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Year))</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_cln)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>          Country rel_unaffiliated
8     Afghanistan            0.010
9         Albania            0.014
10        Algeria            0.018
11 American Samoa            0.010
12        Andorra            0.088
13         Angola            0.051</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with data_file</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">left_join</span>(data_cln2, relig_cln,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"country"</span> <span class="ot">=</span> <span class="st">"Country"</span>))</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_combined)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  country  exec_…¹ year_…² log_s…³ log_p…⁴ rel_c…⁵ rel_m…⁶ rel_p…⁷  growth democ
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Andorra   NA        1800   NA     NA      NA      NA      NA      3.46   NA   
2 Afghani…   0        1919    4.54   2.12    0       0.993   0     -0.0849  0.15
3 Angola     0.333    1975    5.63   0.405   0.687   0       0.198  0.644   0.35
4 Albania    0.667    1912   NA      1.99   NA      NA      NA      1.68    0.75
5 United …   0.333    1971   NA      0       0.004   0.949   0.003  3.37    0.1 
6 Argenti…   0        1816    4.23  -2.21    0.916   0.002   0.027  2.71    0.9 
# … with 1 more variable: rel_unaffiliated &lt;dbl&gt;, and abbreviated variable
#   names ¹​exec_constraint, ²​year_ind, ³​log_settler_mort, ⁴​log_pop_dens,
#   ⁵​rel_catho80, ⁶​rel_muslim80, ⁷​rel_protmg80</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge additional control: education expenditure (GDP)</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>edu <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"C:/Users/caitr/OneDrive/Documents/DACSS/DACSS 603/603_Spring_2023/posts/_data/DACSS603_edu_expend.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 266 Columns: 66
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (4): Country Name, Country Code, Indicator Name, Indicator Code
dbl (52): 1970, 1971, 1972, 1973, 1974, 1975, 1976, 1977, 1978, 1979, 1980, ...
lgl (10): 1960, 1961, 1962, 1963, 1964, 1965, 1966, 1967, 1968, 1969

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(edu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 66
  Country Na…¹ Count…² Indic…³ Indic…⁴ `1960` `1961` `1962` `1963` `1964` `1965`
  &lt;chr&gt;        &lt;chr&gt;   &lt;chr&gt;   &lt;chr&gt;   &lt;lgl&gt;  &lt;lgl&gt;  &lt;lgl&gt;  &lt;lgl&gt;  &lt;lgl&gt;  &lt;lgl&gt; 
1 Aruba        ABW     Govern… SE.XPD… NA     NA     NA     NA     NA     NA    
2 Africa East… AFE     Govern… SE.XPD… NA     NA     NA     NA     NA     NA    
3 Afghanistan  AFG     Govern… SE.XPD… NA     NA     NA     NA     NA     NA    
4 Africa West… AFW     Govern… SE.XPD… NA     NA     NA     NA     NA     NA    
5 Angola       AGO     Govern… SE.XPD… NA     NA     NA     NA     NA     NA    
6 Albania      ALB     Govern… SE.XPD… NA     NA     NA     NA     NA     NA    
# … with 56 more variables: `1966` &lt;lgl&gt;, `1967` &lt;lgl&gt;, `1968` &lt;lgl&gt;,
#   `1969` &lt;lgl&gt;, `1970` &lt;dbl&gt;, `1971` &lt;dbl&gt;, `1972` &lt;dbl&gt;, `1973` &lt;dbl&gt;,
#   `1974` &lt;dbl&gt;, `1975` &lt;dbl&gt;, `1976` &lt;dbl&gt;, `1977` &lt;dbl&gt;, `1978` &lt;dbl&gt;,
#   `1979` &lt;dbl&gt;, `1980` &lt;dbl&gt;, `1981` &lt;dbl&gt;, `1982` &lt;dbl&gt;, `1983` &lt;dbl&gt;,
#   `1984` &lt;dbl&gt;, `1985` &lt;dbl&gt;, `1986` &lt;dbl&gt;, `1987` &lt;dbl&gt;, `1988` &lt;dbl&gt;,
#   `1989` &lt;dbl&gt;, `1990` &lt;dbl&gt;, `1991` &lt;dbl&gt;, `1992` &lt;dbl&gt;, `1993` &lt;dbl&gt;,
#   `1994` &lt;dbl&gt;, `1995` &lt;dbl&gt;, `1996` &lt;dbl&gt;, `1997` &lt;dbl&gt;, `1998` &lt;dbl&gt;, …</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove unneeded columns</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>edu_vars <span class="ot">&lt;-</span> <span class="fu">subset</span>(edu, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Country Name"</span>, <span class="st">"2010"</span>))</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(edu_vars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 2
  `Country Name`              `2010`
  &lt;chr&gt;                        &lt;dbl&gt;
1 Aruba                         6.93
2 Africa Eastern and Southern   4.50
3 Afghanistan                   3.48
4 Africa Western and Central    2.96
5 Angola                        3.42
6 Albania                       3.41</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove duplicates</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>edu_duplicates <span class="ot">&lt;-</span> <span class="fu">duplicated</span>(edu_vars)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>edu_duplicates[<span class="st">"TRUE"</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] NA</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with combined data</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>data_merge <span class="ot">&lt;-</span> <span class="fu">left_join</span>(data_combined, edu_vars,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"country"</span> <span class="ot">=</span> <span class="st">"Country Name"</span>))</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>data_final <span class="ot">&lt;-</span> <span class="fu">rename</span>(data_merge, <span class="st">"education"</span><span class="ot">=</span><span class="st">"2010"</span>)</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 12
  country  exec_…¹ year_…² log_s…³ log_p…⁴ rel_c…⁵ rel_m…⁶ rel_p…⁷  growth democ
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Andorra   NA        1800   NA     NA      NA      NA      NA      3.46   NA   
2 Afghani…   0        1919    4.54   2.12    0       0.993   0     -0.0849  0.15
3 Angola     0.333    1975    5.63   0.405   0.687   0       0.198  0.644   0.35
4 Albania    0.667    1912   NA      1.99   NA      NA      NA      1.68    0.75
5 United …   0.333    1971   NA      0       0.004   0.949   0.003  3.37    0.1 
6 Argenti…   0        1816    4.23  -2.21    0.916   0.002   0.027  2.71    0.9 
# … with 2 more variables: rel_unaffiliated &lt;dbl&gt;, education &lt;dbl&gt;, and
#   abbreviated variable names ¹​exec_constraint, ²​year_ind, ³​log_settler_mort,
#   ⁴​log_pop_dens, ⁵​rel_catho80, ⁶​rel_muslim80, ⁷​rel_protmg80</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of final data frame</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   country          exec_constraint     year_ind    log_settler_mort
 Length:173         Min.   :0.0000   Min.   :1800   Min.   :0.9361  
 Class :character   1st Qu.:0.0000   1st Qu.:1830   1st Qu.:4.2327  
 Mode  :character   Median :0.3333   Median :1947   Median :4.5099  
                    Mean   :0.3942   Mean   :1912   Mean   :4.6269  
                    3rd Qu.:0.6667   3rd Qu.:1964   3rd Qu.:5.5978  
                    Max.   :1.0000   Max.   :1984   Max.   :7.9862  
                    NA's   :23                      NA's   :85      
  log_pop_dens      rel_catho80       rel_muslim80       rel_protmg80   
 Min.   :-3.8309   Min.   :0.00000   Min.   :0.000000   Min.   :0.0000  
 1st Qu.: 0.1911   1st Qu.:0.00875   1st Qu.:0.000075   1st Qu.:0.0020  
 Median : 1.0986   Median :0.12600   Median :0.014500   Median :0.0230  
 Mean   : 1.1317   Mean   :0.31126   Mean   :0.243986   Mean   :0.1253  
 3rd Qu.: 2.4407   3rd Qu.:0.56575   3rd Qu.:0.385750   3rd Qu.:0.1805  
 Max.   : 5.6426   Max.   :0.97300   Max.   :0.998000   Max.   :0.9780  
 NA's   :22        NA's   :21        NA's   :21         NA's   :22      
     growth            democ        rel_unaffiliated    education      
 Min.   :-0.6421   Min.   :0.0000   Min.   :0.01000   Min.   : 0.4664  
 1st Qu.: 1.1432   1st Qu.:0.3500   1st Qu.:0.01000   1st Qu.: 3.1675  
 Median : 1.8700   Median :0.8000   Median :0.03300   Median : 4.4872  
 Mean   : 1.9514   Mean   :0.6556   Mean   :0.08615   Mean   : 4.4160  
 3rd Qu.: 2.7023   3rd Qu.:0.9250   3rd Qu.:0.10925   3rd Qu.: 5.5250  
 Max.   : 4.2531   Max.   :1.0000   Max.   :0.59600   Max.   :12.8373  
 NA's   :1         NA's   :38       NA's   :25        NA's   :53       </code></pre>
</div>
</div>
</section>
<section id="visualization" class="level3">
<h3 class="anchored" data-anchor-id="visualization">Visualization:</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add religion as new categorical variable based on highest percentage of each religion:</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">select</span>(data_final, country, rel_catho80, rel_muslim80, rel_protmg80, rel_unaffiliated)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(newdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  country              rel_catho80 rel_muslim80 rel_protmg80 rel_unaffiliated
  &lt;chr&gt;                      &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;
1 Andorra                   NA           NA           NA                0.088
2 Afghanistan                0            0.993        0                0.01 
3 Angola                     0.687        0            0.198            0.051
4 Albania                   NA           NA           NA                0.014
5 United Arab Emirates       0.004        0.949        0.003            0.011
6 Argentina                  0.916        0.002        0.027            0.122</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'reshape2' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'reshape2'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:tidyr':

    smiths</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>data_final<span class="sc">$</span>religion <span class="ot">&lt;-</span> <span class="fu">apply</span>(data_final[, <span class="fu">c</span>(<span class="st">"rel_protmg80"</span>, <span class="st">"rel_muslim80"</span>, <span class="st">"rel_catho80"</span>, <span class="st">"rel_unaffiliated"</span>)], <span class="dv">1</span>, <span class="cf">function</span>(row) {</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>  religions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rel_protmg80"</span>, <span class="st">"rel_muslim80"</span>, <span class="st">"rel_catho80"</span>, <span class="st">"rel_unaffiliated"</span>)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  max_percentage <span class="ot">&lt;-</span> <span class="fu">max</span>(row)</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  religion <span class="ot">&lt;-</span> religions[row <span class="sc">==</span> max_percentage]</span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(religion, <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
  country  exec_…¹ year_…² log_s…³ log_p…⁴ rel_c…⁵ rel_m…⁶ rel_p…⁷  growth democ
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Andorra   NA        1800   NA     NA      NA      NA      NA      3.46   NA   
2 Afghani…   0        1919    4.54   2.12    0       0.993   0     -0.0849  0.15
3 Angola     0.333    1975    5.63   0.405   0.687   0       0.198  0.644   0.35
4 Albania    0.667    1912   NA      1.99   NA      NA      NA      1.68    0.75
5 United …   0.333    1971   NA      0       0.004   0.949   0.003  3.37    0.1 
6 Argenti…   0        1816    4.23  -2.21    0.916   0.002   0.027  2.71    0.9 
# … with 3 more variables: rel_unaffiliated &lt;dbl&gt;, education &lt;dbl&gt;,
#   religion &lt;chr&gt;, and abbreviated variable names ¹​exec_constraint, ²​year_ind,
#   ³​log_settler_mort, ⁴​log_pop_dens, ⁵​rel_catho80, ⁶​rel_muslim80,
#   ⁷​rel_protmg80</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="co"># pivot data to add variable with all religions</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>data_pivot <span class="ot">&lt;-</span> data_final <span class="sc">%&gt;%</span> </span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="st">'rel_catho80'</span>, <span class="st">'rel_muslim80'</span>, <span class="st">'rel_protmg80'</span>, <span class="st">'rel_unaffiliated'</span>),</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>                    <span class="at">names_to=</span><span class="st">'relig_affiliation'</span>,</span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values_to=</span><span class="st">'relig_pop'</span>)</span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_pivot)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 11
  country  exec_…¹ year_…² log_s…³ log_p…⁴  growth democ educa…⁵ relig…⁶ relig…⁷
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt; &lt;chr&gt;   &lt;chr&gt;  
1 Andorra       NA    1800   NA      NA     3.46   NA       2.98 NA, NA… rel_ca…
2 Andorra       NA    1800   NA      NA     3.46   NA       2.98 NA, NA… rel_mu…
3 Andorra       NA    1800   NA      NA     3.46   NA       2.98 NA, NA… rel_pr…
4 Andorra       NA    1800   NA      NA     3.46   NA       2.98 NA, NA… rel_un…
5 Afghani…       0    1919    4.54    2.12 -0.0849  0.15    3.48 rel_mu… rel_ca…
6 Afghani…       0    1919    4.54    2.12 -0.0849  0.15    3.48 rel_mu… rel_mu…
# … with 1 more variable: relig_pop &lt;dbl&gt;, and abbreviated variable names
#   ¹​exec_constraint, ²​year_ind, ³​log_settler_mort, ⁴​log_pop_dens, ⁵​education,
#   ⁶​religion, ⁷​relig_affiliation</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove NAs</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>data_NA <span class="ot">&lt;-</span> data_pivot<span class="sc">%&gt;%</span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_pivot)<span class="sc">%&gt;%</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(growth, democ, education, relig_affiliation, relig_pop))</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_NA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
   growth democ education relig_affiliation relig_pop
    &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt; &lt;chr&gt;                 &lt;dbl&gt;
1 -0.0849  0.15      3.48 rel_catho80           0    
2 -0.0849  0.15      3.48 rel_muslim80          0.993
3 -0.0849  0.15      3.48 rel_protmg80          0    
4 -0.0849  0.15      3.48 rel_unaffiliated      0.01 
5  0.644   0.35      3.42 rel_catho80           0.687
6  0.644   0.35      3.42 rel_muslim80          0    </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove observations where values are equal</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>data_final_vis <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_final, religion<span class="sc">!=</span><span class="st">"rel_protmg80, rel_catho80"</span>)</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final_vis)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
  country  exec_…¹ year_…² log_s…³ log_p…⁴ rel_c…⁵ rel_m…⁶ rel_p…⁷  growth democ
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Andorra   NA        1800   NA     NA      NA      NA      NA      3.46   NA   
2 Afghani…   0        1919    4.54   2.12    0       0.993   0     -0.0849  0.15
3 Angola     0.333    1975    5.63   0.405   0.687   0       0.198  0.644   0.35
4 Albania    0.667    1912   NA      1.99   NA      NA      NA      1.68    0.75
5 United …   0.333    1971   NA      0       0.004   0.949   0.003  3.37    0.1 
6 Argenti…   0        1816    4.23  -2.21    0.916   0.002   0.027  2.71    0.9 
# … with 3 more variables: rel_unaffiliated &lt;dbl&gt;, education &lt;dbl&gt;,
#   religion &lt;chr&gt;, and abbreviated variable names ¹​exec_constraint, ²​year_ind,
#   ³​log_settler_mort, ⁴​log_pop_dens, ⁵​rel_catho80, ⁶​rel_muslim80,
#   ⁷​rel_protmg80</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot for income x democray by religion</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>relig_vis3 <span class="ot">&lt;-</span> data_final_vis<span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_final_vis)<span class="sc">%&gt;%</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(democ, growth))<span class="sc">+</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">"religion"</span>)<span class="sc">+</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Shift in Democracy"</span>,<span class="at">y=</span><span class="st">"Shift in Per Capita Income"</span>, <span class="at">title =</span> <span class="st">"Shift in Per Capita Income and Democracy by Religious Affiliation"</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> religion))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(relig_vis3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Rowley_Final_Project_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scaterplot by median pop percentages by religion</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>dem_inc_relig <span class="ot">&lt;-</span> data_final_vis<span class="sc">%&gt;%</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_final_vis)<span class="sc">%&gt;%</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(democ, growth))<span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>religion, <span class="at">shape=</span>religion))<span class="sc">+</span>  </span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Shift in Democracy"</span>, <span class="at">y=</span><span class="st">"Shift in Income Per Capita"</span>, <span class="at">title =</span> <span class="st">"Shift in Per Capita Income and Democracy by Religious Affiliation"</span>)</span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dem_inc_relig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Rowley_Final_Project_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar chart</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>inc_relig <span class="ot">&lt;-</span> data_final_vis<span class="sc">%&gt;%</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_final_vis)<span class="sc">%&gt;%</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>democ, <span class="at">y=</span>education, <span class="at">fill=</span>religion)) <span class="sc">+</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Shift in Democracy"</span>, <span class="at">y=</span><span class="st">"Education Funding"</span>, <span class="at">title=</span><span class="st">"Shift in Education Funding and Democracy by Religious Affiliation"</span>)</span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(inc_relig)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Rowley_Final_Project_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># line chart</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>line_chart <span class="ot">&lt;-</span> data_final_vis<span class="sc">%&gt;%</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_final_vis)<span class="sc">%&gt;%</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>democ, <span class="at">y=</span>education, <span class="at">colour=</span>religion, <span class="at">group=</span>religion)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Shift in Democracy"</span>, <span class="at">y=</span><span class="st">"Education Funding"</span>, <span class="at">title=</span><span class="st">"Shift in Education Funding and Democracy by Religious Affiliation"</span>) <span class="sc">+</span></span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(line_chart)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Rowley_Final_Project_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot </span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>relig_income2 <span class="ot">&lt;-</span> data_final_vis<span class="sc">%&gt;%</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_final_vis)<span class="sc">%&gt;%</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(education, growth))<span class="sc">+</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">"religion"</span>)<span class="sc">+</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Education Funding"</span>,<span class="at">y=</span><span class="st">"Shift in Income Per Capita"</span>, <span class="at">title =</span> <span class="st">"Shift in Per Capita Income and Education Funding by Religious Affiliation"</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> religion))</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(relig_income2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Rowley_Final_Project_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="analysis" class="level3">
<h3 class="anchored" data-anchor-id="analysis">Analysis:</h3>
<section id="hypothesis-testing" class="level4">
<h4 class="anchored" data-anchor-id="hypothesis-testing">Hypothesis Testing:</h4>
<p>Define variables:</p>
<ol type="1">
<li><strong>Response (dependent) variable</strong>: Shift in democracy over time (“democ”).</li>
<li><strong>Explanatory (independent) variable</strong>: Shift in per capita income over time (“growth”).</li>
<li><strong>Control variables</strong>: country (“country”); constraint on the executive at the time of independence (“exec_constraint”); year of independence (“year_ind”); settler mortality rate (“log_settler_mort”); population density (“log_pop_dens”); Catholic population (“rel_catho80”); Muslim population (“rel_muslim80”); Protestant population (“rel_protmg80”); <strong>religiously-unaffiliated population (“rel_unaffiliated”)</strong>; and <strong>education funding (“education”)</strong>.</li>
<li><strong>Interaction terms</strong>: Education funding (“education”)*shift in per capita income (“growth”).</li>
</ol>
<p>I specifically added religiously-unaffiliated population (by percentage of population by country) and education funding (by expenditure as a percentage of GDP by country) as additional control variables because of the role they played in Barro’s 1999 study. Although Barro did not control for the same country-specific effects as the authors of “Income and Democracy,” he nonetheless suggested that both education and religious affiliation are statistically significant indicators of the correlation between income and democracy. So, I elected to add religiously-unaffiliated population to my replication data set because it was included in Barro’s study but excluded from “Income and Democracy.” Additionally, even though education was deemed to be statistically insignificant in “Income and Democracy,” I thought it would be interesting to see if adding religiously-unaffiliated population would affect the role of education a country-fixed effect.</p>
<p>Moreover, as I initially speculated that education would be statistically significant prior to reviewing “Income and Democracy,” I was curious to see if adding education funding*shift as an interaction term would perhaps provide additional insight on the reach of education as a country-fixed effect.</p>
<p><strong>Transform Variables</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform education from continuous to ordinal (quartiles based on range)</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>range_edu <span class="ot">&lt;-</span> <span class="fu">range</span>(data_final<span class="sc">$</span>education, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="co"># ID quantiles</span></span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>quantile_edu <span class="ot">&lt;-</span> <span class="fu">quantile</span>(range_edu)</span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>quantile_edu</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        0%        25%        50%        75%       100% 
 0.4663837  3.5591152  6.6518468  9.7445783 12.8373098 </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtools)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'gtools' was built under R version 4.2.3</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># add column for quantiles</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>edu_quant <span class="ot">&lt;-</span> <span class="fu">quantcut</span>(data_final<span class="sc">$</span>education, <span class="at">q =</span> <span class="dv">4</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>data_final_edu <span class="ot">&lt;-</span> <span class="fu">mutate</span>(data_final, <span class="at">edu_quant=</span>edu_quant)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final_edu)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 14
  country  exec_…¹ year_…² log_s…³ log_p…⁴ rel_c…⁵ rel_m…⁶ rel_p…⁷  growth democ
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Andorra   NA        1800   NA     NA      NA      NA      NA      3.46   NA   
2 Afghani…   0        1919    4.54   2.12    0       0.993   0     -0.0849  0.15
3 Angola     0.333    1975    5.63   0.405   0.687   0       0.198  0.644   0.35
4 Albania    0.667    1912   NA      1.99   NA      NA      NA      1.68    0.75
5 United …   0.333    1971   NA      0       0.004   0.949   0.003  3.37    0.1 
6 Argenti…   0        1816    4.23  -2.21    0.916   0.002   0.027  2.71    0.9 
# … with 4 more variables: rel_unaffiliated &lt;dbl&gt;, education &lt;dbl&gt;,
#   religion &lt;chr&gt;, edu_quant &lt;fct&gt;, and abbreviated variable names
#   ¹​exec_constraint, ²​year_ind, ³​log_settler_mort, ⁴​log_pop_dens,
#   ⁵​rel_catho80, ⁶​rel_muslim80, ⁷​rel_protmg80</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">select</span>(data_final, country, rel_catho80, rel_muslim80, rel_protmg80, rel_unaffiliated)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(newdata)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 5
  country              rel_catho80 rel_muslim80 rel_protmg80 rel_unaffiliated
  &lt;chr&gt;                      &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt;            &lt;dbl&gt;
1 Andorra                   NA           NA           NA                0.088
2 Afghanistan                0            0.993        0                0.01 
3 Angola                     0.687        0            0.198            0.051
4 Albania                   NA           NA           NA                0.014
5 United Arab Emirates       0.004        0.949        0.003            0.011
6 Argentina                  0.916        0.002        0.027            0.122</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>data_final<span class="sc">$</span>religion <span class="ot">&lt;-</span> <span class="fu">apply</span>(data_final[, <span class="fu">c</span>(<span class="st">"rel_protmg80"</span>, <span class="st">"rel_muslim80"</span>, <span class="st">"rel_catho80"</span>, <span class="st">"rel_unaffiliated"</span>)], <span class="dv">1</span>, <span class="cf">function</span>(row) {</span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>  religions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rel_protmg80"</span>, <span class="st">"rel_muslim80"</span>, <span class="st">"rel_catho80"</span>, <span class="st">"rel_unaffiliated"</span>)</span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>  max_percentage <span class="ot">&lt;-</span> <span class="fu">max</span>(row)</span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>  religion <span class="ot">&lt;-</span> religions[row <span class="sc">==</span> max_percentage]</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(religion, <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
  country  exec_…¹ year_…² log_s…³ log_p…⁴ rel_c…⁵ rel_m…⁶ rel_p…⁷  growth democ
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Andorra   NA        1800   NA     NA      NA      NA      NA      3.46   NA   
2 Afghani…   0        1919    4.54   2.12    0       0.993   0     -0.0849  0.15
3 Angola     0.333    1975    5.63   0.405   0.687   0       0.198  0.644   0.35
4 Albania    0.667    1912   NA      1.99   NA      NA      NA      1.68    0.75
5 United …   0.333    1971   NA      0       0.004   0.949   0.003  3.37    0.1 
6 Argenti…   0        1816    4.23  -2.21    0.916   0.002   0.027  2.71    0.9 
# … with 3 more variables: rel_unaffiliated &lt;dbl&gt;, education &lt;dbl&gt;,
#   religion &lt;chr&gt;, and abbreviated variable names ¹​exec_constraint, ²​year_ind,
#   ³​log_settler_mort, ⁴​log_pop_dens, ⁵​rel_catho80, ⁶​rel_muslim80,
#   ⁷​rel_protmg80</code></pre>
</div>
</div>
<p><strong>Correlation Tests</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># remove observations with all NAs</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>sans_NA <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_final)</span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sans_NA)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 13
  country  exec_…¹ year_…² log_s…³ log_p…⁴ rel_c…⁵ rel_m…⁶ rel_p…⁷  growth democ
  &lt;chr&gt;      &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;
1 Afghani…   0        1919    4.54   2.12    0       0.993   0     -0.0849  0.15
2 Angola     0.333    1975    5.63   0.405   0.687   0       0.198  0.644   0.35
3 Argenti…   0        1816    4.23  -2.21    0.916   0.002   0.027  2.71    0.9 
4 Austral…   1        1901    2.15  -3.65    0.296   0.002   0.235  3.99    1   
5 Burundi    0.148    1962    5.63   3.22    0.783   0.009   0.049  0.328   0.45
6 Benin      0.125    1960    5.59   1.44    0.185   0.152   0.028  1.16    0.8 
# … with 3 more variables: rel_unaffiliated &lt;dbl&gt;, education &lt;dbl&gt;,
#   religion &lt;chr&gt;, and abbreviated variable names ¹​exec_constraint, ²​year_ind,
#   ³​log_settler_mort, ⁴​log_pop_dens, ⁵​rel_catho80, ⁶​rel_muslim80,
#   ⁷​rel_protmg80</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation between income growth and education</span></span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(sans_NA[<span class="fu">c</span>(<span class="st">"growth"</span>, <span class="st">"education"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>             growth education
growth    1.0000000 0.4441714
education 0.4441714 1.0000000</code></pre>
</div>
</div>
<p>There is a positive but low linear correlation (0.4) between shift in per capita income and education funding.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation between democracy and religious unaffiliation</span></span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(sans_NA[<span class="fu">c</span>(<span class="st">"democ"</span>, <span class="st">"rel_unaffiliated"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                      democ rel_unaffiliated
democ            1.00000000       0.08577673
rel_unaffiliated 0.08577673       1.00000000</code></pre>
</div>
</div>
<p>There is a positive but very low linear correlation (0.1) between shift in democracy and religiously-unaffiliated population.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation between democracy and education</span></span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(sans_NA[<span class="fu">c</span>(<span class="st">"democ"</span>, <span class="st">"education"</span>)])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              democ education
democ     1.0000000 0.2991782
education 0.2991782 1.0000000</code></pre>
</div>
</div>
<p>There is a positive but low linear correlation (0.3) between shift in democracy and education funding.</p>
</section>
<section id="multiple-regression-models" class="level4">
<h4 class="anchored" data-anchor-id="multiple-regression-models">Multiple regression models:</h4>
<p>First, I will check to see if either of my added control variables need to be logged.</p>
<p><strong>Education</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="co"># education</span></span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_final<span class="sc">$</span>education)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Rowley_Final_Project_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This distribution is moderately right-skewed, so I will log the education variable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log() education</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>log_education <span class="ot">&lt;-</span> <span class="fu">log</span>(data_final<span class="sc">$</span>education)</span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(log_education)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Rowley_Final_Project_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Next, I will add this logged variable to my final data set to incorporate into my regression model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform new log(eduation) variable</span></span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a>data_final <span class="ot">&lt;-</span> data_final <span class="sc">%&gt;%</span></span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">log_education=</span><span class="fu">log</span>(education))</span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               country exec_constraint year_ind log_settler_mort log_pop_dens
1              Andorra              NA     1800               NA           NA
2          Afghanistan       0.0000000     1919         4.540098    2.1202640
3               Angola       0.3333333     1975         5.634789    0.4054651
4              Albania       0.6666667     1912               NA    1.9877740
5 United Arab Emirates       0.3333333     1971               NA    0.0000000
6            Argentina       0.0000000     1816         4.232656   -2.2107220
  rel_catho80 rel_muslim80 rel_protmg80     growth democ rel_unaffiliated
1          NA           NA           NA  3.4558480    NA            0.088
2       0.000        0.993        0.000 -0.0848947  0.15            0.010
3       0.687        0.000        0.198  0.6444693  0.35            0.051
4          NA           NA           NA  1.6759930  0.75            0.014
5       0.004        0.949        0.003  3.3726190  0.10            0.011
6       0.916        0.002        0.027  2.7137030  0.90            0.122
  education       religion log_education
1  2.976630 NA, NA, NA, NA      1.090792
2  3.479450   rel_muslim80      1.246874
3  3.421320    rel_catho80      1.230026
4  3.413075 NA, NA, NA, NA      1.227614
5        NA   rel_muslim80            NA
6  5.019710    rel_catho80      1.613372</code></pre>
</div>
</div>
<p><strong>Religiously-unaffiliated population</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="co"># religiously-unaffiliated population</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_final<span class="sc">$</span>rel_unaffiliated)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Rowley_Final_Project_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This distribution is very right-skewed, so I will log the religiously-unaffiliated population variable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># log() rel_unaffiliated</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>log_rel_unaff <span class="ot">&lt;-</span> <span class="fu">log</span>(data_final<span class="sc">$</span>rel_unaffiliated)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(log_rel_unaff)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Rowley_Final_Project_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Next, I will add this logged variable to my final data set to incorporate into my regression model.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="co"># transform new log(rel_unaffiliated) variable</span></span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>data_final <span class="ot">&lt;-</span> data_final <span class="sc">%&gt;%</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">log_rel_unaff=</span><span class="fu">log</span>(rel_unaffiliated))</span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>               country exec_constraint year_ind log_settler_mort log_pop_dens
1              Andorra              NA     1800               NA           NA
2          Afghanistan       0.0000000     1919         4.540098    2.1202640
3               Angola       0.3333333     1975         5.634789    0.4054651
4              Albania       0.6666667     1912               NA    1.9877740
5 United Arab Emirates       0.3333333     1971               NA    0.0000000
6            Argentina       0.0000000     1816         4.232656   -2.2107220
  rel_catho80 rel_muslim80 rel_protmg80     growth democ rel_unaffiliated
1          NA           NA           NA  3.4558480    NA            0.088
2       0.000        0.993        0.000 -0.0848947  0.15            0.010
3       0.687        0.000        0.198  0.6444693  0.35            0.051
4          NA           NA           NA  1.6759930  0.75            0.014
5       0.004        0.949        0.003  3.3726190  0.10            0.011
6       0.916        0.002        0.027  2.7137030  0.90            0.122
  education       religion log_education log_rel_unaff
1  2.976630 NA, NA, NA, NA      1.090792     -2.430418
2  3.479450   rel_muslim80      1.246874     -4.605170
3  3.421320    rel_catho80      1.230026     -2.975930
4  3.413075 NA, NA, NA, NA      1.227614     -4.268698
5        NA   rel_muslim80            NA     -4.509860
6  5.019710    rel_catho80      1.613372     -2.103734</code></pre>
</div>
</div>
<p><strong>Original model:</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="co"># original study multiple regression model</span></span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>reg_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(democ <span class="sc">~</span> growth <span class="sc">+</span> exec_constraint <span class="sc">+</span> year_ind <span class="sc">+</span> log_settler_mort <span class="sc">+</span> log_pop_dens <span class="sc">+</span> rel_catho80 <span class="sc">+</span> rel_muslim80 <span class="sc">+</span> rel_protmg80, <span class="at">data =</span> data_final)</span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = democ ~ growth + exec_constraint + year_ind + log_settler_mort + 
    log_pop_dens + rel_catho80 + rel_muslim80 + rel_protmg80, 
    data = data_final)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.5123 -0.2113  0.0192  0.1510  0.5190 

Coefficients:
                  Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)       2.259348   1.255158   1.800   0.0764 .
growth            0.108020   0.041738   2.588   0.0118 *
exec_constraint   0.132189   0.101750   1.299   0.1983  
year_ind         -0.001112   0.000660  -1.686   0.0965 .
log_settler_mort  0.041026   0.033013   1.243   0.2183  
log_pop_dens     -0.015336   0.020631  -0.743   0.4599  
rel_catho80       0.166250   0.124138   1.339   0.1850  
rel_muslim80     -0.001560   0.120866  -0.013   0.9897  
rel_protmg80      0.375138   0.257481   1.457   0.1498  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2381 on 67 degrees of freedom
  (97 observations deleted due to missingness)
Multiple R-squared:  0.4445,    Adjusted R-squared:  0.3782 
F-statistic: 6.703 on 8 and 67 DF,  p-value: 2.04e-06</code></pre>
</div>
</div>
<p>Interestingly, we see in the original model that the relationship between shift in per capita income (“growth”) and shift in democracy is statistically significant at the 0.05 significance level (p-value=0.01). It is important to note that while the authors of “Income and Democracy” did conclude that there is no causal relationship between per capita shift in income and shift in democracy, this is not to say that there is no level of statistical significance. I will next add my additional control variables and interaction term to see if these terms cause an increase in statistical significance.</p>
<p><strong>Original model plus two control variables:</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple regression model with all variables</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>reg_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(democ <span class="sc">~</span> growth <span class="sc">+</span> exec_constraint <span class="sc">+</span> year_ind <span class="sc">+</span> log_settler_mort <span class="sc">+</span> log_pop_dens <span class="sc">+</span> rel_catho80 <span class="sc">+</span> rel_muslim80 <span class="sc">+</span> rel_protmg80 <span class="sc">+</span> log_rel_unaff <span class="sc">+</span> log_education, <span class="at">data =</span> data_final)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = democ ~ growth + exec_constraint + year_ind + log_settler_mort + 
    log_pop_dens + rel_catho80 + rel_muslim80 + rel_protmg80 + 
    log_rel_unaff + log_education, data = data_final)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40440 -0.11454  0.04055  0.12198  0.39307 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)       4.1044593  1.3841245   2.965  0.00482 **
growth            0.0604059  0.0512635   1.178  0.24485   
exec_constraint   0.2771048  0.1134864   2.442  0.01861 * 
year_ind         -0.0021348  0.0007169  -2.978  0.00466 **
log_settler_mort  0.0314009  0.0381540   0.823  0.41485   
log_pop_dens     -0.0186064  0.0228161  -0.815  0.41909   
rel_catho80       0.1287520  0.1321166   0.975  0.33500   
rel_muslim80      0.0914617  0.1673132   0.547  0.58732   
rel_protmg80      0.4323199  0.2728918   1.584  0.12015   
log_rel_unaff    -0.0531038  0.0359359  -1.478  0.14644   
log_education     0.0186680  0.0676827   0.276  0.78395   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2086 on 45 degrees of freedom
  (117 observations deleted due to missingness)
Multiple R-squared:  0.5209,    Adjusted R-squared:  0.4144 
F-statistic: 4.892 on 10 and 45 DF,  p-value: 9.054e-05</code></pre>
</div>
</div>
<p>We can see based on this multiple regression model that, when controlling for shift in per capita income, constraint on the executive at the time of independence, year of independence, (log) settler mortality rate, (log) population density, Catholic population, Muslim population, Protestant population, religiously-unaffiliated population, and education funding, there is no statistical significance between shift in per capita income (growth) and shift in democracy (democ) when the significance level is 0.05.</p>
<p>We can, however, see that year of independence (p-value=0.001) and constraint on the executive (p-value=0.02) are statistically significant on shift in democracy. Even more interesting is that religiously-unaffiliated population, a control variable that was added to this replication study, is also statistically significant in terms of its relationship with shift in democracy (p-value = 0.02).</p>
<p><strong>Original model plus two control variables and an interaction term:</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple regression with education*growth interaction term</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>reg_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(democ <span class="sc">~</span> growth<span class="sc">*</span>log_education <span class="sc">+</span> exec_constraint <span class="sc">+</span> year_ind <span class="sc">+</span> log_settler_mort <span class="sc">+</span> log_pop_dens <span class="sc">+</span> rel_catho80 <span class="sc">+</span> rel_muslim80 <span class="sc">+</span> rel_protmg80 <span class="sc">+</span> log_rel_unaff, <span class="at">data =</span> data_final)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = democ ~ growth * log_education + exec_constraint + 
    year_ind + log_settler_mort + log_pop_dens + rel_catho80 + 
    rel_muslim80 + rel_protmg80 + log_rel_unaff, data = data_final)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.40025 -0.11755  0.03737  0.11915  0.39458 

Coefficients:
                       Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)           4.1354717  1.4401179   2.872  0.00626 **
growth                0.0708509  0.1254142   0.565  0.57499   
log_education         0.0277360  0.1204740   0.230  0.81898   
exec_constraint       0.2777775  0.1149933   2.416  0.01993 * 
year_ind             -0.0021562  0.0007618  -2.830  0.00698 **
log_settler_mort      0.0309511  0.0388936   0.796  0.43043   
log_pop_dens         -0.0187166  0.0231032  -0.810  0.42223   
rel_catho80           0.1288971  0.1336063   0.965  0.33994   
rel_muslim80          0.0984125  0.1854725   0.531  0.59836   
rel_protmg80          0.4480402  0.3250997   1.378  0.17512   
log_rel_unaff        -0.0525775  0.0367914  -1.429  0.16005   
growth:log_education -0.0078169  0.0854657  -0.091  0.92754   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2109 on 44 degrees of freedom
  (117 observations deleted due to missingness)
Multiple R-squared:  0.521, Adjusted R-squared:  0.4012 
F-statistic:  4.35 on 11 and 44 DF,  p-value: 0.0002112</code></pre>
</div>
</div>
<p>In reviewing the third regression model which incorporates education*growth as an interaction term, we do see some minor shifts in p-values, but no shift is large enough to affect statistical significance. So, we can again confirm that, even when adding an interaction term, shift in per capita income is not statistically significant in terms of its relationship with shift in democracy.</p>
<p>I will now combine these three models into a single, more legible table using the ‘stargazer()’ function. We can again see that shift in income per capita is only statistically significant (though not indicative of a causal relationship) in the first model, which does not include the additional control variables or the interaction term.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="co"># use stargazer to create combined table</span></span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Please cite as: </code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code> R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a>reg_model <span class="ot">&lt;-</span> <span class="fu">stargazer</span>(reg_1, reg_2, reg_3, <span class="at">type=</span><span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
========================================================================================
                                             Dependent variable:                        
                     -------------------------------------------------------------------
                                                    democ                               
                              (1)                   (2)                    (3)          
----------------------------------------------------------------------------------------
growth                      0.108**                0.060                  0.071         
                            (0.042)               (0.051)                (0.125)        
                                                                                        
exec_constraint              0.132                0.277**                0.278**        
                            (0.102)               (0.113)                (0.115)        
                                                                                        
year_ind                    -0.001*              -0.002***              -0.002***       
                            (0.001)               (0.001)                (0.001)        
                                                                                        
log_settler_mort             0.041                 0.031                  0.031         
                            (0.033)               (0.038)                (0.039)        
                                                                                        
log_pop_dens                -0.015                 -0.019                 -0.019        
                            (0.021)               (0.023)                (0.023)        
                                                                                        
rel_catho80                  0.166                 0.129                  0.129         
                            (0.124)               (0.132)                (0.134)        
                                                                                        
rel_muslim80                -0.002                 0.091                  0.098         
                            (0.121)               (0.167)                (0.185)        
                                                                                        
rel_protmg80                 0.375                 0.432                  0.448         
                            (0.257)               (0.273)                (0.325)        
                                                                                        
log_rel_unaff                                      -0.053                 -0.053        
                                                  (0.036)                (0.037)        
                                                                                        
growth:log_education                                                      -0.008        
                                                                         (0.085)        
                                                                                        
log_education                                      0.019                  0.028         
                                                  (0.068)                (0.120)        
                                                                                        
Constant                    2.259*                4.104***               4.135***       
                            (1.255)               (1.384)                (1.440)        
                                                                                        
----------------------------------------------------------------------------------------
Observations                  76                     56                     56          
R2                           0.445                 0.521                  0.521         
Adjusted R2                  0.378                 0.414                  0.401         
Residual Std. Error     0.238 (df = 67)       0.209 (df = 45)        0.211 (df = 44)    
F Statistic          6.703*** (df = 8; 67) 4.892*** (df = 10; 45) 4.350*** (df = 11; 44)
========================================================================================
Note:                                                        *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(reg_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] ""                                                                                        
 [2] "========================================================================================"
 [3] "                                             Dependent variable:                        "
 [4] "                     -------------------------------------------------------------------"
 [5] "                                                    democ                               "
 [6] "                              (1)                   (2)                    (3)          "
 [7] "----------------------------------------------------------------------------------------"
 [8] "growth                      0.108**                0.060                  0.071         "
 [9] "                            (0.042)               (0.051)                (0.125)        "
[10] "                                                                                        "
[11] "exec_constraint              0.132                0.277**                0.278**        "
[12] "                            (0.102)               (0.113)                (0.115)        "
[13] "                                                                                        "
[14] "year_ind                    -0.001*              -0.002***              -0.002***       "
[15] "                            (0.001)               (0.001)                (0.001)        "
[16] "                                                                                        "
[17] "log_settler_mort             0.041                 0.031                  0.031         "
[18] "                            (0.033)               (0.038)                (0.039)        "
[19] "                                                                                        "
[20] "log_pop_dens                -0.015                 -0.019                 -0.019        "
[21] "                            (0.021)               (0.023)                (0.023)        "
[22] "                                                                                        "
[23] "rel_catho80                  0.166                 0.129                  0.129         "
[24] "                            (0.124)               (0.132)                (0.134)        "
[25] "                                                                                        "
[26] "rel_muslim80                -0.002                 0.091                  0.098         "
[27] "                            (0.121)               (0.167)                (0.185)        "
[28] "                                                                                        "
[29] "rel_protmg80                 0.375                 0.432                  0.448         "
[30] "                            (0.257)               (0.273)                (0.325)        "
[31] "                                                                                        "
[32] "log_rel_unaff                                      -0.053                 -0.053        "
[33] "                                                  (0.036)                (0.037)        "
[34] "                                                                                        "
[35] "growth:log_education                                                      -0.008        "
[36] "                                                                         (0.085)        "
[37] "                                                                                        "
[38] "log_education                                      0.019                  0.028         "
[39] "                                                  (0.068)                (0.120)        "
[40] "                                                                                        "
[41] "Constant                    2.259*                4.104***               4.135***       "
[42] "                            (1.255)               (1.384)                (1.440)        "
[43] "                                                                                        "
[44] "----------------------------------------------------------------------------------------"
[45] "Observations                  76                     56                     56          "
[46] "R2                           0.445                 0.521                  0.521         "
[47] "Adjusted R2                  0.378                 0.414                  0.401         "
[48] "Residual Std. Error     0.238 (df = 67)       0.209 (df = 45)        0.211 (df = 44)    "
[49] "F Statistic          6.703*** (df = 8; 67) 4.892*** (df = 10; 45) 4.350*** (df = 11; 44)"
[50] "========================================================================================"
[51] "Note:                                                        *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01"</code></pre>
</div>
</div>
<p><strong>Results of hypothesis test:</strong> We can see based on these regression models that education funding, religiously-unaffiliated population, and education funding*shift in per capita income actually lead to decreased statistical significance between shift in income per capita and shift in democracy. Thus, while these terms do change the causal relationship between shift in per capita income and shift in democracy, the regression outcome ultimately disproves my hypothesis.</p>
</section>
<section id="model-comparison" class="level4">
<h4 class="anchored" data-anchor-id="model-comparison">Model Comparison:</h4>
<p><strong>Adjusted R-Squared</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted R-squared</span></span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(reg_model)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] ""                                                                                        
 [2] "========================================================================================"
 [3] "                                             Dependent variable:                        "
 [4] "                     -------------------------------------------------------------------"
 [5] "                                                    democ                               "
 [6] "                              (1)                   (2)                    (3)          "
 [7] "----------------------------------------------------------------------------------------"
 [8] "growth                      0.108**                0.060                  0.071         "
 [9] "                            (0.042)               (0.051)                (0.125)        "
[10] "                                                                                        "
[11] "exec_constraint              0.132                0.277**                0.278**        "
[12] "                            (0.102)               (0.113)                (0.115)        "
[13] "                                                                                        "
[14] "year_ind                    -0.001*              -0.002***              -0.002***       "
[15] "                            (0.001)               (0.001)                (0.001)        "
[16] "                                                                                        "
[17] "log_settler_mort             0.041                 0.031                  0.031         "
[18] "                            (0.033)               (0.038)                (0.039)        "
[19] "                                                                                        "
[20] "log_pop_dens                -0.015                 -0.019                 -0.019        "
[21] "                            (0.021)               (0.023)                (0.023)        "
[22] "                                                                                        "
[23] "rel_catho80                  0.166                 0.129                  0.129         "
[24] "                            (0.124)               (0.132)                (0.134)        "
[25] "                                                                                        "
[26] "rel_muslim80                -0.002                 0.091                  0.098         "
[27] "                            (0.121)               (0.167)                (0.185)        "
[28] "                                                                                        "
[29] "rel_protmg80                 0.375                 0.432                  0.448         "
[30] "                            (0.257)               (0.273)                (0.325)        "
[31] "                                                                                        "
[32] "log_rel_unaff                                      -0.053                 -0.053        "
[33] "                                                  (0.036)                (0.037)        "
[34] "                                                                                        "
[35] "growth:log_education                                                      -0.008        "
[36] "                                                                         (0.085)        "
[37] "                                                                                        "
[38] "log_education                                      0.019                  0.028         "
[39] "                                                  (0.068)                (0.120)        "
[40] "                                                                                        "
[41] "Constant                    2.259*                4.104***               4.135***       "
[42] "                            (1.255)               (1.384)                (1.440)        "
[43] "                                                                                        "
[44] "----------------------------------------------------------------------------------------"
[45] "Observations                  76                     56                     56          "
[46] "R2                           0.445                 0.521                  0.521         "
[47] "Adjusted R2                  0.378                 0.414                  0.401         "
[48] "Residual Std. Error     0.238 (df = 67)       0.209 (df = 45)        0.211 (df = 44)    "
[49] "F Statistic          6.703*** (df = 8; 67) 4.892*** (df = 10; 45) 4.350*** (df = 11; 44)"
[50] "========================================================================================"
[51] "Note:                                                        *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01"</code></pre>
</div>
</div>
<p>We can see in the stargazer table above that “reg_2,” or the regression model that includes the additional control variables but not the interaction term, has the highest adjusted R-squared value , which is an indicator of best fit as it represents the model with the smallest residuals.</p>
<p><strong>PRESS</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># PRESS</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MPV)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'MPV' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: lattice</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: KernSmooth</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>KernSmooth 2.23 loaded
Copyright M. P. Wand 1997-2009</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: randomForest</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'randomForest' was built under R version 4.2.2</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>randomForest 4.7-1.1</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Type rfNews() to see new features/changes/bug fixes.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'randomForest'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    combine</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:ggplot2':

    margin</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reg_1 = 4.999083</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">PRESS</span>(reg_1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 4.999083</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reg_2 = 3.258505</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a><span class="fu">PRESS</span>(reg_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.258505</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="co">#reg_3 = 3.460336</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="fu">PRESS</span>(reg_3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.460336</code></pre>
</div>
</div>
<p>We can see in the above Predicted Residual Sum of Squares (PRESS) tests that “reg_2,” or the regression model that includes the additional control variables but not the interaction term, has the lowest PRESS value, thus indicating that it is the best-fit model.</p>
<p><strong>AIC</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co"># select number of observations from reg_1 to match reg_2 and reg_3</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>reg_1_data <span class="ot">&lt;-</span> data_final</span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="co"># set observations to sample</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a>observations <span class="ot">&lt;-</span> <span class="dv">136</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">14</span>)</span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="co"># select observations</span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a>sampled_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(reg_1_data), observations)</span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a>sampled_data <span class="ot">&lt;-</span> reg_1_data[sampled_indices, ]</span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a><span class="co"># fit  model with sample data</span></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a>reg_1_sample <span class="ot">&lt;-</span> <span class="fu">lm</span>(democ <span class="sc">~</span> growth <span class="sc">+</span> exec_constraint <span class="sc">+</span> year_ind <span class="sc">+</span> log_settler_mort <span class="sc">+</span> log_pop_dens <span class="sc">+</span> rel_catho80 <span class="sc">+</span> rel_muslim80 <span class="sc">+</span> rel_protmg80, <span class="at">data=</span>sampled_data)</span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a>reg_1_sample</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = democ ~ growth + exec_constraint + year_ind + log_settler_mort + 
    log_pop_dens + rel_catho80 + rel_muslim80 + rel_protmg80, 
    data = sampled_data)

Coefficients:
     (Intercept)            growth   exec_constraint          year_ind  
        3.963300          0.057183          0.226591         -0.001926  
log_settler_mort      log_pop_dens       rel_catho80      rel_muslim80  
        0.042039         -0.011438          0.043297         -0.044685  
    rel_protmg80  
        0.214080  </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check number of observations</span></span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>reg_model <span class="ot">&lt;-</span> <span class="fu">stargazer</span>(reg_1_sample, reg_2, reg_3, <span class="at">type=</span><span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
========================================================================================
                                             Dependent variable:                        
                     -------------------------------------------------------------------
                                                    democ                               
                              (1)                   (2)                    (3)          
----------------------------------------------------------------------------------------
growth                       0.057                 0.060                  0.071         
                            (0.053)               (0.051)                (0.125)        
                                                                                        
exec_constraint             0.227*                0.277**                0.278**        
                            (0.122)               (0.113)                (0.115)        
                                                                                        
year_ind                   -0.002**              -0.002***              -0.002***       
                            (0.001)               (0.001)                (0.001)        
                                                                                        
log_settler_mort             0.042                 0.031                  0.031         
                            (0.039)               (0.038)                (0.039)        
                                                                                        
log_pop_dens                -0.011                 -0.019                 -0.019        
                            (0.023)               (0.023)                (0.023)        
                                                                                        
rel_catho80                  0.043                 0.129                  0.129         
                            (0.146)               (0.132)                (0.134)        
                                                                                        
rel_muslim80                -0.045                 0.091                  0.098         
                            (0.156)               (0.167)                (0.185)        
                                                                                        
rel_protmg80                 0.214                 0.432                  0.448         
                            (0.304)               (0.273)                (0.325)        
                                                                                        
log_rel_unaff                                      -0.053                 -0.053        
                                                  (0.036)                (0.037)        
                                                                                        
growth:log_education                                                      -0.008        
                                                                         (0.085)        
                                                                                        
log_education                                      0.019                  0.028         
                                                  (0.068)                (0.120)        
                                                                                        
Constant                    3.963**               4.104***               4.135***       
                            (1.565)               (1.384)                (1.440)        
                                                                                        
----------------------------------------------------------------------------------------
Observations                  56                     56                     56          
R2                           0.436                 0.521                  0.521         
Adjusted R2                  0.340                 0.414                  0.401         
Residual Std. Error     0.229 (df = 47)       0.209 (df = 45)        0.211 (df = 44)    
F Statistic          4.541*** (df = 8; 47) 4.892*** (df = 10; 45) 4.350*** (df = 11; 44)
========================================================================================
Note:                                                        *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC</span></span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'AICcmodavg' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'AICcmodavg'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:randomForest':

    importance</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(reg_1_sample, reg_2, reg_3)</span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a>mod.names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'reg_1_sample'</span>, <span class="st">'reg_2'</span>, <span class="st">'reg_3'</span>)</span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(<span class="at">cand.set =</span> models, <span class="at">modnames =</span> mod.names)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Model selection based on AICc:

              K AICc Delta_AICc AICcWt Cum.Wt    LL
reg_2        12  2.4       0.00   0.82   0.82 14.43
reg_3        13  5.8       3.40   0.15   0.97 14.44
reg_1_sample 10  9.0       6.61   0.03   1.00  7.94</code></pre>
</div>
</div>
<p>We can see that based on the Akaike Information Criterion (AIC) test, “reg_2,” or the regression model that includes the additional control variables but not the interaction term, has the lowest AICc value. Therefore, because minimizing the AICc value equates to minimizing the number of unnecessary model parameters, “reg_2” is the best fit.</p>
</section>
<section id="diagnostics" class="level4">
<h4 class="anchored" data-anchor-id="diagnostics">Diagnostics:</h4>
<p>Based on the Adjusted R-Squared, PRESS, and AIC tests, “reg_2,” or the regression model that includes the additional control variables but not the interaction term, is universally considered the model of best fit.</p>
<p><strong>Diagnostic plots for the final model (reg_2):</strong></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plots for reg_2</span></span>
<span id="cb148-2"><a href="#cb148-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb148-3"><a href="#cb148-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb148-4"><a href="#cb148-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg_2, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Rowley_Final_Project_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li><p><strong>Residuals vs.&nbsp;Fitted</strong>: In applying the Residuals vs.&nbsp;Fitted plot, we can observe a violation due to the curvature of the red line. We also see that the distribution of data points does not “bounce randomly” about the 0 line. This plot is therefore a <strong>bad fit</strong> for this regression model.</p></li>
<li><p><strong>Normal Q-Q</strong>: In applying the Normal Q-Q plot, we observe that the data points do generally fall along the 0 line, which is indicative of a <strong>good fit</strong> for this regression model.</p></li>
<li><p><strong>Scale-Location</strong>: In applying the Scale-Location plot, we observe what appears to be heteroscedasticity across the data points as well as a non-horizontal red line. Because see indications of heteroscedasticity, we should run a Breusch-Pagan test to confirm.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lmtest)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'lmtest' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: zoo</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: package 'zoo' was built under R version 4.2.3</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'zoo'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    as.Date, as.Date.numeric</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a>bp_test <span class="ot">&lt;-</span> <span class="fu">lm</span>(democ <span class="sc">~</span> growth <span class="sc">+</span> exec_constraint <span class="sc">+</span> year_ind <span class="sc">+</span> log_settler_mort <span class="sc">+</span> log_pop_dens <span class="sc">+</span> rel_catho80 <span class="sc">+</span> rel_muslim80 <span class="sc">+</span> rel_protmg80 <span class="sc">+</span> log_rel_unaff <span class="sc">+</span> log_education, <span class="at">data =</span> data_final)</span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a><span class="fu">bptest</span>(bp_test)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
    studentized Breusch-Pagan test

data:  bp_test
BP = 9.8732, df = 10, p-value = 0.4517</code></pre>
</div>
</div>
<p>The results of the Breusch-Pagan test show that we cannot reject the null hypothesis (p-value=0.45), which in this case is homoscedasticity. So, there is no violation of the assumption of homoscedasticity. This plot is therefore a <strong>good fit</strong> for this regression model.</p></li>
<li><p><strong>Cook’s Distance</strong>: In applying the Cook’s Distance plot, we observe a violation due to several data points yielding a Cook’s distance value greater than 1. This plot is therefore a <strong>bad fit</strong> for this regression model.</p></li>
<li><p><strong>Residuals vs.&nbsp;Leverage</strong>: In applying the Residuals vs.&nbsp;Leverage plot, we can see that there are no data points outside of the dashed lines marked with ‘0.5.’ This plot is therefore a <strong>good fit</strong> for this regression model.</p></li>
<li><p><strong>Cook’s Distance vs.&nbsp;Leverage</strong>: In applying the Cook’s Distance vs.&nbsp;Leverage plot, we do not really observe any influential data points. This plot does not contribute any value to this regression model.</p></li>
</ul>
</section>
</section>
<section id="sources" class="level3">
<h3 class="anchored" data-anchor-id="sources">Sources:</h3>
<ol type="1">
<li><strong>Data set</strong>: Acemoglu, Daron, et al.&nbsp;"Replication Data For: Income and Democracy." <em>American Economic Association</em>, vol.&nbsp;1, 12 Oct.&nbsp;2019, www.openicpsr.org/openicpsr/project/113251/version/V1/view?path=%2Fopenicpsr%2F113251%2Ffcr%3Aversions%2FV1%2FIncome-and-Democracy-Data-AER-adjustment.xls&amp;type=file, https://doi.org/10.3886/e113251v1.</li>
<li><strong>Study</strong>: Acemoglu, D., Johnson, S., Robinson, J. A., &amp; Yared, P. (2008, June 3). <em>Income and democracy</em>. American Economic Review. https://www.aeaweb.org/articles?id=10.1257%2Faer.98.3.808</li>
<li><strong>Comparison study</strong>: Barro, Robert&nbsp;J. "Determinants of Democracy." <em>Journal of Political Economy</em>, vol.&nbsp;107, no. S6, Dec.&nbsp;1999, pp.&nbsp;S158–S183, https://doi.org/10.1086/250107.und</li>
<li><strong>Additional religious affiliation variables</strong>: Datopian. "World Religion Projections." <em>DataHub</em>, 2018, datahub.io/sagargg/world-religion-projections#data.</li>
<li><strong>Education variable</strong>: The World Bank. "Government Expenditure on Education, Total (% of GDP) | Data." <em>Worldbank.org</em>, 2019, data.worldbank.org/indicator/SE.XPD.TOTL.GD.ZS.</li>
</ol>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/603_Spring_2023" data-repo-id="R_kgDOI4oXIA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb157" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project"</span></span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Caitlin Rowley"</span></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "This project provides a high-level overview of the data set I will be using for my final project. The data set, titled 'Income and Democracy,' was published by the American Economic Consortium in 2008."</span></span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "05/25/2023"</span></span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb157-8"><a href="#cb157-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb157-9"><a href="#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb157-10"><a href="#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb157-11"><a href="#cb157-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb157-12"><a href="#cb157-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb157-13"><a href="#cb157-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - final</span></span>
<span id="cb157-14"><a href="#cb157-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb157-15"><a href="#cb157-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-16"><a href="#cb157-16" aria-hidden="true" tabindex="-1"></a><span class="fu">### Background and Research Question:</span></span>
<span id="cb157-17"><a href="#cb157-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-18"><a href="#cb157-18" aria-hidden="true" tabindex="-1"></a>My research question will focus on the cross-country correlation between income and democracy. A 2008 study titled "Income and Democracy," published in the American Economic Review, argues that existing studies that establish a strong cross-country correlation between income and democracy do not control for factors that simultaneously affect both variables. Accordingly, this study, which focuses on changes in democracy over the past 500 years, controls for certain country-fixed effects---such as date of independence, constraints on the executive, and religious affiliation---thereby voiding any causal relationship between income per capita and various measures of democracy. This study is the source for my data set.</span>
<span id="cb157-19"><a href="#cb157-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-20"><a href="#cb157-20" aria-hidden="true" tabindex="-1"></a>The authors of "Income and Democracy" included a wide range of variables in their study; specifically, they tested the significance of constraint on the executive; year of independence; settler mortality; population density; Catholic population; Muslim population; Protestant population; shift in per capita income; and shift in democracy. As noted, the authors asserted that after controlling for all the aforementioned country-fixed effects, there is no evidence of a causal relationship between income and democracy over time. Interestingly, the study also indicated that education was determined to be statistically insignificant as an independent, country-fixed effect on the correlation between income and democracy, and it was thus excluded from the study.</span>
<span id="cb157-21"><a href="#cb157-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-22"><a href="#cb157-22" aria-hidden="true" tabindex="-1"></a>In contrast to "Income and Democracy," a 1999 study titled "Determinants of Democracy," authored by Robert J. Barro, indicates that additional improvements to the standard of living do, in fact, predict an increase in democracy. Barro suggests not only that education is an indicator of the correlation between income democracy, but that the pervasiveness of select religious affiliations is, as well. Specifically, Barro claimed that the negative effects from Muslim and non‐religious affiliations remain statistically significant in this association regardless of external control factors.</span>
<span id="cb157-23"><a href="#cb157-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-24"><a href="#cb157-24" aria-hidden="true" tabindex="-1"></a>This incongruity led me to wonder whether we would see a causal relationship between income and democracy if the economic variables used in the two studies were more aligned. Specifically, I would like to examine how this change would affect both studies' claims on the role of religious affiliation; in other words, will adding explanatory variables related to religious affiliation---specifically, non-religious affiliation---cause a shift in the lack of correlation between income and democracy? Additionally, given "Income and Democracy's" declaration on the statistical insignificance of education as a country-fixed effect, I am also interested in seeing whether adding an interaction term---specifically, government expenditure on education---will have an effect on this relationship.</span>
<span id="cb157-25"><a href="#cb157-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-26"><a href="#cb157-26" aria-hidden="true" tabindex="-1"></a>**Research question**: How will adding non-religious affiliation as an additional control variable and education as an interaction term impact the lack of causal relationship between income and democracy?</span>
<span id="cb157-27"><a href="#cb157-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-28"><a href="#cb157-28" aria-hidden="true" tabindex="-1"></a><span class="fu">### Hypothesis:</span></span>
<span id="cb157-29"><a href="#cb157-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-30"><a href="#cb157-30" aria-hidden="true" tabindex="-1"></a>After reviewing "Income and Democracy," it does not appear that non-religious affiliation was integrated into the report. Further, as the authors noted its lack of statistical significance related to its causal effect on the relationship between income democracy, neither is education. However, I am curious about how the inclusion of these two variables would affect Barro's conclusion relative to the correlation between religious affiliation and democracy. As such, by adding these variables, I will be revisiting a previously-tested hypothesis.</span>
<span id="cb157-31"><a href="#cb157-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-32"><a href="#cb157-32" aria-hidden="true" tabindex="-1"></a>I hypothesize that adding non-religious affiliation and education as additional control variables, and education<span class="sc">\*</span>shift in per capita income as an interaction term will lead to increased statistical significance between income and democracy.</span>
<span id="cb157-33"><a href="#cb157-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-34"><a href="#cb157-34" aria-hidden="true" tabindex="-1"></a><span class="fu">### Descriptive Statistics:</span></span>
<span id="cb157-35"><a href="#cb157-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-36"><a href="#cb157-36" aria-hidden="true" tabindex="-1"></a>Data for this study was collected from the Freedom House Political Rights Index, the Polity Composite Democracy Index, and data from other studies conducted by Barro and Kenneth A. Bollen.</span>
<span id="cb157-37"><a href="#cb157-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-38"><a href="#cb157-38" aria-hidden="true" tabindex="-1"></a>Variables I will be focusing on include:</span>
<span id="cb157-39"><a href="#cb157-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-40"><a href="#cb157-40" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Country;</span>
<span id="cb157-41"><a href="#cb157-41" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Constraint on the executive;</span>
<span id="cb157-42"><a href="#cb157-42" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Year of independence;</span>
<span id="cb157-43"><a href="#cb157-43" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Settler mortality;</span>
<span id="cb157-44"><a href="#cb157-44" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Population density;</span>
<span id="cb157-45"><a href="#cb157-45" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Catholic population;</span>
<span id="cb157-46"><a href="#cb157-46" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Muslim population;</span>
<span id="cb157-47"><a href="#cb157-47" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Protestant population;</span>
<span id="cb157-48"><a href="#cb157-48" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Religiously-unaffiliated population;</span>
<span id="cb157-49"><a href="#cb157-49" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Education funding;</span>
<span id="cb157-50"><a href="#cb157-50" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Shift in per capita income; and</span>
<span id="cb157-51"><a href="#cb157-51" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>Shift in democracy.</span>
<span id="cb157-52"><a href="#cb157-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-55"><a href="#cb157-55" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-56"><a href="#cb157-56" aria-hidden="true" tabindex="-1"></a><span class="co"># load libraries:</span></span>
<span id="cb157-57"><a href="#cb157-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-58"><a href="#cb157-58" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb157-59"><a href="#cb157-59" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb157-60"><a href="#cb157-60" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb157-61"><a href="#cb157-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-62"><a href="#cb157-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-65"><a href="#cb157-65" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-66"><a href="#cb157-66" aria-hidden="true" tabindex="-1"></a><span class="co"># read in data file:</span></span>
<span id="cb157-67"><a href="#cb157-67" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-68"><a href="#cb157-68" aria-hidden="true" tabindex="-1"></a>data_file <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"C:/Users/caitr/OneDrive/Documents/DACSS/DACSS 603/603_Spring_2023/posts/_data/Income-Democracy.xls"</span>, <span class="at">sheet =</span> <span class="st">"500 Year Panel"</span>)</span>
<span id="cb157-69"><a href="#cb157-69" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_file)</span>
<span id="cb157-70"><a href="#cb157-70" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-71"><a href="#cb157-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-74"><a href="#cb157-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-75"><a href="#cb157-75" aria-hidden="true" tabindex="-1"></a><span class="co"># remove dummy/unnecessary variables (as identified in study's variable key):</span></span>
<span id="cb157-76"><a href="#cb157-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-77"><a href="#cb157-77" aria-hidden="true" tabindex="-1"></a>data_cln <span class="ot">=</span> <span class="fu">subset</span>(data_file, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(code, world, colony, indcent, madid))</span>
<span id="cb157-78"><a href="#cb157-78" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_cln)</span>
<span id="cb157-79"><a href="#cb157-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-80"><a href="#cb157-80" aria-hidden="true" tabindex="-1"></a><span class="co"># rename variables</span></span>
<span id="cb157-81"><a href="#cb157-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-82"><a href="#cb157-82" aria-hidden="true" tabindex="-1"></a>data_cln2 <span class="ot">&lt;-</span> data_cln <span class="sc">%&gt;%</span> <span class="fu">rename</span>(<span class="st">"exec_constraint"</span><span class="ot">=</span><span class="st">"consfirstaug"</span>, <span class="st">"year_ind"</span><span class="ot">=</span><span class="st">"indyear"</span>, <span class="st">"log_settler_mort"</span><span class="ot">=</span><span class="st">"logem4"</span>, <span class="st">"log_pop_dens"</span><span class="ot">=</span><span class="st">"lpd1500s"</span>)</span>
<span id="cb157-83"><a href="#cb157-83" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_cln2)</span>
<span id="cb157-84"><a href="#cb157-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-85"><a href="#cb157-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-88"><a href="#cb157-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-89"><a href="#cb157-89" aria-hidden="true" tabindex="-1"></a><span class="co"># remove duplicates:</span></span>
<span id="cb157-90"><a href="#cb157-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-91"><a href="#cb157-91" aria-hidden="true" tabindex="-1"></a>duplicates <span class="ot">&lt;-</span> <span class="fu">duplicated</span>(data_cln2)</span>
<span id="cb157-92"><a href="#cb157-92" aria-hidden="true" tabindex="-1"></a>duplicates[<span class="st">"TRUE"</span>]</span>
<span id="cb157-93"><a href="#cb157-93" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-94"><a href="#cb157-94" aria-hidden="true" tabindex="-1"></a><span class="co"># remove blank observations (observations with some NAs are not removed):</span></span>
<span id="cb157-95"><a href="#cb157-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-96"><a href="#cb157-96" aria-hidden="true" tabindex="-1"></a>data_blank <span class="ot">&lt;-</span> data_cln2[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(data_cln2)) <span class="sc">!=</span> <span class="fu">ncol</span>(data_cln2), ]</span>
<span id="cb157-97"><a href="#cb157-97" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_blank)</span>
<span id="cb157-98"><a href="#cb157-98" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-99"><a href="#cb157-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-102"><a href="#cb157-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-103"><a href="#cb157-103" aria-hidden="true" tabindex="-1"></a><span class="co"># remove some NAs for description but not analysis:</span></span>
<span id="cb157-104"><a href="#cb157-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-105"><a href="#cb157-105" aria-hidden="true" tabindex="-1"></a>data_NA <span class="ot">&lt;-</span> data_blank[<span class="fu">rowSums</span>(<span class="fu">is.na</span>(data_cln2)) <span class="sc">==</span> <span class="dv">0</span>, ]</span>
<span id="cb157-106"><a href="#cb157-106" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_NA)</span>
<span id="cb157-107"><a href="#cb157-107" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-108"><a href="#cb157-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-111"><a href="#cb157-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-112"><a href="#cb157-112" aria-hidden="true" tabindex="-1"></a><span class="co"># confirm data frame size of clean data set:</span></span>
<span id="cb157-113"><a href="#cb157-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-114"><a href="#cb157-114" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(data_cln2)</span>
<span id="cb157-115"><a href="#cb157-115" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-116"><a href="#cb157-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-117"><a href="#cb157-117" aria-hidden="true" tabindex="-1"></a>We can see that this data set has 10 variables and 173 observations (though there will be 12 variables once I collect and add data related to education and non-religious affiliation). There are no duplicate observations, nor are there any blank observations. However, in the case that we remove observations with any missing values, the data set would only have 76 observations. Nonetheless, because the study's authors elected to utilize incomplete observations, I will do the same.</span>
<span id="cb157-118"><a href="#cb157-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-121"><a href="#cb157-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-122"><a href="#cb157-122" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of data (remove categorical variables):</span></span>
<span id="cb157-123"><a href="#cb157-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-124"><a href="#cb157-124" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(summarytools)</span>
<span id="cb157-125"><a href="#cb157-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-126"><a href="#cb157-126" aria-hidden="true" tabindex="-1"></a>summary <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_cln2, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(country))</span>
<span id="cb157-127"><a href="#cb157-127" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(summary)</span>
<span id="cb157-128"><a href="#cb157-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-129"><a href="#cb157-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-130"><a href="#cb157-130" aria-hidden="true" tabindex="-1"></a>We can see here a data frame containing summary statistics for the 9 variables with numeric data, as the categorical variable simply indicates the country name. These statistics will be more meaningful upon following the addition of data related to education and non-religious affiliation.</span>
<span id="cb157-131"><a href="#cb157-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-132"><a href="#cb157-132" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data Merge:</span></span>
<span id="cb157-133"><a href="#cb157-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-136"><a href="#cb157-136" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-137"><a href="#cb157-137" aria-hidden="true" tabindex="-1"></a><span class="co"># import new religious affiliation variables</span></span>
<span id="cb157-138"><a href="#cb157-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-139"><a href="#cb157-139" aria-hidden="true" tabindex="-1"></a>relig_1 <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"C:/Users/caitr/OneDrive/Documents/DACSS/DACSS 603/603_Spring_2023/posts/_data/DACSS603_religious_aff.csv"</span>)</span>
<span id="cb157-140"><a href="#cb157-140" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_1)</span>
<span id="cb157-141"><a href="#cb157-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-142"><a href="#cb157-142" aria-hidden="true" tabindex="-1"></a><span class="co"># convert percentages to decimals</span></span>
<span id="cb157-143"><a href="#cb157-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-144"><a href="#cb157-144" aria-hidden="true" tabindex="-1"></a>relig_dec <span class="ot">&lt;-</span> <span class="fu">transform</span>(relig_1, <span class="at">rel_unaffiliated =</span> (Unaffiliated<span class="sc">/</span><span class="dv">100</span>), <span class="at">Jewish =</span> (Jews<span class="sc">/</span><span class="dv">100</span>), <span class="at">Hindu =</span> (Hindus<span class="sc">/</span><span class="dv">100</span>), <span class="at">Buddhist =</span> (Buddhists<span class="sc">/</span><span class="dv">100</span>))</span>
<span id="cb157-145"><a href="#cb157-145" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_dec)</span>
<span id="cb157-146"><a href="#cb157-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-147"><a href="#cb157-147" aria-hidden="true" tabindex="-1"></a><span class="co"># remove "all countries" from 'country' variable</span></span>
<span id="cb157-148"><a href="#cb157-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-149"><a href="#cb157-149" aria-hidden="true" tabindex="-1"></a>relig_country <span class="ot">&lt;-</span> relig_dec[<span class="sc">!</span>(relig_dec<span class="sc">$</span>Country<span class="sc">==</span><span class="st">"All Countries"</span>),]</span>
<span id="cb157-150"><a href="#cb157-150" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_country)</span>
<span id="cb157-151"><a href="#cb157-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-152"><a href="#cb157-152" aria-hidden="true" tabindex="-1"></a><span class="co"># remove unneeded columns</span></span>
<span id="cb157-153"><a href="#cb157-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-154"><a href="#cb157-154" aria-hidden="true" tabindex="-1"></a>relig_vars <span class="ot">&lt;-</span> <span class="fu">subset</span>(relig_country, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Region, Buddhists, Christians, Folk.Religions, Hindus, Hindu, Jews, Jewish, Buddhist, Muslims, Other.Religions, Unaffiliated))</span>
<span id="cb157-155"><a href="#cb157-155" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_vars)</span>
<span id="cb157-156"><a href="#cb157-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-157"><a href="#cb157-157" aria-hidden="true" tabindex="-1"></a><span class="co"># use data from 2010 (comparable to base data set)</span></span>
<span id="cb157-158"><a href="#cb157-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-159"><a href="#cb157-159" aria-hidden="true" tabindex="-1"></a>relig_2010 <span class="ot">&lt;-</span> relig_vars[<span class="sc">!</span>(relig_vars<span class="sc">$</span>Year<span class="sc">==</span><span class="st">"2020"</span> <span class="sc">|</span> relig_vars<span class="sc">$</span>Year<span class="sc">==</span><span class="st">"2030"</span> <span class="sc">|</span> relig_vars<span class="sc">$</span>Year<span class="sc">==</span><span class="st">"2040"</span> <span class="sc">|</span> relig_vars<span class="sc">$</span>Year<span class="sc">==</span><span class="st">"2050"</span>),]</span>
<span id="cb157-160"><a href="#cb157-160" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_2010)</span>
<span id="cb157-161"><a href="#cb157-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-162"><a href="#cb157-162" aria-hidden="true" tabindex="-1"></a><span class="co"># remove duplicates</span></span>
<span id="cb157-163"><a href="#cb157-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-164"><a href="#cb157-164" aria-hidden="true" tabindex="-1"></a>rel_duplicates <span class="ot">&lt;-</span> <span class="fu">duplicated</span>(relig_2010)</span>
<span id="cb157-165"><a href="#cb157-165" aria-hidden="true" tabindex="-1"></a>rel_duplicates[<span class="st">"TRUE"</span>]</span>
<span id="cb157-166"><a href="#cb157-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-167"><a href="#cb157-167" aria-hidden="true" tabindex="-1"></a><span class="co"># remove "year" column</span></span>
<span id="cb157-168"><a href="#cb157-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-169"><a href="#cb157-169" aria-hidden="true" tabindex="-1"></a>relig_cln <span class="ot">&lt;-</span> <span class="fu">subset</span>(relig_2010, <span class="at">select =</span> <span class="sc">-</span><span class="fu">c</span>(Year))</span>
<span id="cb157-170"><a href="#cb157-170" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(relig_cln)</span>
<span id="cb157-171"><a href="#cb157-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-172"><a href="#cb157-172" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with data_file</span></span>
<span id="cb157-173"><a href="#cb157-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-174"><a href="#cb157-174" aria-hidden="true" tabindex="-1"></a>data_combined <span class="ot">&lt;-</span> <span class="fu">left_join</span>(data_cln2, relig_cln,</span>
<span id="cb157-175"><a href="#cb157-175" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"country"</span> <span class="ot">=</span> <span class="st">"Country"</span>))</span>
<span id="cb157-176"><a href="#cb157-176" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_combined)</span>
<span id="cb157-177"><a href="#cb157-177" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-178"><a href="#cb157-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-181"><a href="#cb157-181" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-182"><a href="#cb157-182" aria-hidden="true" tabindex="-1"></a><span class="co"># merge additional control: education expenditure (GDP)</span></span>
<span id="cb157-183"><a href="#cb157-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-184"><a href="#cb157-184" aria-hidden="true" tabindex="-1"></a>edu <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"C:/Users/caitr/OneDrive/Documents/DACSS/DACSS 603/603_Spring_2023/posts/_data/DACSS603_edu_expend.csv"</span>)</span>
<span id="cb157-185"><a href="#cb157-185" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(edu)</span>
<span id="cb157-186"><a href="#cb157-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-187"><a href="#cb157-187" aria-hidden="true" tabindex="-1"></a><span class="co"># remove unneeded columns</span></span>
<span id="cb157-188"><a href="#cb157-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-189"><a href="#cb157-189" aria-hidden="true" tabindex="-1"></a>edu_vars <span class="ot">&lt;-</span> <span class="fu">subset</span>(edu, <span class="at">select =</span> <span class="fu">c</span>(<span class="st">"Country Name"</span>, <span class="st">"2010"</span>))</span>
<span id="cb157-190"><a href="#cb157-190" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(edu_vars)</span>
<span id="cb157-191"><a href="#cb157-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-192"><a href="#cb157-192" aria-hidden="true" tabindex="-1"></a><span class="co"># remove duplicates</span></span>
<span id="cb157-193"><a href="#cb157-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-194"><a href="#cb157-194" aria-hidden="true" tabindex="-1"></a>edu_duplicates <span class="ot">&lt;-</span> <span class="fu">duplicated</span>(edu_vars)</span>
<span id="cb157-195"><a href="#cb157-195" aria-hidden="true" tabindex="-1"></a>edu_duplicates[<span class="st">"TRUE"</span>]</span>
<span id="cb157-196"><a href="#cb157-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-197"><a href="#cb157-197" aria-hidden="true" tabindex="-1"></a><span class="co"># merge with combined data</span></span>
<span id="cb157-198"><a href="#cb157-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-199"><a href="#cb157-199" aria-hidden="true" tabindex="-1"></a>data_merge <span class="ot">&lt;-</span> <span class="fu">left_join</span>(data_combined, edu_vars,</span>
<span id="cb157-200"><a href="#cb157-200" aria-hidden="true" tabindex="-1"></a>                   <span class="at">by =</span> <span class="fu">c</span>(<span class="st">"country"</span> <span class="ot">=</span> <span class="st">"Country Name"</span>))</span>
<span id="cb157-201"><a href="#cb157-201" aria-hidden="true" tabindex="-1"></a>data_final <span class="ot">&lt;-</span> <span class="fu">rename</span>(data_merge, <span class="st">"education"</span><span class="ot">=</span><span class="st">"2010"</span>)</span>
<span id="cb157-202"><a href="#cb157-202" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final)</span>
<span id="cb157-203"><a href="#cb157-203" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-204"><a href="#cb157-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-207"><a href="#cb157-207" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-208"><a href="#cb157-208" aria-hidden="true" tabindex="-1"></a><span class="co"># summary of final data frame</span></span>
<span id="cb157-209"><a href="#cb157-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-210"><a href="#cb157-210" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(data_final)</span>
<span id="cb157-211"><a href="#cb157-211" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-212"><a href="#cb157-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-213"><a href="#cb157-213" aria-hidden="true" tabindex="-1"></a><span class="fu">### Visualization:</span></span>
<span id="cb157-214"><a href="#cb157-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-217"><a href="#cb157-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-218"><a href="#cb157-218" aria-hidden="true" tabindex="-1"></a><span class="co"># add religion as new categorical variable based on highest percentage of each religion:</span></span>
<span id="cb157-219"><a href="#cb157-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-220"><a href="#cb157-220" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">select</span>(data_final, country, rel_catho80, rel_muslim80, rel_protmg80, rel_unaffiliated)</span>
<span id="cb157-221"><a href="#cb157-221" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(newdata)</span>
<span id="cb157-222"><a href="#cb157-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-223"><a href="#cb157-223" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb157-224"><a href="#cb157-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-225"><a href="#cb157-225" aria-hidden="true" tabindex="-1"></a>data_final<span class="sc">$</span>religion <span class="ot">&lt;-</span> <span class="fu">apply</span>(data_final[, <span class="fu">c</span>(<span class="st">"rel_protmg80"</span>, <span class="st">"rel_muslim80"</span>, <span class="st">"rel_catho80"</span>, <span class="st">"rel_unaffiliated"</span>)], <span class="dv">1</span>, <span class="cf">function</span>(row) {</span>
<span id="cb157-226"><a href="#cb157-226" aria-hidden="true" tabindex="-1"></a>  religions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rel_protmg80"</span>, <span class="st">"rel_muslim80"</span>, <span class="st">"rel_catho80"</span>, <span class="st">"rel_unaffiliated"</span>)</span>
<span id="cb157-227"><a href="#cb157-227" aria-hidden="true" tabindex="-1"></a>  max_percentage <span class="ot">&lt;-</span> <span class="fu">max</span>(row)</span>
<span id="cb157-228"><a href="#cb157-228" aria-hidden="true" tabindex="-1"></a>  religion <span class="ot">&lt;-</span> religions[row <span class="sc">==</span> max_percentage]</span>
<span id="cb157-229"><a href="#cb157-229" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(religion, <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb157-230"><a href="#cb157-230" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb157-231"><a href="#cb157-231" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final)</span>
<span id="cb157-232"><a href="#cb157-232" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-233"><a href="#cb157-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-236"><a href="#cb157-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-237"><a href="#cb157-237" aria-hidden="true" tabindex="-1"></a><span class="co"># pivot data to add variable with all religions</span></span>
<span id="cb157-238"><a href="#cb157-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-239"><a href="#cb157-239" aria-hidden="true" tabindex="-1"></a>data_pivot <span class="ot">&lt;-</span> data_final <span class="sc">%&gt;%</span> </span>
<span id="cb157-240"><a href="#cb157-240" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols=</span><span class="fu">c</span>(<span class="st">'rel_catho80'</span>, <span class="st">'rel_muslim80'</span>, <span class="st">'rel_protmg80'</span>, <span class="st">'rel_unaffiliated'</span>),</span>
<span id="cb157-241"><a href="#cb157-241" aria-hidden="true" tabindex="-1"></a>                    <span class="at">names_to=</span><span class="st">'relig_affiliation'</span>,</span>
<span id="cb157-242"><a href="#cb157-242" aria-hidden="true" tabindex="-1"></a>                    <span class="at">values_to=</span><span class="st">'relig_pop'</span>)</span>
<span id="cb157-243"><a href="#cb157-243" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_pivot)</span>
<span id="cb157-244"><a href="#cb157-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-245"><a href="#cb157-245" aria-hidden="true" tabindex="-1"></a><span class="co"># remove NAs</span></span>
<span id="cb157-246"><a href="#cb157-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-247"><a href="#cb157-247" aria-hidden="true" tabindex="-1"></a>data_NA <span class="ot">&lt;-</span> data_pivot<span class="sc">%&gt;%</span></span>
<span id="cb157-248"><a href="#cb157-248" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_pivot)<span class="sc">%&gt;%</span></span>
<span id="cb157-249"><a href="#cb157-249" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="fu">c</span>(growth, democ, education, relig_affiliation, relig_pop))</span>
<span id="cb157-250"><a href="#cb157-250" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_NA)</span>
<span id="cb157-251"><a href="#cb157-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-252"><a href="#cb157-252" aria-hidden="true" tabindex="-1"></a><span class="co"># remove observations where values are equal</span></span>
<span id="cb157-253"><a href="#cb157-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-254"><a href="#cb157-254" aria-hidden="true" tabindex="-1"></a>data_final_vis <span class="ot">&lt;-</span> <span class="fu">subset</span>(data_final, religion<span class="sc">!=</span><span class="st">"rel_protmg80, rel_catho80"</span>)</span>
<span id="cb157-255"><a href="#cb157-255" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final_vis)</span>
<span id="cb157-256"><a href="#cb157-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-257"><a href="#cb157-257" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot for income x democray by religion</span></span>
<span id="cb157-258"><a href="#cb157-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-259"><a href="#cb157-259" aria-hidden="true" tabindex="-1"></a>relig_vis3 <span class="ot">&lt;-</span> data_final_vis<span class="sc">%&gt;%</span></span>
<span id="cb157-260"><a href="#cb157-260" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_final_vis)<span class="sc">%&gt;%</span></span>
<span id="cb157-261"><a href="#cb157-261" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(democ, growth))<span class="sc">+</span></span>
<span id="cb157-262"><a href="#cb157-262" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">"religion"</span>)<span class="sc">+</span></span>
<span id="cb157-263"><a href="#cb157-263" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Shift in Democracy"</span>,<span class="at">y=</span><span class="st">"Shift in Per Capita Income"</span>, <span class="at">title =</span> <span class="st">"Shift in Per Capita Income and Democracy by Religious Affiliation"</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> religion))</span>
<span id="cb157-264"><a href="#cb157-264" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(relig_vis3)</span>
<span id="cb157-265"><a href="#cb157-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-266"><a href="#cb157-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-269"><a href="#cb157-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-270"><a href="#cb157-270" aria-hidden="true" tabindex="-1"></a><span class="co"># scaterplot by median pop percentages by religion</span></span>
<span id="cb157-271"><a href="#cb157-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-272"><a href="#cb157-272" aria-hidden="true" tabindex="-1"></a>dem_inc_relig <span class="ot">&lt;-</span> data_final_vis<span class="sc">%&gt;%</span></span>
<span id="cb157-273"><a href="#cb157-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_final_vis)<span class="sc">%&gt;%</span></span>
<span id="cb157-274"><a href="#cb157-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(democ, growth))<span class="sc">+</span></span>
<span id="cb157-275"><a href="#cb157-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>religion, <span class="at">shape=</span>religion))<span class="sc">+</span>  </span>
<span id="cb157-276"><a href="#cb157-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Shift in Democracy"</span>, <span class="at">y=</span><span class="st">"Shift in Income Per Capita"</span>, <span class="at">title =</span> <span class="st">"Shift in Per Capita Income and Democracy by Religious Affiliation"</span>)</span>
<span id="cb157-277"><a href="#cb157-277" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(dem_inc_relig)</span>
<span id="cb157-278"><a href="#cb157-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-279"><a href="#cb157-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-282"><a href="#cb157-282" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-283"><a href="#cb157-283" aria-hidden="true" tabindex="-1"></a><span class="co"># stacked bar chart</span></span>
<span id="cb157-284"><a href="#cb157-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-285"><a href="#cb157-285" aria-hidden="true" tabindex="-1"></a>inc_relig <span class="ot">&lt;-</span> data_final_vis<span class="sc">%&gt;%</span></span>
<span id="cb157-286"><a href="#cb157-286" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_final_vis)<span class="sc">%&gt;%</span></span>
<span id="cb157-287"><a href="#cb157-287" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>democ, <span class="at">y=</span>education, <span class="at">fill=</span>religion)) <span class="sc">+</span></span>
<span id="cb157-288"><a href="#cb157-288" aria-hidden="true" tabindex="-1"></a><span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">"identity"</span>) <span class="sc">+</span></span>
<span id="cb157-289"><a href="#cb157-289" aria-hidden="true" tabindex="-1"></a><span class="fu">scale_fill_hue</span>() <span class="sc">+</span></span>
<span id="cb157-290"><a href="#cb157-290" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb157-291"><a href="#cb157-291" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Shift in Democracy"</span>, <span class="at">y=</span><span class="st">"Education Funding"</span>, <span class="at">title=</span><span class="st">"Shift in Education Funding and Democracy by Religious Affiliation"</span>)</span>
<span id="cb157-292"><a href="#cb157-292" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(inc_relig)</span>
<span id="cb157-293"><a href="#cb157-293" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-294"><a href="#cb157-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-297"><a href="#cb157-297" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-298"><a href="#cb157-298" aria-hidden="true" tabindex="-1"></a><span class="co"># line chart</span></span>
<span id="cb157-299"><a href="#cb157-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-300"><a href="#cb157-300" aria-hidden="true" tabindex="-1"></a>line_chart <span class="ot">&lt;-</span> data_final_vis<span class="sc">%&gt;%</span></span>
<span id="cb157-301"><a href="#cb157-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_final_vis)<span class="sc">%&gt;%</span></span>
<span id="cb157-302"><a href="#cb157-302" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>democ, <span class="at">y=</span>education, <span class="at">colour=</span>religion, <span class="at">group=</span>religion)) <span class="sc">+</span> <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Shift in Democracy"</span>, <span class="at">y=</span><span class="st">"Education Funding"</span>, <span class="at">title=</span><span class="st">"Shift in Education Funding and Democracy by Religious Affiliation"</span>) <span class="sc">+</span></span>
<span id="cb157-303"><a href="#cb157-303" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span>
<span id="cb157-304"><a href="#cb157-304" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(line_chart)</span>
<span id="cb157-305"><a href="#cb157-305" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-306"><a href="#cb157-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-309"><a href="#cb157-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-310"><a href="#cb157-310" aria-hidden="true" tabindex="-1"></a><span class="co"># scatterplot </span></span>
<span id="cb157-311"><a href="#cb157-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-312"><a href="#cb157-312" aria-hidden="true" tabindex="-1"></a>relig_income2 <span class="ot">&lt;-</span> data_final_vis<span class="sc">%&gt;%</span></span>
<span id="cb157-313"><a href="#cb157-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">na.omit</span>(data_final_vis)<span class="sc">%&gt;%</span></span>
<span id="cb157-314"><a href="#cb157-314" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(education, growth))<span class="sc">+</span></span>
<span id="cb157-315"><a href="#cb157-315" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="st">"religion"</span>)<span class="sc">+</span></span>
<span id="cb157-316"><a href="#cb157-316" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span><span class="st">"Education Funding"</span>,<span class="at">y=</span><span class="st">"Shift in Income Per Capita"</span>, <span class="at">title =</span> <span class="st">"Shift in Per Capita Income and Education Funding by Religious Affiliation"</span>) <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">color =</span> religion))</span>
<span id="cb157-317"><a href="#cb157-317" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(relig_income2)</span>
<span id="cb157-318"><a href="#cb157-318" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-319"><a href="#cb157-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-320"><a href="#cb157-320" aria-hidden="true" tabindex="-1"></a><span class="fu">### Analysis:</span></span>
<span id="cb157-321"><a href="#cb157-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-322"><a href="#cb157-322" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Hypothesis Testing:</span></span>
<span id="cb157-323"><a href="#cb157-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-324"><a href="#cb157-324" aria-hidden="true" tabindex="-1"></a>Define variables:</span>
<span id="cb157-325"><a href="#cb157-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-326"><a href="#cb157-326" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Response (dependent) variable**: Shift in democracy over time ("democ").</span>
<span id="cb157-327"><a href="#cb157-327" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Explanatory (independent) variable**: Shift in per capita income over time ("growth").</span>
<span id="cb157-328"><a href="#cb157-328" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Control variables**: country ("country"); constraint on the executive at the time of independence ("exec_constraint"); year of independence ("year_ind"); settler mortality rate ("log_settler_mort"); population density ("log_pop_dens"); Catholic population ("rel_catho80"); Muslim population ("rel_muslim80"); Protestant population ("rel_protmg80"); **religiously-unaffiliated population ("rel_unaffiliated")**; and **education funding ("education")**.</span>
<span id="cb157-329"><a href="#cb157-329" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Interaction terms**: Education funding ("education")<span class="sc">\*</span>shift in per capita income ("growth").</span>
<span id="cb157-330"><a href="#cb157-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-331"><a href="#cb157-331" aria-hidden="true" tabindex="-1"></a>I specifically added religiously-unaffiliated population (by percentage of population by country) and education funding (by expenditure as a percentage of GDP by country) as additional control variables because of the role they played in Barro's 1999 study. Although Barro did not control for the same country-specific effects as the authors of "Income and Democracy," he nonetheless suggested that both education and religious affiliation are statistically significant indicators of the correlation between income and democracy. So, I elected to add religiously-unaffiliated population to my replication data set because it was included in Barro's study but excluded from "Income and Democracy." Additionally, even though education was deemed to be statistically insignificant in "Income and Democracy," I thought it would be interesting to see if adding religiously-unaffiliated population would affect the role of education a country-fixed effect.</span>
<span id="cb157-332"><a href="#cb157-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-333"><a href="#cb157-333" aria-hidden="true" tabindex="-1"></a>Moreover, as I initially speculated that education would be statistically significant prior to reviewing "Income and Democracy," I was curious to see if adding education funding<span class="sc">\*</span>shift as an interaction term would perhaps provide additional insight on the reach of education as a country-fixed effect.</span>
<span id="cb157-334"><a href="#cb157-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-335"><a href="#cb157-335" aria-hidden="true" tabindex="-1"></a>**Transform Variables**</span>
<span id="cb157-336"><a href="#cb157-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-339"><a href="#cb157-339" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-340"><a href="#cb157-340" aria-hidden="true" tabindex="-1"></a><span class="co"># transform education from continuous to ordinal (quartiles based on range)</span></span>
<span id="cb157-341"><a href="#cb157-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-342"><a href="#cb157-342" aria-hidden="true" tabindex="-1"></a>range_edu <span class="ot">&lt;-</span> <span class="fu">range</span>(data_final<span class="sc">$</span>education, <span class="at">na.rm=</span><span class="cn">TRUE</span>)</span>
<span id="cb157-343"><a href="#cb157-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-344"><a href="#cb157-344" aria-hidden="true" tabindex="-1"></a><span class="co"># ID quantiles</span></span>
<span id="cb157-345"><a href="#cb157-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-346"><a href="#cb157-346" aria-hidden="true" tabindex="-1"></a>quantile_edu <span class="ot">&lt;-</span> <span class="fu">quantile</span>(range_edu)</span>
<span id="cb157-347"><a href="#cb157-347" aria-hidden="true" tabindex="-1"></a>quantile_edu</span>
<span id="cb157-348"><a href="#cb157-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-349"><a href="#cb157-349" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gtools)</span>
<span id="cb157-350"><a href="#cb157-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-351"><a href="#cb157-351" aria-hidden="true" tabindex="-1"></a><span class="co"># add column for quantiles</span></span>
<span id="cb157-352"><a href="#cb157-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-353"><a href="#cb157-353" aria-hidden="true" tabindex="-1"></a>edu_quant <span class="ot">&lt;-</span> <span class="fu">quantcut</span>(data_final<span class="sc">$</span>education, <span class="at">q =</span> <span class="dv">4</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb157-354"><a href="#cb157-354" aria-hidden="true" tabindex="-1"></a>data_final_edu <span class="ot">&lt;-</span> <span class="fu">mutate</span>(data_final, <span class="at">edu_quant=</span>edu_quant)</span>
<span id="cb157-355"><a href="#cb157-355" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final_edu)</span>
<span id="cb157-356"><a href="#cb157-356" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-357"><a href="#cb157-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-360"><a href="#cb157-360" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-361"><a href="#cb157-361" aria-hidden="true" tabindex="-1"></a>newdata <span class="ot">&lt;-</span> <span class="fu">select</span>(data_final, country, rel_catho80, rel_muslim80, rel_protmg80, rel_unaffiliated)</span>
<span id="cb157-362"><a href="#cb157-362" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(newdata)</span>
<span id="cb157-363"><a href="#cb157-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-364"><a href="#cb157-364" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(reshape2)</span>
<span id="cb157-365"><a href="#cb157-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-366"><a href="#cb157-366" aria-hidden="true" tabindex="-1"></a>data_final<span class="sc">$</span>religion <span class="ot">&lt;-</span> <span class="fu">apply</span>(data_final[, <span class="fu">c</span>(<span class="st">"rel_protmg80"</span>, <span class="st">"rel_muslim80"</span>, <span class="st">"rel_catho80"</span>, <span class="st">"rel_unaffiliated"</span>)], <span class="dv">1</span>, <span class="cf">function</span>(row) {</span>
<span id="cb157-367"><a href="#cb157-367" aria-hidden="true" tabindex="-1"></a>  religions <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"rel_protmg80"</span>, <span class="st">"rel_muslim80"</span>, <span class="st">"rel_catho80"</span>, <span class="st">"rel_unaffiliated"</span>)</span>
<span id="cb157-368"><a href="#cb157-368" aria-hidden="true" tabindex="-1"></a>  max_percentage <span class="ot">&lt;-</span> <span class="fu">max</span>(row)</span>
<span id="cb157-369"><a href="#cb157-369" aria-hidden="true" tabindex="-1"></a>  religion <span class="ot">&lt;-</span> religions[row <span class="sc">==</span> max_percentage]</span>
<span id="cb157-370"><a href="#cb157-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">paste</span>(religion, <span class="at">collapse =</span> <span class="st">", "</span>)</span>
<span id="cb157-371"><a href="#cb157-371" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb157-372"><a href="#cb157-372" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final)</span>
<span id="cb157-373"><a href="#cb157-373" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-374"><a href="#cb157-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-375"><a href="#cb157-375" aria-hidden="true" tabindex="-1"></a>**Correlation Tests**</span>
<span id="cb157-376"><a href="#cb157-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-379"><a href="#cb157-379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-380"><a href="#cb157-380" aria-hidden="true" tabindex="-1"></a><span class="co"># remove observations with all NAs</span></span>
<span id="cb157-381"><a href="#cb157-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-382"><a href="#cb157-382" aria-hidden="true" tabindex="-1"></a>sans_NA <span class="ot">&lt;-</span> <span class="fu">na.omit</span>(data_final)</span>
<span id="cb157-383"><a href="#cb157-383" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(sans_NA)</span>
<span id="cb157-384"><a href="#cb157-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-385"><a href="#cb157-385" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation between income growth and education</span></span>
<span id="cb157-386"><a href="#cb157-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-387"><a href="#cb157-387" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(sans_NA[<span class="fu">c</span>(<span class="st">"growth"</span>, <span class="st">"education"</span>)])</span>
<span id="cb157-388"><a href="#cb157-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-389"><a href="#cb157-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-390"><a href="#cb157-390" aria-hidden="true" tabindex="-1"></a>There is a positive but low linear correlation (0.4) between shift in per capita income and education funding.</span>
<span id="cb157-391"><a href="#cb157-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-394"><a href="#cb157-394" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-395"><a href="#cb157-395" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation between democracy and religious unaffiliation</span></span>
<span id="cb157-396"><a href="#cb157-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-397"><a href="#cb157-397" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(sans_NA[<span class="fu">c</span>(<span class="st">"democ"</span>, <span class="st">"rel_unaffiliated"</span>)])</span>
<span id="cb157-398"><a href="#cb157-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-399"><a href="#cb157-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-400"><a href="#cb157-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-401"><a href="#cb157-401" aria-hidden="true" tabindex="-1"></a>There is a positive but very low linear correlation (0.1) between shift in democracy and religiously-unaffiliated population.</span>
<span id="cb157-402"><a href="#cb157-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-405"><a href="#cb157-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-406"><a href="#cb157-406" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation between democracy and education</span></span>
<span id="cb157-407"><a href="#cb157-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-408"><a href="#cb157-408" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(sans_NA[<span class="fu">c</span>(<span class="st">"democ"</span>, <span class="st">"education"</span>)])</span>
<span id="cb157-409"><a href="#cb157-409" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-410"><a href="#cb157-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-411"><a href="#cb157-411" aria-hidden="true" tabindex="-1"></a>There is a positive but low linear correlation (0.3) between shift in democracy and education funding.</span>
<span id="cb157-412"><a href="#cb157-412" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-413"><a href="#cb157-413" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Multiple regression models:</span></span>
<span id="cb157-414"><a href="#cb157-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-415"><a href="#cb157-415" aria-hidden="true" tabindex="-1"></a>First, I will check to see if either of my added control variables need to be logged.</span>
<span id="cb157-416"><a href="#cb157-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-417"><a href="#cb157-417" aria-hidden="true" tabindex="-1"></a>**Education**</span>
<span id="cb157-418"><a href="#cb157-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-421"><a href="#cb157-421" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-422"><a href="#cb157-422" aria-hidden="true" tabindex="-1"></a><span class="co"># education</span></span>
<span id="cb157-423"><a href="#cb157-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-424"><a href="#cb157-424" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_final<span class="sc">$</span>education)</span>
<span id="cb157-425"><a href="#cb157-425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-426"><a href="#cb157-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-427"><a href="#cb157-427" aria-hidden="true" tabindex="-1"></a>This distribution is moderately right-skewed, so I will log the education variable.</span>
<span id="cb157-428"><a href="#cb157-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-431"><a href="#cb157-431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-432"><a href="#cb157-432" aria-hidden="true" tabindex="-1"></a><span class="co"># log() education</span></span>
<span id="cb157-433"><a href="#cb157-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-434"><a href="#cb157-434" aria-hidden="true" tabindex="-1"></a>log_education <span class="ot">&lt;-</span> <span class="fu">log</span>(data_final<span class="sc">$</span>education)</span>
<span id="cb157-435"><a href="#cb157-435" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(log_education)</span>
<span id="cb157-436"><a href="#cb157-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-437"><a href="#cb157-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-438"><a href="#cb157-438" aria-hidden="true" tabindex="-1"></a>Next, I will add this logged variable to my final data set to incorporate into my regression model.</span>
<span id="cb157-439"><a href="#cb157-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-442"><a href="#cb157-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-443"><a href="#cb157-443" aria-hidden="true" tabindex="-1"></a><span class="co"># transform new log(eduation) variable</span></span>
<span id="cb157-444"><a href="#cb157-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-445"><a href="#cb157-445" aria-hidden="true" tabindex="-1"></a>data_final <span class="ot">&lt;-</span> data_final <span class="sc">%&gt;%</span></span>
<span id="cb157-446"><a href="#cb157-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">log_education=</span><span class="fu">log</span>(education))</span>
<span id="cb157-447"><a href="#cb157-447" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final)</span>
<span id="cb157-448"><a href="#cb157-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-449"><a href="#cb157-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-450"><a href="#cb157-450" aria-hidden="true" tabindex="-1"></a>**Religiously-unaffiliated population**</span>
<span id="cb157-451"><a href="#cb157-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-454"><a href="#cb157-454" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-455"><a href="#cb157-455" aria-hidden="true" tabindex="-1"></a><span class="co"># religiously-unaffiliated population</span></span>
<span id="cb157-456"><a href="#cb157-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-457"><a href="#cb157-457" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(data_final<span class="sc">$</span>rel_unaffiliated)</span>
<span id="cb157-458"><a href="#cb157-458" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-459"><a href="#cb157-459" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-460"><a href="#cb157-460" aria-hidden="true" tabindex="-1"></a>This distribution is very right-skewed, so I will log the religiously-unaffiliated population variable.</span>
<span id="cb157-461"><a href="#cb157-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-464"><a href="#cb157-464" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-465"><a href="#cb157-465" aria-hidden="true" tabindex="-1"></a><span class="co"># log() rel_unaffiliated</span></span>
<span id="cb157-466"><a href="#cb157-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-467"><a href="#cb157-467" aria-hidden="true" tabindex="-1"></a>log_rel_unaff <span class="ot">&lt;-</span> <span class="fu">log</span>(data_final<span class="sc">$</span>rel_unaffiliated)</span>
<span id="cb157-468"><a href="#cb157-468" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(log_rel_unaff)</span>
<span id="cb157-469"><a href="#cb157-469" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-470"><a href="#cb157-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-471"><a href="#cb157-471" aria-hidden="true" tabindex="-1"></a>Next, I will add this logged variable to my final data set to incorporate into my regression model.</span>
<span id="cb157-472"><a href="#cb157-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-475"><a href="#cb157-475" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-476"><a href="#cb157-476" aria-hidden="true" tabindex="-1"></a><span class="co"># transform new log(rel_unaffiliated) variable</span></span>
<span id="cb157-477"><a href="#cb157-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-478"><a href="#cb157-478" aria-hidden="true" tabindex="-1"></a>data_final <span class="ot">&lt;-</span> data_final <span class="sc">%&gt;%</span></span>
<span id="cb157-479"><a href="#cb157-479" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transform</span>(<span class="at">log_rel_unaff=</span><span class="fu">log</span>(rel_unaffiliated))</span>
<span id="cb157-480"><a href="#cb157-480" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_final)</span>
<span id="cb157-481"><a href="#cb157-481" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-482"><a href="#cb157-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-483"><a href="#cb157-483" aria-hidden="true" tabindex="-1"></a>**Original model:**</span>
<span id="cb157-484"><a href="#cb157-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-487"><a href="#cb157-487" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-488"><a href="#cb157-488" aria-hidden="true" tabindex="-1"></a><span class="co"># original study multiple regression model</span></span>
<span id="cb157-489"><a href="#cb157-489" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-490"><a href="#cb157-490" aria-hidden="true" tabindex="-1"></a>reg_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(democ <span class="sc">~</span> growth <span class="sc">+</span> exec_constraint <span class="sc">+</span> year_ind <span class="sc">+</span> log_settler_mort <span class="sc">+</span> log_pop_dens <span class="sc">+</span> rel_catho80 <span class="sc">+</span> rel_muslim80 <span class="sc">+</span> rel_protmg80, <span class="at">data =</span> data_final)</span>
<span id="cb157-491"><a href="#cb157-491" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_1)</span>
<span id="cb157-492"><a href="#cb157-492" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-493"><a href="#cb157-493" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-494"><a href="#cb157-494" aria-hidden="true" tabindex="-1"></a>Interestingly, we see in the original model that the relationship between shift in per capita income ("growth") and shift in democracy is statistically significant at the 0.05 significance level (p-value=0.01). It is important to note that while the authors of "Income and Democracy" did conclude that there is no causal relationship between per capita shift in income and shift in democracy, this is not to say that there is no level of statistical significance. I will next add my additional control variables and interaction term to see if these terms cause an increase in statistical significance.</span>
<span id="cb157-495"><a href="#cb157-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-496"><a href="#cb157-496" aria-hidden="true" tabindex="-1"></a>**Original model plus two control variables:**</span>
<span id="cb157-497"><a href="#cb157-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-500"><a href="#cb157-500" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-501"><a href="#cb157-501" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple regression model with all variables</span></span>
<span id="cb157-502"><a href="#cb157-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-503"><a href="#cb157-503" aria-hidden="true" tabindex="-1"></a>reg_2 <span class="ot">&lt;-</span> <span class="fu">lm</span>(democ <span class="sc">~</span> growth <span class="sc">+</span> exec_constraint <span class="sc">+</span> year_ind <span class="sc">+</span> log_settler_mort <span class="sc">+</span> log_pop_dens <span class="sc">+</span> rel_catho80 <span class="sc">+</span> rel_muslim80 <span class="sc">+</span> rel_protmg80 <span class="sc">+</span> log_rel_unaff <span class="sc">+</span> log_education, <span class="at">data =</span> data_final)</span>
<span id="cb157-504"><a href="#cb157-504" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_2)</span>
<span id="cb157-505"><a href="#cb157-505" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-506"><a href="#cb157-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-507"><a href="#cb157-507" aria-hidden="true" tabindex="-1"></a>We can see based on this multiple regression model that, when controlling for shift in per capita income, constraint on the executive at the time of independence, year of independence, (log) settler mortality rate, (log) population density, Catholic population, Muslim population, Protestant population, religiously-unaffiliated population, and education funding, there is no statistical significance between shift in per capita income (growth) and shift in democracy (democ) when the significance level is 0.05.</span>
<span id="cb157-508"><a href="#cb157-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-509"><a href="#cb157-509" aria-hidden="true" tabindex="-1"></a>We can, however, see that year of independence (p-value=0.001) and constraint on the executive (p-value=0.02) are statistically significant on shift in democracy. Even more interesting is that religiously-unaffiliated population, a control variable that was added to this replication study, is also statistically significant in terms of its relationship with shift in democracy (p-value = 0.02).</span>
<span id="cb157-510"><a href="#cb157-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-511"><a href="#cb157-511" aria-hidden="true" tabindex="-1"></a>**Original model plus two control variables and an interaction term:**</span>
<span id="cb157-512"><a href="#cb157-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-515"><a href="#cb157-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-516"><a href="#cb157-516" aria-hidden="true" tabindex="-1"></a><span class="co"># multiple regression with education*growth interaction term</span></span>
<span id="cb157-517"><a href="#cb157-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-518"><a href="#cb157-518" aria-hidden="true" tabindex="-1"></a>reg_3 <span class="ot">&lt;-</span> <span class="fu">lm</span>(democ <span class="sc">~</span> growth<span class="sc">*</span>log_education <span class="sc">+</span> exec_constraint <span class="sc">+</span> year_ind <span class="sc">+</span> log_settler_mort <span class="sc">+</span> log_pop_dens <span class="sc">+</span> rel_catho80 <span class="sc">+</span> rel_muslim80 <span class="sc">+</span> rel_protmg80 <span class="sc">+</span> log_rel_unaff, <span class="at">data =</span> data_final)</span>
<span id="cb157-519"><a href="#cb157-519" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(reg_3)</span>
<span id="cb157-520"><a href="#cb157-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-521"><a href="#cb157-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-522"><a href="#cb157-522" aria-hidden="true" tabindex="-1"></a>In reviewing the third regression model which incorporates education<span class="sc">\*</span>growth as an interaction term, we do see some minor shifts in p-values, but no shift is large enough to affect statistical significance. So, we can again confirm that, even when adding an interaction term, shift in per capita income is not statistically significant in terms of its relationship with shift in democracy.</span>
<span id="cb157-523"><a href="#cb157-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-524"><a href="#cb157-524" aria-hidden="true" tabindex="-1"></a>I will now combine these three models into a single, more legible table using the 'stargazer()' function. We can again see that shift in income per capita is only statistically significant (though not indicative of a causal relationship) in the first model, which does not include the additional control variables or the interaction term.</span>
<span id="cb157-525"><a href="#cb157-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-528"><a href="#cb157-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-529"><a href="#cb157-529" aria-hidden="true" tabindex="-1"></a><span class="co"># use stargazer to create combined table</span></span>
<span id="cb157-530"><a href="#cb157-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-531"><a href="#cb157-531" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb157-532"><a href="#cb157-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-533"><a href="#cb157-533" aria-hidden="true" tabindex="-1"></a>reg_model <span class="ot">&lt;-</span> <span class="fu">stargazer</span>(reg_1, reg_2, reg_3, <span class="at">type=</span><span class="st">'text'</span>)</span>
<span id="cb157-534"><a href="#cb157-534" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(reg_model)</span>
<span id="cb157-535"><a href="#cb157-535" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-536"><a href="#cb157-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-537"><a href="#cb157-537" aria-hidden="true" tabindex="-1"></a>**Results of hypothesis test:** We can see based on these regression models that education funding, religiously-unaffiliated population, and education funding<span class="sc">\*</span>shift in per capita income actually lead to decreased statistical significance between shift in income per capita and shift in democracy. Thus, while these terms do change the causal relationship between shift in per capita income and shift in democracy, the regression outcome ultimately disproves my hypothesis.</span>
<span id="cb157-538"><a href="#cb157-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-539"><a href="#cb157-539" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Model Comparison:</span></span>
<span id="cb157-540"><a href="#cb157-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-541"><a href="#cb157-541" aria-hidden="true" tabindex="-1"></a>**Adjusted R-Squared**</span>
<span id="cb157-542"><a href="#cb157-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-545"><a href="#cb157-545" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-546"><a href="#cb157-546" aria-hidden="true" tabindex="-1"></a><span class="co"># adjusted R-squared</span></span>
<span id="cb157-547"><a href="#cb157-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-548"><a href="#cb157-548" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(reg_model)</span>
<span id="cb157-549"><a href="#cb157-549" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-550"><a href="#cb157-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-551"><a href="#cb157-551" aria-hidden="true" tabindex="-1"></a>We can see in the stargazer table above that "reg_2," or the regression model that includes the additional control variables but not the interaction term, has the highest adjusted R-squared value , which is an indicator of best fit as it represents the model with the smallest residuals.</span>
<span id="cb157-552"><a href="#cb157-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-553"><a href="#cb157-553" aria-hidden="true" tabindex="-1"></a>**PRESS**</span>
<span id="cb157-554"><a href="#cb157-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-557"><a href="#cb157-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-558"><a href="#cb157-558" aria-hidden="true" tabindex="-1"></a><span class="co"># PRESS</span></span>
<span id="cb157-559"><a href="#cb157-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-560"><a href="#cb157-560" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MPV)</span>
<span id="cb157-561"><a href="#cb157-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-562"><a href="#cb157-562" aria-hidden="true" tabindex="-1"></a><span class="co">#reg_1 = 4.999083</span></span>
<span id="cb157-563"><a href="#cb157-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-564"><a href="#cb157-564" aria-hidden="true" tabindex="-1"></a><span class="fu">PRESS</span>(reg_1)</span>
<span id="cb157-565"><a href="#cb157-565" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-566"><a href="#cb157-566" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-569"><a href="#cb157-569" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-570"><a href="#cb157-570" aria-hidden="true" tabindex="-1"></a><span class="co">#reg_2 = 3.258505</span></span>
<span id="cb157-571"><a href="#cb157-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-572"><a href="#cb157-572" aria-hidden="true" tabindex="-1"></a><span class="fu">PRESS</span>(reg_2)</span>
<span id="cb157-573"><a href="#cb157-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-574"><a href="#cb157-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-577"><a href="#cb157-577" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-578"><a href="#cb157-578" aria-hidden="true" tabindex="-1"></a><span class="co">#reg_3 = 3.460336</span></span>
<span id="cb157-579"><a href="#cb157-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-580"><a href="#cb157-580" aria-hidden="true" tabindex="-1"></a><span class="fu">PRESS</span>(reg_3)</span>
<span id="cb157-581"><a href="#cb157-581" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-582"><a href="#cb157-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-583"><a href="#cb157-583" aria-hidden="true" tabindex="-1"></a>We can see in the above Predicted Residual Sum of Squares (PRESS) tests that "reg_2," or the regression model that includes the additional control variables but not the interaction term, has the lowest PRESS value, thus indicating that it is the best-fit model.</span>
<span id="cb157-584"><a href="#cb157-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-585"><a href="#cb157-585" aria-hidden="true" tabindex="-1"></a>**AIC**</span>
<span id="cb157-586"><a href="#cb157-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-589"><a href="#cb157-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-590"><a href="#cb157-590" aria-hidden="true" tabindex="-1"></a><span class="co"># select number of observations from reg_1 to match reg_2 and reg_3</span></span>
<span id="cb157-591"><a href="#cb157-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-592"><a href="#cb157-592" aria-hidden="true" tabindex="-1"></a>reg_1_data <span class="ot">&lt;-</span> data_final</span>
<span id="cb157-593"><a href="#cb157-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-594"><a href="#cb157-594" aria-hidden="true" tabindex="-1"></a><span class="co"># set observations to sample</span></span>
<span id="cb157-595"><a href="#cb157-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-596"><a href="#cb157-596" aria-hidden="true" tabindex="-1"></a>observations <span class="ot">&lt;-</span> <span class="dv">136</span></span>
<span id="cb157-597"><a href="#cb157-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-598"><a href="#cb157-598" aria-hidden="true" tabindex="-1"></a><span class="co"># set seed</span></span>
<span id="cb157-599"><a href="#cb157-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-600"><a href="#cb157-600" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">14</span>)</span>
<span id="cb157-601"><a href="#cb157-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-602"><a href="#cb157-602" aria-hidden="true" tabindex="-1"></a><span class="co"># select observations</span></span>
<span id="cb157-603"><a href="#cb157-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-604"><a href="#cb157-604" aria-hidden="true" tabindex="-1"></a>sampled_indices <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">nrow</span>(reg_1_data), observations)</span>
<span id="cb157-605"><a href="#cb157-605" aria-hidden="true" tabindex="-1"></a>sampled_data <span class="ot">&lt;-</span> reg_1_data[sampled_indices, ]</span>
<span id="cb157-606"><a href="#cb157-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-607"><a href="#cb157-607" aria-hidden="true" tabindex="-1"></a><span class="co"># fit  model with sample data</span></span>
<span id="cb157-608"><a href="#cb157-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-609"><a href="#cb157-609" aria-hidden="true" tabindex="-1"></a>reg_1_sample <span class="ot">&lt;-</span> <span class="fu">lm</span>(democ <span class="sc">~</span> growth <span class="sc">+</span> exec_constraint <span class="sc">+</span> year_ind <span class="sc">+</span> log_settler_mort <span class="sc">+</span> log_pop_dens <span class="sc">+</span> rel_catho80 <span class="sc">+</span> rel_muslim80 <span class="sc">+</span> rel_protmg80, <span class="at">data=</span>sampled_data)</span>
<span id="cb157-610"><a href="#cb157-610" aria-hidden="true" tabindex="-1"></a>reg_1_sample</span>
<span id="cb157-611"><a href="#cb157-611" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-612"><a href="#cb157-612" aria-hidden="true" tabindex="-1"></a><span class="co"># check number of observations</span></span>
<span id="cb157-613"><a href="#cb157-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-614"><a href="#cb157-614" aria-hidden="true" tabindex="-1"></a>reg_model <span class="ot">&lt;-</span> <span class="fu">stargazer</span>(reg_1_sample, reg_2, reg_3, <span class="at">type=</span><span class="st">'text'</span>)</span>
<span id="cb157-615"><a href="#cb157-615" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-616"><a href="#cb157-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-619"><a href="#cb157-619" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-620"><a href="#cb157-620" aria-hidden="true" tabindex="-1"></a><span class="co"># AIC</span></span>
<span id="cb157-621"><a href="#cb157-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-622"><a href="#cb157-622" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(AICcmodavg)</span>
<span id="cb157-623"><a href="#cb157-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-624"><a href="#cb157-624" aria-hidden="true" tabindex="-1"></a>models <span class="ot">&lt;-</span> <span class="fu">list</span>(reg_1_sample, reg_2, reg_3)</span>
<span id="cb157-625"><a href="#cb157-625" aria-hidden="true" tabindex="-1"></a>mod.names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">'reg_1_sample'</span>, <span class="st">'reg_2'</span>, <span class="st">'reg_3'</span>)</span>
<span id="cb157-626"><a href="#cb157-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-627"><a href="#cb157-627" aria-hidden="true" tabindex="-1"></a><span class="fu">aictab</span>(<span class="at">cand.set =</span> models, <span class="at">modnames =</span> mod.names)</span>
<span id="cb157-628"><a href="#cb157-628" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-629"><a href="#cb157-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-630"><a href="#cb157-630" aria-hidden="true" tabindex="-1"></a>We can see that based on the Akaike Information Criterion (AIC) test, "reg_2," or the regression model that includes the additional control variables but not the interaction term, has the lowest AICc value. Therefore, because minimizing the AICc value equates to minimizing the number of unnecessary model parameters, "reg_2" is the best fit.</span>
<span id="cb157-631"><a href="#cb157-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-632"><a href="#cb157-632" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Diagnostics:</span></span>
<span id="cb157-633"><a href="#cb157-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-634"><a href="#cb157-634" aria-hidden="true" tabindex="-1"></a>Based on the Adjusted R-Squared, PRESS, and AIC tests, "reg_2," or the regression model that includes the additional control variables but not the interaction term, is universally considered the model of best fit.</span>
<span id="cb157-635"><a href="#cb157-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-636"><a href="#cb157-636" aria-hidden="true" tabindex="-1"></a>**Diagnostic plots for the final model (reg_2):**</span>
<span id="cb157-637"><a href="#cb157-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-640"><a href="#cb157-640" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb157-641"><a href="#cb157-641" aria-hidden="true" tabindex="-1"></a><span class="co"># plots for reg_2</span></span>
<span id="cb157-642"><a href="#cb157-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-643"><a href="#cb157-643" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb157-644"><a href="#cb157-644" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(reg_2, <span class="at">which=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb157-645"><a href="#cb157-645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb157-646"><a href="#cb157-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-647"><a href="#cb157-647" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Residuals vs. Fitted**: In applying the Residuals vs. Fitted plot, we can observe a violation due to the curvature of the red line. We also see that the distribution of data points does not "bounce randomly" about the 0 line. This plot is therefore a **bad fit** for this regression model.</span>
<span id="cb157-648"><a href="#cb157-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-649"><a href="#cb157-649" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Normal Q-Q**: In applying the Normal Q-Q plot, we observe that the data points do generally fall along the 0 line, which is indicative of a **good fit** for this regression model.</span>
<span id="cb157-650"><a href="#cb157-650" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-651"><a href="#cb157-651" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Scale-Location**: In applying the Scale-Location plot, we observe what appears to be heteroscedasticity across the data points as well as a non-horizontal red line. Because see indications of heteroscedasticity, we should run a Breusch-Pagan test to confirm.</span>
<span id="cb157-652"><a href="#cb157-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-653"><a href="#cb157-653" aria-hidden="true" tabindex="-1"></a>    <span class="in">```{r}</span></span>
<span id="cb157-654"><a href="#cb157-654" aria-hidden="true" tabindex="-1"></a>    <span class="fu">library</span>(lmtest)</span>
<span id="cb157-655"><a href="#cb157-655" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-656"><a href="#cb157-656" aria-hidden="true" tabindex="-1"></a>    bp_test <span class="ot">&lt;-</span> <span class="fu">lm</span>(democ <span class="sc">~</span> growth <span class="sc">+</span> exec_constraint <span class="sc">+</span> year_ind <span class="sc">+</span> log_settler_mort <span class="sc">+</span> log_pop_dens <span class="sc">+</span> rel_catho80 <span class="sc">+</span> rel_muslim80 <span class="sc">+</span> rel_protmg80 <span class="sc">+</span> log_rel_unaff <span class="sc">+</span> log_education, <span class="at">data =</span> data_final)</span>
<span id="cb157-657"><a href="#cb157-657" aria-hidden="true" tabindex="-1"></a>    <span class="fu">bptest</span>(bp_test)</span>
<span id="cb157-658"><a href="#cb157-658" aria-hidden="true" tabindex="-1"></a>    <span class="in">```</span></span>
<span id="cb157-659"><a href="#cb157-659" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-660"><a href="#cb157-660" aria-hidden="true" tabindex="-1"></a>    The results of the Breusch-Pagan test show that we cannot reject the null hypothesis (p-value=0.45), which in this case is homoscedasticity. So, there is no violation of the assumption of homoscedasticity. This plot is therefore a **good fit** for this regression model.</span>
<span id="cb157-661"><a href="#cb157-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-662"><a href="#cb157-662" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Cook's Distance**: In applying the Cook's Distance plot, we observe a violation due to several data points yielding a Cook's distance value greater than 1. This plot is therefore a **bad fit** for this regression model.</span>
<span id="cb157-663"><a href="#cb157-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-664"><a href="#cb157-664" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Residuals vs. Leverage**: In applying the Residuals vs. Leverage plot, we can see that there are no data points outside of the dashed lines marked with '0.5.' This plot is therefore a **good fit** for this regression model.</span>
<span id="cb157-665"><a href="#cb157-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-666"><a href="#cb157-666" aria-hidden="true" tabindex="-1"></a><span class="ss">-   </span>**Cook's Distance vs. Leverage**: In applying the Cook's Distance vs. Leverage plot, we do not really observe any influential data points. This plot does not contribute any value to this regression model.</span>
<span id="cb157-667"><a href="#cb157-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-668"><a href="#cb157-668" aria-hidden="true" tabindex="-1"></a><span class="fu">### Sources:</span></span>
<span id="cb157-669"><a href="#cb157-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-670"><a href="#cb157-670" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>**Data set**: Acemoglu, Daron, et al. \"Replication Data For: Income and Democracy.\" *American Economic Association*, vol. 1, 12 Oct. 2019, www.openicpsr.org/openicpsr/project/113251/version/V1/view?path=%2Fopenicpsr%2F113251%2Ffcr%3Aversions%2FV1%2FIncome-and-Democracy-Data-AER-adjustment.xls&amp;type=file, https://doi.org/10.3886/e113251v1.</span>
<span id="cb157-671"><a href="#cb157-671" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>**Study**: Acemoglu, D., Johnson, S., Robinson, J. A., &amp; Yared, P. (2008, June 3). *Income and democracy*. American Economic Review. https://www.aeaweb.org/articles?id=10.1257%2Faer.98.3.808</span>
<span id="cb157-672"><a href="#cb157-672" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>**Comparison study**: Barro, Robert&nbsp;J. \"Determinants of Democracy.\" *Journal of Political Economy*, vol. 107, no. S6, Dec. 1999, pp. S158--S183, https://doi.org/10.1086/250107.und</span>
<span id="cb157-673"><a href="#cb157-673" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>**Additional religious affiliation variables**: Datopian. \"World Religion Projections.\" *DataHub*, 2018, datahub.io/sagargg/world-religion-projections#data.</span>
<span id="cb157-674"><a href="#cb157-674" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>**Education variable**: The World Bank. \"Government Expenditure on Education, Total (% of GDP) \| Data.\" *Worldbank.org*, 2019, data.worldbank.org/indicator/SE.XPD.TOTL.GD.ZS.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>