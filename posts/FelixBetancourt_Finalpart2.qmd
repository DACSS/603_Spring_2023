---
title: "Final Project - Check point 2"
author: "Felix Betanourt"
desription: "DACSS 603 Final Project"
date: "04/20/2023"
format:
  html:
    toc: true
    code-fold: true
    code-copy: true
    code-tools: true
categories:
  - finalpart2
  - final project
  - burnout
  - employee burnout
  - descriptives
  - regression
  - Research question
  - hyphoteses
---

```{r}
#| label: setup
#| warning: false

knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
```

### **Burnout in the workplace - Research Question**.

Burnout is a pervasive issue in many professions, and its consequences can be significant for individuals and organizations alike. According to Maslach and Leiter (2016), burnout is characterized by emotional exhaustion, despersonalization, and reduced personal accomplishment. It is prevalent in a variety of fields, including healthcare (West et al., 2016), among other professions. Burnout can have serious consequences, including decreased job satisfaction, increased absenteeism, and turnover (West et al., 2016).

There is a growing body of research exploring the causes and consequences of burnout, as well as potential solutions. Some scholars have identified factors such as job demands, lack of control, and social support as contributing to burnout (Bakker & Demerouti, 2017).

Lee & Eissenstat (2017), for instance, affirm that psychological job demands and work-to-family conflict, as well as control over working hours/schedule, decision-making authority, and role clarity, have significant effects on burnout.

The aim of this research paper is to provide a comprehensive understanding of **how type of business, and seniority level explain the level of burnout.**

### Hypothesis

**Null Hypothesis**: The type of business, and seniority does not affect the burnout rate.

**Alternative hypotheses**:

1.  Working in Services (vs product type of business) predict significantly higher burnout rate, especially in Female workers.

2.  Less years of experience (lower seniority) is significantly related to higher burnout rate.

3.  The numbers of work hours allocated affect the burnout rate significantly in employees working from home setup (vs on site).

### About the Data

```{r}
# Loading packages
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(psych))
suppressPackageStartupMessages(library(scales))
library(lattice)
library(formattable)
suppressPackageStartupMessages(library(kableExtra))
library(ggplot2)

# Reading the data.

burn <- read.csv("_data/burnout.csv")

```

The dataset was obtained from:

https://www.kaggle.com/datasets/blurredmachine/are-your-employees-burning-out

Let's see the strucutre of the dataset:

```{r}
#Structure
str(burn)
```

The dataset contain 9 variables and 22750 observations.

Four of the variables are categorical and five are numeric (including one as date).

According to the source of the data, here is an definition of each variable:

Employee ID: The unique ID allocated for each employee.

Date of Joining: The date-time when the employee has joined the organization.

Gender: The gender of the employee

Company Type: The type of company where the employee is working

WFH Setup Available: Is the work from home facility available for the employee

Designation: The designation (designations refer to the expertise and qualifications a person must complete certain jobs) of the employee of work in the organization. In the range of \[0.0, 5.0\] bigger is higher designation.

Resource Allocation: The amount of resource allocated to the employee to work, ie. number of working hours.In the range of \[1.0, 10.0\] (higher means more resource)

Mental Fatigue Score: The level of fatigue mentally the employee is facing.In the range of \[0.0, 10.0\] where 0.0 means no fatigue and 10.0 means completely fatigue.

Burn Rate: The value we need to predict for each employee telling the rate of Bur out while working.In the range of \[0.0, 1.0\] where the higher the value is more is the burn out.

Let's see a Summary for each variable.

But first let's do some data wranglin:

- simplify the name of the variables
- transform the Date of hire into tenure in months
- eliminate ID form the df as it is not relevant for the analysis
- create new variables for categorical variables as numeric to simplify analysis: Gender (1= Male, 2=Female), WFH (1=Yes, 2=No), Type of Business (1=Service, 2=Product)

```{r}

#simplify some variable names and transforming date
burn <- rename(burn, fatigue = Mental.Fatigue.Score, hours = Resource.Allocation, WFH = WFH.Setup.Available, doh = Date.of.Joining, id = Employee.ID, business = Company.Type, designation = Designation, burn.rate = Burn.Rate, gender = Gender)

#transforming date of hire to tenure
burn$doh <- as.Date(burn$doh)
burn$tenure <- difftime("2023-4-20", burn$doh, units = "weeks")
burn$tenure <- burn$tenure/52
burn$tenure <- as.numeric(burn$tenure)

#eliminate ID as it's not relevant for the analysis. They are just the identification for each individual
burn2 <- burn %>%
  dplyr::select(-id)


burn2 <- burn2%>%
  mutate(gender.n = case_when(
        gender == "Male" ~ 1,
         gender == "Female" ~ 2,
        )) %>%
  mutate(business.n = case_when(
         business == "Service" ~ 1,
         business == "Product" ~ 2,
         )) %>%
  mutate(WFH.n = case_when(
         WFH == "Yes" ~ 1,
         WFH == "No" ~ 2,
         ))

```


#### Descriptives and exploratory visualization.


```{r}

#creating a df with only continuous variables
burn3 <- burn2 %>%
  dplyr::select(-gender, -doh, -WFH, -business)

describe_data <- describe(x=burn3) %>% 
  select(c(vars, n, mean, sd, median, min, max))

kable(describe_data) %>% 
  kable_styling("striped")

```


Histograms for Burn Rate, mental Fatigue, Work hours allocated, Designation Level and tenure.
```{r}

hist(burn2$burn.rate, freq = TRUE, col="#a1e9f0", main = "Histogram for Burnout Rate", xlab = "Burn Rate", ylab = "Frequency")

hist(burn2$fatigue, freq = TRUE, col="#a1e9f0", main = "Histogram for Mental Fatigue", xlab = "Values", ylab = "Frequency")

hist(burn2$hours, freq = TRUE, col="#a1e9f0", main = "Histogram of hours allocated", xlab = "Work Hours allocated", ylab = "Frequency")

hist(burn2$designation, freq = TRUE, col="#a1e9f0", main = "Histogram of Designation", xlab = "Designation Level", ylab = "Frequency")

hist(burn2$tenure, freq = TRUE, col="#a1e9f0", main = "Histogram of Tenure", xlab = "Tenure", ylab = "Frequency")
```


Gender, Type of Business and Work setting (WFH):

```{r}

ggplot(burn) +
  geom_bar(aes(x=business, fill=gender),
           position = "dodge") +
  facet_wrap(~WFH)

```

Seems that there are more females working from home than males regardless the business.

#### Explore relationships

```{r}

box2 <- ggplot(burn2, aes(x=business, y=burn.rate, fill=gender)) + 
    geom_boxplot(alpha=0.7, outlier.shape = NA) +
  labs(title="Box Plot - Burn Rate by Gender, Type of business and Work From home (yes or no)",
        x ="Type Of Business", y = "Burn Rate")+
    facet_wrap(~WFH, scale="free")

box2

```

It looks like the Burn rate is higher in the employees working on site compared to employees working from home, and males shows higher rate compared to females in both type of businesses but it seems a higher difference among employees working from home.

```{r}

scatter1 <- ggplot(burn2, aes(designation,burn.rate))+
  geom_point(aes(color=WFH))+
  geom_smooth(method="lm")+
  labs(title="Scatter Plot - Burn Rate vs Designation and Gender",
        x ="Designation", y = "Burn Rate")
scatter1

scatter2 <- ggplot(burn2, aes(hours,burn.rate))+
  geom_point(aes(color=gender))+
  labs(title="Scatter Plot - Burn Rate vs Hours allocated and Gender",
        x ="Hours allocation", y = "Burn Rate")
scatter2


scatter3 <- ggplot(burn2, aes(fatigue,burn.rate))+
  geom_point(aes(color=WFH))+
  geom_smooth(method="gam")+
  labs(title="Scatter Plot - Burn Rate vs Mental Fatigue grouped by Gender and WFH setup",
        x ="Mental Fatigue", y = "Burn Rate")+
  facet_wrap(~gender)
scatter3

scatter4 <- ggplot(burn2, aes(hours,fatigue))+
  geom_point(aes(color=WFH))+
  geom_smooth(method="glm")+
  labs(title="Scatter Plot - Hours allocated vs Mental Fatigue",
        x ="hours allocated", y = "Mental fatigue")
scatter4

```



### **References**:

Bakker, A. B., & Demerouti, E. (2017). Job demands-resources theory: Taking stock and looking forward. Journal of Occupational Health Psychology, 22(3), 273--285.

Lee, Y., Eissenstat, S. (2017). A longitudinal examination of the causes and effects of burnout based on the job demands-resources model. International Journal for Educational and Vocational Guidance, 18(3), 337--354.

Maslach, C., & Leiter, M. P. (2016). Understanding the burnout experience: Recent research and its implications for psychiatry. World Psychiatry, 15(2), 103--111.

West, C. P., Dyrbye, L. N., Erwin, P., Shanafelt, T. D., (2016). Interventions to promote physician well-being and mitigate burnout: A systematic review and meta-analysis. The Lancet, 388(10057), 2272--228
