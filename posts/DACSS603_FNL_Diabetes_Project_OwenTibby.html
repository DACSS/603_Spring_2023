<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Owen Tibby">

<title>Final Project - Diabetes and General Health</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta name="twitter:title" content="Final Project - Diabetes and General Health">
<meta name="twitter:description" content="">
<meta name="twitter:image" content="https://dacss.github.io/603_Spring_2023/posts/DACSS603_FNL_Diabetes_Project_OwenTibby_files/figure-html/unnamed-chunk-1-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target="">
 <span class="menu-text">Spring 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#introduction" id="toc-introduction" class="nav-link active" data-scroll-target="#introduction"><strong>Introduction:</strong></a></li>
  <li><a href="#section-1-data-preprocessing-wrangling" id="toc-section-1-data-preprocessing-wrangling" class="nav-link" data-scroll-target="#section-1-data-preprocessing-wrangling">Section 1: Data Preprocessing &amp; Wrangling</a></li>
  <li><a href="#section-2-exploratory-data-analysis" id="toc-section-2-exploratory-data-analysis" class="nav-link" data-scroll-target="#section-2-exploratory-data-analysis">Section 2: Exploratory Data Analysis</a></li>
  <li><a href="#section-3-modelling-for-diabetes" id="toc-section-3-modelling-for-diabetes" class="nav-link" data-scroll-target="#section-3-modelling-for-diabetes">Section 3: Modelling for Diabetes</a></li>
  <li><a href="#section-4-model-comparison-diabetes" id="toc-section-4-model-comparison-diabetes" class="nav-link" data-scroll-target="#section-4-model-comparison-diabetes">Section 4: Model Comparison (Diabetes)</a></li>
  <li><a href="#section-5-modelling-for-general-health" id="toc-section-5-modelling-for-general-health" class="nav-link" data-scroll-target="#section-5-modelling-for-general-health">Section 5: Modelling for General Health</a></li>
  <li><a href="#section-6-model-comparison-part-2-general-health" id="toc-section-6-model-comparison-part-2-general-health" class="nav-link" data-scroll-target="#section-6-model-comparison-part-2-general-health">Section 6: Model Comparison Part 2 (General Health)</a></li>
  <li><a href="#section-7-summary-of-findings" id="toc-section-7-summary-of-findings" class="nav-link" data-scroll-target="#section-7-summary-of-findings"><strong>Section 7: Summary of Findings</strong></a></li>
  <li><a href="#section-8-conclusion" id="toc-section-8-conclusion" class="nav-link" data-scroll-target="#section-8-conclusion"><strong>Section 8: Conclusion</strong></a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Final Project - Diabetes and General Health</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Owen Tibby </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="introduction" class="level3">
<h3 class="anchored" data-anchor-id="introduction"><strong>Introduction:</strong></h3>
<p>Diabetes, particularly type 2 diabetes, is a widespread chronic disease in the United States, impacting the health of millions and placing a significant financial strain on the US economy (Xie Z, Nikolayeva O, Luo J, Li D., 2019). Recently becoming aware of the risks associated with consuming too much sugary food, I am passionate about promoting overall health awareness among everyday people.</p>
<p>Xie et al.&nbsp;utilized the diabetes data set obtained from the 2014 Behavioral Risk Factor Surveillance System, which offers a wide array of observations associated with multiple significant variables.</p>
<p>This research project aims to further explore the relationship between general health and various socio-economic and demographic factors, such as income, education, and gender.</p>
<p><strong>Note: For a summary of this project’s findings, please see link to poster:</strong> <a href="https://www.canva.com/design/DAFhgdSVFaI/R02Fl8Rh4JIHe7a4STCHKw/view?utm_content=DAFhgdSVFaI&amp;utm_campaign=designshare&amp;utm_medium=link&amp;utm_source=publishsharelink" class="uri">Poster link</a></p>
<section id="research-questions" class="level4">
<h4 class="anchored" data-anchor-id="research-questions">Research Questions:</h4>
<p>Research Question: How do demographic factors compare to health indicators in predicting the risk of type II diabetes and general health?</p>
<p>Hypothesis A: Among adults aged 30 and above, health factors are slightly more effective than demographic factors in predicting the occurrence of diabetes.</p>
<p>Hypothesis B: Demographic factors play a significantly larger role than health indicators in predicting general health.</p>
</section>
<section id="variables" class="level4">
<h4 class="anchored" data-anchor-id="variables">Variables:</h4>
<p>Diabetes: Indicates whether the individual has diabetes or not.</p>
<p>GenHlth: Represents the self-reported general health status of the individual, rescaled to a range of 1 (poor health) to 5 (excellent health).</p>
<p>HighBP: Indicates whether the individual has been diagnosed with high blood pressure or not.</p>
<p>HighChol: Indicates whether the individual has been diagnosed with high cholesterol or not.</p>
<p>CholCheck: Represents whether the individual has undergone cholesterol checks or screenings in the past 5 years.</p>
<p>BMI: Stands for Body Mass Index, a measure of body fat based on height and weight.</p>
<p>Smoker: Indicates whether the individual has smoked more than 100 cigarettes in their lifetime or not.</p>
<p>Stroke: Represents whether the individual has had a stroke or not.</p>
<p>HeartDiseaseorAttack: Indicates whether the individual has a history of heart disease or heart attacks.</p>
<p>PhysActivity: Indicates whether the individual reported engaging in any level of physical activity outside of their regular job or household activities in the past 30 days.</p>
<p>HvyAlcoholConsump: Indicates whether the individual consumes alcohol heavily. For men, it means consuming more than 14 alcoholic drinks per week, and for women, it means consuming more than 7 drinks per week.</p>
<p>NoDocbcCost: Indicates whether the individual has avoided visiting the doctor due to cost constraints.</p>
<p>MentHlth_low: Refers to the mental health status or conditions of the individual. It represents the number of poor mental health days the individual experienced in the past 30 days.</p>
<p>PhysHlth_low: Indicates the physical health status or conditions of the individual. It represents the number of days per month the individual’s physical health was poor.</p>
<p>Sex: Represents the biological sex of the individual. 0 indicates female, and 1 indicates male.</p>
<p>Age: Refers to the age group of the individual. Group 1 represents individuals aged 18-24 years old, and group 13 represents individuals aged 80 or older.</p>
<p>Education: Represents the educational attainment or level of the individual. The scale ranges from 1 (never attended any level of school beyond kindergarten) to 6 (college, 4 years or more).</p>
<p>Income: Indicates the income level or range of the individual. The scale ranges from 1 (less than $10,000 per annum) to 8 (greater than $75,000 per annum).</p>
<p>Diet: Refers to the dietary habits or patterns of the individual, specifically whether they consume fruits or vegetables at least once a day. The scale ranges from 0 (consumes neither fruits nor vegetables) to 3 (consumes both fruits and vegetables).</p>
</section>
<section id="strategy" class="level4">
<h4 class="anchored" data-anchor-id="strategy">Strategy</h4>
<p>This research project aims to investigate two main dependent variables: <em>diabetes</em> and <em>general health</em>. The goal is to develop models for predicting both variables and evaluate their performance using various metrics.</p>
<p>For predicting both variables, three models will be fitted: Ordinal Logistic Regression, Random Forest classification, and Logistic Regression.</p>
<p>The evaluation metrics for these models will include sensitivity, accuracy, AIC (Akaike Information Criterion), and confusion matrices. The prediction accuracy for both general health and diabetes will be compared to determine which models provide better predictions for each dependent variable.</p>
</section>
</section>
<section id="section-1-data-preprocessing-wrangling" class="level3">
<h3 class="anchored" data-anchor-id="section-1-data-preprocessing-wrangling">Section 1: Data Preprocessing &amp; Wrangling</h3>
<section id="reading-in-data" class="level4">
<h4 class="anchored" data-anchor-id="reading-in-data">Reading in Data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>diabetes<span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"_data/diabetes_012.csv"</span>, </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="at">col_types =</span> <span class="fu">cols</span>(<span class="at">DiffWalk =</span> <span class="fu">col_skip</span>()))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Renaming Columns</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>diabetes <span class="ot">&lt;-</span> diabetes <span class="sc">%&gt;%</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">Diabetes =</span> Diabetes_012, <span class="at">MentHlth_low =</span> MentHlth, <span class="at">PhysHlth_low =</span> PhysHlth)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="co">#Re-factoring Diabetes &amp; General Health</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>diabetes<span class="sc">$</span>GenHlth<span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(diabetes<span class="sc">$</span>GenHlth <span class="sc">==</span> <span class="st">"1"</span>, <span class="dv">5</span>, <span class="fu">ifelse</span>(diabetes<span class="sc">$</span>GenHlth <span class="sc">==</span> <span class="st">"2"</span>, <span class="dv">4</span>, <span class="fu">ifelse</span>(diabetes<span class="sc">$</span>GenHlth<span class="sc">==</span> <span class="st">"3"</span>, <span class="dv">3</span>, <span class="fu">ifelse</span>(diabetes<span class="sc">$</span>GenHlth<span class="sc">==</span> <span class="st">"4"</span>, <span class="dv">2</span>, <span class="fu">ifelse</span>(diabetes<span class="sc">$</span>GenHlth <span class="sc">==</span> <span class="st">"5"</span>, <span class="dv">1</span>, <span class="st">"N/A"</span>))))))</span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>diabetes<span class="sc">$</span>GenHlth <span class="ot">&lt;-</span> diabetes<span class="sc">$</span>GenHlth <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>diabetes<span class="sc">$</span>Diabetes <span class="ot">&lt;-</span>  diabetes<span class="sc">$</span>Diabetes <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Merging 'Fruits' and 'Veggies' into one column called Diet</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>diabetes <span class="ot">&lt;-</span>  diabetes <span class="sc">%&gt;%</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diet=</span> <span class="fu">as.numeric</span>(<span class="fu">ifelse</span>(Fruits <span class="sc">+</span> Veggies <span class="sc">==</span> <span class="dv">2</span>, <span class="dv">3</span>,<span class="fu">ifelse</span>(Fruits <span class="sc">==</span> <span class="dv">1</span> <span class="sc">&amp;</span> Veggies<span class="sc">==</span><span class="dv">0</span>, <span class="dv">2</span>, <span class="fu">ifelse</span>(Veggies<span class="sc">==</span><span class="dv">1</span> <span class="sc">&amp;</span> Fruits <span class="sc">==</span><span class="dv">0</span>, <span class="dv">1</span>, <span class="st">"0"</span>)))))</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="co"># diabetes &lt;- diabetes[,-c("Fruits", "Veggies" )]</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>diabetes <span class="ot">&lt;-</span> diabetes[, <span class="sc">!</span>(<span class="fu">colnames</span>(diabetes) <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Fruits"</span>, <span class="st">"Veggies"</span>))]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-2-exploratory-data-analysis" class="level3">
<h3 class="anchored" data-anchor-id="section-2-exploratory-data-analysis">Section 2: Exploratory Data Analysis</h3>
<p>Below are pie charts illustrating the proportion and distribution of diabetes categories, general health and the age groups of the respondents.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Summarize the data to get the count of records in each category</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> diabetes <span class="sc">%&gt;%</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Diabetes) <span class="sc">%&gt;%</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">prop.table</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">Total =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Diabetes =</span> <span class="fu">case_when</span>(</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    Diabetes <span class="sc">==</span> <span class="dv">0</span> <span class="sc">~</span> <span class="st">"Non-diabetic"</span>,</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    Diabetes <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"Prediabetic"</span>,</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    Diabetes <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"Diabetic"</span>))</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the pie chart of Diabetes Categories</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> Diabetes)) <span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">" Distribution of Diabetes Categories"</span>) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Percentage) ,<span class="st">"%"</span>)),</span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"white"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>plot1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DACSS603_FNL_Diabetes_Project_OwenTibby_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> diabetes <span class="sc">%&gt;%</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(GenHlth) <span class="sc">%&gt;%</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">prop.table</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Total =</span> <span class="fu">sum</span>(n)) <span class="sc">%&gt;%</span> </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">GenHlth =</span> <span class="fu">case_when</span>(</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    GenHlth <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"1-Poor"</span>,</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    GenHlth <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"2-Below Aveage"</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    GenHlth <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"3-Average"</span>, </span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>     GenHlth <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"4-Good"</span>,</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>     GenHlth <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"5-Excellent"</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the pie chart to show General Health Distribution</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> GenHlth)) <span class="sc">+</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Self-Reported General Health"</span> , <span class="at">fill=</span> <span class="st">"General Health"</span>) <span class="sc">+</span></span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Percentage) ,<span class="st">"%"</span>)),</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"white"</span>)</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>plot2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DACSS603_FNL_Diabetes_Project_OwenTibby_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>summary_data <span class="ot">&lt;-</span> diabetes <span class="sc">%&gt;%</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(Age) <span class="sc">%&gt;%</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">Percentage =</span> <span class="fu">prop.table</span>(n) <span class="sc">*</span> <span class="dv">100</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">Total =</span> <span class="fu">sum</span>(n), <span class="at">Age=</span><span class="fu">factor</span>(Age) )<span class="sc">%&gt;%</span> </span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>            <span class="fu">mutate</span>(<span class="at">Age =</span> <span class="fu">case_when</span>(</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">1</span> <span class="sc">~</span> <span class="st">"18-24"</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">2</span> <span class="sc">~</span> <span class="st">"25-29"</span>,</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">3</span> <span class="sc">~</span> <span class="st">"30-34"</span>,</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">4</span> <span class="sc">~</span> <span class="st">"35-39"</span>, </span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">5</span> <span class="sc">~</span> <span class="st">"40-44"</span>,</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">6</span> <span class="sc">~</span> <span class="st">"45-49"</span>,</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">7</span><span class="sc">~</span> <span class="st">"50-54"</span>,</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">8</span> <span class="sc">~</span> <span class="st">"55-59"</span>,</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">9</span> <span class="sc">~</span> <span class="st">"60-64"</span>,</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">10</span> <span class="sc">~</span> <span class="st">"65-69"</span>,</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">11</span> <span class="sc">~</span> <span class="st">"70-74"</span>,</span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">12</span> <span class="sc">~</span> <span class="st">"75-79"</span>,</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>              Age <span class="sc">==</span> <span class="dv">13</span> <span class="sc">~</span> <span class="st">"80-99"</span>))</span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="co"># Create the pie chart to show Age Distribution</span></span>
<span id="cb5-23"><a href="#cb5-23" aria-hidden="true" tabindex="-1"></a>plot3 <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(summary_data, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">""</span>, <span class="at">y =</span> n, <span class="at">fill =</span> Age)) <span class="sc">+</span></span>
<span id="cb5-24"><a href="#cb5-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_bar</span>(<span class="at">stat =</span> <span class="st">"identity"</span>, <span class="at">width =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb5-25"><a href="#cb5-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="st">"y"</span>, <span class="at">start =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb5-26"><a href="#cb5-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_void</span>() <span class="sc">+</span></span>
<span id="cb5-27"><a href="#cb5-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Distribution of Age groups"</span> , <span class="at">fill=</span> <span class="st">"Age"</span>) <span class="sc">+</span></span>
<span id="cb5-28"><a href="#cb5-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> <span class="fu">paste0</span>(<span class="fu">round</span>(Percentage) ,<span class="st">"%"</span>)),</span>
<span id="cb5-29"><a href="#cb5-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">position =</span> <span class="fu">position_stack</span>(<span class="at">vjust =</span> <span class="fl">0.5</span>), <span class="at">color =</span> <span class="st">"white"</span>)</span>
<span id="cb5-30"><a href="#cb5-30" aria-hidden="true" tabindex="-1"></a>plot3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DACSS603_FNL_Diabetes_Project_OwenTibby_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Plot the correlation matrix for people with diabetes and pre-diabetes</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Create correlation matrix</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>correlation_matrix <span class="ot">&lt;-</span> <span class="fu">cor</span>(diabetes <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">GenHlth=</span><span class="fu">as.numeric</span>(GenHlth), <span class="at">Diabetes =</span> <span class="fu">as.numeric</span>(Diabetes)))</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Melt correlation matrix into long format for ggplot2</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>melted_correlation <span class="ot">&lt;-</span> <span class="fu">melt</span>(correlation_matrix)</span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Create heat map with ggplot2</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> melted_correlation, <span class="fu">aes</span>(<span class="at">x =</span> Var1, <span class="at">y =</span> Var2, <span class="at">fill =</span> value)) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>() <span class="sc">+</span></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_fill_gradient2</span>(<span class="at">low =</span> <span class="st">"darkred"</span>, <span class="at">mid =</span> <span class="st">"white"</span>, <span class="at">high =</span> <span class="st">"darkgreen"</span>, <span class="at">midpoint =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span></span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x=</span> <span class="st">""</span>, <span class="at">y=</span><span class="st">""</span>)<span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="co">#+</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DACSS603_FNL_Diabetes_Project_OwenTibby_files/figure-html/Correlation Plot-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#labs(title = "Correlation Matrix")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="splitting-the-data" class="level4">
<h4 class="anchored" data-anchor-id="splitting-the-data">Splitting the Data</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data partition for cross-validation</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>partition <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(diabetes<span class="sc">$</span>Diabetes, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and validation sets</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> diabetes[partition, ]</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>valid <span class="ot">&lt;-</span> diabetes[<span class="sc">-</span>partition, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="section-3-modelling-for-diabetes" class="level3">
<h3 class="anchored" data-anchor-id="section-3-modelling-for-diabetes">Section 3: Modelling for Diabetes</h3>
<section id="random-forest" class="level4">
<h4 class="anchored" data-anchor-id="random-forest">Random Forest</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>demographic_factors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"Income"</span>, <span class="st">"Education"</span>, <span class="st">"Age"</span>, <span class="st">"NoDocbcCost"</span>)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>health_indicators <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GenHlth"</span>, <span class="st">"BMI"</span>,  <span class="st">"Smoker"</span>, <span class="st">"HighBP"</span>, <span class="st">"HighChol"</span>, <span class="st">"Stroke"</span> , <span class="st">"HeartDiseaseorAttack"</span> ,  <span class="st">"HvyAlcoholConsump"</span> ,<span class="st">"Diet"</span>) </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">c</span>(demographic_factors, health_indicators)</span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="st">"Diabetes"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>diab_rf_dem <span class="ot">&lt;-</span>  <span class="fu">train</span>(<span class="at">x =</span> train[,demographic_factors ], <span class="at">y =</span>train[[response]], <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>), <span class="at">ntree=</span><span class="dv">20</span>)</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>diab_rf_hlth <span class="ot">&lt;-</span> diab_rf_hlth <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="at">x =</span> train[,health_indicators ], <span class="at">y =</span> train[[response]], <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>), <span class="at">ntree=</span> <span class="dv">20</span>)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>diab_rf_both <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="at">x =</span> train[,both ], <span class="at">y =</span> train[[response]], <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>), <span class="at">ntree=</span> <span class="dv">20</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">factor</span>(valid<span class="sc">$</span>Diabetes)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the validation set</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>predictions_rf_dem <span class="ot">&lt;-</span> <span class="fu">predict</span>(diab_rf_dem, <span class="at">newdata =</span> valid[, demographic_factors]) <span class="sc">%&gt;%</span>  as.factor</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the validation set</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>predictions_rf_hlth <span class="ot">&lt;-</span> <span class="fu">predict</span>(diab_rf_hlth, <span class="at">newdata =</span> valid[, health_indicators]) <span class="sc">%&gt;%</span>  as.factor</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the validation set</span></span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>predictions_rf_both <span class="ot">&lt;-</span> <span class="fu">predict</span>(diab_rf_both, <span class="at">newdata =</span> valid[, both]) <span class="sc">%&gt;%</span>  as.factor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the confusion matrix and accuracy of the model</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Demogrpahic Variables in RF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Demogrpahic Variables in RF</code></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_rf_dem, actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     1     2
         0 42734   926  7067
         1     0     0     0
         2     6     0     2

Overall Statistics
                                          
               Accuracy : 0.8423          
                 95% CI : (0.8391, 0.8455)
    No Information Rate : 0.8424          
    P-Value [Acc &gt; NIR] : 0.5224          
                                          
                  Kappa : 2e-04           
                                          
 Mcnemar's Test P-Value : NA              

Statistics by Class:

                      Class: 0 Class: 1  Class: 2
Sensitivity          0.9998596  0.00000 2.829e-04
Specificity          0.0002502  1.00000 9.999e-01
Pos Pred Value       0.8424311      NaN 2.500e-01
Neg Pred Value       0.2500000  0.98175 8.607e-01
Prevalence           0.8424165  0.01825 1.393e-01
Detection Rate       0.8422982  0.00000 3.942e-05
Detection Prevalence 0.9998423  0.00000 1.577e-04
Balanced Accuracy    0.5000549  0.50000 5.001e-01</code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Health Variables in RF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Health Variables in RF</code></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_rf_hlth, actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     1     2
         0 42333   894  6393
         1     0     0     0
         2   407    32   676

Overall Statistics
                                          
               Accuracy : 0.8477          
                 95% CI : (0.8446, 0.8508)
    No Information Rate : 0.8424          
    P-Value [Acc &gt; NIR] : 0.0005092       
                                          
                  Kappa : 0.1199          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       

Statistics by Class:

                     Class: 0 Class: 1 Class: 2
Sensitivity           0.99048  0.00000  0.09563
Specificity           0.08856  1.00000  0.98995
Pos Pred Value        0.85314      NaN  0.60628
Neg Pred Value        0.63498  0.98175  0.87116
Prevalence            0.84242  0.01825  0.13933
Detection Rate        0.83439  0.00000  0.01332
Detection Prevalence  0.97802  0.00000  0.02198
Balanced Accuracy     0.53952  0.50000  0.54279</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Demogrpahic &amp; Health Variables in RF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Demogrpahic &amp; Health Variables in RF</code></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_rf_both, actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     1     2
         0 42355   894  6381
         1     0     0     0
         2   385    32   688

Overall Statistics
                                          
               Accuracy : 0.8484          
                 95% CI : (0.8452, 0.8515)
    No Information Rate : 0.8424          
    P-Value [Acc &gt; NIR] : 0.0001062       
                                          
                  Kappa : 0.1231          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       

Statistics by Class:

                     Class: 0 Class: 1 Class: 2
Sensitivity           0.99099  0.00000  0.09733
Specificity           0.09006  1.00000  0.99045
Pos Pred Value        0.85342      NaN  0.62262
Neg Pred Value        0.65158  0.98175  0.87143
Prevalence            0.84242  0.01825  0.13933
Detection Rate        0.83483  0.00000  0.01356
Detection Prevalence  0.97822  0.00000  0.02178
Balanced Accuracy     0.54052  0.50000  0.54389</code></pre>
</div>
</div>
</section>
<section id="ordinal-logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="ordinal-logistic-regression">Ordinal Logistic Regression</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ordinal logistic regression model for diabetes prediction using demographic factors</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>diab_olm_dem <span class="ot">&lt;-</span> <span class="fu">polr</span>(Diabetes <span class="sc">~</span> Income<span class="sc">*</span>Education <span class="sc">+</span> Age <span class="sc">+</span> Sex <span class="sc">+</span> NoDocbcCost, <span class="at">data =</span> train)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diab_olm_dem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = Diabetes ~ Income * Education + Age + Sex + NoDocbcCost, 
    data = train)

Coefficients:
                    Value Std. Error t value
Income           -0.09324   0.013429  -6.944
Education        -0.07608   0.015310  -4.969
Age               0.17403   0.002332  74.641
Sex               0.33003   0.012819  25.746
NoDocbcCost       0.34023   0.021590  15.759
Income:Education -0.01385   0.002734  -5.066

Intercepts:
    Value   Std. Error t value
0|1  2.0392  0.0739    27.5941
1|2  2.1931  0.0739    29.6681

Residual Deviance: 186572.36 
AIC: 186588.36 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>diab_olm_hth <span class="ot">&lt;-</span> <span class="fu">polr</span>(Diabetes<span class="sc">~</span> GenHlth <span class="sc">+</span> BMI <span class="sc">+</span> Smoker<span class="sc">+</span> HighBP <span class="sc">+</span> HighChol <span class="sc">+</span> Stroke <span class="sc">+</span> HeartDiseaseorAttack <span class="sc">+</span> HvyAlcoholConsump <span class="sc">+</span> Diet, <span class="at">data =</span> train)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(diab_olm_hth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = Diabetes ~ GenHlth + BMI + Smoker + HighBP + HighChol + 
    Stroke + HeartDiseaseorAttack + HvyAlcoholConsump + Diet, 
    data = train)

Coefficients:
                        Value Std. Error t value
GenHlth2             -0.18150  0.0263103  -6.899
GenHlth3             -0.66263  0.0250488 -26.454
GenHlth4             -1.37753  0.0270188 -50.984
GenHlth5             -2.06058  0.0385455 -53.458
BMI                   0.05136  0.0009145  56.161
Smoker                0.04533  0.0136497   3.321
HighBP                0.92404  0.0149636  61.753
HighChol              0.66858  0.0141728  47.173
Stroke                0.26567  0.0267760   9.922
HeartDiseaseorAttack  0.40902  0.0188064  21.749
HvyAlcoholConsump    -0.81188  0.0390895 -20.770
Diet                 -0.01702  0.0058222  -2.924

Intercepts:
    Value    Std. Error t value 
0|1   3.2094   0.0417    76.9570
1|2   3.3839   0.0418    80.9461

Residual Deviance: 165914.43 
AIC: 165942.43 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>diab_olm_both <span class="ot">&lt;-</span> <span class="fu">polr</span>(Diabetes<span class="sc">~</span> Income<span class="sc">*</span>Education <span class="sc">+</span> Age <span class="sc">+</span> Sex <span class="sc">+</span> NoDocbcCost <span class="sc">+</span> GenHlth<span class="sc">+</span> BMI <span class="sc">+</span> Smoker<span class="sc">+</span> HighBP <span class="sc">+</span> HighChol <span class="sc">+</span> Stroke <span class="sc">+</span> HeartDiseaseorAttack <span class="sc">+</span> HvyAlcoholConsump <span class="sc">+</span> Diet, <span class="at">data =</span> train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions using demographic indicators with OLM</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>predictions_olm_dem <span class="ot">&lt;-</span> <span class="fu">predict</span>(diab_olm_dem, <span class="at">newdata=</span> valid)</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions using health indicators with OLM</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>predictions_olm_hlth <span class="ot">&lt;-</span> <span class="fu">predict</span>(diab_olm_hth, <span class="at">newdata=</span> valid)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions using health indicators with both</span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>predictions_olm_both <span class="ot">&lt;-</span> <span class="fu">predict</span>(diab_olm_both, <span class="at">newdata=</span> valid)</span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the response variable from the training data</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> valid<span class="sc">$</span>Diabetes</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix for demographic variables</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Demographic Variables in Ordinal logistic model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Demographic Variables in Ordinal logistic model</code></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_olm_dem, actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     1     2
         0 42689   925  7049
         1     0     0     0
         2    51     1    20

Overall Statistics
                                         
               Accuracy : 0.8418         
                 95% CI : (0.8386, 0.845)
    No Information Rate : 0.8424         
    P-Value [Acc &gt; NIR] : 0.6499         
                                         
                  Kappa : 0.0024         
                                         
 Mcnemar's Test P-Value : &lt;2e-16         

Statistics by Class:

                     Class: 0 Class: 1  Class: 2
Sensitivity          0.998807  0.00000 0.0028293
Specificity          0.002627  1.00000 0.9988091
Pos Pred Value       0.842607      NaN 0.2777778
Neg Pred Value       0.291667  0.98175 0.8608649
Prevalence           0.842416  0.01825 0.1393318
Detection Rate       0.841411  0.00000 0.0003942
Detection Prevalence 0.998581  0.00000 0.0014191
Balanced Accuracy    0.500717  0.50000 0.5008192</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix for health indicators</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Health Variables in Ordinal logistic model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Health Variables in Ordinal logistic model</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_olm_hlth, actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     1     2
         0 41876   872  5984
         1     0     0     0
         2   864    54  1085

Overall Statistics
                                          
               Accuracy : 0.8468          
                 95% CI : (0.8436, 0.8499)
    No Information Rate : 0.8424          
    P-Value [Acc &gt; NIR] : 0.003513        
                                          
                  Kappa : 0.1733          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       

Statistics by Class:

                     Class: 0 Class: 1 Class: 2
Sensitivity            0.9798  0.00000  0.15349
Specificity            0.1425  1.00000  0.97898
Pos Pred Value         0.8593      NaN  0.54169
Neg Pred Value         0.5686  0.98175  0.87721
Prevalence             0.8424  0.01825  0.13933
Detection Rate         0.8254  0.00000  0.02139
Detection Prevalence   0.9605  0.00000  0.03948
Balanced Accuracy      0.5611  0.50000  0.56623</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix for health indicators</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Demographic &amp; health Variables in Ordinal logistic model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Demographic &amp; health Variables in Ordinal logistic model</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_olm_both, actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     1     2
         0 41749   862  5910
         1     0     0     0
         2   991    64  1159

Overall Statistics
                                          
               Accuracy : 0.8457          
                 95% CI : (0.8426, 0.8489)
    No Information Rate : 0.8424          
    P-Value [Acc &gt; NIR] : 0.02041         
                                          
                  Kappa : 0.1806          
                                          
 Mcnemar's Test P-Value : &lt; 2e-16         

Statistics by Class:

                     Class: 0 Class: 1 Class: 2
Sensitivity            0.9768  0.00000  0.16396
Specificity            0.1530  1.00000  0.97584
Pos Pred Value         0.8604      NaN  0.52349
Neg Pred Value         0.5524  0.98175  0.87820
Prevalence             0.8424  0.01825  0.13933
Detection Rate         0.8229  0.00000  0.02284
Detection Prevalence   0.9564  0.00000  0.04364
Balanced Accuracy      0.5649  0.50000  0.56990</code></pre>
</div>
</div>
</section>
<section id="logistic-regression" class="level4">
<h4 class="anchored" data-anchor-id="logistic-regression">Logistic Regression</h4>
<p>Note: The diabetes data was subsequently recoded to merge individuals classified as pre-diabetic and non-diabetic, creating two distinct classes. A value of 0 was assigned to those who were non-diabetic or pre-diabetic, while a value of 2 was assigned to those classified as diabetic.</p>
<p>This re-coding process sets the stage for logistic regression analysis, aiming to evaluate how it compares to the sensitivity of the ordinal logistic model.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co">#count of prediabetics</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>( <span class="st">"Number of pre-diabetics: "</span>, <span class="fu">length</span>(diabetes<span class="sc">$</span>Diabetes[diabetes<span class="sc">$</span>Diabetes <span class="sc">==</span> <span class="st">"1"</span>]))</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Merging pre-diabetics with non-diabetics</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>diabetes_binary <span class="ot">&lt;-</span> diabetes</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>diabetes_binary<span class="sc">$</span>Diabetes[diabetes_binary<span class="sc">$</span>Diabetes <span class="sc">==</span> <span class="st">"1"</span>] <span class="ot">&lt;-</span> <span class="dv">0</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co">#count of prediabetics</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>( <span class="st">"Number of pre-diabetics: "</span>, <span class="fu">length</span>(diabetes<span class="sc">$</span>Diabetes[diabetes<span class="sc">$</span>Diabetes <span class="sc">==</span> <span class="st">"1"</span>]))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Number of pre-diabetics:  4631</code></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Merging pre-diabetics with non-diabetics</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>diabetes_binary <span class="ot">&lt;-</span> diabetes</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>diabetes_binary<span class="sc">$</span>Diabetes[diabetes_binary<span class="sc">$</span>Diabetes <span class="sc">==</span> <span class="st">"1"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<pre><code></code></pre>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>demographic_factors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"Income"</span>, <span class="st">"Education"</span>, <span class="st">"Age"</span>, <span class="st">"NoDocbcCost"</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>health_indicators <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"GenHlth"</span>, <span class="st">"BMI"</span>,  <span class="st">"Smoker"</span>, <span class="st">"HighBP"</span>, <span class="st">"HighChol"</span>, <span class="st">"Stroke"</span> , <span class="st">"HeartDiseaseorAttack"</span> ,  <span class="st">"HvyAlcoholConsump"</span> ,<span class="st">"Diet"</span>) </span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">c</span>(demographic_factors, health_indicators)</span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Merging pre-diabetics with non-diabetics</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>diabetes_binary <span class="ot">&lt;-</span> diabetes</span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>diabetes_binary<span class="sc">$</span>Diabetes[diabetes_binary<span class="sc">$</span>Diabetes <span class="sc">==</span> <span class="st">"1"</span>] <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Create a data partition for cross-validation</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">123</span>)</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a>partition <span class="ot">&lt;-</span> <span class="fu">createDataPartition</span>(diabetes_binary<span class="sc">$</span>Diabetes, <span class="at">p =</span> <span class="fl">0.8</span>, <span class="at">list =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and validation sets</span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a>train2 <span class="ot">&lt;-</span> diabetes_binary[partition, ]</span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a>valid2 <span class="ot">&lt;-</span> diabetes_binary[<span class="sc">-</span>partition, ]</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="co"># LR models</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>diab_lr_dem <span class="ot">&lt;-</span>  <span class="fu">multinom</span>(Diabetes <span class="sc">~</span>  Income<span class="sc">*</span>Education <span class="sc">+</span> Age <span class="sc">+</span> Sex <span class="sc">+</span> NoDocbcCost, <span class="at">data =</span> train2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  8 (7 variable)
initial  value 140670.754559 
iter  10 value 81880.470998
final  value 81875.856658 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>diab_lr_hlth <span class="ot">&lt;-</span>  <span class="fu">multinom</span>(Diabetes <span class="sc">~</span> GenHlth <span class="sc">+</span> BMI <span class="sc">+</span> HighBP <span class="sc">+</span> HighChol <span class="sc">+</span> Stroke <span class="sc">+</span> HeartDiseaseorAttack <span class="sc">+</span> HvyAlcoholConsump <span class="sc">+</span> Diet, <span class="at">data =</span> train2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  13 (12 variable)
initial  value 140670.754559 
iter  10 value 81796.759194
iter  20 value 71657.874488
final  value 71657.844798 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>diab_lr_both <span class="ot">&lt;-</span> <span class="fu">multinom</span>(Diabetes <span class="sc">~</span> Income<span class="sc">*</span>Education <span class="sc">+</span> Age <span class="sc">+</span> Sex <span class="sc">+</span> NoDocbcCost <span class="sc">+</span> GenHlth <span class="sc">+</span>BMI <span class="sc">+</span> HighBP <span class="sc">+</span> HighChol <span class="sc">+</span> Stroke <span class="sc">+</span> HeartDiseaseorAttack <span class="sc">+</span> HvyAlcoholConsump <span class="sc">+</span> Diet, <span class="at">data =</span> train2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  19 (18 variable)
initial  value 140670.754559 
iter  10 value 75778.902970
iter  20 value 74308.882164
final  value 70218.660619 
converged</code></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>actual <span class="ot">&lt;-</span> <span class="fu">factor</span>(valid2<span class="sc">$</span>Diabetes)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the validation set</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>predictions_lr_dem <span class="ot">&lt;-</span> <span class="fu">predict</span>(diab_lr_dem, <span class="at">newdata =</span> valid2[, demographic_factors]) <span class="sc">%&gt;%</span>  as.factor</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the validation set</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>predictions_lr_hlth <span class="ot">&lt;-</span> <span class="fu">predict</span>(diab_lr_hlth, <span class="at">newdata =</span> valid2[, health_indicators]) <span class="sc">%&gt;%</span>  as.factor</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the validation set</span></span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>predictions_lr_both <span class="ot">&lt;-</span> <span class="fu">predict</span>(diab_lr_both, <span class="at">newdata =</span> valid2[, both]) <span class="sc">%&gt;%</span>  as.factor</span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-13"><a href="#cb53-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the confusion matrix and accuracy of the model</span></span>
<span id="cb53-14"><a href="#cb53-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-15"><a href="#cb53-15" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Demographic Variables in  logistic regression model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Demographic Variables in  logistic regression model</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_lr_dem, actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     2
         0 42659  7960
         2    81    35
                                          
               Accuracy : 0.8415          
                 95% CI : (0.8383, 0.8447)
    No Information Rate : 0.8424          
    P-Value [Acc &gt; NIR] : 0.7148          
                                          
                  Kappa : 0.0041          
                                          
 Mcnemar's Test P-Value : &lt;2e-16          
                                          
            Sensitivity : 0.998105        
            Specificity : 0.004378        
         Pos Pred Value : 0.842747        
         Neg Pred Value : 0.301724        
             Prevalence : 0.842416        
         Detection Rate : 0.840820        
   Detection Prevalence : 0.997714        
      Balanced Accuracy : 0.501241        
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Health Variables in  logistic regression model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Health Variables in  logistic regression model</code></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_lr_hlth, actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     2
         0 41694  6637
         2  1046  1358
                                          
               Accuracy : 0.8486          
                 95% CI : (0.8454, 0.8517)
    No Information Rate : 0.8424          
    P-Value [Acc &gt; NIR] : 6.819e-05       
                                          
                  Kappa : 0.2031          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9755          
            Specificity : 0.1699          
         Pos Pred Value : 0.8627          
         Neg Pred Value : 0.5649          
             Prevalence : 0.8424          
         Detection Rate : 0.8218          
   Detection Prevalence : 0.9526          
      Balanced Accuracy : 0.5727          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">"Demographic &amp; health Variables in  logistic regression model"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Demographic &amp; health Variables in  logistic regression model</code></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_lr_both, actual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     0     2
         0 41544  6540
         2  1196  1455
                                          
               Accuracy : 0.8475          
                 95% CI : (0.8444, 0.8506)
    No Information Rate : 0.8424          
    P-Value [Acc &gt; NIR] : 0.0007823       
                                          
                  Kappa : 0.2115          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       
                                          
            Sensitivity : 0.9720          
            Specificity : 0.1820          
         Pos Pred Value : 0.8640          
         Neg Pred Value : 0.5488          
             Prevalence : 0.8424          
         Detection Rate : 0.8188          
   Detection Prevalence : 0.9477          
      Balanced Accuracy : 0.5770          
                                          
       'Positive' Class : 0               
                                          </code></pre>
</div>
</div>
</section>
</section>
<section id="section-4-model-comparison-diabetes" class="level3">
<h3 class="anchored" data-anchor-id="section-4-model-comparison-diabetes">Section 4: Model Comparison (Diabetes)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>model_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Demographic Variables"</span>, <span class="st">"Health Variables"</span>, <span class="st">"Both Dem. &amp; Hlth"</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>AIC_values_olm <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">AIC</span>(diab_olm_dem), <span class="fu">AIC</span>(diab_olm_hth), <span class="fu">AIC</span>(diab_olm_both))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="co"># BIC_values_olm &lt;- c(BIC(diab_olm_dem), BIC(diab_olm_hth), BIC(diab_olm_both))</span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting AIC values</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(AIC_values_olm, <span class="at">names.arg =</span> model_names, <span class="at">ylab =</span> <span class="st">"AIC"</span>, <span class="at">main =</span> <span class="st">"Ordinal Logistic Regression Model: AIC Comparison (Diabetes)"</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"darkblue"</span>, <span class="st">"blue"</span>, <span class="st">"lightblue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DACSS603_FNL_Diabetes_Project_OwenTibby_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>AIC_values_lr <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">AIC</span>(diab_lr_dem), <span class="fu">AIC</span>(diab_lr_hlth), <span class="fu">AIC</span>(diab_lr_both))</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting AIC values</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(AIC_values_lr, <span class="at">names.arg =</span> model_names, <span class="at">ylab =</span> <span class="st">"AIC"</span>, <span class="at">main =</span> <span class="st">"Logistic Regression Model: AIC Comparison (Diabetes)"</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"darkred"</span>, <span class="st">"red"</span>, <span class="st">"pink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DACSS603_FNL_Diabetes_Project_OwenTibby_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section-5-modelling-for-general-health" class="level3">
<h3 class="anchored" data-anchor-id="section-5-modelling-for-general-health">Section 5: Modelling for General Health</h3>
<section id="random-forest-1" class="level4">
<h4 class="anchored" data-anchor-id="random-forest-1">Random Forest</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="do">#### Random Forest</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>demographic_factors <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Sex"</span>, <span class="st">"Income"</span>, <span class="st">"Education"</span>, <span class="st">"Age"</span>, <span class="st">"NoDocbcCost"</span>)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>health_indicators <span class="ot">&lt;-</span> <span class="fu">c</span>( <span class="st">"Diabetes"</span> ,<span class="st">"BMI"</span>,  <span class="st">"Smoker"</span>, <span class="st">"HighBP"</span>, <span class="st">"HighChol"</span>, <span class="st">"Stroke"</span> , <span class="st">"HeartDiseaseorAttack"</span> ,  <span class="st">"HvyAlcoholConsump"</span> ,<span class="st">"Diet"</span>) </span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>both <span class="ot">&lt;-</span> <span class="fu">c</span>(demographic_factors, health_indicators)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>response <span class="ot">&lt;-</span> <span class="st">"GenHlth"</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>gen_rf_dem <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="at">x =</span> train[,demographic_factors ], <span class="at">y =</span>train[[response]], <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>), <span class="at">ntree=</span><span class="dv">15</span>)</span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a>gen_rf_hlth <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="at">x =</span> train[,health_indicators ], <span class="at">y =</span> train[[response]], <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>), <span class="at">ntree=</span> <span class="dv">15</span>)</span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a>gen_rf_both <span class="ot">&lt;-</span> <span class="fu">train</span>(<span class="at">x =</span> train[,both ], <span class="at">y =</span> train[[response]], <span class="at">method =</span> <span class="st">"rf"</span>, <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">"cv"</span>, <span class="at">number =</span> <span class="dv">5</span>), <span class="at">ntree=</span> <span class="dv">15</span>)</span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-18"><a href="#cb67-18" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions</span></span>
<span id="cb67-19"><a href="#cb67-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-20"><a href="#cb67-20" aria-hidden="true" tabindex="-1"></a>valid<span class="sc">$</span>GenHlth <span class="ot">&lt;-</span> valid<span class="sc">$</span>GenHlth <span class="sc">%&gt;%</span> as.factor</span>
<span id="cb67-21"><a href="#cb67-21" aria-hidden="true" tabindex="-1"></a>actual_gen <span class="ot">&lt;-</span> (valid<span class="sc">$</span>GenHlth) <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb67-22"><a href="#cb67-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-23"><a href="#cb67-23" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the validation set using demographic factors</span></span>
<span id="cb67-24"><a href="#cb67-24" aria-hidden="true" tabindex="-1"></a>predictions_gen_rf_dem <span class="ot">&lt;-</span> <span class="fu">predict</span>(gen_rf_dem, <span class="at">newdata =</span> valid[, demographic_factors]) <span class="sc">%&gt;%</span>   <span class="fu">as.factor</span>()</span>
<span id="cb67-25"><a href="#cb67-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-26"><a href="#cb67-26" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the validation set using health factors</span></span>
<span id="cb67-27"><a href="#cb67-27" aria-hidden="true" tabindex="-1"></a>predictions_gen_rf_hlth <span class="ot">&lt;-</span> <span class="fu">predict</span>(gen_rf_hlth, <span class="at">newdata =</span> valid[, health_indicators]) <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb67-28"><a href="#cb67-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-29"><a href="#cb67-29" aria-hidden="true" tabindex="-1"></a><span class="co"># Make predictions on the validation set using health factors</span></span>
<span id="cb67-30"><a href="#cb67-30" aria-hidden="true" tabindex="-1"></a>predictions_gen_rf_both <span class="ot">&lt;-</span> <span class="fu">predict</span>(gen_rf_both, <span class="at">newdata =</span> valid[, both]) <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb67-31"><a href="#cb67-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-32"><a href="#cb67-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-33"><a href="#cb67-33" aria-hidden="true" tabindex="-1"></a><span class="co">#predictions_gen_rf_dem &lt;- factor(predictions_gen_rf_dem, levels = levels(actual_gen))</span></span>
<span id="cb67-34"><a href="#cb67-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-35"><a href="#cb67-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-36"><a href="#cb67-36" aria-hidden="true" tabindex="-1"></a><span class="co">#predictions_gen_rf_both &lt;- factor(predictions_gen_rf_both, levels = levels(actual_gen))</span></span>
<span id="cb67-37"><a href="#cb67-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-38"><a href="#cb67-38" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the confusion matrix and accuracy of the model</span></span>
<span id="cb67-39"><a href="#cb67-39" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_gen_rf_dem, actual_gen)</span>
<span id="cb67-40"><a href="#cb67-40" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_gen_rf_hlth, actual_gen)</span>
<span id="cb67-41"><a href="#cb67-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-42"><a href="#cb67-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-43"><a href="#cb67-43" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_gen_rf_both, actual_gen)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="ordinal-logistic-model" class="level4">
<h4 class="anchored" data-anchor-id="ordinal-logistic-model">Ordinal Logistic Model</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>diabetes<span class="sc">$</span>GenHlth <span class="ot">&lt;-</span> diabetes<span class="sc">$</span>GenHlth <span class="sc">%&gt;%</span> <span class="fu">as.factor</span>()</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Split the data into training and validation sets</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>train <span class="ot">&lt;-</span> diabetes[partition, ]</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a>valid <span class="ot">&lt;-</span> diabetes[<span class="sc">-</span>partition, ]</span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="co"># Fit ordinal logistic regression model for diabetes prediction using demographic factors</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>gen_olm_dem <span class="ot">&lt;-</span> <span class="fu">polr</span>(GenHlth <span class="sc">~</span> Income<span class="sc">*</span>Education <span class="sc">+</span> Age <span class="sc">+</span> Sex <span class="sc">+</span> NoDocbcCost, <span class="at">data =</span> train)</span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the model summary</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gen_olm_dem)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = GenHlth ~ Income * Education + Age + Sex + NoDocbcCost, 
    data = train)

Coefficients:
                     Value Std. Error t value
Income            0.247518   0.009676  25.582
Education         0.268930   0.011905  22.590
Age              -0.074559   0.001367 -54.551
Sex              -0.175646   0.008252 -21.285
NoDocbcCost      -0.787298   0.015327 -51.368
Income:Education  0.003006   0.001949   1.542

Intercepts:
    Value    Std. Error t value 
1|2  -1.1290   0.0569   -19.8344
2|3   0.4422   0.0570     7.7600
3|4   2.1254   0.0574    36.9993
4|5   3.9489   0.0575    68.6786

Residual Deviance: 546445.71 
AIC: 546465.71 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="co">#OLR model</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>gen_olm_hth <span class="ot">&lt;-</span> <span class="fu">polr</span>(GenHlth<span class="sc">~</span> Diabetes <span class="sc">+</span> BMI <span class="sc">+</span> Smoker<span class="sc">+</span> HighBP <span class="sc">+</span> HighChol <span class="sc">+</span> Stroke <span class="sc">+</span> HeartDiseaseorAttack <span class="sc">+</span> HvyAlcoholConsump <span class="sc">+</span> Diet, <span class="at">data =</span> train)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(gen_olm_hth)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Call:
polr(formula = GenHlth ~ Diabetes + BMI + Smoker + HighBP + HighChol + 
    Stroke + HeartDiseaseorAttack + HvyAlcoholConsump + Diet, 
    data = train)

Coefficients:
                       Value Std. Error t value
Diabetes1            -0.6437  0.0305433  -21.08
Diabetes2            -0.9534  0.0127099  -75.01
BMI                  -0.0492  0.0006732  -73.08
Smoker               -0.4205  0.0083976  -50.07
HighBP               -0.6254  0.0091414  -68.41
HighChol             -0.2767  0.0087734  -31.54
Stroke               -0.9755  0.0217750  -44.80
HeartDiseaseorAttack -0.9949  0.0150702  -66.02
HvyAlcoholConsump     0.2017  0.0178414   11.31
Diet                  0.1523  0.0036542   41.68

Intercepts:
    Value     Std. Error t value  
1|2   -5.4235    0.0255  -212.4224
2|3   -3.7883    0.0233  -162.9228
3|4   -2.0268    0.0220   -92.0342
4|5   -0.1318    0.0216    -6.0947

Residual Deviance: 533054.80 
AIC: 533082.80 </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>gen_olm_both <span class="ot">&lt;-</span> <span class="fu">polr</span>(GenHlth<span class="sc">~</span> Diabetes <span class="sc">+</span>BMI <span class="sc">+</span> Smoker<span class="sc">+</span> HighBP <span class="sc">+</span> HighChol <span class="sc">+</span> Stroke <span class="sc">+</span> HeartDiseaseorAttack <span class="sc">+</span> HvyAlcoholConsump <span class="sc">+</span> Diet <span class="sc">+</span> Income<span class="sc">*</span>Education <span class="sc">+</span> Age <span class="sc">+</span> Sex <span class="sc">+</span> NoDocbcCost</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>, <span class="at">data =</span> train)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions using demographic indicators with OLM</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>predictions_olm_dem_gen <span class="ot">&lt;-</span> <span class="fu">predict</span>(gen_olm_dem, <span class="at">newdata=</span> valid)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions using health indicators with OLM</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>predictions_olm_hlth_gen <span class="ot">&lt;-</span> <span class="fu">predict</span>(gen_olm_hth, <span class="at">newdata=</span> valid)</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Predictions using health indicators with OLM</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>predictions_olm_both_gen <span class="ot">&lt;-</span> <span class="fu">predict</span>(gen_olm_both, <span class="at">newdata=</span> valid)</span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the response variable from the training data</span></span>
<span id="cb73-13"><a href="#cb73-13" aria-hidden="true" tabindex="-1"></a>actual_gen_olm <span class="ot">&lt;-</span> valid<span class="sc">$</span>GenHlth</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix for demographic variables</span></span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_olm_dem_gen, actual_gen_olm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     1     2     3     4     5
         1    19    14     8     6     1
         2   334   470   366   155    57
         3  1669  3784  6356  4563  1640
         4   489  2069  8264 12994  7285
         5     0     5    38    92    57

Overall Statistics
                                          
               Accuracy : 0.3922          
                 95% CI : (0.3879, 0.3964)
    No Information Rate : 0.351           
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.1002          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       

Statistics by Class:

                      Class: 1 Class: 2 Class: 3 Class: 4 Class: 5
Sensitivity          0.0075667 0.074109   0.4228   0.7296 0.006305
Specificity          0.9993986 0.979456   0.6735   0.4501 0.996762
Pos Pred Value       0.3958333 0.340087   0.3529   0.4178 0.296875
Neg Pred Value       0.9508355 0.881020   0.7349   0.7547 0.822270
Prevalence           0.0494925 0.125002   0.2963   0.3510 0.178181
Detection Rate       0.0003745 0.009264   0.1253   0.2561 0.001123
Detection Prevalence 0.0009461 0.027240   0.3550   0.6130 0.003784
Balanced Accuracy    0.5034827 0.526783   0.5482   0.5898 0.501534</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix for health indicators</span></span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_olm_hlth_gen, actual_gen_olm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     1     2     3     4     5
         1   152   145    81    32     5
         2   439   763   627   220    41
         3  1245  3275  6124  4099   938
         4   667  2144  8141 13291  7845
         5     8    15    59   168   211

Overall Statistics
                                          
               Accuracy : 0.4049          
                 95% CI : (0.4006, 0.4092)
    No Information Rate : 0.351           
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16       
                                          
                  Kappa : 0.1238          
                                          
 Mcnemar's Test P-Value : &lt; 2.2e-16       

Statistics by Class:

                     Class: 1 Class: 2 Class: 3 Class: 4 Class: 5
Sensitivity          0.060534  0.12031   0.4074   0.7463 0.023341
Specificity          0.994546  0.97011   0.7323   0.4291 0.994004
Pos Pred Value       0.366265  0.36507   0.3905   0.4142 0.457701
Neg Pred Value       0.953120  0.88531   0.7459   0.7577 0.824382
Prevalence           0.049492  0.12500   0.2963   0.3510 0.178181
Detection Rate       0.002996  0.01504   0.1207   0.2620 0.004159
Detection Prevalence 0.008180  0.04119   0.3091   0.6325 0.009086
Balanced Accuracy    0.527540  0.54521   0.5699   0.5877 0.508672</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Confusion matrix for both indicators</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="fu">confusionMatrix</span>(predictions_olm_both_gen, actual_gen_olm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Confusion Matrix and Statistics

          Reference
Prediction     1     2     3     4     5
         1   251   228    98    28     9
         2   698  1089   828   236    68
         3  1211  3582  6898  4285  1135
         4   339  1414  7017 12406  6639
         5    12    29   191   855  1189

Overall Statistics
                                         
               Accuracy : 0.4303         
                 95% CI : (0.426, 0.4347)
    No Information Rate : 0.351          
    P-Value [Acc &gt; NIR] : &lt; 2.2e-16      
                                         
                  Kappa : 0.1766         
                                         
 Mcnemar's Test P-Value : &lt; 2.2e-16      

Statistics by Class:

                     Class: 1 Class: 2 Class: 3 Class: 4 Class: 5
Sensitivity          0.099960  0.17171   0.4589   0.6966  0.13153
Specificity          0.992473  0.95878   0.7139   0.5320  0.97393
Pos Pred Value       0.408795  0.37307   0.4031   0.4460  0.52241
Neg Pred Value       0.954909  0.89014   0.7581   0.7642  0.83799
Prevalence           0.049492  0.12500   0.2963   0.3510  0.17818
Detection Rate       0.004947  0.02146   0.1360   0.2445  0.02344
Detection Prevalence 0.012102  0.05753   0.3373   0.5482  0.04486
Balanced Accuracy    0.546216  0.56524   0.5864   0.6143  0.55273</code></pre>
</div>
</div>
</section>
</section>
<section id="section-6-model-comparison-part-2-general-health" class="level3">
<h3 class="anchored" data-anchor-id="section-6-model-comparison-part-2-general-health">Section 6: Model Comparison Part 2 (General Health)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>model_names <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Demographic Variables"</span>, <span class="st">"Health Variables"</span>, <span class="st">"Both Dem. &amp; Hlth"</span>)</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>AIC_values_olm_gen <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">AIC</span>(gen_olm_dem), <span class="fu">AIC</span>(gen_olm_hth), <span class="fu">AIC</span>(gen_olm_both))</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Plotting AIC values</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(AIC_values_olm_gen, <span class="at">names.arg =</span> model_names, <span class="at">ylab =</span> <span class="st">"AIC"</span>, <span class="at">main =</span> <span class="st">"Ordinal Logistic Regression Model: AIC Comparison (General Health)"</span>, <span class="at">col =</span> <span class="fu">c</span>(<span class="st">"darkgreen"</span>, <span class="st">"green"</span>, <span class="st">"lightgreen"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="DACSS603_FNL_Diabetes_Project_OwenTibby_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="section-7-summary-of-findings" class="level3">
<h3 class="anchored" data-anchor-id="section-7-summary-of-findings"><strong>Section 7: Summary of Findings</strong></h3>
<p>Diabetes</p>
<ul>
<li><p>Contrary to the primary hypothesis, demographic variables alone demonstrate very limited effectiveness in predicting diabetes. In contrast, health indicators exhibit superior predictive capability for diabetes. When combining demographic variables with health indicators, there are only slight improvements in model accuracy and sensitivity compared to models fitted solely with health variables.</p></li>
<li><p>Comparing the predictive performance of different models for diabetes and general health, the ordinal logistic regression model outperformed the random forest and logistic regression models.</p></li>
<li><p>Logistic regression models (Fig.5) exhibited a lower AIC across all groups of variables after recoding the response variable, but sensitivity did not improve.</p></li>
</ul>
<p>General Health</p>
<ul>
<li><p>Demographic variables were more effective at predicting general health than classifying the presence of diabetes.</p></li>
<li><p>In all models, including the random forest model, demographic variables such as age, sex, income, and education provided close predictions of general health for individuals. It is worth noting that the random forest model was less likely to classify respondents as having excellent health, typically predicting on a scale of 1-4</p></li>
<li><p>This behavior may be attributed to the mismatch in sample size between the classes and the random forest model needing to sample across a wide number of trees to determine the most likely outcome. As a result, the predictions leaned towards good health but not excellent health, which aligns with the tendency of respondents to report higher general health ratings for themselves.</p></li>
</ul>
</section>
<section id="section-8-conclusion" class="level3">
<h3 class="anchored" data-anchor-id="section-8-conclusion"><strong>Section 8: Conclusion</strong></h3>
<p>Fitting additional variables has minimal impact on accuracy and the true-positive rate. Health indicators alone are sufficient for predicting diabetes, as demographic variables, whether considered individually or in combination with health indicators, do not contribute significantly to predictive power.</p>
<p>While health indicators alone may be suitable for diabetes prediction (despite a relatively low 15% sensitivity rate), it is important to acknowledge that the data relies on self-reports, which may introduce response bias or rating inflation.</p>
<p>The findings did not substantially support the secondary hypothesis. For predicting general health, regression with a continuous outcome variable and metrics like root mean squared error could have provided a better measure of model performance. However, this aspect was beyond the scope of the project.</p>
<p>The correlation matrix reveals a moderate relationship between demographic variables (such as income and age) and certain key health indicators. Although this relationship exists, it is not strong enough for demographic variables to predict (either diabetes or general health) well in the absence of health factors.</p>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/603_Spring_2023" data-repo-id="R_kgDOI4oXIA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script>
</div> <!-- /content -->



</body></html>