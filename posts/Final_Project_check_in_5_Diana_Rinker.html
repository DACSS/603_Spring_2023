<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Diana Rinker">
<meta name="dcterms.date" content="2023-05-09">
<meta name="description" content="Final project DACSS 603">

<title>Final Project checkin 5</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>


<meta name="twitter:title" content="Final Project checkin 5">
<meta name="twitter:description" content="Final project DACSS 603">
<meta name="twitter:image" content="https://dacss.github.io/603_Spring_2023/posts/Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-4-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="true"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target="">
 <span class="menu-text">Spring 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dacss-603-spring-2023" id="toc-dacss-603-spring-2023" class="nav-link active" data-scroll-target="#dacss-603-spring-2023">DACSS 603, spring 2023</a></li>
  <li><a href="#final-project-check-in-5-diana-rinker." id="toc-final-project-check-in-5-diana-rinker." class="nav-link" data-scroll-target="#final-project-check-in-5-diana-rinker.">Final Project check-in 5, Diana Rinker.</a></li>
  <li><a href="#introduction.-online-engagement" id="toc-introduction.-online-engagement" class="nav-link" data-scroll-target="#introduction.-online-engagement">Introduction. Online engagement</a></li>
  <li><a href="#research-question-and-hypothesis." id="toc-research-question-and-hypothesis." class="nav-link" data-scroll-target="#research-question-and-hypothesis.">Research Question and hypothesis.</a>
  <ul class="collapse">
  <li><a href="#data-source-and-description." id="toc-data-source-and-description." class="nav-link" data-scroll-target="#data-source-and-description.">Data source and description.</a></li>
  </ul></li>
  <li><a href="#dv-engagement." id="toc-dv-engagement." class="nav-link" data-scroll-target="#dv-engagement.">1.DV: engagement.</a>
  <ul class="collapse">
  <li><a href="#exit-rate" id="toc-exit-rate" class="nav-link" data-scroll-target="#exit-rate">Exit rate</a></li>
  <li><a href="#number-of-comments" id="toc-number-of-comments" class="nav-link" data-scroll-target="#number-of-comments">Number of comments:</a></li>
  </ul></li>
  <li><a href="#iv.-independent-variables" id="toc-iv.-independent-variables" class="nav-link" data-scroll-target="#iv.-independent-variables">2.IV. Independent variables:</a>
  <ul class="collapse">
  <li><a href="#popularity" id="toc-popularity" class="nav-link" data-scroll-target="#popularity">2.1.Popularity</a></li>
  <li><a href="#referral-sources." id="toc-referral-sources." class="nav-link" data-scroll-target="#referral-sources.">2.2. Referral sources.</a></li>
  <li><a href="#post-weekdays" id="toc-post-weekdays" class="nav-link" data-scroll-target="#post-weekdays">2.3. Post weekdays</a></li>
  <li><a href="#authors-comments" id="toc-authors-comments" class="nav-link" data-scroll-target="#authors-comments">2.4. Authors comments</a></li>
  <li><a href="#mood-of-the-post." id="toc-mood-of-the-post." class="nav-link" data-scroll-target="#mood-of-the-post.">2.5. Mood of the post.</a></li>
  <li><a href="#blocked-comments-per-post." id="toc-blocked-comments-per-post." class="nav-link" data-scroll-target="#blocked-comments-per-post.">2.6. Blocked comments per post.</a></li>
  </ul></li>
  <li><a href="#creating-a-model-for-exit-rate---all-users-engagement." id="toc-creating-a-model-for-exit-rate---all-users-engagement." class="nav-link" data-scroll-target="#creating-a-model-for-exit-rate---all-users-engagement.">3. Creating a model for exit rate - all users engagement.</a>
  <ul class="collapse">
  <li><a href="#basic-model." id="toc-basic-model." class="nav-link" data-scroll-target="#basic-model.">3.1 Basic model.</a></li>
  <li><a href="#diagnostic-of-linear-models" id="toc-diagnostic-of-linear-models" class="nav-link" data-scroll-target="#diagnostic-of-linear-models">3.2. Diagnostic of linear models:</a></li>
  <li><a href="#improved-model." id="toc-improved-model." class="nav-link" data-scroll-target="#improved-model.">3.3. Improved model.</a></li>
  </ul></li>
  <li><a href="#model-for-n.comments---loyal-readers-engagement" id="toc-model-for-n.comments---loyal-readers-engagement" class="nav-link" data-scroll-target="#model-for-n.comments---loyal-readers-engagement">4. Model for N.comments - loyal readers engagement:</a>
  <ul class="collapse">
  <li><a href="#basic-model-for-n.comments" id="toc-basic-model-for-n.comments" class="nav-link" data-scroll-target="#basic-model-for-n.comments">4.1. Basic model for n.comments</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">4.2. Diagnostics:</a>
  <ul class="collapse">
  <li><a href="#question---do-i-need-to-improve-mod-fit-here" id="toc-question---do-i-need-to-improve-mod-fit-here" class="nav-link" data-scroll-target="#question---do-i-need-to-improve-mod-fit-here">4.3. QUESTION - do i need to improve mod fit here ?</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#conlusion" id="toc-conlusion" class="nav-link" data-scroll-target="#conlusion">4. Conlusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project checkin 5</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>

<div>
  <div class="description">
    Final project DACSS 603
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Diana Rinker </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 9, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="dacss-603-spring-2023" class="level2">
<h2 class="anchored" data-anchor-id="dacss-603-spring-2023">DACSS 603, spring 2023</h2>
</section>
<section id="final-project-check-in-5-diana-rinker." class="level2">
<h2 class="anchored" data-anchor-id="final-project-check-in-5-diana-rinker.">Final Project check-in 5, Diana Rinker.</h2>
</section>
<section id="introduction.-online-engagement" class="level1">
<h1>Introduction. Online engagement</h1>
<p>It is well known that online engagement with the web resource is a highly valuable metric and is contributing to the site revenue. This research project is exploring which factors contribute to users online engagement. To do that I will use the data of an online blog on the news website. The author of this blog is posting articles about interpersonal relationships every work day (Mon- Fri). The posts are formulated as a letter from a reader with the situation and a question about relationships. The author gives an advice about the situation. Website readers are free to comment under each post, but cannot make their own posts.</p>
<p>All post methadata and comments are public. They are saved by the website and available for the analysis. Using this data set, I will explore how readers’ engagement connected with blogs’s author engagement, site comments’, web source of readers and negative behaviors online.</p>
</section>
<section id="research-question-and-hypothesis." class="level1">
<h1>Research Question and hypothesis.</h1>
<p><strong>RQ:</strong> Which factors influence user’s engagement in online blog?</p>
<p><strong>DV:</strong> My dependent construct is <strong>“user’s engagement</strong>”, I will measure users’ engagement at the level of individual post, using the following metrics:</p>
<p>1. Exit rate or “bounces”. When the visitor is coming to the page and then leaving, i.e.&nbsp;not opening other pages on this website. this will represent all readers.</p>
<p>2. Number of comments - is engagement metric, representing only loyal readers, who have created an account and signed in.</p>
<p><strong>IV:</strong> My main independent variables are</p>
<ol type="1">
<li>Post popularity. Unique users - number of unique people viewed the post.</li>
<li>Source of the readers - which web page the reader came from. This is represented by 6 different variables, each is continuous type.</li>
<li>Mood of the conversation , derivative continuous variable calculated as the ratio of “likes” to all emotions (sum of thumbs up and thumbs down), with the range 0-1.</li>
<li>Blocked and flagged comments.</li>
<li>Number of author’s comments.</li>
<li>Weekday of the post.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ tibble  3.1.8     ✔ purrr   1.0.1
✔ tidyr   1.3.0     ✔ stringr 1.5.0
✔ readr   2.1.4     ✔ forcats 1.0.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()

Attaching package: 'gridExtra'


The following object is masked from 'package:dplyr':

    combine



Please cite as: 


 Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.

 R package version 5.2.3. https://CRAN.R-project.org/package=stargazer </code></pre>
</div>
</div>
<section id="data-source-and-description." class="level3">
<h3 class="anchored" data-anchor-id="data-source-and-description.">Data source and description.</h3>
<p>To answer my research question I will use two datasets. The first data set has information about all comments associated with each post by post ID. The second data set is analytics data for the web page. It contains one post per row and variables describe each post as a whole without breaking down to the comment level.</p>
<p>In this project I will analyze posts for January 2022 - March 2023. Here is the list of variables in each data set:</p>
<p>Comments data:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/Diana/OneDrive - University Of Massachusetts Medical School/Documents/R/R working directory/DACSS/603/603_Spring_2023/posts"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, I will load the data set with the comment level data:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>raw <span class="ot">&lt;-</span> <span class="fu">as_tibble</span> (<span class="fu">read_csv</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Diana</span><span class="sc">\\</span><span class="st">OneDrive - University Of Massachusetts Medical School</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">R working directory</span><span class="sc">\\</span><span class="st">DACSS</span><span class="sc">\\</span><span class="st">603</span><span class="sc">\\</span><span class="st">my study files for dacss603</span><span class="sc">\\</span><span class="st">globe</span><span class="sc">\\</span><span class="st"> data.2021.plus.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 105136 Columns: 17
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (6): content, user_name, display_name, image_url, email, approved
dbl  (7): message_id, post_id, user_id, parent, absolute_likes, absolute_dis...
lgl  (3): email_verified, created_at, private_profile
dttm (1): written_at

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>comments.data<span class="ot">&lt;-</span>raw </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span> (comments.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "content"           "message_id"        "post_id"          
 [4] "user_id"           "user_name"         "display_name"     
 [7] "image_url"         "email"             "email_verified"   
[10] "created_at"        "private_profile"   "approved"         
[13] "written_at"        "parent"            "absolute_likes"   
[16] "absolute_dislikes" "comment.year"     </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(comments.data<span class="sc">$</span>written_at)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021-01-01 08:28:44 UTC" "2021-01-01 08:57:08 UTC"
[3] "2021-01-01 10:36:58 UTC" "2021-01-01 11:13:13 UTC"
[5] "2021-01-01 12:27:44 UTC" "2021-01-01 12:51:48 UTC"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>comments.data <span class="ot">&lt;-</span>comments.data<span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">com.year =</span> <span class="fu">format</span>(written_at,<span class="at">format =</span> <span class="st">"%Y"</span> ))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># range(comments.data$com.year)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(comments.data)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(comments.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [105,136 × 18] (S3: tbl_df/tbl/data.frame)
 $ content          : chr [1:105136] "08:15  Dawn of the 21st year of the 21st century&lt;br/&gt;&amp;quot;21st Century Schizoid Man&amp;quot;  on the BOSE" "Liz:  😄" "Happy New Year to all y'all. And Ms. G, thank you for letting me play for another year playing in your sandbox." "Blog needs a new name - Hate Letters" ...
 $ message_id       : num [1:105136] 1.15e+08 1.15e+08 1.15e+08 1.15e+08 1.15e+08 ...
 $ post_id          : num [1:105136] 27071015 27071015 27071009 27071009 27071009 ...
 $ user_id          : num [1:105136] 2889100 1855822 5133556 5156343 5560421 ...
 $ user_name        : chr [1:105136] "Lefty49" "JacquiSmith" "Bzznlike-crazyman" "--SnowMan--" ...
 $ display_name     : chr [1:105136] "Lefty49" "JacquiSmith" "Bzznlike-crazyman" "--SnowMan--" ...
 $ image_url        : chr [1:105136] "https://u.o0bc.com/avatars/48/121/77/5077296.png?35" "https://u.o0bc.com/avatars/41/194/84/5554729.png?47" "https://u.o0bc.com/avatars/85/175/84/5549909.png?9" "https://u.o0bc.com/avatars/64/191/84/5553984.png?5" ...
 $ email            : chr [1:105136] "danwalker1949@aol.com" "amcr1124@comcast.net" "eflynn105@yahoo.com" "markedoc@yahoo.com" ...
 $ email_verified   : logi [1:105136] FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ created_at       : logi [1:105136] NA NA NA NA NA NA ...
 $ private_profile  : logi [1:105136] FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ approved         : chr [1:105136] "approved" "approved" "approved" "approved" ...
 $ written_at       : POSIXct[1:105136], format: "2021-01-01 08:28:44" "2021-01-01 08:57:08" ...
 $ parent           : num [1:105136] NA 1.15e+08 NA NA 1.15e+08 ...
 $ absolute_likes   : num [1:105136] 2 0 14 7 7 7 4 3 2 4 ...
 $ absolute_dislikes: num [1:105136] 1 0 1 0 1 1 1 1 1 0 ...
 $ comment.year     : num [1:105136] 2021 2021 2021 2021 2021 ...
 $ com.year         : chr [1:105136] "2021" "2021" "2021" "2021" ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(comments.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 105136     18</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>comments.data <span class="ot">&lt;-</span> comments.data<span class="sc">%&gt;%</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(written_at  <span class="sc">&gt;=</span> <span class="st">"2022-01-01"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Post data:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Second, loadng post-level data :</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">as_tibble</span> (<span class="fu">read_csv</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Diana</span><span class="sc">\\</span><span class="st">OneDrive - University Of Massachusetts Medical School</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">R working directory</span><span class="sc">\\</span><span class="st">DACSS</span><span class="sc">\\</span><span class="st">603</span><span class="sc">\\</span><span class="st">my study files for dacss603</span><span class="sc">\\</span><span class="st">globe</span><span class="sc">\\</span><span class="st">data.merged.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 535 Columns: 23
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr   (3): Letter, Exit rate, post.month
dbl  (18): Page views, Search + amp referral visits, Direct (non-email) refe...
num   (1): Visits when post was on LL HP
date  (1): post.date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [535 × 23] (S3: tbl_df/tbl/data.frame)
 $ post.date                         : Date[1:535], format: "2021-01-04" "2021-01-05" ...
 $ Letter                            : chr [1:535] "love letters | blog | I don&amp;'t want him to let me go" "love letters | blog | Should I be working to get her back?" "love letters | blog | I&amp;'m sick of thinking about the breakup" "love letters | blog | I don&amp;'t want to be selfish about 2020 Christmas" ...
 $ Page views                        : num [1:535] 14830 12067 11921 12817 12866 ...
 $ Search + amp referral visits      : num [1:535] 1005 822 793 765 934 ...
 $ Direct (non-email) referral visits: num [1:535] 10005 7948 7997 8746 8400 ...
 $ Visits                            : num [1:535] 12998 10391 10331 11040 10818 ...
 $ Uniques                           : num [1:535] 11453 8985 8917 9662 8564 ...
 $ Other website referral visits     : num [1:535] 129 232 106 152 139 153 165 157 85 151 ...
 $ Social referral visits            : num [1:535] 457 94 156 106 113 368 90 171 84 129 ...
 $ BDC referral visits               : num [1:535] 7087 5312 5185 5901 4570 ...
 $ Visits when post was on LL HP     : num [1:535] 3167 3323 2929 3056 4795 ...
 $ Exits                             : num [1:535] 9679 7549 7613 8188 7900 ...
 $ Exit rate                         : chr [1:535] "74%" "73%" "74%" "74%" ...
 $ dup                               : num [1:535] 0 0 0 0 0 0 0 0 0 0 ...
 $ post_id                           : num [1:535] 27071003 27070997 27070991 27070985 27070979 ...
 $ n.comments                        : num [1:535] 267 207 266 372 319 267 337 154 179 375 ...
 $ post.year                         : num [1:535] 2021 2021 2021 2021 2021 ...
 $ post.month                        : chr [1:535] "01" "01" "01" "01" ...
 $ post.likes                        : num [1:535] 1440 864 936 1497 1145 ...
 $ post.dislikes                     : num [1:535] 72 106 96 520 154 188 150 62 106 150 ...
 $ post.total.likes                  : num [1:535] 1512 970 1032 2017 1299 ...
 $ blocked.sum                       : num [1:535] 1 2 3 9 2 3 4 0 3 3 ...
 $ pct.positive                      : num [1:535] 95.2 89.1 90.7 74.2 88.1 ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 535  23</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Limiting the dataset to 2022: </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged<span class="sc">%&gt;%</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(post.date  <span class="sc">&gt;=</span>  <span class="st">"2022-01-01"</span>)</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 287  23</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Due to dataset of comments having more data than post dataset,  I will cut them to match: </span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (<span class="sc">!</span><span class="fu">is.na</span>(merged<span class="sc">$</span>pct.positive))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To begin, I will review available variables and evaluate to idntify a metric for each construct in my study.</p>
</section>
</section>
<section id="dv-engagement." class="level1">
<h1>1.DV: engagement.</h1>
<section id="exit-rate" class="level2">
<h2 class="anchored" data-anchor-id="exit-rate">Exit rate</h2>
<p>This variable is measuring how many people visited the page and then left the website after the first view. This metric is the best measure of engagement for all users, as it represents the first step after being exposed to the post - either quitting the site or remaining on the site.</p>
<p>Here can see the distribution of this variable :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(merged)</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">e.rate =</span> Exits<span class="sc">/</span><span class="st">`</span><span class="at">Page views</span><span class="st">`</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span> (merged, <span class="st">`</span><span class="at">Exit rate</span><span class="st">`</span>, e.rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 287 × 2
   `Exit rate` e.rate
   &lt;chr&gt;        &lt;dbl&gt;
 1 76%          0.675
 2 79%          0.703
 3 86%          0.791
 4 68%          0.600
 5 75%          0.665
 6 76%          0.678
 7 83%          0.751
 8 88%          0.804
 9 91%          0.836
10 72%          0.620
# … with 277 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merged$`Exit rate` &lt;- as.numeric(sub("%", "", merged$`Exit rate`)) / 100</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>e.rate))<span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.02</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">fill =</span> <span class="st">"sandybrown"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Distribution of exit rate over time:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating  year_month  variable </span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>post.month <span class="ot">&lt;-</span><span class="fu">as.numeric</span>(merged<span class="sc">$</span>post.month)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>year_month <span class="ot">&lt;-</span> <span class="fu">paste0</span>(merged<span class="sc">$</span>post.year, <span class="st">"-"</span>, <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, merged<span class="sc">$</span>post.month))</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span><span class="st">`</span><span class="at">e.rate</span><span class="st">`</span>, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of `Exit rate` per post "</span>, <span class="at">y =</span> <span class="st">"Exit rate"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="number-of-comments" class="level2">
<h2 class="anchored" data-anchor-id="number-of-comments">Number of comments:</h2>
<p>engagement metric for loyal readers.</p>
<p>Commenting requires user to log in, which is an indicator of greater engagement of an individual user. Therefore this variable represents engagement of a subset of users,loyal readers, who have created an account.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merged$year_month </span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>n.comments))<span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"seagreen4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And change in the distribution over time:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>n.comments, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of comments per post "</span>, <span class="at">y =</span> <span class="st">"Number of comments"</span> )<span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span> (<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span> <span class="dv">10000</span>, <span class="at">by=</span> <span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="iv.-independent-variables" class="level1">
<h1>2.IV. Independent variables:</h1>
<section id="popularity" class="level3">
<h3 class="anchored" data-anchor-id="popularity">2.1.Popularity</h3>
<p>“Uniques” variable represents number of unique people who came to the page and viewed it at least once, his metric represents popularity of the post. It’s distribution shows us that not all posts are equally popular:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Uniques))<span class="sc">+</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"purple2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see a long tail on the right, showing that there is a number of posts who are way more popular than the majority of the sample.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>Uniques, <span class="at">x=</span>merged<span class="sc">$</span>year_month))<span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of unique viewers per month"</span>, <span class="at">x=</span><span class="st">"Month"</span>, <span class="at">y=</span><span class="st">"Number of unique viewers"</span>)<span class="sc">+</span> </span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `merged$year_month` is discouraged.
ℹ Use `year_month` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Next plot will illustrate connection between popularity and engagement metrics:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (merged, <span class="at">select=</span><span class="fu">c</span>(Uniques, e.rate, n.comments )))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that popularity strongly correlated with exit rate,where an increase in popularity causes decrease of engagement.It is not as strongly correlated with number of comments. Engagement rate and number of comments dont show obvious pattern between each other.</p>
</section>
<section id="referral-sources." class="level3">
<h3 class="anchored" data-anchor-id="referral-sources.">2.2. Referral sources.</h3>
<p>The website analytics provides information on where the viewers are coming from to the blog page. For example, if people clicked on the blog link posted on FaceBook, that would be referral from social media. If people clicked on the blog link within BDC website, that would be “BDC referral visit”.</p>
<p>There are 5 sources of referrals, each corresponding with a variable in the data set. Variable’s value is a number of visits from this referral source.</p>
<pre><code>"Search + amp referral visits"
"Direct (non-email) referral visits"
"Other website referral visits"
"Social referral visits"
"BDC referral visits"
"Visits when post was on LL HP" </code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co">#renaming variables for convenience: </span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>merged<span class="ot">&lt;-</span>merged<span class="sc">%&gt;%</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">google =</span><span class="st">"Search + amp referral visits"</span>,</span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">direct =</span><span class="st">"Direct (non-email) referral visits"</span>,</span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">other.web =</span> <span class="st">"Other website referral visits"</span>,</span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">social=</span> <span class="st">"Social referral visits"</span>,</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">bdc=</span> <span class="st">"BDC referral visits"</span>,</span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ll=</span> <span class="st">"Visits when post was on LL HP"</span> )</span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>post.date))<span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>google), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb40-12"><a href="#cb40-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>direct), <span class="at">color=</span><span class="st">"green"</span>)<span class="sc">+</span></span>
<span id="cb40-13"><a href="#cb40-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>other.web), <span class="at">color=</span><span class="st">"yellow"</span>)<span class="sc">+</span></span>
<span id="cb40-14"><a href="#cb40-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>social), <span class="at">color=</span><span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb40-15"><a href="#cb40-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>bdc), <span class="at">color=</span><span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb40-16"><a href="#cb40-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>ll), <span class="at">color=</span><span class="st">"pink"</span>)  <span class="sc">+</span></span>
<span id="cb40-17"><a href="#cb40-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Referral sources per post "</span>, <span class="at">y =</span> <span class="st">"Number of referrals"</span> , <span class="at">x=</span><span class="st">"Post"</span>)<span class="sc">+</span> </span>
<span id="cb40-18"><a href="#cb40-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"purple"</span>, <span class="st">"blue"</span>, <span class="st">"pink"</span>),</span>
<span id="cb40-19"><a href="#cb40-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Google"</span>, <span class="st">"Direct"</span>, <span class="st">"Other Web"</span>, <span class="st">"Social"</span>, <span class="st">"Bdc"</span>, <span class="st">"LL"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph is showing of “Search + amp referral visits” have high variability. Other referral sources range is much smaller.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(comments.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "content"           "message_id"        "post_id"          
 [4] "user_id"           "user_name"         "display_name"     
 [7] "image_url"         "email"             "email_verified"   
[10] "created_at"        "private_profile"   "approved"         
[13] "written_at"        "parent"            "absolute_likes"   
[16] "absolute_dislikes" "comment.year"      "com.year"         </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating date of the post and weekday  from comments data </span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'lubridate'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>post.date <span class="ot">&lt;-</span>comments.data <span class="sc">%&gt;%</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(post_id)<span class="sc">%&gt;%</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(written_at)<span class="sc">%&gt;%</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">post.dt =</span> <span class="fu">first</span>(written_at))</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>post.date  <span class="ot">&lt;-</span>post.date <span class="sc">%&gt;%</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">weekday =</span> <span class="fu">wday</span>(post.dt, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">n.coms =</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (n.coms<span class="sc">&gt;</span><span class="dv">100</span>)<span class="sc">%&gt;%</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(post_id,post.dt,  weekday )</span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a> <span class="co"># Adding weekdays to both data sets: comments level and post level:</span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a>comments.data <span class="ot">&lt;-</span> <span class="fu">merge</span>(comments.data, post.date , <span class="at">by =</span> <span class="st">"post_id"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">merge</span>( merged, post.date , <span class="at">by =</span> <span class="st">"post_id"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="post-weekdays" class="level3">
<h3 class="anchored" data-anchor-id="post-weekdays">2.3. Post weekdays</h3>
<p>The posts are being published Monday through Friday (with rare exceptions). No posts are published on the weekend. Below is a plot for exit rate and number of comments’ distributions per week day</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>weekday, <span class="at">y=</span>e.rate) )<span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per weekday"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>weekday, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per weekday"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing non-finite values (`stat_boxplot()`).
Removed 144 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that exit rate is overall lower on Tuesday, and number of comments overall highest on Fridays.</p>
</section>
<section id="authors-comments" class="level3">
<h3 class="anchored" data-anchor-id="authors-comments">2.4. Authors comments</h3>
<p>To identify, how much the author of the blog is engaged in the post, I will create an additional variable derived from a user_name field and review the distribution of autor’s comments :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(merged)</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>comments.data<span class="sc">$</span>user_name<span class="ot">&lt;-</span>  <span class="fu">ifelse</span> (<span class="fu">is.na</span>(comments.data<span class="sc">$</span>user_name), <span class="dv">0</span>, comments.data<span class="sc">$</span>user_name)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>comments.data<span class="sc">$</span>author<span class="ot">&lt;-</span>  <span class="fu">ifelse</span> (comments.data<span class="sc">$</span>user_name<span class="sc">==</span><span class="st">"MeredithGoldstein"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.data <span class="sc">%&gt;%</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(post_id)<span class="sc">%&gt;%</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n.comments=</span><span class="fu">n</span>(),</span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">author.sum =</span> <span class="fu">sum</span>(author))</span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments data contains rows that dont actually reporesent posts, and were crearted by web support team for troubleshooting. I need to remove these rows. They typically have very low number of comments</span></span>
<span id="cb52-11"><a href="#cb52-11" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.grouped <span class="sc">%&gt;%</span></span>
<span id="cb52-12"><a href="#cb52-12" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(n.comments <span class="sc">&gt;</span><span class="dv">100</span>)  <span class="co"># removing invalid posts created by the  website management team.</span></span>
<span id="cb52-13"><a href="#cb52-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-14"><a href="#cb52-14" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.grouped <span class="sc">%&gt;%</span></span>
<span id="cb52-15"><a href="#cb52-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(post_id, author.sum)</span>
<span id="cb52-16"><a href="#cb52-16" aria-hidden="true" tabindex="-1"></a> <span class="fu">dim</span>(comments.grouped)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 287   2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="co">#adding author.sum to main data set: </span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">merge</span>( merged , comments.grouped, <span class="at">by =</span> <span class="st">"post_id"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum) )<span class="sc">+</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Authors comments distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Authors comments per engagement metrics:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per author.sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per author.sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph shows, that majority of posts have no author’s comments.</p>
</section>
<section id="mood-of-the-post." class="level3">
<h3 class="anchored" data-anchor-id="mood-of-the-post.">2.5. Mood of the post.</h3>
<p>This is a numerical variable, calculated as percentage of “thumbs up” from all likes (both “thumbs up” and “thumbs down”).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive) )<span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"springgreen3"</span>)<span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Mood of the post (pct.positive) distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plotting mood pf the post against engagement metyrics:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per pct.positive"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per pct.positive"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Distribution of mood over time:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>pct.positive, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of Mood per post "</span>, <span class="at">y =</span> <span class="st">"Mood"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="blocked-comments-per-post." class="level3">
<h3 class="anchored" data-anchor-id="blocked-comments-per-post.">2.6. Blocked comments per post.</h3>
<p>Now I will visualize amount of blocked comments per post: Distribution of blocked comments:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum) )<span class="sc">+</span></span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"brown"</span>)<span class="sc">+</span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"blocked.sum distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing non-finite values (`stat_bin()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plotting blocked comments against engagement metrics:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per blocked.sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per blocked.sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing missing values (`geom_point()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Distribution of blocked comments over time:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>blocked.sum, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number Blocked comments  per post "</span>, <span class="at">y =</span> <span class="st">"Number of blocked comments per post"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Removed 144 rows containing non-finite values (`stat_boxplot()`).</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="creating-a-model-for-exit-rate---all-users-engagement." class="level1">
<h1>3. Creating a model for exit rate - all users engagement.</h1>
<section id="basic-model." class="level3">
<h3 class="anchored" data-anchor-id="basic-model.">3.1 Basic model.</h3>
<p>I will start with entering all of the independent variable in the model and then eliminating ones that are not significant.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> author.sum <span class="sc">+</span>n.comments <span class="sc">+</span>google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>,model<span class="fl">.2</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=======================================================================
                                    Dependent variable:                
                    ---------------------------------------------------
                                          e.rate                       
                               (1)                       (2)           
-----------------------------------------------------------------------
log(Uniques)                0.189***                  0.191***         
                             (0.009)                   (0.009)         
                                                                       
author.sum                   -0.002                                    
                             (0.002)                                   
                                                                       
n.comments                  -0.00002                                   
                            (0.00003)                                  
                                                                       
google                     -0.00000***               -0.00000***       
                            (0.00000)                 (0.00000)        
                                                                       
direct                     -0.00003***               -0.00002***       
                            (0.00000)                 (0.00000)        
                                                                       
other.web                  -0.00001***               -0.00001***       
                            (0.00000)                 (0.00000)        
                                                                       
social                     -0.00004**                -0.00004**        
                            (0.00002)                 (0.00002)        
                                                                       
bdc                        0.00002***                0.00002***        
                            (0.00000)                 (0.00000)        
                                                                       
ll                           0.00000                                   
                            (0.00000)                                  
                                                                       
blocked.sum                  -0.0001                                   
                            (0.0002)                                   
                                                                       
pct.positive                -0.00001                                   
                            (0.0002)                                   
                                                                       
weekday.L                    0.006*                    0.007**         
                             (0.003)                   (0.003)         
                                                                       
weekday.Q                   0.012***                  0.014***         
                             (0.003)                   (0.003)         
                                                                       
weekday.C                     0.003                     0.004          
                             (0.003)                   (0.003)         
                                                                       
weekday4                     0.006**                  0.007***         
                             (0.003)                   (0.003)         
                                                                       
Constant                    -1.030***                 -1.047***        
                             (0.086)                   (0.082)         
                                                                       
-----------------------------------------------------------------------
Observations                   287                       287           
R2                            0.918                     0.917          
Adjusted R2                   0.914                     0.914          
Residual Std. Error     0.020 (df = 271)          0.020 (df = 276)     
F Statistic         203.411*** (df = 15; 271) 306.564*** (df = 10; 276)
=======================================================================
Note:                                       *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Elimination of non-significant factors slightly impacted coefficients of significant variables, and did not change R^2 or adjusted R^2 much.</p>
<p>My next step is to diagnoze this model:</p>
</section>
<section id="diagnostic-of-linear-models" class="level3">
<h3 class="anchored" data-anchor-id="diagnostic-of-linear-models">3.2. Diagnostic of linear models:</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.2</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-24-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see the issue with distribution of residuals in “Residuals vs fitted” plot. This suggests non-linear relationship between variables. I will transform some of my variables to see if that gives me a better model:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co">#original model</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Logging Google referrals</span></span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a><span class="co"># squaring google referrals</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">I</span>(google<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>, model<span class="fl">.2</span>, model<span class="fl">.3</span>,<span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
==================================================================
                                       Dependent variable:        
                               -----------------------------------
                                             e.rate               
                                   (1)         (2)         (3)    
------------------------------------------------------------------
log(Uniques)                    0.191***    0.106***    0.159***  
                                 (0.009)     (0.012)     (0.004)  
                                                                  
google                         -0.00000***                        
                                (0.00000)                         
                                                                  
log(google)                                 0.016***              
                                             (0.004)              
                                                                  
I(google2)                                              -0.000*** 
                                                         (0.000)  
                                                                  
direct                         -0.00002*** -0.00003*** -0.00002***
                                (0.00000)   (0.00000)   (0.00000) 
                                                                  
other.web                      -0.00001*** -0.00001*** -0.00001***
                                (0.00000)   (0.00000)   (0.00000) 
                                                                  
social                         -0.00004**  -0.00003**  -0.00004** 
                                (0.00002)   (0.00002)   (0.00002) 
                                                                  
bdc                            0.00002***  0.00003***  0.00002*** 
                                (0.00000)   (0.00000)   (0.00000) 
                                                                  
weekday.L                        0.007**     0.008**     0.007**  
                                 (0.003)     (0.003)     (0.003)  
                                                                  
weekday.Q                       0.014***    0.016***    0.015***  
                                 (0.003)     (0.003)     (0.003)  
                                                                  
weekday.C                         0.004      0.005*       0.004   
                                 (0.003)     (0.003)     (0.003)  
                                                                  
weekday4                        0.007***    0.008***    0.007***  
                                 (0.003)     (0.003)     (0.003)  
                                                                  
Constant                        -1.047***   -0.384***   -0.752*** 
                                 (0.082)     (0.073)     (0.040)  
                                                                  
------------------------------------------------------------------
Observations                       287         287         287    
R2                                0.917       0.913       0.915   
Adjusted R2                       0.914       0.910       0.911   
Residual Std. Error (df = 276)    0.020       0.020       0.020   
F Statistic (df = 10; 276)     306.564***  291.392***  295.313*** 
==================================================================
Note:                                  *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>This table showing that google referrals are significant in either form - squared or logged. However, its coefficient is much higher when logged. Uniques variables’s coefficient also changes significantly as I am modifying google variable. That migh indicate interaction between them.</p>
<p>Comparing diagnostic plots for model 2 (google logged) and 3 (google squared):</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.2</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>These two plots show ineven distribution of residuals around zero line. To address it, I will transform the variables further.</p>
<p>First , I will log the rest of referral variables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#original model</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># all source variables are logged: </span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span><span class="fu">log</span>(other.web) <span class="sc">+</span><span class="fu">log</span>(social) <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>,model<span class="fl">.3</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================
                                   Dependent variable:     
                               ----------------------------
                                          e.rate           
                                    (1)            (2)     
-----------------------------------------------------------
log(Uniques)                      0.191***      0.096***   
                                  (0.009)        (0.013)   
                                                           
google                          -0.00000***                
                                 (0.00000)                 
                                                           
direct                          -0.00002***                
                                 (0.00000)                 
                                                           
other.web                       -0.00001***                
                                 (0.00000)                 
                                                           
social                           -0.00004**                
                                 (0.00002)                 
                                                           
bdc                              0.00002***                
                                 (0.00000)                 
                                                           
log(google)                                     0.019***   
                                                 (0.005)   
                                                           
log(direct)                                     -0.298***  
                                                 (0.029)   
                                                           
log(other.web)                                   -0.001    
                                                 (0.002)   
                                                           
log(social)                                      -0.005    
                                                 (0.003)   
                                                           
log(bdc)                                        0.218***   
                                                 (0.018)   
                                                           
weekday.L                         0.007**       0.009***   
                                  (0.003)        (0.003)   
                                                           
weekday.Q                         0.014***      0.018***   
                                  (0.003)        (0.003)   
                                                           
weekday.C                          0.004         0.006**   
                                  (0.003)        (0.003)   
                                                           
weekday4                          0.007***      0.009***   
                                  (0.003)        (0.003)   
                                                           
Constant                         -1.047***      0.453***   
                                  (0.082)        (0.094)   
                                                           
-----------------------------------------------------------
Observations                        287            287     
R2                                 0.917          0.901    
Adjusted R2                        0.914          0.898    
Residual Std. Error (df = 276)     0.020          0.021    
F Statistic (df = 10; 276)       306.564***    252.106***  
===========================================================
Note:                           *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>All referral sources except “other.web” and “social” show better fit when logged. Moving forward I will use these variables not logeed.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.1</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We still observe curvi-linear distribution of residuals.</p>
<p>Next, I will check if the referral variables have an ineraction with popularity (Uniques)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="co"># last model</span></span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span> other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="co"># adding interaction: </span></span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.3</span>,model<span class="fl">.4</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
============================================================================
                                         Dependent variable:                
                         ---------------------------------------------------
                                               e.rate                       
                                    (1)                       (2)           
----------------------------------------------------------------------------
log(Uniques)                     0.112***                  0.372***         
                                  (0.013)                   (0.042)         
                                                                            
log(google)                      0.014***                  0.200***         
                                  (0.005)                   (0.029)         
                                                                            
log(direct)                      -0.307***                 -0.293***        
                                  (0.027)                   (0.026)         
                                                                            
other.web                       -0.00001***               -0.00001***       
                                 (0.00000)                 (0.00000)        
                                                                            
social                           -0.00003                 -0.00003**        
                                 (0.00002)                 (0.00002)        
                                                                            
log(bdc)                         0.220***                  0.181***         
                                  (0.017)                   (0.017)         
                                                                            
weekday.L                        0.010***                  0.009***         
                                  (0.003)                   (0.003)         
                                                                            
weekday.Q                        0.019***                  0.017***         
                                  (0.003)                   (0.003)         
                                                                            
weekday.C                         0.006**                   0.006**         
                                  (0.003)                   (0.003)         
                                                                            
weekday4                         0.008***                  0.007***         
                                  (0.003)                   (0.003)         
                                                                            
log(Uniques):log(google)                                   -0.021***        
                                                            (0.003)         
                                                                            
Constant                         0.396***                  -1.734***        
                                  (0.093)                   (0.345)         
                                                                            
----------------------------------------------------------------------------
Observations                        287                       287           
R2                                 0.906                     0.918          
Adjusted R2                        0.903                     0.915          
Residual Std. Error          0.021 (df = 276)          0.020 (df = 275)     
F Statistic              266.805*** (df = 10; 276) 281.232*** (df = 11; 275)
============================================================================
Note:                                            *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Adding interaction between popularity and google referrals significcntly improved the model: interaction term has negative correlation with dependent variable, it also made “social” referrals significant, and improved models R^2 and adjusted R^2.</p>
<p>It also significantly changed distribution of residuals: now distribution is equally spread around 0.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Lets review other diagnostic plots:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># last model</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb92-2"><a href="#cb92-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb92-3"><a href="#cb92-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb94-4"><a href="#cb94-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-31-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see from both models, that variable 231 is an outlier that significantly impacts the model. I will remove that observation and re-evaluate the model:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>merged.old <span class="ot">&lt;-</span> merged</span>
<span id="cb96-2"><a href="#cb96-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">231</span>), ]</span>
<span id="cb96-3"><a href="#cb96-3" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged.old)</span>
<span id="cb96-4"><a href="#cb96-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb96-5"><a href="#cb96-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb96-6"><a href="#cb96-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.4</span>,model<span class="fl">.5</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
============================================================================
                                         Dependent variable:                
                         ---------------------------------------------------
                                               e.rate                       
                                    (1)                       (2)           
----------------------------------------------------------------------------
log(Uniques)                     0.372***                  0.369***         
                                  (0.042)                   (0.042)         
                                                                            
log(google)                      0.200***                  0.196***         
                                  (0.029)                   (0.029)         
                                                                            
log(direct)                      -0.293***                 -0.296***        
                                  (0.026)                   (0.026)         
                                                                            
other.web                       -0.00001***               -0.00001***       
                                 (0.00000)                 (0.00000)        
                                                                            
social                          -0.00003**                -0.00003**        
                                 (0.00002)                 (0.00002)        
                                                                            
log(bdc)                         0.181***                  0.182***         
                                  (0.017)                   (0.017)         
                                                                            
weekday.L                        0.009***                  0.009***         
                                  (0.003)                   (0.003)         
                                                                            
weekday.Q                        0.017***                  0.018***         
                                  (0.003)                   (0.003)         
                                                                            
weekday.C                         0.006**                   0.006**         
                                  (0.003)                   (0.003)         
                                                                            
weekday4                         0.007***                  0.007***         
                                  (0.003)                   (0.003)         
                                                                            
log(Uniques):log(google)         -0.021***                 -0.021***        
                                  (0.003)                   (0.003)         
                                                                            
Constant                         -1.734***                 -1.685***        
                                  (0.345)                   (0.344)         
                                                                            
----------------------------------------------------------------------------
Observations                        287                       286           
R2                                 0.918                     0.919          
Adjusted R2                        0.915                     0.916          
Residual Std. Error          0.020 (df = 275)          0.019 (df = 274)     
F Statistic              281.232*** (df = 11; 275) 283.635*** (df = 11; 274)
============================================================================
Note:                                            *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb101-4"><a href="#cb101-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb101-5"><a href="#cb101-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-32-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>New, the variable “other.web” became unsignificant, but model fit improved.</p>
</section>
<section id="improved-model." class="level3">
<h3 class="anchored" data-anchor-id="improved-model.">3.3. Improved model.</h3>
<p>I will check whether other referral sources have an interaction with popularity:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span> <span class="fu">log</span>(direct) <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span>other.web <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span>social <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(bdc)  <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span> <span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-6"><a href="#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.5</span>,model<span class="fl">.6</span>, model<span class="fl">.7</span> , <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
======================================================================================================
                                                      Dependent variable:                             
                         -----------------------------------------------------------------------------
                                                            e.rate                                    
                                    (1)                       (2)                       (3)           
------------------------------------------------------------------------------------------------------
log(Uniques)                     0.369***                   -0.127                     0.023          
                                  (0.042)                   (0.166)                   (0.105)         
                                                                                                      
log(google)                      0.196***                  0.322***                  0.312***         
                                  (0.029)                   (0.051)                   (0.043)         
                                                                                                      
log(direct)                      -0.296***                 -1.174**                  -0.847***        
                                  (0.026)                   (0.476)                   (0.156)         
                                                                                                      
other.web                       -0.00001***                 0.00004                 -0.00001***       
                                 (0.00000)                 (0.00003)                 (0.00000)        
                                                                                                      
social                          -0.00003**                  -0.0004                 -0.00003**        
                                 (0.00002)                 (0.0003)                  (0.00002)        
                                                                                                      
log(bdc)                         0.182***                    0.355                   0.175***         
                                  (0.017)                   (0.342)                   (0.017)         
                                                                                                      
weekday.L                        0.009***                    0.036                   0.009***         
                                  (0.003)                   (0.065)                   (0.003)         
                                                                                                      
weekday.Q                        0.018***                   0.100*                   0.018***         
                                  (0.003)                   (0.059)                   (0.003)         
                                                                                                      
weekday.C                         0.006**                    0.062                    0.007**         
                                  (0.003)                   (0.055)                   (0.003)         
                                                                                                      
weekday4                         0.007***                   0.090*                   0.007***         
                                  (0.003)                   (0.052)                   (0.003)         
                                                                                                      
log(Uniques):log(google)         -0.021***                 -0.035***                 -0.034***        
                                  (0.003)                   (0.006)                   (0.005)         
                                                                                                      
log(Uniques):log(direct)                                    0.086*                   0.053***         
                                                            (0.048)                   (0.015)         
                                                                                                      
log(Uniques):other.web                                     -0.00000                                   
                                                           (0.00000)                                  
                                                                                                      
log(Uniques):social                                         0.00004                                   
                                                           (0.00003)                                  
                                                                                                      
log(Uniques):log(bdc)                                       -0.018                                    
                                                            (0.034)                                   
                                                                                                      
log(Uniques):weekday.L                                      -0.003                                    
                                                            (0.007)                                   
                                                                                                      
log(Uniques):weekday.Q                                      -0.008                                    
                                                            (0.006)                                   
                                                                                                      
log(Uniques):weekday.C                                      -0.006                                    
                                                            (0.006)                                   
                                                                                                      
log(Uniques):weekday4                                       -0.008                                    
                                                            (0.005)                                   
                                                                                                      
Constant                         -1.685***                  3.581**                   2.136*          
                                  (0.344)                   (1.694)                   (1.120)         
                                                                                                      
------------------------------------------------------------------------------------------------------
Observations                        286                       286                       286           
R2                                 0.919                     0.925                     0.923          
Adjusted R2                        0.916                     0.920                     0.919          
Residual Std. Error          0.019 (df = 274)          0.019 (df = 266)          0.019 (df = 273)     
F Statistic              283.635*** (df = 11; 274) 173.644*** (df = 19; 266) 272.255*** (df = 12; 273)
======================================================================================================
Note:                                                                      *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-33-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>All models have similar R^2 and adjusted R^2. However, the last model (model.7) best accounts for all source variables.</p>
<p>Calculation of AIC and BIC:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model<span class="fl">.5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1427.865</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model<span class="fl">.6</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1434.419</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model<span class="fl">.7</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1438.962</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model<span class="fl">.5</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1380.337</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model<span class="fl">.6</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1357.643</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model<span class="fl">.7</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1387.779</code></pre>
</div>
</div>
<p>AIC and BIC are very close to each other in all three models.</p>
<p>To summarize, the model # 7 demonstrated the best fit with high R^2 value and good results in diagnostic plots.</p>
<p>Te resulting model of my analysis is:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.7</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = e.rate ~ log(Uniques) * log(google) + log(Uniques) * 
    log(direct) + other.web + social + log(bdc) + weekday, data = merged)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.058514 -0.011536  0.000688  0.011476  0.044715 

Coefficients:
                           Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)               2.136e+00  1.120e+00   1.907 0.057604 .  
log(Uniques)              2.260e-02  1.052e-01   0.215 0.830113    
log(google)               3.119e-01  4.324e-02   7.213 5.41e-12 ***
log(direct)              -8.466e-01  1.559e-01  -5.430 1.25e-07 ***
other.web                -6.250e-06  1.298e-06  -4.814 2.45e-06 ***
social                   -3.105e-05  1.511e-05  -2.055 0.040819 *  
log(bdc)                  1.751e-01  1.699e-02  10.304  &lt; 2e-16 ***
weekday.L                 9.142e-03  2.960e-03   3.088 0.002220 ** 
weekday.Q                 1.839e-02  2.918e-03   6.303 1.17e-09 ***
weekday.C                 6.568e-03  2.587e-03   2.539 0.011675 *  
weekday^4                 7.360e-03  2.527e-03   2.913 0.003879 ** 
log(Uniques):log(google) -3.399e-02  4.889e-03  -6.952 2.65e-11 ***
log(Uniques):log(direct)  5.331e-02  1.490e-02   3.577 0.000411 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.01906 on 273 degrees of freedom
  (144 observations deleted due to missingness)
Multiple R-squared:  0.9229,    Adjusted R-squared:  0.9195 
F-statistic: 272.3 on 12 and 273 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
</section>
<section id="model-for-n.comments---loyal-readers-engagement" class="level1">
<h1>4. Model for N.comments - loyal readers engagement:</h1>
<section id="basic-model-for-n.comments" class="level2">
<h2 class="anchored" data-anchor-id="basic-model-for-n.comments">4.1. Basic model for n.comments</h2>
<p>Now as I have created a model for exit rate, I will do the same for n.comments as dependent variable, which represents the measurement of engagement of loyal readers.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "post_id"          "post.date"        "Letter"           "Page views"      
 [5] "google"           "direct"           "Visits"           "Uniques"         
 [9] "other.web"        "social"           "bdc"              "ll"              
[13] "Exits"            "Exit rate"        "dup"              "n.comments"      
[17] "post.year"        "post.month"       "post.likes"       "post.dislikes"   
[21] "post.total.likes" "blocked.sum"      "pct.positive"     "e.rate"          
[25] "year_month"       "post.dt"          "weekday"          "author.sum"      </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(n.comments <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> author.sum <span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = n.comments ~ log(Uniques) + author.sum + google + 
    direct + other.web + social + bdc + ll + blocked.sum + pct.positive + 
    weekday, data = merged)

Residuals:
    Min      1Q  Median      3Q     Max 
-81.070 -24.045  -5.684  22.404 152.083 

Coefficients:
               Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)   8.554e+01  1.627e+02   0.526  0.59943   
log(Uniques) -9.286e+00  1.674e+01  -0.555  0.57958   
author.sum    4.794e-01  3.273e+00   0.146  0.88367   
google        3.337e-04  6.802e-04   0.491  0.62413   
direct        9.789e-03  5.092e-03   1.922  0.05560 . 
other.web     2.806e-03  2.421e-03   1.159  0.24761   
social        6.666e-02  2.923e-02   2.281  0.02335 * 
bdc          -6.082e-03  5.066e-03  -1.200  0.23102   
ll            9.258e-03  3.778e-03   2.451  0.01489 * 
blocked.sum   4.571e-01  3.551e-01   1.287  0.19915   
pct.positive  9.632e-01  3.811e-01   2.527  0.01206 * 
weekday.L     2.694e-01  6.029e+00   0.045  0.96439   
weekday.Q    -1.852e+01  6.094e+00  -3.038  0.00261 **
weekday.C    -3.401e+00  5.179e+00  -0.657  0.51190   
weekday^4    -3.050e+00  4.957e+00  -0.615  0.53883   
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 37.18 on 271 degrees of freedom
  (144 observations deleted due to missingness)
Multiple R-squared:  0.2261,    Adjusted R-squared:  0.1861 
F-statistic: 5.656 on 14 and 271 DF,  p-value: 1.291e-09</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> author.sum <span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span> Uniques<span class="sc">+</span> author.sum <span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="co">#removing unsignificant variables:</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>,model<span class="fl">.2</span>, model<span class="fl">.3</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
==========================================================================================
                                             Dependent variable:                          
                    ----------------------------------------------------------------------
                                                  n.comments                              
                              (1)                     (2)                    (3)          
------------------------------------------------------------------------------------------
log(Uniques)                -9.286                                                        
                           (16.741)                                                       
                                                                                          
Uniques                                              0.004                                
                                                    (0.004)                               
                                                                                          
author.sum                   0.479                   0.293                                
                            (3.273)                 (3.283)                               
                                                                                          
google                      0.0003                  -0.004                                
                            (0.001)                 (0.004)                               
                                                                                          
direct                      0.010*                   0.008                 0.004***       
                            (0.005)                 (0.006)                (0.001)        
                                                                                          
other.web                    0.003                  -0.0004                               
                            (0.002)                 (0.004)                               
                                                                                          
social                      0.067**                 0.063**                0.068**        
                            (0.029)                 (0.029)                (0.029)        
                                                                                          
bdc                         -0.006                  -0.008*                               
                            (0.005)                 (0.005)                               
                                                                                          
ll                          0.009**                 0.010**                0.012***       
                            (0.004)                 (0.004)                (0.003)        
                                                                                          
blocked.sum                  0.457                   0.482                                
                            (0.355)                 (0.356)                               
                                                                                          
pct.positive                0.963**                0.998***                1.011***       
                            (0.381)                 (0.381)                (0.378)        
                                                                                          
weekday.L                    0.269                  -0.326                  1.804         
                            (6.029)                 (6.060)                (5.954)        
                                                                                          
weekday.Q                 -18.516***              -19.039***              -20.379***      
                            (6.094)                 (6.091)                (5.968)        
                                                                                          
weekday.C                   -3.401                  -3.259                  -5.286        
                            (5.179)                 (5.159)                (5.083)        
                                                                                          
weekday4                    -3.050                  -3.239                  -3.952        
                            (4.957)                 (4.960)                (4.917)        
                                                                                          
Constant                    85.544                  -11.024                 5.845         
                           (162.681)               (38.118)                (35.136)       
                                                                                          
------------------------------------------------------------------------------------------
Observations                  286                     286                    286          
R2                           0.226                   0.227                  0.206         
Adjusted R2                  0.186                   0.187                  0.183         
Residual Std. Error    37.185 (df = 271)       37.158 (df = 271)      37.265 (df = 277)   
F Statistic         5.656*** (df = 14; 271) 5.692*** (df = 14; 271) 8.958*** (df = 8; 277)
==========================================================================================
Note:                                                          *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
</section>
<section id="diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="diagnostics">4.2. Diagnostics:</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Observation #48 looks like on outlier impacting the model. I will remove this observation to see if that gives us any different results:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>merged.old <span class="ot">&lt;-</span> merged</span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">48</span>), ]</span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged.old )</span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.3</span>, model<span class="fl">.4</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=================================================================
                                 Dependent variable:             
                    ---------------------------------------------
                                     n.comments                  
                             (1)                    (2)          
-----------------------------------------------------------------
direct                     0.004***               0.004***       
                           (0.001)                (0.001)        
                                                                 
social                     0.068**                0.068**        
                           (0.029)                (0.029)        
                                                                 
ll                         0.012***               0.012***       
                           (0.003)                (0.003)        
                                                                 
pct.positive               1.011***               1.010***       
                           (0.378)                (0.378)        
                                                                 
weekday.L                   1.804                  1.809         
                           (5.954)                (5.965)        
                                                                 
weekday.Q                 -20.379***             -20.407***      
                           (5.968)                (5.985)        
                                                                 
weekday.C                   -5.286                 -5.283        
                           (5.083)                (5.092)        
                                                                 
weekday4                    -3.952                 -3.903        
                           (4.917)                (4.950)        
                                                                 
Constant                    5.845                  5.965         
                           (35.136)               (35.219)       
                                                                 
-----------------------------------------------------------------
Observations                 286                    285          
R2                          0.206                  0.205         
Adjusted R2                 0.183                  0.182         
Residual Std. Error   37.265 (df = 277)      37.332 (df = 276)   
F Statistic         8.958*** (df = 8; 277) 8.906*** (df = 8; 276)
=================================================================
Note:                                 *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>We can see that removing #48 changed some coefficients, did not impact significance of variables. It also improved R^2 and adjusted R^2.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_check_in_5_Diana_Rinker_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<section id="question---do-i-need-to-improve-mod-fit-here" class="level3">
<h3 class="anchored" data-anchor-id="question---do-i-need-to-improve-mod-fit-here">4.3. QUESTION - do i need to improve mod fit here ?</h3>
</section>
</section>
</section>
<section id="conlusion" class="level1">
<h1>4. Conlusion</h1>
<p>We have build two models for different engagement metrics: engagement of all readers and engagement of loyal readers. As we can see from the models, different factors contribute to engagement of these two groups of readers:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.7</span>, model<span class="fl">.4</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=========================================================================
                                       Dependent variable:               
                         ------------------------------------------------
                                  e.rate                 n.comments      
                                    (1)                     (2)          
-------------------------------------------------------------------------
log(Uniques)                       0.023                                 
                                  (0.105)                                
                                                                         
log(google)                      0.312***                                
                                  (0.043)                                
                                                                         
log(direct)                      -0.847***                               
                                  (0.156)                                
                                                                         
other.web                       -0.00001***                              
                                 (0.00000)                               
                                                                         
direct                                                    0.004***       
                                                          (0.001)        
                                                                         
social                          -0.00003**                0.068**        
                                 (0.00002)                (0.029)        
                                                                         
log(bdc)                         0.175***                                
                                  (0.017)                                
                                                                         
ll                                                        0.012***       
                                                          (0.003)        
                                                                         
pct.positive                                              1.010***       
                                                          (0.378)        
                                                                         
weekday.L                        0.009***                  1.809         
                                  (0.003)                 (5.965)        
                                                                         
weekday.Q                        0.018***                -20.407***      
                                  (0.003)                 (5.985)        
                                                                         
weekday.C                         0.007**                  -5.283        
                                  (0.003)                 (5.092)        
                                                                         
weekday4                         0.007***                  -3.903        
                                  (0.003)                 (4.950)        
                                                                         
log(Uniques):log(google)         -0.034***                               
                                  (0.005)                                
                                                                         
log(Uniques):log(direct)         0.053***                                
                                  (0.015)                                
                                                                         
Constant                          2.136*                   5.965         
                                  (1.120)                 (35.219)       
                                                                         
-------------------------------------------------------------------------
Observations                        286                     285          
R2                                 0.923                   0.205         
Adjusted R2                        0.919                   0.182         
Residual Std. Error          0.019 (df = 273)        37.332 (df = 276)   
F Statistic              272.255*** (df = 12; 273) 8.906*** (df = 8; 276)
=========================================================================
Note:                                         *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>We can see, that different referral sourses contribute to users engagement. While all readers’engagement (measured with exit rate) is influenced by interaction of referrals from Google and Direct and popularity, internal bdc referrals and somewhat referrals from other web sources, loyal readers’ engagement is highly impacted by the mood pf the post, internal page referrals, social referrals. Thhey also show some direct referrals’ impact, but very small in compare with its influence on all users’ engagement.</p>
<p>We also see significant contibution of day of the week on readers engagement. Specifically, Monday’s engagement of all readers is significantly higher than any other day. For loyal readers, Wednesday showing thee lowest engagement.</p>
<p>It also important to point out, that popularity of the post (Uniques) only plays a role for all user’s engagement. Loyal readers appear not being impacted by popularity.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/603_Spring_2023" data-repo-id="R_kgDOI4oXIA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb138" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project checkin 5"</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Diana Rinker"</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Final project DACSS 603"</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "5/9/2023"</span></span>
<span id="cb138-6"><a href="#cb138-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb138-7"><a href="#cb138-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb138-8"><a href="#cb138-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb138-9"><a href="#cb138-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb138-10"><a href="#cb138-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb138-11"><a href="#cb138-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb138-12"><a href="#cb138-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb138-13"><a href="#cb138-13" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb138-14"><a href="#cb138-14" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb138-15"><a href="#cb138-15" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb138-16"><a href="#cb138-16" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb138-17"><a href="#cb138-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb138-18"><a href="#cb138-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-19"><a href="#cb138-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## DACSS 603, spring 2023</span></span>
<span id="cb138-20"><a href="#cb138-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-21"><a href="#cb138-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final Project check-in 5, Diana Rinker.</span></span>
<span id="cb138-22"><a href="#cb138-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-23"><a href="#cb138-23" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction. Online engagement</span></span>
<span id="cb138-24"><a href="#cb138-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-25"><a href="#cb138-25" aria-hidden="true" tabindex="-1"></a>It is well known that online engagement with the web resource is a</span>
<span id="cb138-26"><a href="#cb138-26" aria-hidden="true" tabindex="-1"></a>highly valuable metric and is contributing to the site revenue. This</span>
<span id="cb138-27"><a href="#cb138-27" aria-hidden="true" tabindex="-1"></a>research project is exploring which factors contribute to users online</span>
<span id="cb138-28"><a href="#cb138-28" aria-hidden="true" tabindex="-1"></a>engagement. To do that I will use the data of an online blog on the news</span>
<span id="cb138-29"><a href="#cb138-29" aria-hidden="true" tabindex="-1"></a>website. The author of this blog is posting articles about interpersonal</span>
<span id="cb138-30"><a href="#cb138-30" aria-hidden="true" tabindex="-1"></a>relationships every work day (Mon- Fri). The posts are formulated as a</span>
<span id="cb138-31"><a href="#cb138-31" aria-hidden="true" tabindex="-1"></a>letter from a reader with the situation and a question about</span>
<span id="cb138-32"><a href="#cb138-32" aria-hidden="true" tabindex="-1"></a>relationships. The author gives an advice about the situation. Website</span>
<span id="cb138-33"><a href="#cb138-33" aria-hidden="true" tabindex="-1"></a>readers are free to comment under each post, but cannot make their own</span>
<span id="cb138-34"><a href="#cb138-34" aria-hidden="true" tabindex="-1"></a>posts.</span>
<span id="cb138-35"><a href="#cb138-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-36"><a href="#cb138-36" aria-hidden="true" tabindex="-1"></a>All post methadata and comments are public. They are saved by the</span>
<span id="cb138-37"><a href="#cb138-37" aria-hidden="true" tabindex="-1"></a>website and available for the analysis. Using this data set, I will</span>
<span id="cb138-38"><a href="#cb138-38" aria-hidden="true" tabindex="-1"></a>explore how readers' engagement connected with blogs's author</span>
<span id="cb138-39"><a href="#cb138-39" aria-hidden="true" tabindex="-1"></a>engagement, site comments', web source of readers and negative behaviors</span>
<span id="cb138-40"><a href="#cb138-40" aria-hidden="true" tabindex="-1"></a>online.</span>
<span id="cb138-41"><a href="#cb138-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-42"><a href="#cb138-42" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research Question and hypothesis.</span></span>
<span id="cb138-43"><a href="#cb138-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-44"><a href="#cb138-44" aria-hidden="true" tabindex="-1"></a>**RQ:** Which factors influence user's engagement in online blog?</span>
<span id="cb138-45"><a href="#cb138-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-46"><a href="#cb138-46" aria-hidden="true" tabindex="-1"></a>**DV:** My dependent construct is **"user's engagement**", I will</span>
<span id="cb138-47"><a href="#cb138-47" aria-hidden="true" tabindex="-1"></a>measure users' engagement at the level of individual post, using the</span>
<span id="cb138-48"><a href="#cb138-48" aria-hidden="true" tabindex="-1"></a>following metrics:</span>
<span id="cb138-49"><a href="#cb138-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-50"><a href="#cb138-50" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> Exit rate or "bounces". When the visitor is coming to the page and</span>
<span id="cb138-51"><a href="#cb138-51" aria-hidden="true" tabindex="-1"></a>then leaving, i.e. not opening other pages on this website. this will</span>
<span id="cb138-52"><a href="#cb138-52" aria-hidden="true" tabindex="-1"></a>represent all readers.</span>
<span id="cb138-53"><a href="#cb138-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-54"><a href="#cb138-54" aria-hidden="true" tabindex="-1"></a>2<span class="sc">\.</span> Number of comments - is engagement metric, representing only loyal</span>
<span id="cb138-55"><a href="#cb138-55" aria-hidden="true" tabindex="-1"></a>readers, who have created an account and signed in.</span>
<span id="cb138-56"><a href="#cb138-56" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-57"><a href="#cb138-57" aria-hidden="true" tabindex="-1"></a>**IV:** My main independent variables are</span>
<span id="cb138-58"><a href="#cb138-58" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-59"><a href="#cb138-59" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Post popularity. Unique users - number of unique people viewed the</span>
<span id="cb138-60"><a href="#cb138-60" aria-hidden="true" tabindex="-1"></a>    post.</span>
<span id="cb138-61"><a href="#cb138-61" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Source of the readers - which web page the reader came from. This is</span>
<span id="cb138-62"><a href="#cb138-62" aria-hidden="true" tabindex="-1"></a>    represented by 6 different variables, each is continuous type.</span>
<span id="cb138-63"><a href="#cb138-63" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Mood of the conversation , derivative continuous variable calculated</span>
<span id="cb138-64"><a href="#cb138-64" aria-hidden="true" tabindex="-1"></a>    as the ratio of "likes" to all emotions (sum of thumbs up and thumbs</span>
<span id="cb138-65"><a href="#cb138-65" aria-hidden="true" tabindex="-1"></a>    down), with the range 0-1.</span>
<span id="cb138-66"><a href="#cb138-66" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Blocked and flagged comments.</span>
<span id="cb138-67"><a href="#cb138-67" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Number of author's comments.</span>
<span id="cb138-68"><a href="#cb138-68" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Weekday of the post.</span>
<span id="cb138-69"><a href="#cb138-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-70"><a href="#cb138-70" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=F}</span></span>
<span id="cb138-71"><a href="#cb138-71" aria-hidden="true" tabindex="-1"></a><span class="co">#Loading necessary libraries: </span></span>
<span id="cb138-72"><a href="#cb138-72" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb138-73"><a href="#cb138-73" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb138-74"><a href="#cb138-74" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb138-75"><a href="#cb138-75" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb138-76"><a href="#cb138-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(png)</span>
<span id="cb138-77"><a href="#cb138-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb138-78"><a href="#cb138-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb138-79"><a href="#cb138-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb138-80"><a href="#cb138-80" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-81"><a href="#cb138-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-82"><a href="#cb138-82" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data source and description.</span></span>
<span id="cb138-83"><a href="#cb138-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-84"><a href="#cb138-84" aria-hidden="true" tabindex="-1"></a>To answer my research question I will use two datasets. The first data</span>
<span id="cb138-85"><a href="#cb138-85" aria-hidden="true" tabindex="-1"></a>set has information about all comments associated with each post by post</span>
<span id="cb138-86"><a href="#cb138-86" aria-hidden="true" tabindex="-1"></a>ID. The second data set is analytics data for the web page. It contains</span>
<span id="cb138-87"><a href="#cb138-87" aria-hidden="true" tabindex="-1"></a>one post per row and variables describe each post as a whole without</span>
<span id="cb138-88"><a href="#cb138-88" aria-hidden="true" tabindex="-1"></a>breaking down to the comment level.</span>
<span id="cb138-89"><a href="#cb138-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-90"><a href="#cb138-90" aria-hidden="true" tabindex="-1"></a>In this project I will analyze posts for January 2022 - March 2023. Here</span>
<span id="cb138-91"><a href="#cb138-91" aria-hidden="true" tabindex="-1"></a>is the list of variables in each data set:</span>
<span id="cb138-92"><a href="#cb138-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-93"><a href="#cb138-93" aria-hidden="true" tabindex="-1"></a>Comments data:</span>
<span id="cb138-94"><a href="#cb138-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-95"><a href="#cb138-95" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-96"><a href="#cb138-96" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb138-97"><a href="#cb138-97" aria-hidden="true" tabindex="-1"></a><span class="co"># First, I will load the data set with the comment level data:</span></span>
<span id="cb138-98"><a href="#cb138-98" aria-hidden="true" tabindex="-1"></a>raw <span class="ot">&lt;-</span> <span class="fu">as_tibble</span> (<span class="fu">read_csv</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Diana</span><span class="sc">\\</span><span class="st">OneDrive - University Of Massachusetts Medical School</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">R working directory</span><span class="sc">\\</span><span class="st">DACSS</span><span class="sc">\\</span><span class="st">603</span><span class="sc">\\</span><span class="st">my study files for dacss603</span><span class="sc">\\</span><span class="st">globe</span><span class="sc">\\</span><span class="st"> data.2021.plus.csv"</span>))</span>
<span id="cb138-99"><a href="#cb138-99" aria-hidden="true" tabindex="-1"></a>comments.data<span class="ot">&lt;-</span>raw </span>
<span id="cb138-100"><a href="#cb138-100" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span> (comments.data)</span>
<span id="cb138-101"><a href="#cb138-101" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(comments.data<span class="sc">$</span>written_at)</span>
<span id="cb138-102"><a href="#cb138-102" aria-hidden="true" tabindex="-1"></a>comments.data <span class="ot">&lt;-</span>comments.data<span class="sc">%&gt;%</span></span>
<span id="cb138-103"><a href="#cb138-103" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">com.year =</span> <span class="fu">format</span>(written_at,<span class="at">format =</span> <span class="st">"%Y"</span> ))</span>
<span id="cb138-104"><a href="#cb138-104" aria-hidden="true" tabindex="-1"></a><span class="co"># range(comments.data$com.year)</span></span>
<span id="cb138-105"><a href="#cb138-105" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(comments.data)</span></span>
<span id="cb138-106"><a href="#cb138-106" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(comments.data)</span>
<span id="cb138-107"><a href="#cb138-107" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(comments.data)</span>
<span id="cb138-108"><a href="#cb138-108" aria-hidden="true" tabindex="-1"></a>comments.data <span class="ot">&lt;-</span> comments.data<span class="sc">%&gt;%</span></span>
<span id="cb138-109"><a href="#cb138-109" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(written_at  <span class="sc">&gt;=</span> <span class="st">"2022-01-01"</span>)</span>
<span id="cb138-110"><a href="#cb138-110" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-111"><a href="#cb138-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-112"><a href="#cb138-112" aria-hidden="true" tabindex="-1"></a>Post data:</span>
<span id="cb138-113"><a href="#cb138-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-114"><a href="#cb138-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-115"><a href="#cb138-115" aria-hidden="true" tabindex="-1"></a><span class="co"># Second, loadng post-level data :</span></span>
<span id="cb138-116"><a href="#cb138-116" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">as_tibble</span> (<span class="fu">read_csv</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Diana</span><span class="sc">\\</span><span class="st">OneDrive - University Of Massachusetts Medical School</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">R working directory</span><span class="sc">\\</span><span class="st">DACSS</span><span class="sc">\\</span><span class="st">603</span><span class="sc">\\</span><span class="st">my study files for dacss603</span><span class="sc">\\</span><span class="st">globe</span><span class="sc">\\</span><span class="st">data.merged.csv"</span>))</span>
<span id="cb138-117"><a href="#cb138-117" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb138-118"><a href="#cb138-118" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(merged)</span>
<span id="cb138-119"><a href="#cb138-119" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merged)</span>
<span id="cb138-120"><a href="#cb138-120" aria-hidden="true" tabindex="-1"></a><span class="co"># Limiting the dataset to 2022: </span></span>
<span id="cb138-121"><a href="#cb138-121" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged<span class="sc">%&gt;%</span></span>
<span id="cb138-122"><a href="#cb138-122" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(post.date  <span class="sc">&gt;=</span>  <span class="st">"2022-01-01"</span>)</span>
<span id="cb138-123"><a href="#cb138-123" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merged)</span>
<span id="cb138-124"><a href="#cb138-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-125"><a href="#cb138-125" aria-hidden="true" tabindex="-1"></a><span class="co"># Due to dataset of comments having more data than post dataset,  I will cut them to match: </span></span>
<span id="cb138-126"><a href="#cb138-126" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span></span>
<span id="cb138-127"><a href="#cb138-127" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (<span class="sc">!</span><span class="fu">is.na</span>(merged<span class="sc">$</span>pct.positive))</span>
<span id="cb138-128"><a href="#cb138-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-129"><a href="#cb138-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-130"><a href="#cb138-130" aria-hidden="true" tabindex="-1"></a>To begin, I will review available variables and evaluate to idntify a</span>
<span id="cb138-131"><a href="#cb138-131" aria-hidden="true" tabindex="-1"></a>metric for each construct in my study.</span>
<span id="cb138-132"><a href="#cb138-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-133"><a href="#cb138-133" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1.DV: engagement.</span></span>
<span id="cb138-134"><a href="#cb138-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-135"><a href="#cb138-135" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exit rate</span></span>
<span id="cb138-136"><a href="#cb138-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-137"><a href="#cb138-137" aria-hidden="true" tabindex="-1"></a>This variable is measuring how many people visited the page and then</span>
<span id="cb138-138"><a href="#cb138-138" aria-hidden="true" tabindex="-1"></a>left the website after the first view. This metric is the best measure</span>
<span id="cb138-139"><a href="#cb138-139" aria-hidden="true" tabindex="-1"></a>of engagement for all users, as it represents the first step after being</span>
<span id="cb138-140"><a href="#cb138-140" aria-hidden="true" tabindex="-1"></a>exposed to the post - either quitting the site or remaining on the site.</span>
<span id="cb138-141"><a href="#cb138-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-142"><a href="#cb138-142" aria-hidden="true" tabindex="-1"></a>Here can see the distribution of this variable :</span>
<span id="cb138-143"><a href="#cb138-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-144"><a href="#cb138-144" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-145"><a href="#cb138-145" aria-hidden="true" tabindex="-1"></a><span class="co"># str(merged)</span></span>
<span id="cb138-146"><a href="#cb138-146" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span></span>
<span id="cb138-147"><a href="#cb138-147" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">e.rate =</span> Exits<span class="sc">/</span><span class="st">`</span><span class="at">Page views</span><span class="st">`</span>)</span>
<span id="cb138-148"><a href="#cb138-148" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span> (merged, <span class="st">`</span><span class="at">Exit rate</span><span class="st">`</span>, e.rate)</span>
<span id="cb138-149"><a href="#cb138-149" aria-hidden="true" tabindex="-1"></a><span class="co"># merged$`Exit rate` &lt;- as.numeric(sub("%", "", merged$`Exit rate`)) / 100</span></span>
<span id="cb138-150"><a href="#cb138-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-151"><a href="#cb138-151" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>e.rate))<span class="sc">+</span></span>
<span id="cb138-152"><a href="#cb138-152" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.02</span>, <span class="at">fill =</span> <span class="st">"grey50"</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span></span>
<span id="cb138-153"><a href="#cb138-153" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">fill =</span> <span class="st">"sandybrown"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)</span>
<span id="cb138-154"><a href="#cb138-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-155"><a href="#cb138-155" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-156"><a href="#cb138-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-157"><a href="#cb138-157" aria-hidden="true" tabindex="-1"></a>Distribution of exit rate over time:</span>
<span id="cb138-158"><a href="#cb138-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-159"><a href="#cb138-159" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-160"><a href="#cb138-160" aria-hidden="true" tabindex="-1"></a><span class="co"># creating  year_month  variable </span></span>
<span id="cb138-161"><a href="#cb138-161" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>post.month <span class="ot">&lt;-</span><span class="fu">as.numeric</span>(merged<span class="sc">$</span>post.month)</span>
<span id="cb138-162"><a href="#cb138-162" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>year_month <span class="ot">&lt;-</span> <span class="fu">paste0</span>(merged<span class="sc">$</span>post.year, <span class="st">"-"</span>, <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, merged<span class="sc">$</span>post.month))</span>
<span id="cb138-163"><a href="#cb138-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-164"><a href="#cb138-164" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span><span class="st">`</span><span class="at">e.rate</span><span class="st">`</span>, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb138-165"><a href="#cb138-165" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb138-166"><a href="#cb138-166" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of `Exit rate` per post "</span>, <span class="at">y =</span> <span class="st">"Exit rate"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb138-167"><a href="#cb138-167" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb138-168"><a href="#cb138-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-169"><a href="#cb138-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-170"><a href="#cb138-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-171"><a href="#cb138-171" aria-hidden="true" tabindex="-1"></a><span class="fu">## Number of comments:</span></span>
<span id="cb138-172"><a href="#cb138-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-173"><a href="#cb138-173" aria-hidden="true" tabindex="-1"></a>engagement metric for loyal readers.</span>
<span id="cb138-174"><a href="#cb138-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-175"><a href="#cb138-175" aria-hidden="true" tabindex="-1"></a>Commenting requires user to log in, which is an indicator of greater</span>
<span id="cb138-176"><a href="#cb138-176" aria-hidden="true" tabindex="-1"></a>engagement of an individual user. Therefore this variable represents</span>
<span id="cb138-177"><a href="#cb138-177" aria-hidden="true" tabindex="-1"></a>engagement of a subset of users,loyal readers, who have created an</span>
<span id="cb138-178"><a href="#cb138-178" aria-hidden="true" tabindex="-1"></a>account.</span>
<span id="cb138-179"><a href="#cb138-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-180"><a href="#cb138-180" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-181"><a href="#cb138-181" aria-hidden="true" tabindex="-1"></a><span class="co"># merged$year_month </span></span>
<span id="cb138-182"><a href="#cb138-182" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>n.comments))<span class="sc">+</span></span>
<span id="cb138-183"><a href="#cb138-183" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"seagreen4"</span>)</span>
<span id="cb138-184"><a href="#cb138-184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-185"><a href="#cb138-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-186"><a href="#cb138-186" aria-hidden="true" tabindex="-1"></a>And change in the distribution over time:</span>
<span id="cb138-187"><a href="#cb138-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-188"><a href="#cb138-188" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-189"><a href="#cb138-189" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>n.comments, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb138-190"><a href="#cb138-190" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb138-191"><a href="#cb138-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of comments per post "</span>, <span class="at">y =</span> <span class="st">"Number of comments"</span> )<span class="sc">+</span></span>
<span id="cb138-192"><a href="#cb138-192" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span> (<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span> <span class="dv">10000</span>, <span class="at">by=</span> <span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb138-193"><a href="#cb138-193" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb138-194"><a href="#cb138-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-195"><a href="#cb138-195" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-196"><a href="#cb138-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-197"><a href="#cb138-197" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2.IV. Independent variables:</span></span>
<span id="cb138-198"><a href="#cb138-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-199"><a href="#cb138-199" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-200"><a href="#cb138-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-201"><a href="#cb138-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-202"><a href="#cb138-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-203"><a href="#cb138-203" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.1.Popularity</span></span>
<span id="cb138-204"><a href="#cb138-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-205"><a href="#cb138-205" aria-hidden="true" tabindex="-1"></a>"Uniques" variable represents number of unique people who came to the</span>
<span id="cb138-206"><a href="#cb138-206" aria-hidden="true" tabindex="-1"></a>page and viewed it at least once, his metric represents popularity of</span>
<span id="cb138-207"><a href="#cb138-207" aria-hidden="true" tabindex="-1"></a>the post. It's distribution shows us that not all posts are equally</span>
<span id="cb138-208"><a href="#cb138-208" aria-hidden="true" tabindex="-1"></a>popular:</span>
<span id="cb138-209"><a href="#cb138-209" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-210"><a href="#cb138-210" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-211"><a href="#cb138-211" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb138-212"><a href="#cb138-212" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Uniques))<span class="sc">+</span></span>
<span id="cb138-213"><a href="#cb138-213" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"purple2"</span>)</span>
<span id="cb138-214"><a href="#cb138-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-215"><a href="#cb138-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-216"><a href="#cb138-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-217"><a href="#cb138-217" aria-hidden="true" tabindex="-1"></a>We can see a long tail on the right, showing that there is a number of</span>
<span id="cb138-218"><a href="#cb138-218" aria-hidden="true" tabindex="-1"></a>posts who are way more popular than the majority of the sample.</span>
<span id="cb138-219"><a href="#cb138-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-220"><a href="#cb138-220" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-221"><a href="#cb138-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-222"><a href="#cb138-222" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>Uniques, <span class="at">x=</span>merged<span class="sc">$</span>year_month))<span class="sc">+</span></span>
<span id="cb138-223"><a href="#cb138-223" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb138-224"><a href="#cb138-224" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of unique viewers per month"</span>, <span class="at">x=</span><span class="st">"Month"</span>, <span class="at">y=</span><span class="st">"Number of unique viewers"</span>)<span class="sc">+</span> </span>
<span id="cb138-225"><a href="#cb138-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb138-226"><a href="#cb138-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-227"><a href="#cb138-227" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-228"><a href="#cb138-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-229"><a href="#cb138-229" aria-hidden="true" tabindex="-1"></a>Next plot will illustrate connection between popularity and engagement</span>
<span id="cb138-230"><a href="#cb138-230" aria-hidden="true" tabindex="-1"></a>metrics:</span>
<span id="cb138-231"><a href="#cb138-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-232"><a href="#cb138-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-233"><a href="#cb138-233" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (merged, <span class="at">select=</span><span class="fu">c</span>(Uniques, e.rate, n.comments )))</span>
<span id="cb138-234"><a href="#cb138-234" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-235"><a href="#cb138-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-236"><a href="#cb138-236" aria-hidden="true" tabindex="-1"></a>We can see that popularity strongly correlated with exit rate,where an</span>
<span id="cb138-237"><a href="#cb138-237" aria-hidden="true" tabindex="-1"></a>increase in popularity causes decrease of engagement.It is not as</span>
<span id="cb138-238"><a href="#cb138-238" aria-hidden="true" tabindex="-1"></a>strongly correlated with number of comments. Engagement rate and number</span>
<span id="cb138-239"><a href="#cb138-239" aria-hidden="true" tabindex="-1"></a>of comments dont show obvious pattern between each other.</span>
<span id="cb138-240"><a href="#cb138-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-241"><a href="#cb138-241" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2. Referral sources.</span></span>
<span id="cb138-242"><a href="#cb138-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-243"><a href="#cb138-243" aria-hidden="true" tabindex="-1"></a>The website analytics provides information on where the viewers are</span>
<span id="cb138-244"><a href="#cb138-244" aria-hidden="true" tabindex="-1"></a>coming from to the blog page. For example, if people clicked on the blog</span>
<span id="cb138-245"><a href="#cb138-245" aria-hidden="true" tabindex="-1"></a>link posted on FaceBook, that would be referral from social media. If</span>
<span id="cb138-246"><a href="#cb138-246" aria-hidden="true" tabindex="-1"></a>people clicked on the blog link within BDC website, that would be "BDC</span>
<span id="cb138-247"><a href="#cb138-247" aria-hidden="true" tabindex="-1"></a>referral visit".</span>
<span id="cb138-248"><a href="#cb138-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-249"><a href="#cb138-249" aria-hidden="true" tabindex="-1"></a>There are 5 sources of referrals, each corresponding with a variable in</span>
<span id="cb138-250"><a href="#cb138-250" aria-hidden="true" tabindex="-1"></a>the data set. Variable's value is a number of visits from this referral</span>
<span id="cb138-251"><a href="#cb138-251" aria-hidden="true" tabindex="-1"></a>source.</span>
<span id="cb138-252"><a href="#cb138-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-253"><a href="#cb138-253" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb138-254"><a href="#cb138-254" aria-hidden="true" tabindex="-1"></a><span class="in">"Search + amp referral visits"</span></span>
<span id="cb138-255"><a href="#cb138-255" aria-hidden="true" tabindex="-1"></a><span class="in">"Direct (non-email) referral visits"</span></span>
<span id="cb138-256"><a href="#cb138-256" aria-hidden="true" tabindex="-1"></a><span class="in">"Other website referral visits"</span></span>
<span id="cb138-257"><a href="#cb138-257" aria-hidden="true" tabindex="-1"></a><span class="in">"Social referral visits"</span></span>
<span id="cb138-258"><a href="#cb138-258" aria-hidden="true" tabindex="-1"></a><span class="in">"BDC referral visits"</span></span>
<span id="cb138-259"><a href="#cb138-259" aria-hidden="true" tabindex="-1"></a><span class="in">"Visits when post was on LL HP" </span></span>
<span id="cb138-260"><a href="#cb138-260" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-261"><a href="#cb138-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-262"><a href="#cb138-262" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-263"><a href="#cb138-263" aria-hidden="true" tabindex="-1"></a><span class="co">#renaming variables for convenience: </span></span>
<span id="cb138-264"><a href="#cb138-264" aria-hidden="true" tabindex="-1"></a>merged<span class="ot">&lt;-</span>merged<span class="sc">%&gt;%</span></span>
<span id="cb138-265"><a href="#cb138-265" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">google =</span><span class="st">"Search + amp referral visits"</span>,</span>
<span id="cb138-266"><a href="#cb138-266" aria-hidden="true" tabindex="-1"></a>         <span class="at">direct =</span><span class="st">"Direct (non-email) referral visits"</span>,</span>
<span id="cb138-267"><a href="#cb138-267" aria-hidden="true" tabindex="-1"></a>         <span class="at">other.web =</span> <span class="st">"Other website referral visits"</span>,</span>
<span id="cb138-268"><a href="#cb138-268" aria-hidden="true" tabindex="-1"></a>          <span class="at">social=</span> <span class="st">"Social referral visits"</span>,</span>
<span id="cb138-269"><a href="#cb138-269" aria-hidden="true" tabindex="-1"></a>          <span class="at">bdc=</span> <span class="st">"BDC referral visits"</span>,</span>
<span id="cb138-270"><a href="#cb138-270" aria-hidden="true" tabindex="-1"></a>          <span class="at">ll=</span> <span class="st">"Visits when post was on LL HP"</span> )</span>
<span id="cb138-271"><a href="#cb138-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-272"><a href="#cb138-272" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>post.date))<span class="sc">+</span></span>
<span id="cb138-273"><a href="#cb138-273" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>google), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb138-274"><a href="#cb138-274" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>direct), <span class="at">color=</span><span class="st">"green"</span>)<span class="sc">+</span></span>
<span id="cb138-275"><a href="#cb138-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>other.web), <span class="at">color=</span><span class="st">"yellow"</span>)<span class="sc">+</span></span>
<span id="cb138-276"><a href="#cb138-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>social), <span class="at">color=</span><span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb138-277"><a href="#cb138-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>bdc), <span class="at">color=</span><span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb138-278"><a href="#cb138-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>ll), <span class="at">color=</span><span class="st">"pink"</span>)  <span class="sc">+</span></span>
<span id="cb138-279"><a href="#cb138-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Referral sources per post "</span>, <span class="at">y =</span> <span class="st">"Number of referrals"</span> , <span class="at">x=</span><span class="st">"Post"</span>)<span class="sc">+</span> </span>
<span id="cb138-280"><a href="#cb138-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"purple"</span>, <span class="st">"blue"</span>, <span class="st">"pink"</span>),</span>
<span id="cb138-281"><a href="#cb138-281" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Google"</span>, <span class="st">"Direct"</span>, <span class="st">"Other Web"</span>, <span class="st">"Social"</span>, <span class="st">"Bdc"</span>, <span class="st">"LL"</span>))</span>
<span id="cb138-282"><a href="#cb138-282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-283"><a href="#cb138-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-284"><a href="#cb138-284" aria-hidden="true" tabindex="-1"></a>This graph is showing of "Search + amp referral visits" have high</span>
<span id="cb138-285"><a href="#cb138-285" aria-hidden="true" tabindex="-1"></a>variability. Other referral sources range is much smaller.</span>
<span id="cb138-286"><a href="#cb138-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-287"><a href="#cb138-287" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-288"><a href="#cb138-288" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(comments.data)</span>
<span id="cb138-289"><a href="#cb138-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculating date of the post and weekday  from comments data </span></span>
<span id="cb138-290"><a href="#cb138-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-291"><a href="#cb138-291" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb138-292"><a href="#cb138-292" aria-hidden="true" tabindex="-1"></a>post.date <span class="ot">&lt;-</span>comments.data <span class="sc">%&gt;%</span></span>
<span id="cb138-293"><a href="#cb138-293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(post_id)<span class="sc">%&gt;%</span></span>
<span id="cb138-294"><a href="#cb138-294" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(written_at)<span class="sc">%&gt;%</span></span>
<span id="cb138-295"><a href="#cb138-295" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">post.dt =</span> <span class="fu">first</span>(written_at))</span>
<span id="cb138-296"><a href="#cb138-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-297"><a href="#cb138-297" aria-hidden="true" tabindex="-1"></a>post.date  <span class="ot">&lt;-</span>post.date <span class="sc">%&gt;%</span></span>
<span id="cb138-298"><a href="#cb138-298" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">weekday =</span> <span class="fu">wday</span>(post.dt, <span class="at">label =</span> <span class="cn">TRUE</span>),</span>
<span id="cb138-299"><a href="#cb138-299" aria-hidden="true" tabindex="-1"></a>          <span class="at">n.coms =</span><span class="fu">n</span>())<span class="sc">%&gt;%</span></span>
<span id="cb138-300"><a href="#cb138-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (n.coms<span class="sc">&gt;</span><span class="dv">100</span>)<span class="sc">%&gt;%</span></span>
<span id="cb138-301"><a href="#cb138-301" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(post_id,post.dt,  weekday )</span>
<span id="cb138-302"><a href="#cb138-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-303"><a href="#cb138-303" aria-hidden="true" tabindex="-1"></a> <span class="co"># Adding weekdays to both data sets: comments level and post level:</span></span>
<span id="cb138-304"><a href="#cb138-304" aria-hidden="true" tabindex="-1"></a>comments.data <span class="ot">&lt;-</span> <span class="fu">merge</span>(comments.data, post.date , <span class="at">by =</span> <span class="st">"post_id"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-305"><a href="#cb138-305" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">merge</span>( merged, post.date , <span class="at">by =</span> <span class="st">"post_id"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-306"><a href="#cb138-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-307"><a href="#cb138-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-308"><a href="#cb138-308" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-309"><a href="#cb138-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-310"><a href="#cb138-310" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.3. Post weekdays</span></span>
<span id="cb138-311"><a href="#cb138-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-312"><a href="#cb138-312" aria-hidden="true" tabindex="-1"></a>The posts are being published Monday through Friday (with rare</span>
<span id="cb138-313"><a href="#cb138-313" aria-hidden="true" tabindex="-1"></a>exceptions). No posts are published on the weekend. Below is a plot for</span>
<span id="cb138-314"><a href="#cb138-314" aria-hidden="true" tabindex="-1"></a>exit rate and number of comments' distributions per week day</span>
<span id="cb138-315"><a href="#cb138-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-316"><a href="#cb138-316" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-317"><a href="#cb138-317" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>weekday, <span class="at">y=</span>e.rate) )<span class="sc">+</span></span>
<span id="cb138-318"><a href="#cb138-318" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb138-319"><a href="#cb138-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb138-320"><a href="#cb138-320" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per weekday"</span>)</span>
<span id="cb138-321"><a href="#cb138-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-322"><a href="#cb138-322" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>weekday, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb138-323"><a href="#cb138-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb138-324"><a href="#cb138-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb138-325"><a href="#cb138-325" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per weekday"</span>)</span>
<span id="cb138-326"><a href="#cb138-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-327"><a href="#cb138-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-328"><a href="#cb138-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-329"><a href="#cb138-329" aria-hidden="true" tabindex="-1"></a>We can see that exit rate is overall lower on Tuesday, and number of</span>
<span id="cb138-330"><a href="#cb138-330" aria-hidden="true" tabindex="-1"></a>comments overall highest on Fridays.</span>
<span id="cb138-331"><a href="#cb138-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-332"><a href="#cb138-332" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.4. Authors comments</span></span>
<span id="cb138-333"><a href="#cb138-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-334"><a href="#cb138-334" aria-hidden="true" tabindex="-1"></a>To identify, how much the author of the blog is engaged in the post, I</span>
<span id="cb138-335"><a href="#cb138-335" aria-hidden="true" tabindex="-1"></a>will create an additional variable derived from a user_name field and</span>
<span id="cb138-336"><a href="#cb138-336" aria-hidden="true" tabindex="-1"></a>review the distribution of autor's comments :</span>
<span id="cb138-337"><a href="#cb138-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-338"><a href="#cb138-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-339"><a href="#cb138-339" aria-hidden="true" tabindex="-1"></a><span class="co"># str(merged)</span></span>
<span id="cb138-340"><a href="#cb138-340" aria-hidden="true" tabindex="-1"></a>comments.data<span class="sc">$</span>user_name<span class="ot">&lt;-</span>  <span class="fu">ifelse</span> (<span class="fu">is.na</span>(comments.data<span class="sc">$</span>user_name), <span class="dv">0</span>, comments.data<span class="sc">$</span>user_name)</span>
<span id="cb138-341"><a href="#cb138-341" aria-hidden="true" tabindex="-1"></a>comments.data<span class="sc">$</span>author<span class="ot">&lt;-</span>  <span class="fu">ifelse</span> (comments.data<span class="sc">$</span>user_name<span class="sc">==</span><span class="st">"MeredithGoldstein"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb138-342"><a href="#cb138-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-343"><a href="#cb138-343" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.data <span class="sc">%&gt;%</span></span>
<span id="cb138-344"><a href="#cb138-344" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(post_id)<span class="sc">%&gt;%</span></span>
<span id="cb138-345"><a href="#cb138-345" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n.comments=</span><span class="fu">n</span>(),</span>
<span id="cb138-346"><a href="#cb138-346" aria-hidden="true" tabindex="-1"></a>            <span class="at">author.sum =</span> <span class="fu">sum</span>(author))</span>
<span id="cb138-347"><a href="#cb138-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-348"><a href="#cb138-348" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments data contains rows that dont actually reporesent posts, and were crearted by web support team for troubleshooting. I need to remove these rows. They typically have very low number of comments</span></span>
<span id="cb138-349"><a href="#cb138-349" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.grouped <span class="sc">%&gt;%</span></span>
<span id="cb138-350"><a href="#cb138-350" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(n.comments <span class="sc">&gt;</span><span class="dv">100</span>)  <span class="co"># removing invalid posts created by the  website management team.</span></span>
<span id="cb138-351"><a href="#cb138-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-352"><a href="#cb138-352" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.grouped <span class="sc">%&gt;%</span></span>
<span id="cb138-353"><a href="#cb138-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(post_id, author.sum)</span>
<span id="cb138-354"><a href="#cb138-354" aria-hidden="true" tabindex="-1"></a> <span class="fu">dim</span>(comments.grouped)</span>
<span id="cb138-355"><a href="#cb138-355" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb138-356"><a href="#cb138-356" aria-hidden="true" tabindex="-1"></a><span class="co">#adding author.sum to main data set: </span></span>
<span id="cb138-357"><a href="#cb138-357" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">merge</span>( merged , comments.grouped, <span class="at">by =</span> <span class="st">"post_id"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb138-358"><a href="#cb138-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-359"><a href="#cb138-359" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum) )<span class="sc">+</span></span>
<span id="cb138-360"><a href="#cb138-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb138-361"><a href="#cb138-361" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Authors comments distribution"</span>)</span>
<span id="cb138-362"><a href="#cb138-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-363"><a href="#cb138-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-364"><a href="#cb138-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-365"><a href="#cb138-365" aria-hidden="true" tabindex="-1"></a>Authors comments per engagement metrics:</span>
<span id="cb138-366"><a href="#cb138-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-367"><a href="#cb138-367" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-368"><a href="#cb138-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-369"><a href="#cb138-369" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb138-370"><a href="#cb138-370" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb138-371"><a href="#cb138-371" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per author.sum"</span>)</span>
<span id="cb138-372"><a href="#cb138-372" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-373"><a href="#cb138-373" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb138-374"><a href="#cb138-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb138-375"><a href="#cb138-375" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per author.sum"</span>)</span>
<span id="cb138-376"><a href="#cb138-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-377"><a href="#cb138-377" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-378"><a href="#cb138-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-379"><a href="#cb138-379" aria-hidden="true" tabindex="-1"></a>This graph shows, that majority of posts have no author's comments.</span>
<span id="cb138-380"><a href="#cb138-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-381"><a href="#cb138-381" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.5. Mood of the post.</span></span>
<span id="cb138-382"><a href="#cb138-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-383"><a href="#cb138-383" aria-hidden="true" tabindex="-1"></a>This is a numerical variable, calculated as percentage of "thumbs up"</span>
<span id="cb138-384"><a href="#cb138-384" aria-hidden="true" tabindex="-1"></a>from all likes (both "thumbs up" and "thumbs down").</span>
<span id="cb138-385"><a href="#cb138-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-386"><a href="#cb138-386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-387"><a href="#cb138-387" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb138-388"><a href="#cb138-388" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive) )<span class="sc">+</span></span>
<span id="cb138-389"><a href="#cb138-389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"springgreen3"</span>)<span class="sc">+</span></span>
<span id="cb138-390"><a href="#cb138-390" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Mood of the post (pct.positive) distribution"</span>)</span>
<span id="cb138-391"><a href="#cb138-391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-392"><a href="#cb138-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-393"><a href="#cb138-393" aria-hidden="true" tabindex="-1"></a>Plotting mood pf the post against engagement metyrics:</span>
<span id="cb138-394"><a href="#cb138-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-395"><a href="#cb138-395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-396"><a href="#cb138-396" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb138-397"><a href="#cb138-397" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb138-398"><a href="#cb138-398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per pct.positive"</span>)</span>
<span id="cb138-399"><a href="#cb138-399" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-400"><a href="#cb138-400" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb138-401"><a href="#cb138-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb138-402"><a href="#cb138-402" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per pct.positive"</span>)</span>
<span id="cb138-403"><a href="#cb138-403" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-404"><a href="#cb138-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-405"><a href="#cb138-405" aria-hidden="true" tabindex="-1"></a>Distribution of mood over time:</span>
<span id="cb138-406"><a href="#cb138-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-407"><a href="#cb138-407" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-408"><a href="#cb138-408" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>pct.positive, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb138-409"><a href="#cb138-409" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb138-410"><a href="#cb138-410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of Mood per post "</span>, <span class="at">y =</span> <span class="st">"Mood"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb138-411"><a href="#cb138-411" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb138-412"><a href="#cb138-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-413"><a href="#cb138-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-414"><a href="#cb138-414" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.6. Blocked comments per post.</span></span>
<span id="cb138-415"><a href="#cb138-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-416"><a href="#cb138-416" aria-hidden="true" tabindex="-1"></a>Now I will visualize amount of blocked comments per post: Distribution</span>
<span id="cb138-417"><a href="#cb138-417" aria-hidden="true" tabindex="-1"></a>of blocked comments:</span>
<span id="cb138-418"><a href="#cb138-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-419"><a href="#cb138-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-420"><a href="#cb138-420" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum) )<span class="sc">+</span></span>
<span id="cb138-421"><a href="#cb138-421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"brown"</span>)<span class="sc">+</span></span>
<span id="cb138-422"><a href="#cb138-422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"blocked.sum distribution"</span>)</span>
<span id="cb138-423"><a href="#cb138-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-424"><a href="#cb138-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-425"><a href="#cb138-425" aria-hidden="true" tabindex="-1"></a>Plotting blocked comments against engagement metrics:</span>
<span id="cb138-426"><a href="#cb138-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-427"><a href="#cb138-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-428"><a href="#cb138-428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-429"><a href="#cb138-429" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb138-430"><a href="#cb138-430" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb138-431"><a href="#cb138-431" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per blocked.sum"</span>)</span>
<span id="cb138-432"><a href="#cb138-432" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb138-433"><a href="#cb138-433" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb138-434"><a href="#cb138-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb138-435"><a href="#cb138-435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per blocked.sum"</span>)</span>
<span id="cb138-436"><a href="#cb138-436" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-437"><a href="#cb138-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-438"><a href="#cb138-438" aria-hidden="true" tabindex="-1"></a>Distribution of blocked comments over time:</span>
<span id="cb138-439"><a href="#cb138-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-440"><a href="#cb138-440" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-441"><a href="#cb138-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-442"><a href="#cb138-442" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>blocked.sum, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb138-443"><a href="#cb138-443" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb138-444"><a href="#cb138-444" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number Blocked comments  per post "</span>, <span class="at">y =</span> <span class="st">"Number of blocked comments per post"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb138-445"><a href="#cb138-445" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb138-446"><a href="#cb138-446" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-447"><a href="#cb138-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-448"><a href="#cb138-448" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3. Creating a model for exit rate - all users engagement.</span></span>
<span id="cb138-449"><a href="#cb138-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-450"><a href="#cb138-450" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1 Basic model.</span></span>
<span id="cb138-451"><a href="#cb138-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-452"><a href="#cb138-452" aria-hidden="true" tabindex="-1"></a>I will start with entering all of the independent variable in the model</span>
<span id="cb138-453"><a href="#cb138-453" aria-hidden="true" tabindex="-1"></a>and then eliminating ones that are not significant.</span>
<span id="cb138-454"><a href="#cb138-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-455"><a href="#cb138-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-456"><a href="#cb138-456" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb138-457"><a href="#cb138-457" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> author.sum <span class="sc">+</span>n.comments <span class="sc">+</span>google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-458"><a href="#cb138-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-459"><a href="#cb138-459" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-460"><a href="#cb138-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-461"><a href="#cb138-461" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>,model<span class="fl">.2</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb138-462"><a href="#cb138-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-463"><a href="#cb138-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-464"><a href="#cb138-464" aria-hidden="true" tabindex="-1"></a>Elimination of non-significant factors slightly impacted coefficients of</span>
<span id="cb138-465"><a href="#cb138-465" aria-hidden="true" tabindex="-1"></a>significant variables, and did not change R\^2 or adjusted R\^2 much.</span>
<span id="cb138-466"><a href="#cb138-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-467"><a href="#cb138-467" aria-hidden="true" tabindex="-1"></a>My next step is to diagnoze this model:</span>
<span id="cb138-468"><a href="#cb138-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-469"><a href="#cb138-469" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2. Diagnostic of linear models:</span></span>
<span id="cb138-470"><a href="#cb138-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-471"><a href="#cb138-471" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-472"><a href="#cb138-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-473"><a href="#cb138-473" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-474"><a href="#cb138-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-475"><a href="#cb138-475" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.2</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb138-476"><a href="#cb138-476" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-477"><a href="#cb138-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-478"><a href="#cb138-478" aria-hidden="true" tabindex="-1"></a>We can see the issue with distribution of residuals in "Residuals vs</span>
<span id="cb138-479"><a href="#cb138-479" aria-hidden="true" tabindex="-1"></a>fitted" plot. This suggests non-linear relationship between variables. I</span>
<span id="cb138-480"><a href="#cb138-480" aria-hidden="true" tabindex="-1"></a>will transform some of my variables to see if that gives me a better</span>
<span id="cb138-481"><a href="#cb138-481" aria-hidden="true" tabindex="-1"></a>model:</span>
<span id="cb138-482"><a href="#cb138-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-483"><a href="#cb138-483" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-484"><a href="#cb138-484" aria-hidden="true" tabindex="-1"></a><span class="co">#original model</span></span>
<span id="cb138-485"><a href="#cb138-485" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-486"><a href="#cb138-486" aria-hidden="true" tabindex="-1"></a><span class="co"># Logging Google referrals</span></span>
<span id="cb138-487"><a href="#cb138-487" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-488"><a href="#cb138-488" aria-hidden="true" tabindex="-1"></a><span class="co"># squaring google referrals</span></span>
<span id="cb138-489"><a href="#cb138-489" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">I</span>(google<span class="sc">^</span><span class="dv">2</span>) <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-490"><a href="#cb138-490" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>, model<span class="fl">.2</span>, model<span class="fl">.3</span>,<span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb138-491"><a href="#cb138-491" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-492"><a href="#cb138-492" aria-hidden="true" tabindex="-1"></a>This table showing that google referrals are significant in either</span>
<span id="cb138-493"><a href="#cb138-493" aria-hidden="true" tabindex="-1"></a>form - squared or logged. However, its coefficient is much higher when</span>
<span id="cb138-494"><a href="#cb138-494" aria-hidden="true" tabindex="-1"></a>logged. Uniques variables's coefficient also changes significantly as I</span>
<span id="cb138-495"><a href="#cb138-495" aria-hidden="true" tabindex="-1"></a>am modifying google variable. That migh indicate interaction between</span>
<span id="cb138-496"><a href="#cb138-496" aria-hidden="true" tabindex="-1"></a>them.</span>
<span id="cb138-497"><a href="#cb138-497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-498"><a href="#cb138-498" aria-hidden="true" tabindex="-1"></a>Comparing diagnostic plots for model 2 (google logged) and  3 (google squared):</span>
<span id="cb138-499"><a href="#cb138-499" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-500"><a href="#cb138-500" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb138-501"><a href="#cb138-501" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.2</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-502"><a href="#cb138-502" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-503"><a href="#cb138-503" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-504"><a href="#cb138-504" aria-hidden="true" tabindex="-1"></a>These two plots show ineven distribution of residuals around zero line. To address it,  I will transform  the variables further. </span>
<span id="cb138-505"><a href="#cb138-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-506"><a href="#cb138-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-507"><a href="#cb138-507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-508"><a href="#cb138-508" aria-hidden="true" tabindex="-1"></a> First , I will log the rest of referral variables.</span>
<span id="cb138-509"><a href="#cb138-509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-510"><a href="#cb138-510" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-511"><a href="#cb138-511" aria-hidden="true" tabindex="-1"></a><span class="co">#original model</span></span>
<span id="cb138-512"><a href="#cb138-512" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-513"><a href="#cb138-513" aria-hidden="true" tabindex="-1"></a><span class="co"># all source variables are logged: </span></span>
<span id="cb138-514"><a href="#cb138-514" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span><span class="fu">log</span>(other.web) <span class="sc">+</span><span class="fu">log</span>(social) <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-515"><a href="#cb138-515" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>,model<span class="fl">.3</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb138-516"><a href="#cb138-516" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-517"><a href="#cb138-517" aria-hidden="true" tabindex="-1"></a>All referral sources except "other.web" and "social" show better fit</span>
<span id="cb138-518"><a href="#cb138-518" aria-hidden="true" tabindex="-1"></a>when logged. Moving forward I will use these variables not logeed.</span>
<span id="cb138-519"><a href="#cb138-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-520"><a href="#cb138-520" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-521"><a href="#cb138-521" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb138-522"><a href="#cb138-522" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.1</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-523"><a href="#cb138-523" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-524"><a href="#cb138-524" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-525"><a href="#cb138-525" aria-hidden="true" tabindex="-1"></a>We still observe curvi-linear distribution of residuals.</span>
<span id="cb138-526"><a href="#cb138-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-527"><a href="#cb138-527" aria-hidden="true" tabindex="-1"></a>Next, I will check if the referral variables have an ineraction with</span>
<span id="cb138-528"><a href="#cb138-528" aria-hidden="true" tabindex="-1"></a>popularity (Uniques)</span>
<span id="cb138-529"><a href="#cb138-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-530"><a href="#cb138-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-531"><a href="#cb138-531" aria-hidden="true" tabindex="-1"></a><span class="co"># last model</span></span>
<span id="cb138-532"><a href="#cb138-532" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span> other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-533"><a href="#cb138-533" aria-hidden="true" tabindex="-1"></a><span class="co"># adding interaction: </span></span>
<span id="cb138-534"><a href="#cb138-534" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-535"><a href="#cb138-535" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.3</span>,model<span class="fl">.4</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb138-536"><a href="#cb138-536" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-537"><a href="#cb138-537" aria-hidden="true" tabindex="-1"></a>Adding interaction between popularity and google referrals significcntly</span>
<span id="cb138-538"><a href="#cb138-538" aria-hidden="true" tabindex="-1"></a>improved the model: interaction term has negative correlation with</span>
<span id="cb138-539"><a href="#cb138-539" aria-hidden="true" tabindex="-1"></a>dependent variable, it also made "social" referrals significant, and</span>
<span id="cb138-540"><a href="#cb138-540" aria-hidden="true" tabindex="-1"></a>improved models R\^2 and adjusted R\^2.</span>
<span id="cb138-541"><a href="#cb138-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-542"><a href="#cb138-542" aria-hidden="true" tabindex="-1"></a>It also significantly changed distribution of residuals: now distribution is equally spread around 0.</span>
<span id="cb138-543"><a href="#cb138-543" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-544"><a href="#cb138-544" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb138-545"><a href="#cb138-545" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-546"><a href="#cb138-546" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-547"><a href="#cb138-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-548"><a href="#cb138-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-549"><a href="#cb138-549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-550"><a href="#cb138-550" aria-hidden="true" tabindex="-1"></a>Lets review other diagnostic plots:</span>
<span id="cb138-551"><a href="#cb138-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-552"><a href="#cb138-552" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-553"><a href="#cb138-553" aria-hidden="true" tabindex="-1"></a><span class="co"># last model</span></span>
<span id="cb138-554"><a href="#cb138-554" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-555"><a href="#cb138-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-556"><a href="#cb138-556" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb138-557"><a href="#cb138-557" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb138-558"><a href="#cb138-558" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb138-559"><a href="#cb138-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-560"><a href="#cb138-560" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb138-561"><a href="#cb138-561" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb138-562"><a href="#cb138-562" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb138-563"><a href="#cb138-563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-564"><a href="#cb138-564" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb138-565"><a href="#cb138-565" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb138-566"><a href="#cb138-566" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb138-567"><a href="#cb138-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-568"><a href="#cb138-568" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb138-569"><a href="#cb138-569" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb138-570"><a href="#cb138-570" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb138-571"><a href="#cb138-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-572"><a href="#cb138-572" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb138-573"><a href="#cb138-573" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb138-574"><a href="#cb138-574" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb138-575"><a href="#cb138-575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-576"><a href="#cb138-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-577"><a href="#cb138-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-578"><a href="#cb138-578" aria-hidden="true" tabindex="-1"></a>We can see from both models, that variable 231 is an outlier that</span>
<span id="cb138-579"><a href="#cb138-579" aria-hidden="true" tabindex="-1"></a>significantly impacts the model. I will remove that observation and</span>
<span id="cb138-580"><a href="#cb138-580" aria-hidden="true" tabindex="-1"></a>re-evaluate the model:</span>
<span id="cb138-581"><a href="#cb138-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-582"><a href="#cb138-582" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-583"><a href="#cb138-583" aria-hidden="true" tabindex="-1"></a>merged.old <span class="ot">&lt;-</span> merged</span>
<span id="cb138-584"><a href="#cb138-584" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">231</span>), ]</span>
<span id="cb138-585"><a href="#cb138-585" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged.old)</span>
<span id="cb138-586"><a href="#cb138-586" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-587"><a href="#cb138-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-588"><a href="#cb138-588" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.4</span>,model<span class="fl">.5</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb138-589"><a href="#cb138-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-590"><a href="#cb138-590" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb138-591"><a href="#cb138-591" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-592"><a href="#cb138-592" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-593"><a href="#cb138-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-594"><a href="#cb138-594" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb138-595"><a href="#cb138-595" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb138-596"><a href="#cb138-596" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb138-597"><a href="#cb138-597" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-598"><a href="#cb138-598" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb138-599"><a href="#cb138-599" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb138-600"><a href="#cb138-600" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb138-601"><a href="#cb138-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-602"><a href="#cb138-602" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb138-603"><a href="#cb138-603" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb138-604"><a href="#cb138-604" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb138-605"><a href="#cb138-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-606"><a href="#cb138-606" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb138-607"><a href="#cb138-607" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb138-608"><a href="#cb138-608" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb138-609"><a href="#cb138-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-610"><a href="#cb138-610" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb138-611"><a href="#cb138-611" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb138-612"><a href="#cb138-612" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb138-613"><a href="#cb138-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-614"><a href="#cb138-614" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb138-615"><a href="#cb138-615" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb138-616"><a href="#cb138-616" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb138-617"><a href="#cb138-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-618"><a href="#cb138-618" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-619"><a href="#cb138-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-620"><a href="#cb138-620" aria-hidden="true" tabindex="-1"></a>New, the variable "other.web" became unsignificant, but model fit</span>
<span id="cb138-621"><a href="#cb138-621" aria-hidden="true" tabindex="-1"></a>improved.</span>
<span id="cb138-622"><a href="#cb138-622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-623"><a href="#cb138-623" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3. Improved model.</span></span>
<span id="cb138-624"><a href="#cb138-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-625"><a href="#cb138-625" aria-hidden="true" tabindex="-1"></a>I will check whether other referral sources have an interaction with</span>
<span id="cb138-626"><a href="#cb138-626" aria-hidden="true" tabindex="-1"></a>popularity:</span>
<span id="cb138-627"><a href="#cb138-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-628"><a href="#cb138-628" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-629"><a href="#cb138-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-630"><a href="#cb138-630" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-631"><a href="#cb138-631" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span> <span class="fu">log</span>(direct) <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span>other.web <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span>social <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(bdc)  <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-632"><a href="#cb138-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-633"><a href="#cb138-633" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span> <span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-634"><a href="#cb138-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-635"><a href="#cb138-635" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.5</span>,model<span class="fl">.6</span>, model<span class="fl">.7</span> , <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb138-636"><a href="#cb138-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-637"><a href="#cb138-637" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb138-638"><a href="#cb138-638" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-639"><a href="#cb138-639" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-640"><a href="#cb138-640" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb138-641"><a href="#cb138-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-642"><a href="#cb138-642" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb138-643"><a href="#cb138-643" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb138-644"><a href="#cb138-644" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb138-645"><a href="#cb138-645" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb138-646"><a href="#cb138-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-647"><a href="#cb138-647" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb138-648"><a href="#cb138-648" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb138-649"><a href="#cb138-649" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb138-650"><a href="#cb138-650" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb138-651"><a href="#cb138-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-652"><a href="#cb138-652" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb138-653"><a href="#cb138-653" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb138-654"><a href="#cb138-654" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb138-655"><a href="#cb138-655" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb138-656"><a href="#cb138-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-657"><a href="#cb138-657" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb138-658"><a href="#cb138-658" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb138-659"><a href="#cb138-659" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb138-660"><a href="#cb138-660" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb138-661"><a href="#cb138-661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-662"><a href="#cb138-662" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>))</span>
<span id="cb138-663"><a href="#cb138-663" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.5</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb138-664"><a href="#cb138-664" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.6</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb138-665"><a href="#cb138-665" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb138-666"><a href="#cb138-666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-667"><a href="#cb138-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-668"><a href="#cb138-668" aria-hidden="true" tabindex="-1"></a>All models have similar R\^2 and adjusted R\^2. However, the last model</span>
<span id="cb138-669"><a href="#cb138-669" aria-hidden="true" tabindex="-1"></a>(model.7) best accounts for all source variables.</span>
<span id="cb138-670"><a href="#cb138-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-671"><a href="#cb138-671" aria-hidden="true" tabindex="-1"></a>Calculation of AIC and BIC:</span>
<span id="cb138-672"><a href="#cb138-672" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-673"><a href="#cb138-673" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-674"><a href="#cb138-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-675"><a href="#cb138-675" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model<span class="fl">.5</span>) </span>
<span id="cb138-676"><a href="#cb138-676" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model<span class="fl">.6</span>) </span>
<span id="cb138-677"><a href="#cb138-677" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model<span class="fl">.7</span>) </span>
<span id="cb138-678"><a href="#cb138-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-679"><a href="#cb138-679" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model<span class="fl">.5</span>) </span>
<span id="cb138-680"><a href="#cb138-680" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model<span class="fl">.6</span>) </span>
<span id="cb138-681"><a href="#cb138-681" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model<span class="fl">.7</span>) </span>
<span id="cb138-682"><a href="#cb138-682" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-683"><a href="#cb138-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-684"><a href="#cb138-684" aria-hidden="true" tabindex="-1"></a>AIC and BIC are very close to each other in all three models.</span>
<span id="cb138-685"><a href="#cb138-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-686"><a href="#cb138-686" aria-hidden="true" tabindex="-1"></a>To summarize, the model <span class="sc">\#</span> 7 demonstrated the best fit with high R\^2</span>
<span id="cb138-687"><a href="#cb138-687" aria-hidden="true" tabindex="-1"></a>value and good results in diagnostic plots.</span>
<span id="cb138-688"><a href="#cb138-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-689"><a href="#cb138-689" aria-hidden="true" tabindex="-1"></a>Te resulting model of my analysis is:</span>
<span id="cb138-690"><a href="#cb138-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-691"><a href="#cb138-691" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-692"><a href="#cb138-692" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(model<span class="fl">.7</span>)</span>
<span id="cb138-693"><a href="#cb138-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-694"><a href="#cb138-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-695"><a href="#cb138-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-696"><a href="#cb138-696" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4. Model for N.comments - loyal readers engagement:</span></span>
<span id="cb138-697"><a href="#cb138-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-698"><a href="#cb138-698" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.1. Basic model for n.comments</span></span>
<span id="cb138-699"><a href="#cb138-699" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-700"><a href="#cb138-700" aria-hidden="true" tabindex="-1"></a>Now as I have created a model for exit rate, I will do the same for</span>
<span id="cb138-701"><a href="#cb138-701" aria-hidden="true" tabindex="-1"></a>n.comments as dependent variable, which represents the measurement of</span>
<span id="cb138-702"><a href="#cb138-702" aria-hidden="true" tabindex="-1"></a>engagement of loyal readers.</span>
<span id="cb138-703"><a href="#cb138-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-704"><a href="#cb138-704" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-705"><a href="#cb138-705" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-706"><a href="#cb138-706" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(merged)</span>
<span id="cb138-707"><a href="#cb138-707" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(n.comments <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> author.sum <span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged))</span>
<span id="cb138-708"><a href="#cb138-708" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb138-709"><a href="#cb138-709" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> author.sum <span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-710"><a href="#cb138-710" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span> Uniques<span class="sc">+</span> author.sum <span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-711"><a href="#cb138-711" aria-hidden="true" tabindex="-1"></a><span class="co">#removing unsignificant variables:</span></span>
<span id="cb138-712"><a href="#cb138-712" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-713"><a href="#cb138-713" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>,model<span class="fl">.2</span>, model<span class="fl">.3</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb138-714"><a href="#cb138-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-715"><a href="#cb138-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-716"><a href="#cb138-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-717"><a href="#cb138-717" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.2. Diagnostics:</span></span>
<span id="cb138-718"><a href="#cb138-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-719"><a href="#cb138-719" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-720"><a href="#cb138-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-721"><a href="#cb138-721" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-722"><a href="#cb138-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-723"><a href="#cb138-723" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb138-724"><a href="#cb138-724" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb138-725"><a href="#cb138-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-726"><a href="#cb138-726" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-727"><a href="#cb138-727" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-728"><a href="#cb138-728" aria-hidden="true" tabindex="-1"></a>Observation #48 looks like on outlier impacting the model. I will remove</span>
<span id="cb138-729"><a href="#cb138-729" aria-hidden="true" tabindex="-1"></a>this observation to see if that gives us any different results:</span>
<span id="cb138-730"><a href="#cb138-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-731"><a href="#cb138-731" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-732"><a href="#cb138-732" aria-hidden="true" tabindex="-1"></a>merged.old <span class="ot">&lt;-</span> merged</span>
<span id="cb138-733"><a href="#cb138-733" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">48</span>), ]</span>
<span id="cb138-734"><a href="#cb138-734" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged.old )</span>
<span id="cb138-735"><a href="#cb138-735" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb138-736"><a href="#cb138-736" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.3</span>, model<span class="fl">.4</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb138-737"><a href="#cb138-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-738"><a href="#cb138-738" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-739"><a href="#cb138-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-740"><a href="#cb138-740" aria-hidden="true" tabindex="-1"></a>We can see that removing #48 changed some coefficients, did not impact</span>
<span id="cb138-741"><a href="#cb138-741" aria-hidden="true" tabindex="-1"></a>significance of variables. It also improved R\^2 and adjusted R\^2.</span>
<span id="cb138-742"><a href="#cb138-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-743"><a href="#cb138-743" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-744"><a href="#cb138-744" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb138-745"><a href="#cb138-745" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb138-746"><a href="#cb138-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-747"><a href="#cb138-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-748"><a href="#cb138-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-749"><a href="#cb138-749" aria-hidden="true" tabindex="-1"></a><span class="fu">### 4.3. QUESTION - do i need to improve mod fit here ?</span></span>
<span id="cb138-750"><a href="#cb138-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-751"><a href="#cb138-751" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4. Conlusion</span></span>
<span id="cb138-752"><a href="#cb138-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-753"><a href="#cb138-753" aria-hidden="true" tabindex="-1"></a>We have build two models for different engagement metrics: engagement of</span>
<span id="cb138-754"><a href="#cb138-754" aria-hidden="true" tabindex="-1"></a>all readers and engagement of loyal readers. As we can see from the</span>
<span id="cb138-755"><a href="#cb138-755" aria-hidden="true" tabindex="-1"></a>models, different factors contribute to engagement of these two groups</span>
<span id="cb138-756"><a href="#cb138-756" aria-hidden="true" tabindex="-1"></a>of readers:</span>
<span id="cb138-757"><a href="#cb138-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-758"><a href="#cb138-758" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb138-759"><a href="#cb138-759" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.7</span>, model<span class="fl">.4</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb138-760"><a href="#cb138-760" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb138-761"><a href="#cb138-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-762"><a href="#cb138-762" aria-hidden="true" tabindex="-1"></a>We can see, that different referral sourses contribute to users</span>
<span id="cb138-763"><a href="#cb138-763" aria-hidden="true" tabindex="-1"></a>engagement. While all readers'engagement (measured with exit rate) is</span>
<span id="cb138-764"><a href="#cb138-764" aria-hidden="true" tabindex="-1"></a>influenced by interaction of referrals from Google and Direct and</span>
<span id="cb138-765"><a href="#cb138-765" aria-hidden="true" tabindex="-1"></a>popularity, internal bdc referrals and somewhat referrals from other web</span>
<span id="cb138-766"><a href="#cb138-766" aria-hidden="true" tabindex="-1"></a>sources, loyal readers' engagement is highly impacted by the mood pf the</span>
<span id="cb138-767"><a href="#cb138-767" aria-hidden="true" tabindex="-1"></a>post, internal page referrals, social referrals. Thhey also show some</span>
<span id="cb138-768"><a href="#cb138-768" aria-hidden="true" tabindex="-1"></a>direct referrals' impact, but very small in compare with its influence</span>
<span id="cb138-769"><a href="#cb138-769" aria-hidden="true" tabindex="-1"></a>on all users' engagement.</span>
<span id="cb138-770"><a href="#cb138-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-771"><a href="#cb138-771" aria-hidden="true" tabindex="-1"></a>We also see significant contibution of day of the week on readers</span>
<span id="cb138-772"><a href="#cb138-772" aria-hidden="true" tabindex="-1"></a>engagement. Specifically, Monday's engagement of all readers is</span>
<span id="cb138-773"><a href="#cb138-773" aria-hidden="true" tabindex="-1"></a>significantly higher than any other day. For loyal readers, Wednesday</span>
<span id="cb138-774"><a href="#cb138-774" aria-hidden="true" tabindex="-1"></a>showing thee lowest engagement.</span>
<span id="cb138-775"><a href="#cb138-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb138-776"><a href="#cb138-776" aria-hidden="true" tabindex="-1"></a>It also important to point out, that popularity of the post (Uniques)</span>
<span id="cb138-777"><a href="#cb138-777" aria-hidden="true" tabindex="-1"></a>only plays a role for all user's engagement. Loyal readers appear not</span>
<span id="cb138-778"><a href="#cb138-778" aria-hidden="true" tabindex="-1"></a>being impacted by popularity.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>