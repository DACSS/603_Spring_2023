<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Diana Rinker">
<meta name="dcterms.date" content="2023-05-18">
<meta name="description" content="Final project DACSS 603">

<title>Final Project</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta name="twitter:title" content="Final Project">
<meta name="twitter:description" content="Final project DACSS 603">
<meta name="twitter:image" content="https://dacss.github.io/603_Spring_2023/posts/Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-4-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target="">
 <span class="menu-text">Spring 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dacss-603-spring-2023" id="toc-dacss-603-spring-2023" class="nav-link active" data-scroll-target="#dacss-603-spring-2023">DACSS 603, Spring 2023</a></li>
  <li><a href="#final-project-diana-rinker." id="toc-final-project-diana-rinker." class="nav-link" data-scroll-target="#final-project-diana-rinker.">Final Project, Diana Rinker.</a></li>
  <li><a href="#online-engagement." id="toc-online-engagement." class="nav-link" data-scroll-target="#online-engagement.">Online engagement.</a></li>
  <li><a href="#introduction." id="toc-introduction." class="nav-link" data-scroll-target="#introduction.">Introduction.</a></li>
  <li><a href="#research-question-and-hypothesis." id="toc-research-question-and-hypothesis." class="nav-link" data-scroll-target="#research-question-and-hypothesis.">Research Question and hypothesis.</a>
  <ul class="collapse">
  <li><a href="#data-source-and-description." id="toc-data-source-and-description." class="nav-link" data-scroll-target="#data-source-and-description.">Data source and description.</a></li>
  </ul></li>
  <li><a href="#dv-engagement." id="toc-dv-engagement." class="nav-link" data-scroll-target="#dv-engagement.">1.DV: engagement.</a>
  <ul class="collapse">
  <li><a href="#exit-rate" id="toc-exit-rate" class="nav-link" data-scroll-target="#exit-rate">Exit rate</a></li>
  <li><a href="#number-of-comments" id="toc-number-of-comments" class="nav-link" data-scroll-target="#number-of-comments">Number of comments:</a></li>
  </ul></li>
  <li><a href="#iv.-independent-variables" id="toc-iv.-independent-variables" class="nav-link" data-scroll-target="#iv.-independent-variables">2.IV. Independent variables:</a>
  <ul class="collapse">
  <li><a href="#popularity" id="toc-popularity" class="nav-link" data-scroll-target="#popularity">2.1.Popularity</a></li>
  <li><a href="#referral-sources." id="toc-referral-sources." class="nav-link" data-scroll-target="#referral-sources.">2.2. Referral sources.</a></li>
  <li><a href="#post-weekdays" id="toc-post-weekdays" class="nav-link" data-scroll-target="#post-weekdays">2.3. Post weekdays</a></li>
  <li><a href="#authors-comments" id="toc-authors-comments" class="nav-link" data-scroll-target="#authors-comments">2.4. Authors comments</a></li>
  <li><a href="#mood-of-the-post." id="toc-mood-of-the-post." class="nav-link" data-scroll-target="#mood-of-the-post.">2.5. Mood of the post.</a></li>
  <li><a href="#blocked-comments-per-post." id="toc-blocked-comments-per-post." class="nav-link" data-scroll-target="#blocked-comments-per-post.">2.6. Blocked comments per post.</a></li>
  </ul></li>
  <li><a href="#creating-a-model-for-exit-rate---all-users-engagement." id="toc-creating-a-model-for-exit-rate---all-users-engagement." class="nav-link" data-scroll-target="#creating-a-model-for-exit-rate---all-users-engagement.">3. Creating a model for exit rate - all users engagement.</a>
  <ul class="collapse">
  <li><a href="#basic-model." id="toc-basic-model." class="nav-link" data-scroll-target="#basic-model.">3.1 Basic model.</a></li>
  <li><a href="#diagnostic-of-linear-models" id="toc-diagnostic-of-linear-models" class="nav-link" data-scroll-target="#diagnostic-of-linear-models">3.2. Diagnostic of linear models:</a></li>
  <li><a href="#improved-model-model.9-." id="toc-improved-model-model.9-." class="nav-link" data-scroll-target="#improved-model-model.9-.">3.3. Improved model (model.9) .</a></li>
  <li><a href="#visualizing-interaction" id="toc-visualizing-interaction" class="nav-link" data-scroll-target="#visualizing-interaction">3.4. Visualizing interaction:</a></li>
  <li><a href="#moderating-impact-of-direct-referrals-on-relationship-between-popularity-and-engagement" id="toc-moderating-impact-of-direct-referrals-on-relationship-between-popularity-and-engagement" class="nav-link" data-scroll-target="#moderating-impact-of-direct-referrals-on-relationship-between-popularity-and-engagement">Moderating impact of direct referrals on relationship between popularity and engagement:</a></li>
  </ul></li>
  <li><a href="#model-for-n.comments---loyal-readers-engagement" id="toc-model-for-n.comments---loyal-readers-engagement" class="nav-link" data-scroll-target="#model-for-n.comments---loyal-readers-engagement">4. Model for N.comments - loyal readers engagement:</a>
  <ul class="collapse">
  <li><a href="#basic-model-for-n.comments" id="toc-basic-model-for-n.comments" class="nav-link" data-scroll-target="#basic-model-for-n.comments">4.1. Basic model for n.comments</a></li>
  <li><a href="#diagnostics" id="toc-diagnostics" class="nav-link" data-scroll-target="#diagnostics">4.2. Diagnostics:</a></li>
  </ul></li>
  <li><a href="#conlusion" id="toc-conlusion" class="nav-link" data-scroll-target="#conlusion">4. Conlusion</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>

<div>
  <div class="description">
    Final project DACSS 603
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Diana Rinker </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">May 18, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="dacss-603-spring-2023" class="level2">
<h2 class="anchored" data-anchor-id="dacss-603-spring-2023">DACSS 603, Spring 2023</h2>
</section>
<section id="final-project-diana-rinker." class="level2">
<h2 class="anchored" data-anchor-id="final-project-diana-rinker.">Final Project, Diana Rinker.</h2>
</section>
<section id="online-engagement." class="level2">
<h2 class="anchored" data-anchor-id="online-engagement.">Online engagement.</h2>
</section>
<section id="introduction." class="level1">
<h1>Introduction.</h1>
<p>It is well known that online engagement with the web resource is a highly valuable metric and is contributing to the site revenue. This research project is exploring which factors contribute to users online engagement.I used the data of an online blog hosted by the news website. The author of this blog is posting articles about interpersonal relationships every work day (Mon- Fri). The posts are formulated as a letter from a reader with the situation and a question about relationships. The author gives an advice about the situation. Website readers are free to comment under each post, but cannot make their own posts.</p>
<p>All post methadata and comments are public. They are saved by the website and available for the analysis. Using this data set, I will explore how readers’ engagement connected with blog author’s engagement, site comments, views’ web source, post reactions, and blocked comments.</p>
</section>
<section id="research-question-and-hypothesis." class="level1">
<h1>Research Question and hypothesis.</h1>
<p><strong>RQ:</strong> Which factors influence user’s engagement in online blog?</p>
<p><strong>Hypothesis:</strong> Loyal readers’ and all readers’ engagement are impacted by the same factors.</p>
<p><strong>DV:</strong> My dependent construct is <strong>“user’s engagement</strong>”, I will measure users’ engagement at the level of individual post, using the following metrics:</p>
<p>1. Exit rate or “bounces”. When the visitor is coming to the page and then leaving, i.e.&nbsp;not opening other pages on this website. this will represent all readers.</p>
<p>2. Number of comments - is engagement metric, representing only loyal readers, who have created an account and signed in.</p>
<p><strong>IV:</strong> My main independent variables are</p>
<ol type="1">
<li>Post popularity. Unique users - number of unique people viewed the post.</li>
<li>Source of the readers - which web page the reader came from. This is represented by 6 different variables, each is continuous type.</li>
<li>Mood of the conversation , derivative continuous variable calculated as the percentage of “likes” to all emotions (sum of thumbs up and thumbs down). It ranges from 0 to 1.</li>
<li>Blocked and flagged comments.</li>
<li>Number of author’s comments.</li>
<li>Weekday of the post.</li>
</ol>
<div class="cell">
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ tibble  3.1.8     ✔ purrr   1.0.1
✔ tidyr   1.3.0     ✔ stringr 1.5.0
✔ readr   2.1.4     ✔ forcats 1.0.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()

Attaching package: 'gridExtra'


The following object is masked from 'package:dplyr':

    combine



Please cite as: 


 Hlavac, Marek (2022). stargazer: Well-Formatted Regression and Summary Statistics Tables.

 R package version 5.2.3. https://CRAN.R-project.org/package=stargazer 



Attaching package: 'lubridate'


The following objects are masked from 'package:base':

    date, intersect, setdiff, union</code></pre>
</div>
</div>
<section id="data-source-and-description." class="level3">
<h3 class="anchored" data-anchor-id="data-source-and-description.">Data source and description.</h3>
<p>To answer my research question I will use two datasets. The first data set has information about all comments associated with each post by post ID. The second data set is analytics data for the web page. It contains one post per row and variables describe each post as a whole without breaking down to the comment level.</p>
<p>In this project I will analyze posts for January 2022 - March 2023. Here is the list of variables in each data set:</p>
<p>A. Comments data:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "C:/Users/Diana/OneDrive - University Of Massachusetts Medical School/Documents/R/R working directory/DACSS/603/603_Spring_2023/posts"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co"># First, I will load the data set with the comment level data:</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>raw <span class="ot">&lt;-</span> <span class="fu">as_tibble</span> (<span class="fu">read_csv</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Diana</span><span class="sc">\\</span><span class="st">OneDrive - University Of Massachusetts Medical School</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">R working directory</span><span class="sc">\\</span><span class="st">DACSS</span><span class="sc">\\</span><span class="st">603</span><span class="sc">\\</span><span class="st">my study files for dacss603</span><span class="sc">\\</span><span class="st">globe</span><span class="sc">\\</span><span class="st"> data.2021.plus.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 105136 Columns: 17
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr  (6): content, user_name, display_name, image_url, email, approved
dbl  (7): message_id, post_id, user_id, parent, absolute_likes, absolute_dis...
lgl  (3): email_verified, created_at, private_profile
dttm (1): written_at

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>comments.data<span class="ot">&lt;-</span>raw </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span> (comments.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "content"           "message_id"        "post_id"          
 [4] "user_id"           "user_name"         "display_name"     
 [7] "image_url"         "email"             "email_verified"   
[10] "created_at"        "private_profile"   "approved"         
[13] "written_at"        "parent"            "absolute_likes"   
[16] "absolute_dislikes" "comment.year"     </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(comments.data<span class="sc">$</span>written_at)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "2021-01-01 08:28:44 UTC" "2021-01-01 08:57:08 UTC"
[3] "2021-01-01 10:36:58 UTC" "2021-01-01 11:13:13 UTC"
[5] "2021-01-01 12:27:44 UTC" "2021-01-01 12:51:48 UTC"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>comments.data <span class="ot">&lt;-</span>comments.data<span class="sc">%&gt;%</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">com.year =</span> <span class="fu">format</span>(written_at,<span class="at">format =</span> <span class="st">"%Y"</span> ))</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="co"># range(comments.data$com.year)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(comments.data)</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(comments.data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [105,136 × 18] (S3: tbl_df/tbl/data.frame)
 $ content          : chr [1:105136] "08:15  Dawn of the 21st year of the 21st century&lt;br/&gt;&amp;quot;21st Century Schizoid Man&amp;quot;  on the BOSE" "Liz:  😄" "Happy New Year to all y'all. And Ms. G, thank you for letting me play for another year playing in your sandbox." "Blog needs a new name - Hate Letters" ...
 $ message_id       : num [1:105136] 1.15e+08 1.15e+08 1.15e+08 1.15e+08 1.15e+08 ...
 $ post_id          : num [1:105136] 27071015 27071015 27071009 27071009 27071009 ...
 $ user_id          : num [1:105136] 2889100 1855822 5133556 5156343 5560421 ...
 $ user_name        : chr [1:105136] "Lefty49" "JacquiSmith" "Bzznlike-crazyman" "--SnowMan--" ...
 $ display_name     : chr [1:105136] "Lefty49" "JacquiSmith" "Bzznlike-crazyman" "--SnowMan--" ...
 $ image_url        : chr [1:105136] "https://u.o0bc.com/avatars/48/121/77/5077296.png?35" "https://u.o0bc.com/avatars/41/194/84/5554729.png?47" "https://u.o0bc.com/avatars/85/175/84/5549909.png?9" "https://u.o0bc.com/avatars/64/191/84/5553984.png?5" ...
 $ email            : chr [1:105136] "danwalker1949@aol.com" "amcr1124@comcast.net" "eflynn105@yahoo.com" "markedoc@yahoo.com" ...
 $ email_verified   : logi [1:105136] FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ created_at       : logi [1:105136] NA NA NA NA NA NA ...
 $ private_profile  : logi [1:105136] FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ approved         : chr [1:105136] "approved" "approved" "approved" "approved" ...
 $ written_at       : POSIXct[1:105136], format: "2021-01-01 08:28:44" "2021-01-01 08:57:08" ...
 $ parent           : num [1:105136] NA 1.15e+08 NA NA 1.15e+08 ...
 $ absolute_likes   : num [1:105136] 2 0 14 7 7 7 4 3 2 4 ...
 $ absolute_dislikes: num [1:105136] 1 0 1 0 1 1 1 1 1 0 ...
 $ comment.year     : num [1:105136] 2021 2021 2021 2021 2021 ...
 $ com.year         : chr [1:105136] "2021" "2021" "2021" "2021" ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>comments.data <span class="ot">&lt;-</span> comments.data<span class="sc">%&gt;%</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(written_at  <span class="sc">&gt;=</span> <span class="st">"2022-01-01"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>B. Post data:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Second, loadng post-level data :</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">as_tibble</span> (<span class="fu">read_csv</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Diana</span><span class="sc">\\</span><span class="st">OneDrive - University Of Massachusetts Medical School</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">R working directory</span><span class="sc">\\</span><span class="st">DACSS</span><span class="sc">\\</span><span class="st">603</span><span class="sc">\\</span><span class="st">my study files for dacss603</span><span class="sc">\\</span><span class="st">globe</span><span class="sc">\\</span><span class="st">data.merged.csv"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Rows: 535 Columns: 23
── Column specification ────────────────────────────────────────────────────────
Delimiter: ","
chr   (3): Letter, Exit rate, post.month
dbl  (18): Page views, Search + amp referral visits, Direct (non-email) refe...
num   (1): Visits when post was on LL HP
date  (1): post.date

ℹ Use `spec()` to retrieve the full column specification for this data.
ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>tibble [535 × 23] (S3: tbl_df/tbl/data.frame)
 $ post.date                         : Date[1:535], format: "2021-01-04" "2021-01-05" ...
 $ Letter                            : chr [1:535] "love letters | blog | I don&amp;'t want him to let me go" "love letters | blog | Should I be working to get her back?" "love letters | blog | I&amp;'m sick of thinking about the breakup" "love letters | blog | I don&amp;'t want to be selfish about 2020 Christmas" ...
 $ Page views                        : num [1:535] 14830 12067 11921 12817 12866 ...
 $ Search + amp referral visits      : num [1:535] 1005 822 793 765 934 ...
 $ Direct (non-email) referral visits: num [1:535] 10005 7948 7997 8746 8400 ...
 $ Visits                            : num [1:535] 12998 10391 10331 11040 10818 ...
 $ Uniques                           : num [1:535] 11453 8985 8917 9662 8564 ...
 $ Other website referral visits     : num [1:535] 129 232 106 152 139 153 165 157 85 151 ...
 $ Social referral visits            : num [1:535] 457 94 156 106 113 368 90 171 84 129 ...
 $ BDC referral visits               : num [1:535] 7087 5312 5185 5901 4570 ...
 $ Visits when post was on LL HP     : num [1:535] 3167 3323 2929 3056 4795 ...
 $ Exits                             : num [1:535] 9679 7549 7613 8188 7900 ...
 $ Exit rate                         : chr [1:535] "74%" "73%" "74%" "74%" ...
 $ dup                               : num [1:535] 0 0 0 0 0 0 0 0 0 0 ...
 $ post_id                           : num [1:535] 27071003 27070997 27070991 27070985 27070979 ...
 $ n.comments                        : num [1:535] 267 207 266 372 319 267 337 154 179 375 ...
 $ post.year                         : num [1:535] 2021 2021 2021 2021 2021 ...
 $ post.month                        : chr [1:535] "01" "01" "01" "01" ...
 $ post.likes                        : num [1:535] 1440 864 936 1497 1145 ...
 $ post.dislikes                     : num [1:535] 72 106 96 520 154 188 150 62 106 150 ...
 $ post.total.likes                  : num [1:535] 1512 970 1032 2017 1299 ...
 $ blocked.sum                       : num [1:535] 1 2 3 9 2 3 4 0 3 3 ...
 $ pct.positive                      : num [1:535] 95.2 89.1 90.7 74.2 88.1 ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Limiting the dataset to 2022: </span></span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged<span class="sc">%&gt;%</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(post.date  <span class="sc">&gt;=</span>  <span class="st">"2022-01-01"</span>)</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Due to dataset of comments having more data than post dataset,  I will cut them to match: </span></span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (<span class="sc">!</span><span class="fu">is.na</span>(merged<span class="sc">$</span>pct.positive))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>To begin, I will review available variables and evaluate to identify a metric for each construct in my study.</p>
</section>
</section>
<section id="dv-engagement." class="level1">
<h1>1.DV: engagement.</h1>
<section id="exit-rate" class="level2">
<h2 class="anchored" data-anchor-id="exit-rate">Exit rate</h2>
<p>This variable is measuring how many people visited the page and then left the website after the first view. This metric is the best measure of engagement for all users, as it represents the first step after being exposed to the post - either quitting the site or remaining on the site.</p>
<p>Here can see the distribution of this variable :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(merged)</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">e.rate =</span> Exits<span class="sc">/</span><span class="st">`</span><span class="at">Page views</span><span class="st">`</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span> (merged, <span class="st">`</span><span class="at">Exit rate</span><span class="st">`</span>, e.rate)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 287 × 2
   `Exit rate` e.rate
   &lt;chr&gt;        &lt;dbl&gt;
 1 76%          0.675
 2 79%          0.703
 3 86%          0.791
 4 68%          0.600
 5 75%          0.665
 6 76%          0.678
 7 83%          0.751
 8 88%          0.804
 9 91%          0.836
10 72%          0.620
# … with 277 more rows</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merged$`Exit rate` &lt;- as.numeric(sub("%", "", merged$`Exit rate`)) / 100</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>e.rate))<span class="sc">+</span></span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">fill =</span> <span class="st">"sandybrown"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Distribution of exit rate over time:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># creating  year_month  variable </span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>post.month <span class="ot">&lt;-</span><span class="fu">as.numeric</span>(merged<span class="sc">$</span>post.month)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>year_month <span class="ot">&lt;-</span> <span class="fu">paste0</span>(merged<span class="sc">$</span>post.year, <span class="st">"-"</span>, <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, merged<span class="sc">$</span>post.month))</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span><span class="st">`</span><span class="at">e.rate</span><span class="st">`</span>, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of `Exit rate` per post "</span>, <span class="at">y =</span> <span class="st">"Exit rate"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="number-of-comments" class="level2">
<h2 class="anchored" data-anchor-id="number-of-comments">Number of comments:</h2>
<p>This is an engagement metric for loyal readers - people who created an account and can comment.</p>
<p>Commenting requires user to log in, which is an indicator of greater engagement of an individual user. Therefore this variable represents engagement of a subset of users (“loyal readers”).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merged$year_month </span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>n.comments))<span class="sc">+</span></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"seagreen4"</span>)<span class="sc">+</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments histogram"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>And change in the distribution over time:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>n.comments, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of comments per post "</span>, <span class="at">y =</span> <span class="st">"Number of comments"</span> )<span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span> (<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span> <span class="dv">10000</span>, <span class="at">by=</span> <span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="iv.-independent-variables" class="level1">
<h1>2.IV. Independent variables:</h1>
<section id="popularity" class="level3">
<h3 class="anchored" data-anchor-id="popularity">2.1.Popularity</h3>
<p>“Uniques” variable represents number of unique people who came to the page and viewed it at least once. This metric represents popularity of the post. It has Poisson distribution:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Uniques))<span class="sc">+</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"purple2"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see a long tail on the right, showing that there is a number of posts who are way more popular than the majority of the sample. Distribution of popularity over time also showing significant variance:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>Uniques, <span class="at">x=</span>merged<span class="sc">$</span>year_month))<span class="sc">+</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of unique viewers per month"</span>, <span class="at">x=</span><span class="st">"Month"</span>, <span class="at">y=</span><span class="st">"Number of unique viewers"</span>)<span class="sc">+</span> </span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Warning: Use of `merged$year_month` is discouraged.
ℹ Use `year_month` instead.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p><br>
Next plot is illustrating connection between popularity and engagement metrics:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (merged, <span class="at">select=</span><span class="fu">c</span>(Uniques, e.rate, n.comments )))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that popularity strongly correlated with exit rate, where an increase in popularity causes decrease of engagement. It is not as strongly correlated with number of comments. Engagement rate and number of comments don’t show obvious pattern between each other.</p>
</section>
<section id="referral-sources." class="level3">
<h3 class="anchored" data-anchor-id="referral-sources.">2.2. Referral sources.</h3>
<p>The website analytics provides information on where the viewers are coming from to the blog page. For example, if people clicked on the blog link posted on FaceBook, that would be referral from social media. If people clicked on the blog link within BDC website, that would be “BDC referral visit”.</p>
<p>There are 5 sources of referrals, each corresponding with a variable in the data set. Variable’s value is a number of visits from this referral source.</p>
<pre><code>"Search + amp referral visits"
"Direct (non-email) referral visits"
"Other website referral visits"
"Social referral visits"
"BDC referral visits"
"Visits when post was on LL HP" </code></pre>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co">#renaming variables for convenience: </span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>merged<span class="ot">&lt;-</span>merged<span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">google =</span><span class="st">"Search + amp referral visits"</span>,</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>         <span class="at">direct =</span><span class="st">"Direct (non-email) referral visits"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">other.web =</span> <span class="st">"Other website referral visits"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">social=</span> <span class="st">"Social referral visits"</span>,</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>          <span class="at">bdc=</span> <span class="st">"BDC referral visits"</span>,</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>          <span class="at">ll=</span> <span class="st">"Visits when post was on LL HP"</span> )</span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>post.date))<span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>google), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>direct), <span class="at">color=</span><span class="st">"green"</span>)<span class="sc">+</span></span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>other.web), <span class="at">color=</span><span class="st">"yellow"</span>)<span class="sc">+</span></span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>social), <span class="at">color=</span><span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>bdc), <span class="at">color=</span><span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>ll), <span class="at">color=</span><span class="st">"pink"</span>)  <span class="sc">+</span></span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Referral sources per post "</span>, <span class="at">y =</span> <span class="st">"Number of referrals"</span> , <span class="at">x=</span><span class="st">"Post"</span>)<span class="sc">+</span> </span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"purple"</span>, <span class="st">"blue"</span>, <span class="st">"pink"</span>),</span>
<span id="cb34-19"><a href="#cb34-19" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Google"</span>, <span class="st">"Direct"</span>, <span class="st">"Other Web"</span>, <span class="st">"Social"</span>, <span class="st">"Bdc"</span>, <span class="st">"LL"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph is showing of “Search + amp referral visits” have high variability. Other referral sources range is much smaller. Here is the plot of direct referrals per exit rate and goolge per exit rate:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>direct , <span class="at">y=</span>e.rate))<span class="sc">+</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Direct referrals and exit rate"</span>, <span class="at">x=</span><span class="st">"direct referrals"</span>, <span class="at">y=</span><span class="st">"Exit rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>google , <span class="at">y=</span>e.rate))<span class="sc">+</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Google referrals and exit rate"</span>, <span class="at">x=</span><span class="st">"Googlereferrals"</span>, <span class="at">y=</span><span class="st">"Exit rate"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-12-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="post-weekdays" class="level3">
<h3 class="anchored" data-anchor-id="post-weekdays">2.3. Post weekdays</h3>
<p>Calculating weekdays variable:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(comments.data)</span></span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="co"># merged &lt;- merge( merged, post.date , by = "post_id", all = TRUE)</span></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span>merged <span class="sc">%&gt;%</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">weekday =</span> <span class="fu">wday</span>(post.date, <span class="at">label =</span> <span class="cn">TRUE</span>))</span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(merged<span class="sc">$</span>weekday)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Sun Mon Tue Wed Thu Fri Sat 
  0  49  61  60  59  58   0 </code></pre>
</div>
</div>
<p>Posts are published Monday through Friday (with rare exceptions). No posts are published on the weekend. Below is visualization of DV distribution (exit rate and number of comment) per week day:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>weekday, <span class="at">y=</span>e.rate) )<span class="sc">+</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per weekday"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>weekday, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per weekday"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see that exit rate is overall lower on Tuesday, and number of comments overall highest on Fridays.</p>
</section>
<section id="authors-comments" class="level3">
<h3 class="anchored" data-anchor-id="authors-comments">2.4. Authors comments</h3>
<p>To identify, how much the author of the blog is engaged in the post, I will create an additional variable derived from a user_name field and review the distribution of autor’s comments :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># str(merged)</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>comments.data<span class="sc">$</span>user_name<span class="ot">&lt;-</span>  <span class="fu">ifelse</span> (<span class="fu">is.na</span>(comments.data<span class="sc">$</span>user_name), <span class="dv">0</span>, comments.data<span class="sc">$</span>user_name)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>comments.data<span class="sc">$</span>author<span class="ot">&lt;-</span>  <span class="fu">ifelse</span> (comments.data<span class="sc">$</span>user_name<span class="sc">==</span><span class="st">"MeredithGoldstein"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.data <span class="sc">%&gt;%</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(post_id)<span class="sc">%&gt;%</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n.comments=</span><span class="fu">n</span>(),</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a>            <span class="at">author.sum =</span> <span class="fu">sum</span>(author))</span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments data contains rows that dont actually reporesent posts, and were crearted by web support team for troubleshooting. I need to remove these rows. They typically have very low number of comments</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.grouped <span class="sc">%&gt;%</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(n.comments <span class="sc">&gt;</span><span class="dv">100</span>)  <span class="co"># removing invalid posts created by the  website management team.</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.grouped <span class="sc">%&gt;%</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(post_id, author.sum)</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co">#adding author.sum to main data set: </span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">merge</span>( merged , comments.grouped, <span class="at">by =</span> <span class="st">"post_id"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum) )<span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Authors comments distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Authors comments per engagement metrics:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per author.sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per author.sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-16-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph shows, that majority of posts have no author’s comments.</p>
</section>
<section id="mood-of-the-post." class="level3">
<h3 class="anchored" data-anchor-id="mood-of-the-post.">2.5. Mood of the post.</h3>
<p>This is a numerical variable, calculated as a percentage of “thumbs up” from all likes (both “thumbs up” and “thumbs down”).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive) )<span class="sc">+</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"springgreen3"</span>)<span class="sc">+</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Mood of the post (pct.positive) distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plotting mood pf the post against engagement metrics:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per pct.positive"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per pct.positive"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-18-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Distribution of mood over time:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>pct.positive, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of Mood per post "</span>, <span class="at">y =</span> <span class="st">"Mood"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="blocked-comments-per-post." class="level3">
<h3 class="anchored" data-anchor-id="blocked-comments-per-post.">2.6. Blocked comments per post.</h3>
<p>Now I will visualize amount of blocked comments per post. It also has Poisson distribution.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum) )<span class="sc">+</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"brown"</span>)<span class="sc">+</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"blocked.sum distribution"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Plotting blocked comments against engagement metrics:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per blocked.sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per blocked.sum"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-21-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Distribution of blocked comments over time:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>blocked.sum, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number Blocked comments  per post "</span>, <span class="at">y =</span> <span class="st">"Number of blocked comments per post"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="creating-a-model-for-exit-rate---all-users-engagement." class="level1">
<h1>3. Creating a model for exit rate - all users engagement.</h1>
<section id="basic-model." class="level3">
<h3 class="anchored" data-anchor-id="basic-model.">3.1 Basic model.</h3>
<p>I will start with entering all of the independent variable in the model and then eliminating ones that are not significant.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques) <span class="sc">+</span>google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> author.sum <span class="sc">+</span>n.comments <span class="sc">+</span>blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>merged<span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span> (<span class="at">author.sum =</span>author.sum <span class="sc">+</span><span class="fl">0.001</span>,</span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>          <span class="at">blocked.sum =</span>blocked.sum <span class="sc">+</span><span class="fl">0.001</span>)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="co"># logging variables with Poisson distribution to see if that increases significantce.</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques) <span class="sc">+</span>google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> <span class="fu">log</span>(author.sum) <span class="sc">+</span>n.comments <span class="sc">+</span> <span class="fu">log</span>(blocked.sum) <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>, model<span class="fl">.2</span>, model<span class="fl">.3</span>,  <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=================================================================================================
                                                 Dependent variable:                             
                    -----------------------------------------------------------------------------
                                                       e.rate                                    
                               (1)                       (2)                       (3)           
-------------------------------------------------------------------------------------------------
log(Uniques)                0.189***                  0.190***                  0.191***         
                             (0.009)                   (0.009)                   (0.009)         
                                                                                                 
google                     -0.00000***               -0.00000***               -0.00000***       
                            (0.00000)                 (0.00000)                 (0.00000)        
                                                                                                 
direct                     -0.00003***               -0.00003***               -0.00002***       
                            (0.00000)                 (0.00000)                 (0.00000)        
                                                                                                 
other.web                  -0.00001***               -0.00001***               -0.00001***       
                            (0.00000)                 (0.00000)                 (0.00000)        
                                                                                                 
social                     -0.00004**                -0.00004**                -0.00004**        
                            (0.00002)                 (0.00002)                 (0.00002)        
                                                                                                 
bdc                        0.00002***                0.00002***                0.00002***        
                            (0.00000)                 (0.00000)                 (0.00000)        
                                                                                                 
ll                           0.00000                   0.00000                                   
                            (0.00000)                 (0.00000)                                  
                                                                                                 
author.sum                   -0.002                                                              
                             (0.002)                                                             
                                                                                                 
log(author.sum)                                        -0.001                                    
                                                      (0.0005)                                   
                                                                                                 
n.comments                  -0.00002                  -0.00002                                   
                            (0.00003)                 (0.00003)                                  
                                                                                                 
blocked.sum                  -0.0001                                                             
                            (0.0002)                                                             
                                                                                                 
log(blocked.sum)                                       0.0002                                    
                                                      (0.0004)                                   
                                                                                                 
pct.positive                -0.00001                   0.00001                                   
                            (0.0002)                  (0.0002)                                   
                                                                                                 
weekday.L                    0.006*                    0.006*                    0.007**         
                             (0.003)                   (0.003)                   (0.003)         
                                                                                                 
weekday.Q                   0.012***                  0.012***                  0.014***         
                             (0.003)                   (0.003)                   (0.003)         
                                                                                                 
weekday.C                     0.003                     0.003                     0.004          
                             (0.003)                   (0.003)                   (0.003)         
                                                                                                 
weekday4                     0.006**                   0.007**                  0.007***         
                             (0.003)                   (0.003)                   (0.003)         
                                                                                                 
Constant                    -1.030***                 -1.038***                 -1.047***        
                             (0.086)                   (0.086)                   (0.082)         
                                                                                                 
-------------------------------------------------------------------------------------------------
Observations                   287                       287                       287           
R2                            0.918                     0.918                     0.917          
Adjusted R2                   0.914                     0.914                     0.914          
Residual Std. Error     0.020 (df = 271)          0.020 (df = 271)          0.020 (df = 276)     
F Statistic         203.411*** (df = 15; 271) 203.257*** (df = 15; 271) 306.564*** (df = 10; 276)
=================================================================================================
Note:                                                                 *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Elimination of non-significant factors slightly impacted coefficients of significant variables, and did not change R^2 or adjusted R^2 much.</p>
<p>My next step is to diagnose this model:</p>
</section>
<section id="diagnostic-of-linear-models" class="level3">
<h3 class="anchored" data-anchor-id="diagnostic-of-linear-models">3.2. Diagnostic of linear models:</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-24-2.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-24-3.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-24-4.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-24-5.png" class="img-fluid" width="672"></p>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-24-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see the issue with distribution of residuals in “Residuals vs fitted” plot. This suggests non-linear relationship between variables.</p>
<p>I will transform some referral variables to see if that gives me a better model:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="co">#original model</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Logging Google referrals</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.3</span>, model<span class="fl">.4</span>, model<span class="fl">.5</span>,    <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in .stargazer.wrap(..., type = type, title = title, style = style, : object 'model.5' not found</code></pre>
</div>
</div>
<p>This table showing better fit when google variable is logged. Uniques’ coefficient also changed significantly as I am modified google variable. That might indicate interaction between them, which I will explore later in this paper.</p>
<p>Now, I will log the rest of referral variables.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span><span class="fu">log</span>(other.web) <span class="sc">+</span><span class="fu">log</span>(social) <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.4</span>,model<span class="fl">.5</span>,model<span class="fl">.6</span>,  <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
=================================================================
                                      Dependent variable:        
                               ----------------------------------
                                             e.rate              
                                   (1)        (2)         (3)    
-----------------------------------------------------------------
log(Uniques)                    0.106***    0.096***   0.112***  
                                 (0.012)    (0.013)     (0.013)  
                                                                 
log(google)                     0.016***    0.019***   0.014***  
                                 (0.004)    (0.005)     (0.005)  
                                                                 
direct                         -0.00003***                       
                                (0.00000)                        
                                                                 
other.web                      -0.00001***            -0.00001***
                                (0.00000)              (0.00000) 
                                                                 
social                         -0.00003**              -0.00003  
                                (0.00002)              (0.00002) 
                                                                 
bdc                            0.00003***                        
                                (0.00000)                        
                                                                 
log(direct)                                -0.298***   -0.307*** 
                                            (0.029)     (0.027)  
                                                                 
log(other.web)                               -0.001              
                                            (0.002)              
                                                                 
log(social)                                  -0.005              
                                            (0.003)              
                                                                 
log(bdc)                                    0.218***   0.220***  
                                            (0.018)     (0.017)  
                                                                 
weekday.L                        0.008**    0.009***   0.010***  
                                 (0.003)    (0.003)     (0.003)  
                                                                 
weekday.Q                       0.016***    0.018***   0.019***  
                                 (0.003)    (0.003)     (0.003)  
                                                                 
weekday.C                        0.005*     0.006**     0.006**  
                                 (0.003)    (0.003)     (0.003)  
                                                                 
weekday4                        0.008***    0.009***   0.008***  
                                 (0.003)    (0.003)     (0.003)  
                                                                 
Constant                        -0.384***   0.453***   0.396***  
                                 (0.073)    (0.094)     (0.093)  
                                                                 
-----------------------------------------------------------------
Observations                       287        287         287    
R2                                0.913      0.901       0.906   
Adjusted R2                       0.910      0.898       0.903   
Residual Std. Error (df = 276)    0.020      0.021       0.021   
F Statistic (df = 10; 276)     291.392***  252.106*** 266.805*** 
=================================================================
Note:                                 *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>All referral sources except “other.web” and “social” show better fit when logged. Moving forward, I will use these two variables not logged:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web<span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model<span class="fl">.7</span>,  <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
===============================================
                        Dependent variable:    
                    ---------------------------
                              e.rate           
-----------------------------------------------
log(Uniques)                 0.112***          
                              (0.013)          
                                               
log(google)                  0.014***          
                              (0.005)          
                                               
log(direct)                  -0.307***         
                              (0.027)          
                                               
other.web                   -0.00001***        
                             (0.00000)         
                                               
social                       -0.00003          
                             (0.00002)         
                                               
log(bdc)                     0.220***          
                              (0.017)          
                                               
weekday.L                    0.010***          
                              (0.003)          
                                               
weekday.Q                    0.019***          
                              (0.003)          
                                               
weekday.C                     0.006**          
                              (0.003)          
                                               
weekday4                     0.008***          
                              (0.003)          
                                               
Constant                     0.396***          
                              (0.093)          
                                               
-----------------------------------------------
Observations                    287            
R2                             0.906           
Adjusted R2                    0.903           
Residual Std. Error      0.021 (df = 276)      
F Statistic          266.805*** (df = 10; 276) 
===============================================
Note:               *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Diagnostics of model.7:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We still observe curvi-linear distribution of residuals.</p>
<p>Now I will explore an interaction of referral sources with popularity (variable “Uniques”)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="co"># last model</span></span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span><span class="fu">log</span>(bdc)<span class="sc">+</span>social  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="co"># adding interaction with google: </span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.7</span>,model<span class="fl">.8</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
============================================================================
                                         Dependent variable:                
                         ---------------------------------------------------
                                               e.rate                       
                                    (1)                       (2)           
----------------------------------------------------------------------------
log(Uniques)                     0.112***                  0.372***         
                                  (0.013)                   (0.042)         
                                                                            
log(google)                      0.014***                  0.200***         
                                  (0.005)                   (0.029)         
                                                                            
log(direct)                      -0.307***                 -0.293***        
                                  (0.027)                   (0.026)         
                                                                            
other.web                       -0.00001***               -0.00001***       
                                 (0.00000)                 (0.00000)        
                                                                            
log(bdc)                         0.220***                  0.181***         
                                  (0.017)                   (0.017)         
                                                                            
social                           -0.00003                 -0.00003**        
                                 (0.00002)                 (0.00002)        
                                                                            
weekday.L                        0.010***                  0.009***         
                                  (0.003)                   (0.003)         
                                                                            
weekday.Q                        0.019***                  0.017***         
                                  (0.003)                   (0.003)         
                                                                            
weekday.C                         0.006**                   0.006**         
                                  (0.003)                   (0.003)         
                                                                            
weekday4                         0.008***                  0.007***         
                                  (0.003)                   (0.003)         
                                                                            
log(Uniques):log(google)                                   -0.021***        
                                                            (0.003)         
                                                                            
Constant                         0.396***                  -1.734***        
                                  (0.093)                   (0.345)         
                                                                            
----------------------------------------------------------------------------
Observations                        287                       287           
R2                                 0.906                     0.918          
Adjusted R2                        0.903                     0.915          
Residual Std. Error          0.021 (df = 276)          0.020 (df = 275)     
F Statistic              266.805*** (df = 10; 276) 281.232*** (df = 11; 275)
============================================================================
Note:                                            *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Adding interaction between popularity and google referrals significantly improved the model: interaction term has negative correlation with dependent variable, it also made “social” referrals significant, and improved models R^2 and adjusted R^2.</p>
<p>It also significantly changed distribution of residuals: now distribution is equally spread around 0.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Lets review other diagnostic plots:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-31-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-31-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-31-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-31-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see from both models, that variable 231 is an outlier that significantly impacts the model. I will remove that observation and re-evaluate the model:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>merged.old <span class="ot">&lt;-</span> merged</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 287  27</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merged.old)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 287  27</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">235</span>), ]</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged.old)</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.8</span>,model<span class="fl">.9</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
============================================================================
                                         Dependent variable:                
                         ---------------------------------------------------
                                               e.rate                       
                                    (1)                       (2)           
----------------------------------------------------------------------------
log(Uniques)                     0.372***                  0.374***         
                                  (0.042)                   (0.043)         
                                                                            
log(google)                      0.200***                  0.201***         
                                  (0.029)                   (0.029)         
                                                                            
log(direct)                      -0.293***                 -0.293***        
                                  (0.026)                   (0.026)         
                                                                            
other.web                       -0.00001***               -0.00001***       
                                 (0.00000)                 (0.00000)        
                                                                            
social                          -0.00003**                -0.00003**        
                                 (0.00002)                 (0.00002)        
                                                                            
log(bdc)                         0.181***                  0.181***         
                                  (0.017)                   (0.017)         
                                                                            
weekday.L                        0.009***                  0.009***         
                                  (0.003)                   (0.003)         
                                                                            
weekday.Q                        0.017***                  0.017***         
                                  (0.003)                   (0.003)         
                                                                            
weekday.C                         0.006**                   0.006**         
                                  (0.003)                   (0.003)         
                                                                            
weekday4                         0.007***                  0.007***         
                                  (0.003)                   (0.003)         
                                                                            
log(Uniques):log(google)         -0.021***                 -0.022***        
                                  (0.003)                   (0.003)         
                                                                            
Constant                         -1.734***                 -1.751***        
                                  (0.345)                   (0.345)         
                                                                            
----------------------------------------------------------------------------
Observations                        287                       286           
R2                                 0.918                     0.919          
Adjusted R2                        0.915                     0.915          
Residual Std. Error          0.020 (df = 275)          0.020 (df = 274)     
F Statistic              281.232*** (df = 11; 275) 281.142*** (df = 11; 274)
============================================================================
Note:                                            *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-32-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-32-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-32-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-32-5.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-32-6.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>New, the variable “other.web” became insignificant, but model fit improved.</p>
</section>
<section id="improved-model-model.9-." class="level3">
<h3 class="anchored" data-anchor-id="improved-model-model.9-.">3.3. Improved model (model.9) .</h3>
<p>I will check whether “direct” referral sources have an interaction with popularity as well (model 10) :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">#last model: </span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="co"># adding interaction to direct.</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.10</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span> <span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.9</span>, model<span class="fl">.10</span>, <span class="at">type =</span> <span class="st">'text'</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
===========================================================
                                   Dependent variable:     
                               ----------------------------
                                          e.rate           
                                    (1)            (2)     
-----------------------------------------------------------
log(Uniques)                      0.374***      0.356***   
                                  (0.043)        (0.103)   
                                                           
log(google)                       0.201***      0.013***   
                                  (0.029)        (0.005)   
                                                           
log(direct)                      -0.293***       -0.037    
                                  (0.026)        (0.117)   
                                                           
other.web                       -0.00001***    -0.00001*** 
                                 (0.00000)      (0.00000)  
                                                           
social                           -0.00003**     -0.00003*  
                                 (0.00002)      (0.00002)  
                                                           
log(bdc)                          0.181***      0.212***   
                                  (0.017)        (0.017)   
                                                           
weekday.L                         0.009***      0.010***   
                                  (0.003)        (0.003)   
                                                           
weekday.Q                         0.017***      0.018***   
                                  (0.003)        (0.003)   
                                                           
weekday.C                         0.006**        0.005*    
                                  (0.003)        (0.003)   
                                                           
weekday4                          0.007***      0.007***   
                                  (0.003)        (0.003)   
                                                           
log(Uniques):log(google)         -0.022***                 
                                  (0.003)                  
                                                           
log(Uniques):log(direct)                        -0.026**   
                                                 (0.011)   
                                                           
Constant                         -1.751***      -2.085**   
                                  (0.345)        (1.044)   
                                                           
-----------------------------------------------------------
Observations                        286            286     
R2                                 0.919          0.908    
Adjusted R2                        0.915          0.905    
Residual Std. Error (df = 274)     0.020          0.021    
F Statistic (df = 11; 274)       281.142***    246.519***  
===========================================================
Note:                           *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>Diagnostics:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">1</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>We can see model 9 ( with interaction between google and Uniques) shows better residuals vs fitted plot. Model 10, however, demonstrates the there is an interaction between popularity and direct referrals as well. I will use both of these models to respond to my research question.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-35-2.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb90-2"><a href="#cb90-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb90-3"><a href="#cb90-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-35-3.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-35-4.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.11</span>, <span class="at">which =</span> <span class="dv">5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-error">
<pre><code>Error in plot(model.11, which = 5): object 'model.11' not found</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb94-3"><a href="#cb94-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-35-5.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Both models have similar R^2 and adjusted R^2.</p>
<p>Calculation of AIC and BIC:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model<span class="fl">.9</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1425.685</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model<span class="fl">.10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1391.349</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model<span class="fl">.9</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1378.158</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model<span class="fl">.10</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -1343.821</code></pre>
</div>
</div>
<p>AIC and BIC are very close.</p>
<p>To summarize, models # 9 and 10 demonstrated a good fit with high R^2 value and good results in diagnostic plots. Each of them is visualizing interaction between popularity and referral variable.</p>
</section>
<section id="visualizing-interaction" class="level3">
<h3 class="anchored" data-anchor-id="visualizing-interaction">3.4. Visualizing interaction:</h3>
<p>Moderating impact of referral source on relationship between popularity and engagement:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(model<span class="fl">.9</span>, <span class="at">pred =</span>Uniques , <span class="at">modx =</span>  google, <span class="at">plot.points =</span> <span class="cn">TRUE</span>, <span class="at">data=</span>merged )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>This graph shows that for higher levels of Google impact of popularity on exit rate will be lower (i.e.&nbsp;better engagement for the same level of popularity) .</p>
</section>
<section id="moderating-impact-of-direct-referrals-on-relationship-between-popularity-and-engagement" class="level3">
<h3 class="anchored" data-anchor-id="moderating-impact-of-direct-referrals-on-relationship-between-popularity-and-engagement">Moderating impact of direct referrals on relationship between popularity and engagement:</h3>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(model<span class="fl">.9</span>, <span class="at">pred =</span> Uniques, <span class="at">modx =</span> direct, <span class="at">plot.points =</span> <span class="cn">TRUE</span> )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Using data merged from global environment. This could cause incorrect
results if merged has been altered since the model was fit. You can
manually provide the data to the "data =" argument.</code></pre>
</div>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Popularity generally decreases engagement. However, with higher levels of direct , impact of popularity on exit rate will be lower.</p>
</section>
</section>
<section id="model-for-n.comments---loyal-readers-engagement" class="level1">
<h1>4. Model for N.comments - loyal readers engagement:</h1>
<section id="basic-model-for-n.comments" class="level2">
<h2 class="anchored" data-anchor-id="basic-model-for-n.comments">4.1. Basic model for n.comments</h2>
<p>Now I will create a model for n.comments as dependent variable, which represents the engagement of loyal readers.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> author.sum <span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span> Uniques<span class="sc">+</span> author.sum <span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a><span class="co">#removing unsignificant variables:</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>,model<span class="fl">.2</span>, model<span class="fl">.3</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
==========================================================================================
                                             Dependent variable:                          
                    ----------------------------------------------------------------------
                                                  n.comments                              
                              (1)                     (2)                    (3)          
------------------------------------------------------------------------------------------
log(Uniques)                -9.224                                                        
                           (16.724)                                                       
                                                                                          
Uniques                                              0.004                                
                                                    (0.004)                               
                                                                                          
author.sum                   0.459                   0.277                                
                            (3.273)                 (3.282)                               
                                                                                          
google                      0.0003                  -0.004                                
                            (0.001)                 (0.004)                               
                                                                                          
direct                      0.010*                   0.008                 0.004***       
                            (0.005)                 (0.006)                (0.001)        
                                                                                          
other.web                    0.003                  -0.0004                               
                            (0.002)                 (0.004)                               
                                                                                          
social                      0.066**                 0.063**                0.068**        
                            (0.029)                 (0.029)                (0.029)        
                                                                                          
bdc                         -0.006                  -0.009*                               
                            (0.005)                 (0.005)                               
                                                                                          
ll                          0.009**                 0.010**                0.012***       
                            (0.004)                 (0.004)                (0.003)        
                                                                                          
blocked.sum                  0.453                   0.478                                
                            (0.355)                 (0.356)                               
                                                                                          
pct.positive                0.960**                0.995***                1.008***       
                            (0.381)                 (0.380)                (0.377)        
                                                                                          
weekday.L                    0.353                  -0.239                  1.961         
                            (6.042)                 (6.074)                (5.967)        
                                                                                          
weekday.Q                 -18.499***              -19.001***              -20.251***      
                            (6.075)                 (6.072)                (5.961)        
                                                                                          
weekday.C                   -3.375                  -3.231                  -5.207        
                            (5.180)                 (5.160)                (5.087)        
                                                                                          
weekday4                    -2.998                  -3.203                  -3.907        
                            (4.942)                 (4.945)                (4.901)        
                                                                                          
Constant                    85.149                  -10.846                 6.193         
                           (162.552)               (38.121)                (35.107)       
                                                                                          
------------------------------------------------------------------------------------------
Observations                  286                     286                    286          
R2                           0.226                   0.227                  0.206         
Adjusted R2                  0.186                   0.187                  0.183         
Residual Std. Error    37.182 (df = 271)       37.155 (df = 271)      37.257 (df = 277)   
F Statistic         5.658*** (df = 14; 271) 5.694*** (df = 14; 271) 8.976*** (df = 8; 277)
==========================================================================================
Note:                                                          *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
</section>
<section id="diagnostics" class="level2">
<h2 class="anchored" data-anchor-id="diagnostics">4.2. Diagnostics:</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Observation #48 looks like on outlier impacting the model. I will remove this observation to see if that gives us any different results:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>merged.old <span class="ot">&lt;-</span> merged</span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">48</span>), ]</span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged.old )</span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb109-5"><a href="#cb109-5" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.3</span>, model<span class="fl">.4</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
==================================================================
                                 Dependent variable:              
                    ----------------------------------------------
                                      n.comments                  
                             (1)                     (2)          
------------------------------------------------------------------
direct                     0.004***               0.004***        
                           (0.001)                 (0.001)        
                                                                  
social                     0.068**                 0.067**        
                           (0.029)                 (0.029)        
                                                                  
ll                         0.012***               0.018***        
                           (0.003)                 (0.003)        
                                                                  
pct.positive               1.008***                0.923**        
                           (0.377)                 (0.371)        
                                                                  
weekday.L                   1.961                  -5.138         
                           (5.967)                 (6.250)        
                                                                  
weekday.Q                 -20.251***             -24.223***       
                           (5.961)                 (5.982)        
                                                                  
weekday.C                   -5.207                 -8.503*        
                           (5.087)                 (5.099)        
                                                                  
weekday4                    -3.907                 -4.654         
                           (4.901)                 (4.822)        
                                                                  
Constant                    6.193                  -0.466         
                           (35.107)               (34.562)        
                                                                  
------------------------------------------------------------------
Observations                 286                     285          
R2                          0.206                   0.232         
Adjusted R2                 0.183                   0.210         
Residual Std. Error   37.257 (df = 277)       36.615 (df = 276)   
F Statistic         8.976*** (df = 8; 277) 10.432*** (df = 8; 276)
==================================================================
Note:                                  *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
</div>
<p>We can see that removing #48 changed some coefficients, did not impact significance of variables. It also improved R^2 and adjusted R^2.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="Final_Project_Diana_Rinker_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>In the first and third plot we can see values being concentrated unevenly, which suggests hetersroscedasticity of the variables.</p>
</section>
</section>
<section id="conlusion" class="level1">
<h1>4. Conlusion</h1>
<p>We have build tree models for different engagement metrics: engagement of all readers (model 9 and 10) and engagement of loyal readers (model 4) . As we can see from the models, different factors contribute to engagement of these two groups of readers:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model<span class="fl">.9</span>, model<span class="fl">.10</span>, model<span class="fl">.4</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
====================================================================================================
                                                     Dependent variable:                            
                         ---------------------------------------------------------------------------
                                               e.rate                              n.comments       
                                    (1)                       (2)                      (3)          
----------------------------------------------------------------------------------------------------
log(Uniques)                     0.374***                  0.356***                                 
                                  (0.043)                   (0.103)                                 
                                                                                                    
log(google)                      0.201***                  0.013***                                 
                                  (0.029)                   (0.005)                                 
                                                                                                    
log(direct)                      -0.293***                  -0.037                                  
                                  (0.026)                   (0.117)                                 
                                                                                                    
other.web                       -0.00001***               -0.00001***                               
                                 (0.00000)                 (0.00000)                                
                                                                                                    
direct                                                                              0.004***        
                                                                                     (0.001)        
                                                                                                    
social                          -0.00003**                 -0.00003*                 0.067**        
                                 (0.00002)                 (0.00002)                 (0.029)        
                                                                                                    
log(bdc)                         0.181***                  0.212***                                 
                                  (0.017)                   (0.017)                                 
                                                                                                    
ll                                                                                  0.018***        
                                                                                     (0.003)        
                                                                                                    
pct.positive                                                                         0.923**        
                                                                                     (0.371)        
                                                                                                    
weekday.L                        0.009***                  0.010***                  -5.138         
                                  (0.003)                   (0.003)                  (6.250)        
                                                                                                    
weekday.Q                        0.017***                  0.018***                -24.223***       
                                  (0.003)                   (0.003)                  (5.982)        
                                                                                                    
weekday.C                         0.006**                   0.005*                   -8.503*        
                                  (0.003)                   (0.003)                  (5.099)        
                                                                                                    
weekday4                         0.007***                  0.007***                  -4.654         
                                  (0.003)                   (0.003)                  (4.822)        
                                                                                                    
log(Uniques):log(google)         -0.022***                                                          
                                  (0.003)                                                           
                                                                                                    
log(Uniques):log(direct)                                   -0.026**                                 
                                                            (0.011)                                 
                                                                                                    
Constant                         -1.751***                 -2.085**                  -0.466         
                                  (0.345)                   (1.044)                 (34.562)        
                                                                                                    
----------------------------------------------------------------------------------------------------
Observations                        286                       286                      285          
R2                                 0.919                     0.908                    0.232         
Adjusted R2                        0.915                     0.905                    0.210         
Residual Std. Error          0.020 (df = 274)          0.021 (df = 274)         36.615 (df = 276)   
F Statistic              281.142*** (df = 11; 274) 246.519*** (df = 11; 274) 10.432*** (df = 8; 276)
====================================================================================================
Note:                                                                    *p&lt;0.1; **p&lt;0.05; ***p&lt;0.01</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="co">#  sink("output.txt")</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="co"># stargazer(model.9, model.10, model.4, type = 'text')</span></span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a><span class="co">#   dev.off()</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a><span class="co">#  sink(type = "output")</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>The main colclusion is that all users and loyal users’s engagement should be described by different models, as the are influenced by different variables andvariables’ combinations.</p>
<p>We can see, that a few referral sources contribute to users engagement. All readers’engagement (measured with exit rate) is influenced by interaction of referrals from Google and Direct and popularity, internal bdc referrals and somewhat referrals from other web sources.</p>
<p>Loyal readers’ engagement is highly impacted by the mood of the post, internal page referrals, social referrals. They also show some direct referrals’ impact, but very small in compare with its influence on all users’ engagement.</p>
<p>We also see significant contribution of day of the week on readers engagement. Specifically, Monday’s engagement of all readers is significantly lower than any other day. For loyal readers, Wednesday showing thee lowest engagement.</p>
<p>It also important to point out, that popularity of the post (Uniques) only plays a role for all user’s engagement. Loyal readers appear not being impacted by popularity. Impact of popularity (Uniques) is moderated by Google and Direct referrals, where the posts with higher amounts of referrals show overall better engagement.</p>
<p>To conclude, we found significant connection between the referral source and readers engagement. Most ofthe influencing factors related to the source of readers and timing(day of the week), with the exception of post mood positively impacting loyal readers engagement.</p>
<p>Limitations: The role of Google referrals needs to be explored further, to identify how posts with high level of Google referrals contibute to this model. Also, finding out a cause of some pots having high Google referral rate would be beneficial for the blog development.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/603_Spring_2023" data-repo-id="R_kgDOI4oXIA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb115" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project"</span></span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Diana Rinker"</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Final project DACSS 603"</span></span>
<span id="cb115-5"><a href="#cb115-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "5/18/2023"</span></span>
<span id="cb115-6"><a href="#cb115-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb115-7"><a href="#cb115-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb115-8"><a href="#cb115-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb115-9"><a href="#cb115-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb115-10"><a href="#cb115-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb115-11"><a href="#cb115-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb115-12"><a href="#cb115-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb115-13"><a href="#cb115-13" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb115-14"><a href="#cb115-14" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb115-15"><a href="#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="an">editor_options:</span><span class="co"> </span></span>
<span id="cb115-16"><a href="#cb115-16" aria-hidden="true" tabindex="-1"></a><span class="co">  chunk_output_type: console</span></span>
<span id="cb115-17"><a href="#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb115-18"><a href="#cb115-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-19"><a href="#cb115-19" aria-hidden="true" tabindex="-1"></a><span class="fu">## DACSS 603, Spring 2023</span></span>
<span id="cb115-20"><a href="#cb115-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-21"><a href="#cb115-21" aria-hidden="true" tabindex="-1"></a><span class="fu">## Final Project, Diana Rinker.</span></span>
<span id="cb115-22"><a href="#cb115-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-23"><a href="#cb115-23" aria-hidden="true" tabindex="-1"></a><span class="fu">## Online engagement.</span></span>
<span id="cb115-24"><a href="#cb115-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-25"><a href="#cb115-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># Introduction.</span></span>
<span id="cb115-26"><a href="#cb115-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-27"><a href="#cb115-27" aria-hidden="true" tabindex="-1"></a>It is well known that online engagement with the web resource is a</span>
<span id="cb115-28"><a href="#cb115-28" aria-hidden="true" tabindex="-1"></a>highly valuable metric and is contributing to the site revenue. This</span>
<span id="cb115-29"><a href="#cb115-29" aria-hidden="true" tabindex="-1"></a>research project is exploring which factors contribute to users online</span>
<span id="cb115-30"><a href="#cb115-30" aria-hidden="true" tabindex="-1"></a>engagement.I used the data of an online blog hosted by the news website.</span>
<span id="cb115-31"><a href="#cb115-31" aria-hidden="true" tabindex="-1"></a>The author of this blog is posting articles about interpersonal</span>
<span id="cb115-32"><a href="#cb115-32" aria-hidden="true" tabindex="-1"></a>relationships every work day (Mon- Fri). The posts are formulated as a</span>
<span id="cb115-33"><a href="#cb115-33" aria-hidden="true" tabindex="-1"></a>letter from a reader with the situation and a question about</span>
<span id="cb115-34"><a href="#cb115-34" aria-hidden="true" tabindex="-1"></a>relationships. The author gives an advice about the situation. Website</span>
<span id="cb115-35"><a href="#cb115-35" aria-hidden="true" tabindex="-1"></a>readers are free to comment under each post, but cannot make their own</span>
<span id="cb115-36"><a href="#cb115-36" aria-hidden="true" tabindex="-1"></a>posts.</span>
<span id="cb115-37"><a href="#cb115-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-38"><a href="#cb115-38" aria-hidden="true" tabindex="-1"></a>All post methadata and comments are public. They are saved by the</span>
<span id="cb115-39"><a href="#cb115-39" aria-hidden="true" tabindex="-1"></a>website and available for the analysis. Using this data set, I will</span>
<span id="cb115-40"><a href="#cb115-40" aria-hidden="true" tabindex="-1"></a>explore how readers' engagement connected with blog author's engagement,</span>
<span id="cb115-41"><a href="#cb115-41" aria-hidden="true" tabindex="-1"></a>site comments, views' web source, post reactions, and blocked comments.</span>
<span id="cb115-42"><a href="#cb115-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-43"><a href="#cb115-43" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research Question and hypothesis.</span></span>
<span id="cb115-44"><a href="#cb115-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-45"><a href="#cb115-45" aria-hidden="true" tabindex="-1"></a>**RQ:** Which factors influence user's engagement in online blog?</span>
<span id="cb115-46"><a href="#cb115-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-47"><a href="#cb115-47" aria-hidden="true" tabindex="-1"></a>**Hypothesis:** Loyal readers' and all readers' engagement are impacted</span>
<span id="cb115-48"><a href="#cb115-48" aria-hidden="true" tabindex="-1"></a>by the same factors.</span>
<span id="cb115-49"><a href="#cb115-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-50"><a href="#cb115-50" aria-hidden="true" tabindex="-1"></a>**DV:** My dependent construct is **"user's engagement**", I will</span>
<span id="cb115-51"><a href="#cb115-51" aria-hidden="true" tabindex="-1"></a>measure users' engagement at the level of individual post, using the</span>
<span id="cb115-52"><a href="#cb115-52" aria-hidden="true" tabindex="-1"></a>following metrics:</span>
<span id="cb115-53"><a href="#cb115-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-54"><a href="#cb115-54" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\.</span> Exit rate or "bounces". When the visitor is coming to the page and</span>
<span id="cb115-55"><a href="#cb115-55" aria-hidden="true" tabindex="-1"></a>then leaving, i.e. not opening other pages on this website. this will</span>
<span id="cb115-56"><a href="#cb115-56" aria-hidden="true" tabindex="-1"></a>represent all readers.</span>
<span id="cb115-57"><a href="#cb115-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-58"><a href="#cb115-58" aria-hidden="true" tabindex="-1"></a>2<span class="sc">\.</span> Number of comments - is engagement metric, representing only loyal</span>
<span id="cb115-59"><a href="#cb115-59" aria-hidden="true" tabindex="-1"></a>readers, who have created an account and signed in.</span>
<span id="cb115-60"><a href="#cb115-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-61"><a href="#cb115-61" aria-hidden="true" tabindex="-1"></a>**IV:** My main independent variables are</span>
<span id="cb115-62"><a href="#cb115-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-63"><a href="#cb115-63" aria-hidden="true" tabindex="-1"></a><span class="ss">1.  </span>Post popularity. Unique users - number of unique people viewed the</span>
<span id="cb115-64"><a href="#cb115-64" aria-hidden="true" tabindex="-1"></a>    post.</span>
<span id="cb115-65"><a href="#cb115-65" aria-hidden="true" tabindex="-1"></a><span class="ss">2.  </span>Source of the readers - which web page the reader came from. This is</span>
<span id="cb115-66"><a href="#cb115-66" aria-hidden="true" tabindex="-1"></a>    represented by 6 different variables, each is continuous type.</span>
<span id="cb115-67"><a href="#cb115-67" aria-hidden="true" tabindex="-1"></a><span class="ss">3.  </span>Mood of the conversation , derivative continuous variable calculated</span>
<span id="cb115-68"><a href="#cb115-68" aria-hidden="true" tabindex="-1"></a>    as the percentage of "likes" to all emotions (sum of thumbs up and</span>
<span id="cb115-69"><a href="#cb115-69" aria-hidden="true" tabindex="-1"></a>    thumbs down). It ranges from 0 to 1.</span>
<span id="cb115-70"><a href="#cb115-70" aria-hidden="true" tabindex="-1"></a><span class="ss">4.  </span>Blocked and flagged comments.</span>
<span id="cb115-71"><a href="#cb115-71" aria-hidden="true" tabindex="-1"></a><span class="ss">5.  </span>Number of author's comments.</span>
<span id="cb115-72"><a href="#cb115-72" aria-hidden="true" tabindex="-1"></a><span class="ss">6.  </span>Weekday of the post.</span>
<span id="cb115-73"><a href="#cb115-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-74"><a href="#cb115-74" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=F}</span></span>
<span id="cb115-75"><a href="#cb115-75" aria-hidden="true" tabindex="-1"></a><span class="co">#Loading necessary libraries: </span></span>
<span id="cb115-76"><a href="#cb115-76" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(readxl)</span>
<span id="cb115-77"><a href="#cb115-77" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb115-78"><a href="#cb115-78" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb115-79"><a href="#cb115-79" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb115-80"><a href="#cb115-80" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(png)</span>
<span id="cb115-81"><a href="#cb115-81" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(grid)</span>
<span id="cb115-82"><a href="#cb115-82" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(gridExtra)</span>
<span id="cb115-83"><a href="#cb115-83" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stargazer)</span>
<span id="cb115-84"><a href="#cb115-84" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(jtools)</span>
<span id="cb115-85"><a href="#cb115-85" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(interactions)</span>
<span id="cb115-86"><a href="#cb115-86" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(lubridate)</span>
<span id="cb115-87"><a href="#cb115-87" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-88"><a href="#cb115-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-89"><a href="#cb115-89" aria-hidden="true" tabindex="-1"></a><span class="fu">### Data source and description.</span></span>
<span id="cb115-90"><a href="#cb115-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-91"><a href="#cb115-91" aria-hidden="true" tabindex="-1"></a>To answer my research question I will use two datasets. The first data</span>
<span id="cb115-92"><a href="#cb115-92" aria-hidden="true" tabindex="-1"></a>set has information about all comments associated with each post by post</span>
<span id="cb115-93"><a href="#cb115-93" aria-hidden="true" tabindex="-1"></a>ID. The second data set is analytics data for the web page. It contains</span>
<span id="cb115-94"><a href="#cb115-94" aria-hidden="true" tabindex="-1"></a>one post per row and variables describe each post as a whole without</span>
<span id="cb115-95"><a href="#cb115-95" aria-hidden="true" tabindex="-1"></a>breaking down to the comment level.</span>
<span id="cb115-96"><a href="#cb115-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-97"><a href="#cb115-97" aria-hidden="true" tabindex="-1"></a>In this project I will analyze posts for January 2022 - March 2023. Here</span>
<span id="cb115-98"><a href="#cb115-98" aria-hidden="true" tabindex="-1"></a>is the list of variables in each data set:</span>
<span id="cb115-99"><a href="#cb115-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-100"><a href="#cb115-100" aria-hidden="true" tabindex="-1"></a>A. Comments data:</span>
<span id="cb115-101"><a href="#cb115-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-102"><a href="#cb115-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-103"><a href="#cb115-103" aria-hidden="true" tabindex="-1"></a><span class="fu">getwd</span>()</span>
<span id="cb115-104"><a href="#cb115-104" aria-hidden="true" tabindex="-1"></a><span class="co"># First, I will load the data set with the comment level data:</span></span>
<span id="cb115-105"><a href="#cb115-105" aria-hidden="true" tabindex="-1"></a>raw <span class="ot">&lt;-</span> <span class="fu">as_tibble</span> (<span class="fu">read_csv</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Diana</span><span class="sc">\\</span><span class="st">OneDrive - University Of Massachusetts Medical School</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">R working directory</span><span class="sc">\\</span><span class="st">DACSS</span><span class="sc">\\</span><span class="st">603</span><span class="sc">\\</span><span class="st">my study files for dacss603</span><span class="sc">\\</span><span class="st">globe</span><span class="sc">\\</span><span class="st"> data.2021.plus.csv"</span>))</span>
<span id="cb115-106"><a href="#cb115-106" aria-hidden="true" tabindex="-1"></a>comments.data<span class="ot">&lt;-</span>raw </span>
<span id="cb115-107"><a href="#cb115-107" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span> (comments.data)</span>
<span id="cb115-108"><a href="#cb115-108" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(comments.data<span class="sc">$</span>written_at)</span>
<span id="cb115-109"><a href="#cb115-109" aria-hidden="true" tabindex="-1"></a>comments.data <span class="ot">&lt;-</span>comments.data<span class="sc">%&gt;%</span></span>
<span id="cb115-110"><a href="#cb115-110" aria-hidden="true" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">com.year =</span> <span class="fu">format</span>(written_at,<span class="at">format =</span> <span class="st">"%Y"</span> ))</span>
<span id="cb115-111"><a href="#cb115-111" aria-hidden="true" tabindex="-1"></a><span class="co"># range(comments.data$com.year)</span></span>
<span id="cb115-112"><a href="#cb115-112" aria-hidden="true" tabindex="-1"></a><span class="co"># dim(comments.data)</span></span>
<span id="cb115-113"><a href="#cb115-113" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(comments.data)</span>
<span id="cb115-114"><a href="#cb115-114" aria-hidden="true" tabindex="-1"></a>comments.data <span class="ot">&lt;-</span> comments.data<span class="sc">%&gt;%</span></span>
<span id="cb115-115"><a href="#cb115-115" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(written_at  <span class="sc">&gt;=</span> <span class="st">"2022-01-01"</span>)</span>
<span id="cb115-116"><a href="#cb115-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-117"><a href="#cb115-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-118"><a href="#cb115-118" aria-hidden="true" tabindex="-1"></a>B. Post data:</span>
<span id="cb115-119"><a href="#cb115-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-120"><a href="#cb115-120" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-121"><a href="#cb115-121" aria-hidden="true" tabindex="-1"></a><span class="co"># Second, loadng post-level data :</span></span>
<span id="cb115-122"><a href="#cb115-122" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">as_tibble</span> (<span class="fu">read_csv</span>(<span class="st">"C:</span><span class="sc">\\</span><span class="st">Users</span><span class="sc">\\</span><span class="st">Diana</span><span class="sc">\\</span><span class="st">OneDrive - University Of Massachusetts Medical School</span><span class="sc">\\</span><span class="st">Documents</span><span class="sc">\\</span><span class="st">R</span><span class="sc">\\</span><span class="st">R working directory</span><span class="sc">\\</span><span class="st">DACSS</span><span class="sc">\\</span><span class="st">603</span><span class="sc">\\</span><span class="st">my study files for dacss603</span><span class="sc">\\</span><span class="st">globe</span><span class="sc">\\</span><span class="st">data.merged.csv"</span>))</span>
<span id="cb115-123"><a href="#cb115-123" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb115-124"><a href="#cb115-124" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(merged)</span>
<span id="cb115-125"><a href="#cb115-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-126"><a href="#cb115-126" aria-hidden="true" tabindex="-1"></a><span class="co"># Limiting the dataset to 2022: </span></span>
<span id="cb115-127"><a href="#cb115-127" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged<span class="sc">%&gt;%</span></span>
<span id="cb115-128"><a href="#cb115-128" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(post.date  <span class="sc">&gt;=</span>  <span class="st">"2022-01-01"</span>)</span>
<span id="cb115-129"><a href="#cb115-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-130"><a href="#cb115-130" aria-hidden="true" tabindex="-1"></a><span class="co"># Due to dataset of comments having more data than post dataset,  I will cut them to match: </span></span>
<span id="cb115-131"><a href="#cb115-131" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span></span>
<span id="cb115-132"><a href="#cb115-132" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span> (<span class="sc">!</span><span class="fu">is.na</span>(merged<span class="sc">$</span>pct.positive))</span>
<span id="cb115-133"><a href="#cb115-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-134"><a href="#cb115-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-135"><a href="#cb115-135" aria-hidden="true" tabindex="-1"></a>To begin, I will review available variables and evaluate to identify a</span>
<span id="cb115-136"><a href="#cb115-136" aria-hidden="true" tabindex="-1"></a>metric for each construct in my study.</span>
<span id="cb115-137"><a href="#cb115-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-138"><a href="#cb115-138" aria-hidden="true" tabindex="-1"></a><span class="fu"># 1.DV: engagement.</span></span>
<span id="cb115-139"><a href="#cb115-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-140"><a href="#cb115-140" aria-hidden="true" tabindex="-1"></a><span class="fu">## Exit rate</span></span>
<span id="cb115-141"><a href="#cb115-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-142"><a href="#cb115-142" aria-hidden="true" tabindex="-1"></a>This variable is measuring how many people visited the page and then</span>
<span id="cb115-143"><a href="#cb115-143" aria-hidden="true" tabindex="-1"></a>left the website after the first view. This metric is the best measure</span>
<span id="cb115-144"><a href="#cb115-144" aria-hidden="true" tabindex="-1"></a>of engagement for all users, as it represents the first step after being</span>
<span id="cb115-145"><a href="#cb115-145" aria-hidden="true" tabindex="-1"></a>exposed to the post - either quitting the site or remaining on the site.</span>
<span id="cb115-146"><a href="#cb115-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-147"><a href="#cb115-147" aria-hidden="true" tabindex="-1"></a>Here can see the distribution of this variable :</span>
<span id="cb115-148"><a href="#cb115-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-149"><a href="#cb115-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-150"><a href="#cb115-150" aria-hidden="true" tabindex="-1"></a><span class="co"># str(merged)</span></span>
<span id="cb115-151"><a href="#cb115-151" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span></span>
<span id="cb115-152"><a href="#cb115-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">e.rate =</span> Exits<span class="sc">/</span><span class="st">`</span><span class="at">Page views</span><span class="st">`</span>)</span>
<span id="cb115-153"><a href="#cb115-153" aria-hidden="true" tabindex="-1"></a><span class="fu">select</span> (merged, <span class="st">`</span><span class="at">Exit rate</span><span class="st">`</span>, e.rate)</span>
<span id="cb115-154"><a href="#cb115-154" aria-hidden="true" tabindex="-1"></a><span class="co"># merged$`Exit rate` &lt;- as.numeric(sub("%", "", merged$`Exit rate`)) / 100</span></span>
<span id="cb115-155"><a href="#cb115-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-156"><a href="#cb115-156" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>e.rate))<span class="sc">+</span></span>
<span id="cb115-157"><a href="#cb115-157" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.01</span>, <span class="at">fill =</span> <span class="st">"sandybrown"</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)<span class="sc">+</span></span>
<span id="cb115-158"><a href="#cb115-158" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate histogram"</span>)</span>
<span id="cb115-159"><a href="#cb115-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-160"><a href="#cb115-160" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-161"><a href="#cb115-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-162"><a href="#cb115-162" aria-hidden="true" tabindex="-1"></a>Distribution of exit rate over time:</span>
<span id="cb115-163"><a href="#cb115-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-164"><a href="#cb115-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-165"><a href="#cb115-165" aria-hidden="true" tabindex="-1"></a><span class="co"># creating  year_month  variable </span></span>
<span id="cb115-166"><a href="#cb115-166" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>post.month <span class="ot">&lt;-</span><span class="fu">as.numeric</span>(merged<span class="sc">$</span>post.month)</span>
<span id="cb115-167"><a href="#cb115-167" aria-hidden="true" tabindex="-1"></a>merged<span class="sc">$</span>year_month <span class="ot">&lt;-</span> <span class="fu">paste0</span>(merged<span class="sc">$</span>post.year, <span class="st">"-"</span>, <span class="fu">sprintf</span>(<span class="st">"%02d"</span>, merged<span class="sc">$</span>post.month))</span>
<span id="cb115-168"><a href="#cb115-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-169"><a href="#cb115-169" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span><span class="st">`</span><span class="at">e.rate</span><span class="st">`</span>, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb115-170"><a href="#cb115-170" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb115-171"><a href="#cb115-171" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of `Exit rate` per post "</span>, <span class="at">y =</span> <span class="st">"Exit rate"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb115-172"><a href="#cb115-172" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb115-173"><a href="#cb115-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-174"><a href="#cb115-174" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-175"><a href="#cb115-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-176"><a href="#cb115-176" aria-hidden="true" tabindex="-1"></a><span class="fu">## Number of comments:</span></span>
<span id="cb115-177"><a href="#cb115-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-178"><a href="#cb115-178" aria-hidden="true" tabindex="-1"></a>This is an engagement metric for loyal readers - people who created an</span>
<span id="cb115-179"><a href="#cb115-179" aria-hidden="true" tabindex="-1"></a>account and can comment.</span>
<span id="cb115-180"><a href="#cb115-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-181"><a href="#cb115-181" aria-hidden="true" tabindex="-1"></a>Commenting requires user to log in, which is an indicator of greater</span>
<span id="cb115-182"><a href="#cb115-182" aria-hidden="true" tabindex="-1"></a>engagement of an individual user. Therefore this variable represents</span>
<span id="cb115-183"><a href="#cb115-183" aria-hidden="true" tabindex="-1"></a>engagement of a subset of users ("loyal readers").</span>
<span id="cb115-184"><a href="#cb115-184" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-185"><a href="#cb115-185" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-186"><a href="#cb115-186" aria-hidden="true" tabindex="-1"></a><span class="co"># merged$year_month </span></span>
<span id="cb115-187"><a href="#cb115-187" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>n.comments))<span class="sc">+</span></span>
<span id="cb115-188"><a href="#cb115-188" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"seagreen4"</span>)<span class="sc">+</span></span>
<span id="cb115-189"><a href="#cb115-189" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments histogram"</span>)</span>
<span id="cb115-190"><a href="#cb115-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-191"><a href="#cb115-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-192"><a href="#cb115-192" aria-hidden="true" tabindex="-1"></a>And change in the distribution over time:</span>
<span id="cb115-193"><a href="#cb115-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-194"><a href="#cb115-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-195"><a href="#cb115-195" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>n.comments, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb115-196"><a href="#cb115-196" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb115-197"><a href="#cb115-197" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of comments per post "</span>, <span class="at">y =</span> <span class="st">"Number of comments"</span> )<span class="sc">+</span></span>
<span id="cb115-198"><a href="#cb115-198" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">breaks =</span> <span class="fu">seq</span> (<span class="at">from=</span><span class="dv">0</span>, <span class="at">to=</span> <span class="dv">10000</span>, <span class="at">by=</span> <span class="dv">100</span>)) <span class="sc">+</span> </span>
<span id="cb115-199"><a href="#cb115-199" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb115-200"><a href="#cb115-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-201"><a href="#cb115-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-202"><a href="#cb115-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-203"><a href="#cb115-203" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2.IV. Independent variables:</span></span>
<span id="cb115-204"><a href="#cb115-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-205"><a href="#cb115-205" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.1.Popularity</span></span>
<span id="cb115-206"><a href="#cb115-206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-207"><a href="#cb115-207" aria-hidden="true" tabindex="-1"></a>"Uniques" variable represents number of unique people who came to the</span>
<span id="cb115-208"><a href="#cb115-208" aria-hidden="true" tabindex="-1"></a>page and viewed it at least once. This metric represents popularity of</span>
<span id="cb115-209"><a href="#cb115-209" aria-hidden="true" tabindex="-1"></a>the post. It has Poisson distribution:</span>
<span id="cb115-210"><a href="#cb115-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-211"><a href="#cb115-211" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-212"><a href="#cb115-212" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb115-213"><a href="#cb115-213" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>Uniques))<span class="sc">+</span></span>
<span id="cb115-214"><a href="#cb115-214" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"purple2"</span>)</span>
<span id="cb115-215"><a href="#cb115-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-216"><a href="#cb115-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-217"><a href="#cb115-217" aria-hidden="true" tabindex="-1"></a>We can see a long tail on the right, showing that there is a number of</span>
<span id="cb115-218"><a href="#cb115-218" aria-hidden="true" tabindex="-1"></a>posts who are way more popular than the majority of the sample.</span>
<span id="cb115-219"><a href="#cb115-219" aria-hidden="true" tabindex="-1"></a>Distribution of popularity over time also showing significant variance:</span>
<span id="cb115-220"><a href="#cb115-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-221"><a href="#cb115-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-222"><a href="#cb115-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-223"><a href="#cb115-223" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">y=</span>Uniques, <span class="at">x=</span>merged<span class="sc">$</span>year_month))<span class="sc">+</span></span>
<span id="cb115-224"><a href="#cb115-224" aria-hidden="true" tabindex="-1"></a>          <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb115-225"><a href="#cb115-225" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of unique viewers per month"</span>, <span class="at">x=</span><span class="st">"Month"</span>, <span class="at">y=</span><span class="st">"Number of unique viewers"</span>)<span class="sc">+</span> </span>
<span id="cb115-226"><a href="#cb115-226" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb115-227"><a href="#cb115-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-228"><a href="#cb115-228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-229"><a href="#cb115-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-230"><a href="#cb115-230" aria-hidden="true" tabindex="-1"></a>\</span>
<span id="cb115-231"><a href="#cb115-231" aria-hidden="true" tabindex="-1"></a>Next plot is illustrating connection between popularity and engagement</span>
<span id="cb115-232"><a href="#cb115-232" aria-hidden="true" tabindex="-1"></a>metrics:</span>
<span id="cb115-233"><a href="#cb115-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-234"><a href="#cb115-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-235"><a href="#cb115-235" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (merged, <span class="at">select=</span><span class="fu">c</span>(Uniques, e.rate, n.comments )))</span>
<span id="cb115-236"><a href="#cb115-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-237"><a href="#cb115-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-238"><a href="#cb115-238" aria-hidden="true" tabindex="-1"></a>We can see that popularity strongly correlated with exit rate, where an</span>
<span id="cb115-239"><a href="#cb115-239" aria-hidden="true" tabindex="-1"></a>increase in popularity causes decrease of engagement. It is not as</span>
<span id="cb115-240"><a href="#cb115-240" aria-hidden="true" tabindex="-1"></a>strongly correlated with number of comments. Engagement rate and number</span>
<span id="cb115-241"><a href="#cb115-241" aria-hidden="true" tabindex="-1"></a>of comments don't show obvious pattern between each other.</span>
<span id="cb115-242"><a href="#cb115-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-243"><a href="#cb115-243" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.2. Referral sources.</span></span>
<span id="cb115-244"><a href="#cb115-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-245"><a href="#cb115-245" aria-hidden="true" tabindex="-1"></a>The website analytics provides information on where the viewers are</span>
<span id="cb115-246"><a href="#cb115-246" aria-hidden="true" tabindex="-1"></a>coming from to the blog page. For example, if people clicked on the blog</span>
<span id="cb115-247"><a href="#cb115-247" aria-hidden="true" tabindex="-1"></a>link posted on FaceBook, that would be referral from social media. If</span>
<span id="cb115-248"><a href="#cb115-248" aria-hidden="true" tabindex="-1"></a>people clicked on the blog link within BDC website, that would be "BDC</span>
<span id="cb115-249"><a href="#cb115-249" aria-hidden="true" tabindex="-1"></a>referral visit".</span>
<span id="cb115-250"><a href="#cb115-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-251"><a href="#cb115-251" aria-hidden="true" tabindex="-1"></a>There are 5 sources of referrals, each corresponding with a variable in</span>
<span id="cb115-252"><a href="#cb115-252" aria-hidden="true" tabindex="-1"></a>the data set. Variable's value is a number of visits from this referral</span>
<span id="cb115-253"><a href="#cb115-253" aria-hidden="true" tabindex="-1"></a>source.</span>
<span id="cb115-254"><a href="#cb115-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-255"><a href="#cb115-255" aria-hidden="true" tabindex="-1"></a><span class="in">```         </span></span>
<span id="cb115-256"><a href="#cb115-256" aria-hidden="true" tabindex="-1"></a><span class="in">"Search + amp referral visits"</span></span>
<span id="cb115-257"><a href="#cb115-257" aria-hidden="true" tabindex="-1"></a><span class="in">"Direct (non-email) referral visits"</span></span>
<span id="cb115-258"><a href="#cb115-258" aria-hidden="true" tabindex="-1"></a><span class="in">"Other website referral visits"</span></span>
<span id="cb115-259"><a href="#cb115-259" aria-hidden="true" tabindex="-1"></a><span class="in">"Social referral visits"</span></span>
<span id="cb115-260"><a href="#cb115-260" aria-hidden="true" tabindex="-1"></a><span class="in">"BDC referral visits"</span></span>
<span id="cb115-261"><a href="#cb115-261" aria-hidden="true" tabindex="-1"></a><span class="in">"Visits when post was on LL HP" </span></span>
<span id="cb115-262"><a href="#cb115-262" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-263"><a href="#cb115-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-264"><a href="#cb115-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-265"><a href="#cb115-265" aria-hidden="true" tabindex="-1"></a><span class="co">#renaming variables for convenience: </span></span>
<span id="cb115-266"><a href="#cb115-266" aria-hidden="true" tabindex="-1"></a>merged<span class="ot">&lt;-</span>merged<span class="sc">%&gt;%</span></span>
<span id="cb115-267"><a href="#cb115-267" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">google =</span><span class="st">"Search + amp referral visits"</span>,</span>
<span id="cb115-268"><a href="#cb115-268" aria-hidden="true" tabindex="-1"></a>         <span class="at">direct =</span><span class="st">"Direct (non-email) referral visits"</span>,</span>
<span id="cb115-269"><a href="#cb115-269" aria-hidden="true" tabindex="-1"></a>         <span class="at">other.web =</span> <span class="st">"Other website referral visits"</span>,</span>
<span id="cb115-270"><a href="#cb115-270" aria-hidden="true" tabindex="-1"></a>          <span class="at">social=</span> <span class="st">"Social referral visits"</span>,</span>
<span id="cb115-271"><a href="#cb115-271" aria-hidden="true" tabindex="-1"></a>          <span class="at">bdc=</span> <span class="st">"BDC referral visits"</span>,</span>
<span id="cb115-272"><a href="#cb115-272" aria-hidden="true" tabindex="-1"></a>          <span class="at">ll=</span> <span class="st">"Visits when post was on LL HP"</span> )</span>
<span id="cb115-273"><a href="#cb115-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-274"><a href="#cb115-274" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>post.date))<span class="sc">+</span></span>
<span id="cb115-275"><a href="#cb115-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>google), <span class="at">color=</span><span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb115-276"><a href="#cb115-276" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>direct), <span class="at">color=</span><span class="st">"green"</span>)<span class="sc">+</span></span>
<span id="cb115-277"><a href="#cb115-277" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>other.web), <span class="at">color=</span><span class="st">"yellow"</span>)<span class="sc">+</span></span>
<span id="cb115-278"><a href="#cb115-278" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>social), <span class="at">color=</span><span class="st">"purple"</span>)<span class="sc">+</span></span>
<span id="cb115-279"><a href="#cb115-279" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>bdc), <span class="at">color=</span><span class="st">"blue"</span>)<span class="sc">+</span></span>
<span id="cb115-280"><a href="#cb115-280" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">y=</span>ll), <span class="at">color=</span><span class="st">"pink"</span>)  <span class="sc">+</span></span>
<span id="cb115-281"><a href="#cb115-281" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Referral sources per post "</span>, <span class="at">y =</span> <span class="st">"Number of referrals"</span> , <span class="at">x=</span><span class="st">"Post"</span>)<span class="sc">+</span> </span>
<span id="cb115-282"><a href="#cb115-282" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"green"</span>, <span class="st">"yellow"</span>, <span class="st">"purple"</span>, <span class="st">"blue"</span>, <span class="st">"pink"</span>),</span>
<span id="cb115-283"><a href="#cb115-283" aria-hidden="true" tabindex="-1"></a>                     <span class="at">labels =</span> <span class="fu">c</span>(<span class="st">"Google"</span>, <span class="st">"Direct"</span>, <span class="st">"Other Web"</span>, <span class="st">"Social"</span>, <span class="st">"Bdc"</span>, <span class="st">"LL"</span>))</span>
<span id="cb115-284"><a href="#cb115-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-285"><a href="#cb115-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-286"><a href="#cb115-286" aria-hidden="true" tabindex="-1"></a>This graph is showing of "Search + amp referral visits" have high</span>
<span id="cb115-287"><a href="#cb115-287" aria-hidden="true" tabindex="-1"></a>variability. Other referral sources range is much smaller. Here is the</span>
<span id="cb115-288"><a href="#cb115-288" aria-hidden="true" tabindex="-1"></a>plot of direct referrals per exit rate and goolge per exit rate:</span>
<span id="cb115-289"><a href="#cb115-289" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-290"><a href="#cb115-290" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-291"><a href="#cb115-291" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>direct , <span class="at">y=</span>e.rate))<span class="sc">+</span></span>
<span id="cb115-292"><a href="#cb115-292" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb115-293"><a href="#cb115-293" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Direct referrals and exit rate"</span>, <span class="at">x=</span><span class="st">"direct referrals"</span>, <span class="at">y=</span><span class="st">"Exit rate"</span>)</span>
<span id="cb115-294"><a href="#cb115-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-295"><a href="#cb115-295" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>google , <span class="at">y=</span>e.rate))<span class="sc">+</span></span>
<span id="cb115-296"><a href="#cb115-296" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb115-297"><a href="#cb115-297" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Google referrals and exit rate"</span>, <span class="at">x=</span><span class="st">"Googlereferrals"</span>, <span class="at">y=</span><span class="st">"Exit rate"</span>)</span>
<span id="cb115-298"><a href="#cb115-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-299"><a href="#cb115-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-300"><a href="#cb115-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-301"><a href="#cb115-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-302"><a href="#cb115-302" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.3. Post weekdays</span></span>
<span id="cb115-303"><a href="#cb115-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-304"><a href="#cb115-304" aria-hidden="true" tabindex="-1"></a>Calculating weekdays variable:</span>
<span id="cb115-305"><a href="#cb115-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-306"><a href="#cb115-306" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-307"><a href="#cb115-307" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(comments.data)</span></span>
<span id="cb115-308"><a href="#cb115-308" aria-hidden="true" tabindex="-1"></a><span class="co"># merged &lt;- merge( merged, post.date , by = "post_id", all = TRUE)</span></span>
<span id="cb115-309"><a href="#cb115-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-310"><a href="#cb115-310" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span>merged <span class="sc">%&gt;%</span></span>
<span id="cb115-311"><a href="#cb115-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span> (<span class="at">weekday =</span> <span class="fu">wday</span>(post.date, <span class="at">label =</span> <span class="cn">TRUE</span>))</span>
<span id="cb115-312"><a href="#cb115-312" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(merged<span class="sc">$</span>weekday)</span>
<span id="cb115-313"><a href="#cb115-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-314"><a href="#cb115-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-315"><a href="#cb115-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-316"><a href="#cb115-316" aria-hidden="true" tabindex="-1"></a>Posts are published Monday through Friday (with rare exceptions). No</span>
<span id="cb115-317"><a href="#cb115-317" aria-hidden="true" tabindex="-1"></a>posts are published on the weekend. Below is visualization of DV</span>
<span id="cb115-318"><a href="#cb115-318" aria-hidden="true" tabindex="-1"></a>distribution (exit rate and number of comment) per week day:</span>
<span id="cb115-319"><a href="#cb115-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-320"><a href="#cb115-320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-321"><a href="#cb115-321" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>weekday, <span class="at">y=</span>e.rate) )<span class="sc">+</span></span>
<span id="cb115-322"><a href="#cb115-322" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb115-323"><a href="#cb115-323" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb115-324"><a href="#cb115-324" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per weekday"</span>)</span>
<span id="cb115-325"><a href="#cb115-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-326"><a href="#cb115-326" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>weekday, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb115-327"><a href="#cb115-327" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>()<span class="sc">+</span></span>
<span id="cb115-328"><a href="#cb115-328" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb115-329"><a href="#cb115-329" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per weekday"</span>)</span>
<span id="cb115-330"><a href="#cb115-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-331"><a href="#cb115-331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-332"><a href="#cb115-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-333"><a href="#cb115-333" aria-hidden="true" tabindex="-1"></a>We can see that exit rate is overall lower on Tuesday, and number of</span>
<span id="cb115-334"><a href="#cb115-334" aria-hidden="true" tabindex="-1"></a>comments overall highest on Fridays.</span>
<span id="cb115-335"><a href="#cb115-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-336"><a href="#cb115-336" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.4. Authors comments</span></span>
<span id="cb115-337"><a href="#cb115-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-338"><a href="#cb115-338" aria-hidden="true" tabindex="-1"></a>To identify, how much the author of the blog is engaged in the post, I</span>
<span id="cb115-339"><a href="#cb115-339" aria-hidden="true" tabindex="-1"></a>will create an additional variable derived from a user_name field and</span>
<span id="cb115-340"><a href="#cb115-340" aria-hidden="true" tabindex="-1"></a>review the distribution of autor's comments :</span>
<span id="cb115-341"><a href="#cb115-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-342"><a href="#cb115-342" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-343"><a href="#cb115-343" aria-hidden="true" tabindex="-1"></a><span class="co"># str(merged)</span></span>
<span id="cb115-344"><a href="#cb115-344" aria-hidden="true" tabindex="-1"></a>comments.data<span class="sc">$</span>user_name<span class="ot">&lt;-</span>  <span class="fu">ifelse</span> (<span class="fu">is.na</span>(comments.data<span class="sc">$</span>user_name), <span class="dv">0</span>, comments.data<span class="sc">$</span>user_name)</span>
<span id="cb115-345"><a href="#cb115-345" aria-hidden="true" tabindex="-1"></a>comments.data<span class="sc">$</span>author<span class="ot">&lt;-</span>  <span class="fu">ifelse</span> (comments.data<span class="sc">$</span>user_name<span class="sc">==</span><span class="st">"MeredithGoldstein"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb115-346"><a href="#cb115-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-347"><a href="#cb115-347" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.data <span class="sc">%&gt;%</span></span>
<span id="cb115-348"><a href="#cb115-348" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(post_id)<span class="sc">%&gt;%</span></span>
<span id="cb115-349"><a href="#cb115-349" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n.comments=</span><span class="fu">n</span>(),</span>
<span id="cb115-350"><a href="#cb115-350" aria-hidden="true" tabindex="-1"></a>            <span class="at">author.sum =</span> <span class="fu">sum</span>(author))</span>
<span id="cb115-351"><a href="#cb115-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-352"><a href="#cb115-352" aria-hidden="true" tabindex="-1"></a><span class="co"># Comments data contains rows that dont actually reporesent posts, and were crearted by web support team for troubleshooting. I need to remove these rows. They typically have very low number of comments</span></span>
<span id="cb115-353"><a href="#cb115-353" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.grouped <span class="sc">%&gt;%</span></span>
<span id="cb115-354"><a href="#cb115-354" aria-hidden="true" tabindex="-1"></a><span class="fu">filter</span>(n.comments <span class="sc">&gt;</span><span class="dv">100</span>)  <span class="co"># removing invalid posts created by the  website management team.</span></span>
<span id="cb115-355"><a href="#cb115-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-356"><a href="#cb115-356" aria-hidden="true" tabindex="-1"></a>comments.grouped <span class="ot">&lt;-</span>comments.grouped <span class="sc">%&gt;%</span></span>
<span id="cb115-357"><a href="#cb115-357" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(post_id, author.sum)</span>
<span id="cb115-358"><a href="#cb115-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-359"><a href="#cb115-359" aria-hidden="true" tabindex="-1"></a><span class="co">#adding author.sum to main data set: </span></span>
<span id="cb115-360"><a href="#cb115-360" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> <span class="fu">merge</span>( merged , comments.grouped, <span class="at">by =</span> <span class="st">"post_id"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb115-361"><a href="#cb115-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-362"><a href="#cb115-362" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum) )<span class="sc">+</span></span>
<span id="cb115-363"><a href="#cb115-363" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()<span class="sc">+</span></span>
<span id="cb115-364"><a href="#cb115-364" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Authors comments distribution"</span>)</span>
<span id="cb115-365"><a href="#cb115-365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-366"><a href="#cb115-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-367"><a href="#cb115-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-368"><a href="#cb115-368" aria-hidden="true" tabindex="-1"></a>Authors comments per engagement metrics:</span>
<span id="cb115-369"><a href="#cb115-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-370"><a href="#cb115-370" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-371"><a href="#cb115-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-372"><a href="#cb115-372" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb115-373"><a href="#cb115-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb115-374"><a href="#cb115-374" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per author.sum"</span>)</span>
<span id="cb115-375"><a href="#cb115-375" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-376"><a href="#cb115-376" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>author.sum, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb115-377"><a href="#cb115-377" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb115-378"><a href="#cb115-378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per author.sum"</span>)</span>
<span id="cb115-379"><a href="#cb115-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-380"><a href="#cb115-380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-381"><a href="#cb115-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-382"><a href="#cb115-382" aria-hidden="true" tabindex="-1"></a>This graph shows, that majority of posts have no author's comments.</span>
<span id="cb115-383"><a href="#cb115-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-384"><a href="#cb115-384" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.5. Mood of the post.</span></span>
<span id="cb115-385"><a href="#cb115-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-386"><a href="#cb115-386" aria-hidden="true" tabindex="-1"></a>This is a numerical variable, calculated as a percentage of "thumbs up"</span>
<span id="cb115-387"><a href="#cb115-387" aria-hidden="true" tabindex="-1"></a>from all likes (both "thumbs up" and "thumbs down").</span>
<span id="cb115-388"><a href="#cb115-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-389"><a href="#cb115-389" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-390"><a href="#cb115-390" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb115-391"><a href="#cb115-391" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive) )<span class="sc">+</span></span>
<span id="cb115-392"><a href="#cb115-392" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"springgreen3"</span>)<span class="sc">+</span></span>
<span id="cb115-393"><a href="#cb115-393" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Mood of the post (pct.positive) distribution"</span>)</span>
<span id="cb115-394"><a href="#cb115-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-395"><a href="#cb115-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-396"><a href="#cb115-396" aria-hidden="true" tabindex="-1"></a>Plotting mood pf the post against engagement metrics:</span>
<span id="cb115-397"><a href="#cb115-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-398"><a href="#cb115-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-399"><a href="#cb115-399" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb115-400"><a href="#cb115-400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb115-401"><a href="#cb115-401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per pct.positive"</span>)</span>
<span id="cb115-402"><a href="#cb115-402" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-403"><a href="#cb115-403" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>pct.positive, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb115-404"><a href="#cb115-404" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb115-405"><a href="#cb115-405" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per pct.positive"</span>)</span>
<span id="cb115-406"><a href="#cb115-406" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-407"><a href="#cb115-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-408"><a href="#cb115-408" aria-hidden="true" tabindex="-1"></a>Distribution of mood over time:</span>
<span id="cb115-409"><a href="#cb115-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-410"><a href="#cb115-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-411"><a href="#cb115-411" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>pct.positive, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb115-412"><a href="#cb115-412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb115-413"><a href="#cb115-413" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"distribution of Mood per post "</span>, <span class="at">y =</span> <span class="st">"Mood"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb115-414"><a href="#cb115-414" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb115-415"><a href="#cb115-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-416"><a href="#cb115-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-417"><a href="#cb115-417" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2.6. Blocked comments per post.</span></span>
<span id="cb115-418"><a href="#cb115-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-419"><a href="#cb115-419" aria-hidden="true" tabindex="-1"></a>Now I will visualize amount of blocked comments per post. It also has</span>
<span id="cb115-420"><a href="#cb115-420" aria-hidden="true" tabindex="-1"></a>Poisson distribution.</span>
<span id="cb115-421"><a href="#cb115-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-422"><a href="#cb115-422" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-423"><a href="#cb115-423" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum) )<span class="sc">+</span></span>
<span id="cb115-424"><a href="#cb115-424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">fill =</span> <span class="st">"brown"</span>)<span class="sc">+</span></span>
<span id="cb115-425"><a href="#cb115-425" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"blocked.sum distribution"</span>)</span>
<span id="cb115-426"><a href="#cb115-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-427"><a href="#cb115-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-428"><a href="#cb115-428" aria-hidden="true" tabindex="-1"></a>Plotting blocked comments against engagement metrics:</span>
<span id="cb115-429"><a href="#cb115-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-430"><a href="#cb115-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-431"><a href="#cb115-431" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-432"><a href="#cb115-432" aria-hidden="true" tabindex="-1"></a> <span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum, <span class="at">y=</span>e.rate ))<span class="sc">+</span></span>
<span id="cb115-433"><a href="#cb115-433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb115-434"><a href="#cb115-434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Exit rate per blocked.sum"</span>)</span>
<span id="cb115-435"><a href="#cb115-435" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb115-436"><a href="#cb115-436" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (merged,  <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>blocked.sum, <span class="at">y=</span>n.comments) )<span class="sc">+</span></span>
<span id="cb115-437"><a href="#cb115-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb115-438"><a href="#cb115-438" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Number of comments per blocked.sum"</span>)</span>
<span id="cb115-439"><a href="#cb115-439" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-440"><a href="#cb115-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-441"><a href="#cb115-441" aria-hidden="true" tabindex="-1"></a>Distribution of blocked comments over time:</span>
<span id="cb115-442"><a href="#cb115-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-443"><a href="#cb115-443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-444"><a href="#cb115-444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-445"><a href="#cb115-445" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(merged, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>year_month , <span class="at">y=</span>blocked.sum, <span class="at">fill=</span>year_month ))<span class="sc">+</span></span>
<span id="cb115-446"><a href="#cb115-446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb115-447"><a href="#cb115-447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Number Blocked comments  per post "</span>, <span class="at">y =</span> <span class="st">"Number of blocked comments per post"</span> , <span class="at">x=</span><span class="st">"Month"</span>)<span class="sc">+</span> </span>
<span id="cb115-448"><a href="#cb115-448" aria-hidden="true" tabindex="-1"></a>     <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span>
<span id="cb115-449"><a href="#cb115-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-450"><a href="#cb115-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-451"><a href="#cb115-451" aria-hidden="true" tabindex="-1"></a><span class="fu"># 3. Creating a model for exit rate - all users engagement.</span></span>
<span id="cb115-452"><a href="#cb115-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-453"><a href="#cb115-453" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.1 Basic model.</span></span>
<span id="cb115-454"><a href="#cb115-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-455"><a href="#cb115-455" aria-hidden="true" tabindex="-1"></a>I will start with entering all of the independent variable in the model</span>
<span id="cb115-456"><a href="#cb115-456" aria-hidden="true" tabindex="-1"></a>and then eliminating ones that are not significant.</span>
<span id="cb115-457"><a href="#cb115-457" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-458"><a href="#cb115-458" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-459"><a href="#cb115-459" aria-hidden="true" tabindex="-1"></a><span class="co"># colnames(merged)</span></span>
<span id="cb115-460"><a href="#cb115-460" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques) <span class="sc">+</span>google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> author.sum <span class="sc">+</span>n.comments <span class="sc">+</span>blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-461"><a href="#cb115-461" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-462"><a href="#cb115-462" aria-hidden="true" tabindex="-1"></a>merged<span class="ot">&lt;-</span> merged <span class="sc">%&gt;%</span></span>
<span id="cb115-463"><a href="#cb115-463" aria-hidden="true" tabindex="-1"></a>     <span class="fu">mutate</span> (<span class="at">author.sum =</span>author.sum <span class="sc">+</span><span class="fl">0.001</span>,</span>
<span id="cb115-464"><a href="#cb115-464" aria-hidden="true" tabindex="-1"></a>          <span class="at">blocked.sum =</span>blocked.sum <span class="sc">+</span><span class="fl">0.001</span>)</span>
<span id="cb115-465"><a href="#cb115-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-466"><a href="#cb115-466" aria-hidden="true" tabindex="-1"></a><span class="co"># logging variables with Poisson distribution to see if that increases significantce.</span></span>
<span id="cb115-467"><a href="#cb115-467" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques) <span class="sc">+</span>google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> <span class="fu">log</span>(author.sum) <span class="sc">+</span>n.comments <span class="sc">+</span> <span class="fu">log</span>(blocked.sum) <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-468"><a href="#cb115-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-469"><a href="#cb115-469" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-470"><a href="#cb115-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-471"><a href="#cb115-471" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>, model<span class="fl">.2</span>, model<span class="fl">.3</span>,  <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb115-472"><a href="#cb115-472" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-473"><a href="#cb115-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-474"><a href="#cb115-474" aria-hidden="true" tabindex="-1"></a>Elimination of non-significant factors slightly impacted coefficients of</span>
<span id="cb115-475"><a href="#cb115-475" aria-hidden="true" tabindex="-1"></a>significant variables, and did not change R\^2 or adjusted R\^2 much.</span>
<span id="cb115-476"><a href="#cb115-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-477"><a href="#cb115-477" aria-hidden="true" tabindex="-1"></a>My next step is to diagnose this model:</span>
<span id="cb115-478"><a href="#cb115-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-479"><a href="#cb115-479" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.2. Diagnostic of linear models:</span></span>
<span id="cb115-480"><a href="#cb115-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-481"><a href="#cb115-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-482"><a href="#cb115-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-483"><a href="#cb115-483" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-484"><a href="#cb115-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-485"><a href="#cb115-485" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb115-486"><a href="#cb115-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-487"><a href="#cb115-487" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-488"><a href="#cb115-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-489"><a href="#cb115-489" aria-hidden="true" tabindex="-1"></a>We can see the issue with distribution of residuals in "Residuals vs</span>
<span id="cb115-490"><a href="#cb115-490" aria-hidden="true" tabindex="-1"></a>fitted" plot. This suggests non-linear relationship between variables.</span>
<span id="cb115-491"><a href="#cb115-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-492"><a href="#cb115-492" aria-hidden="true" tabindex="-1"></a>I will transform some referral variables to see if that gives me a</span>
<span id="cb115-493"><a href="#cb115-493" aria-hidden="true" tabindex="-1"></a>better model:</span>
<span id="cb115-494"><a href="#cb115-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-495"><a href="#cb115-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-496"><a href="#cb115-496" aria-hidden="true" tabindex="-1"></a><span class="co">#original model</span></span>
<span id="cb115-497"><a href="#cb115-497" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-498"><a href="#cb115-498" aria-hidden="true" tabindex="-1"></a><span class="co"># Logging Google referrals</span></span>
<span id="cb115-499"><a href="#cb115-499" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-500"><a href="#cb115-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-501"><a href="#cb115-501" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.3</span>, model<span class="fl">.4</span>, model<span class="fl">.5</span>,    <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb115-502"><a href="#cb115-502" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-503"><a href="#cb115-503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-504"><a href="#cb115-504" aria-hidden="true" tabindex="-1"></a>This table showing better fit when google variable is logged. Uniques'</span>
<span id="cb115-505"><a href="#cb115-505" aria-hidden="true" tabindex="-1"></a>coefficient also changed significantly as I am modified google variable.</span>
<span id="cb115-506"><a href="#cb115-506" aria-hidden="true" tabindex="-1"></a>That might indicate interaction between them, which I will explore later</span>
<span id="cb115-507"><a href="#cb115-507" aria-hidden="true" tabindex="-1"></a>in this paper.</span>
<span id="cb115-508"><a href="#cb115-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-509"><a href="#cb115-509" aria-hidden="true" tabindex="-1"></a>Now, I will log the rest of referral variables.</span>
<span id="cb115-510"><a href="#cb115-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-511"><a href="#cb115-511" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-512"><a href="#cb115-512" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-513"><a href="#cb115-513" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span><span class="fu">log</span>(other.web) <span class="sc">+</span><span class="fu">log</span>(social) <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-514"><a href="#cb115-514" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.6</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-515"><a href="#cb115-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-516"><a href="#cb115-516" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.4</span>,model<span class="fl">.5</span>,model<span class="fl">.6</span>,  <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb115-517"><a href="#cb115-517" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-518"><a href="#cb115-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-519"><a href="#cb115-519" aria-hidden="true" tabindex="-1"></a>All referral sources except "other.web" and "social" show better fit</span>
<span id="cb115-520"><a href="#cb115-520" aria-hidden="true" tabindex="-1"></a>when logged. Moving forward, I will use these two variables not logged:</span>
<span id="cb115-521"><a href="#cb115-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-522"><a href="#cb115-522" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-523"><a href="#cb115-523" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web<span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-524"><a href="#cb115-524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-525"><a href="#cb115-525" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model<span class="fl">.7</span>,  <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb115-526"><a href="#cb115-526" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-527"><a href="#cb115-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-528"><a href="#cb115-528" aria-hidden="true" tabindex="-1"></a>Diagnostics of model.7:</span>
<span id="cb115-529"><a href="#cb115-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-530"><a href="#cb115-530" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-531"><a href="#cb115-531" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb115-532"><a href="#cb115-532" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb115-533"><a href="#cb115-533" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-534"><a href="#cb115-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-535"><a href="#cb115-535" aria-hidden="true" tabindex="-1"></a>We still observe curvi-linear distribution of residuals.</span>
<span id="cb115-536"><a href="#cb115-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-537"><a href="#cb115-537" aria-hidden="true" tabindex="-1"></a>Now I will explore an interaction of referral sources with popularity</span>
<span id="cb115-538"><a href="#cb115-538" aria-hidden="true" tabindex="-1"></a>(variable "Uniques")</span>
<span id="cb115-539"><a href="#cb115-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-540"><a href="#cb115-540" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-541"><a href="#cb115-541" aria-hidden="true" tabindex="-1"></a><span class="co"># last model</span></span>
<span id="cb115-542"><a href="#cb115-542" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.7</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span><span class="fu">log</span>(bdc)<span class="sc">+</span>social  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-543"><a href="#cb115-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-544"><a href="#cb115-544" aria-hidden="true" tabindex="-1"></a><span class="co"># adding interaction with google: </span></span>
<span id="cb115-545"><a href="#cb115-545" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-546"><a href="#cb115-546" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.7</span>,model<span class="fl">.8</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb115-547"><a href="#cb115-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-548"><a href="#cb115-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-549"><a href="#cb115-549" aria-hidden="true" tabindex="-1"></a>Adding interaction between popularity and google referrals significantly</span>
<span id="cb115-550"><a href="#cb115-550" aria-hidden="true" tabindex="-1"></a>improved the model: interaction term has negative correlation with</span>
<span id="cb115-551"><a href="#cb115-551" aria-hidden="true" tabindex="-1"></a>dependent variable, it also made "social" referrals significant, and</span>
<span id="cb115-552"><a href="#cb115-552" aria-hidden="true" tabindex="-1"></a>improved models R\^2 and adjusted R\^2.</span>
<span id="cb115-553"><a href="#cb115-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-554"><a href="#cb115-554" aria-hidden="true" tabindex="-1"></a>It also significantly changed distribution of residuals: now</span>
<span id="cb115-555"><a href="#cb115-555" aria-hidden="true" tabindex="-1"></a>distribution is equally spread around 0.</span>
<span id="cb115-556"><a href="#cb115-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-557"><a href="#cb115-557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-558"><a href="#cb115-558" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-559"><a href="#cb115-559" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb115-560"><a href="#cb115-560" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb115-561"><a href="#cb115-561" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-562"><a href="#cb115-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-563"><a href="#cb115-563" aria-hidden="true" tabindex="-1"></a>Lets review other diagnostic plots:</span>
<span id="cb115-564"><a href="#cb115-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-565"><a href="#cb115-565" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-566"><a href="#cb115-566" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-567"><a href="#cb115-567" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb115-568"><a href="#cb115-568" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb115-569"><a href="#cb115-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-570"><a href="#cb115-570" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-571"><a href="#cb115-571" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb115-572"><a href="#cb115-572" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb115-573"><a href="#cb115-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-574"><a href="#cb115-574" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb115-575"><a href="#cb115-575" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb115-576"><a href="#cb115-576" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb115-577"><a href="#cb115-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-578"><a href="#cb115-578" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb115-579"><a href="#cb115-579" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb115-580"><a href="#cb115-580" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb115-581"><a href="#cb115-581" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-582"><a href="#cb115-582" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb115-583"><a href="#cb115-583" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.7</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb115-584"><a href="#cb115-584" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb115-585"><a href="#cb115-585" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-586"><a href="#cb115-586" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-587"><a href="#cb115-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-588"><a href="#cb115-588" aria-hidden="true" tabindex="-1"></a>We can see from both models, that variable 231 is an outlier that</span>
<span id="cb115-589"><a href="#cb115-589" aria-hidden="true" tabindex="-1"></a>significantly impacts the model. I will remove that observation and</span>
<span id="cb115-590"><a href="#cb115-590" aria-hidden="true" tabindex="-1"></a>re-evaluate the model:</span>
<span id="cb115-591"><a href="#cb115-591" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-592"><a href="#cb115-592" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-593"><a href="#cb115-593" aria-hidden="true" tabindex="-1"></a>merged.old <span class="ot">&lt;-</span> merged</span>
<span id="cb115-594"><a href="#cb115-594" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merged)</span>
<span id="cb115-595"><a href="#cb115-595" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(merged.old)</span>
<span id="cb115-596"><a href="#cb115-596" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">235</span>), ]</span>
<span id="cb115-597"><a href="#cb115-597" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.8</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged.old)</span>
<span id="cb115-598"><a href="#cb115-598" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-599"><a href="#cb115-599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-600"><a href="#cb115-600" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.8</span>,model<span class="fl">.9</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb115-601"><a href="#cb115-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-602"><a href="#cb115-602" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-603"><a href="#cb115-603" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb115-604"><a href="#cb115-604" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb115-605"><a href="#cb115-605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-606"><a href="#cb115-606" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-607"><a href="#cb115-607" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb115-608"><a href="#cb115-608" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb115-609"><a href="#cb115-609" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-610"><a href="#cb115-610" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-611"><a href="#cb115-611" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb115-612"><a href="#cb115-612" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb115-613"><a href="#cb115-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-614"><a href="#cb115-614" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-615"><a href="#cb115-615" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb115-616"><a href="#cb115-616" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb115-617"><a href="#cb115-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-618"><a href="#cb115-618" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-619"><a href="#cb115-619" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb115-620"><a href="#cb115-620" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb115-621"><a href="#cb115-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-622"><a href="#cb115-622" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-623"><a href="#cb115-623" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.8</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb115-624"><a href="#cb115-624" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb115-625"><a href="#cb115-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-626"><a href="#cb115-626" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-627"><a href="#cb115-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-628"><a href="#cb115-628" aria-hidden="true" tabindex="-1"></a>New, the variable "other.web" became insignificant, but model fit</span>
<span id="cb115-629"><a href="#cb115-629" aria-hidden="true" tabindex="-1"></a>improved.</span>
<span id="cb115-630"><a href="#cb115-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-631"><a href="#cb115-631" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.3. Improved model (model.9) .</span></span>
<span id="cb115-632"><a href="#cb115-632" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-633"><a href="#cb115-633" aria-hidden="true" tabindex="-1"></a>I will check whether "direct" referral sources have an interaction with</span>
<span id="cb115-634"><a href="#cb115-634" aria-hidden="true" tabindex="-1"></a>popularity as well (model 10) :</span>
<span id="cb115-635"><a href="#cb115-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-636"><a href="#cb115-636" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-637"><a href="#cb115-637" aria-hidden="true" tabindex="-1"></a><span class="co">#last model: </span></span>
<span id="cb115-638"><a href="#cb115-638" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.9</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">*</span><span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-639"><a href="#cb115-639" aria-hidden="true" tabindex="-1"></a><span class="co"># adding interaction to direct.</span></span>
<span id="cb115-640"><a href="#cb115-640" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.10</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(e.rate <span class="sc">~</span> <span class="fu">log</span>(google) <span class="sc">+</span><span class="fu">log</span>(Uniques)<span class="sc">*</span> <span class="fu">log</span>(direct) <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span><span class="fu">log</span>(bdc)  <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-641"><a href="#cb115-641" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.9</span>, model<span class="fl">.10</span>, <span class="at">type =</span> <span class="st">'text'</span> )</span>
<span id="cb115-642"><a href="#cb115-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-643"><a href="#cb115-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-644"><a href="#cb115-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-645"><a href="#cb115-645" aria-hidden="true" tabindex="-1"></a>Diagnostics:</span>
<span id="cb115-646"><a href="#cb115-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-647"><a href="#cb115-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-648"><a href="#cb115-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-649"><a href="#cb115-649" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-650"><a href="#cb115-650" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb115-651"><a href="#cb115-651" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">1</span>)</span>
<span id="cb115-652"><a href="#cb115-652" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-653"><a href="#cb115-653" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-654"><a href="#cb115-654" aria-hidden="true" tabindex="-1"></a>We can see model 9 ( with interaction between google and Uniques) shows</span>
<span id="cb115-655"><a href="#cb115-655" aria-hidden="true" tabindex="-1"></a>better residuals vs fitted plot. Model 10, however, demonstrates the</span>
<span id="cb115-656"><a href="#cb115-656" aria-hidden="true" tabindex="-1"></a>there is an interaction between popularity and direct referrals as well.</span>
<span id="cb115-657"><a href="#cb115-657" aria-hidden="true" tabindex="-1"></a>I will use both of these models to respond to my research question.</span>
<span id="cb115-658"><a href="#cb115-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-659"><a href="#cb115-659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-660"><a href="#cb115-660" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-661"><a href="#cb115-661" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb115-662"><a href="#cb115-662" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">2</span>)</span>
<span id="cb115-663"><a href="#cb115-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-664"><a href="#cb115-664" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-665"><a href="#cb115-665" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb115-666"><a href="#cb115-666" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">3</span>)</span>
<span id="cb115-667"><a href="#cb115-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-668"><a href="#cb115-668" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-669"><a href="#cb115-669" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb115-670"><a href="#cb115-670" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">4</span>)</span>
<span id="cb115-671"><a href="#cb115-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-672"><a href="#cb115-672" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-673"><a href="#cb115-673" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb115-674"><a href="#cb115-674" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb115-675"><a href="#cb115-675" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.11</span>, <span class="at">which =</span> <span class="dv">5</span>)</span>
<span id="cb115-676"><a href="#cb115-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-677"><a href="#cb115-677" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb115-678"><a href="#cb115-678" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.9</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb115-679"><a href="#cb115-679" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.10</span>, <span class="at">which =</span> <span class="dv">6</span>)</span>
<span id="cb115-680"><a href="#cb115-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-681"><a href="#cb115-681" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-682"><a href="#cb115-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-683"><a href="#cb115-683" aria-hidden="true" tabindex="-1"></a>Both models have similar R\^2 and adjusted R\^2.</span>
<span id="cb115-684"><a href="#cb115-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-685"><a href="#cb115-685" aria-hidden="true" tabindex="-1"></a>Calculation of AIC and BIC:</span>
<span id="cb115-686"><a href="#cb115-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-687"><a href="#cb115-687" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-688"><a href="#cb115-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-689"><a href="#cb115-689" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model<span class="fl">.9</span>) </span>
<span id="cb115-690"><a href="#cb115-690" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(model<span class="fl">.10</span>) </span>
<span id="cb115-691"><a href="#cb115-691" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model<span class="fl">.9</span>) </span>
<span id="cb115-692"><a href="#cb115-692" aria-hidden="true" tabindex="-1"></a><span class="fu">BIC</span>(model<span class="fl">.10</span>) </span>
<span id="cb115-693"><a href="#cb115-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-694"><a href="#cb115-694" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-695"><a href="#cb115-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-696"><a href="#cb115-696" aria-hidden="true" tabindex="-1"></a>AIC and BIC are very close.</span>
<span id="cb115-697"><a href="#cb115-697" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-698"><a href="#cb115-698" aria-hidden="true" tabindex="-1"></a>To summarize, models <span class="sc">\#</span> 9 and 10 demonstrated a good fit with high R\^2</span>
<span id="cb115-699"><a href="#cb115-699" aria-hidden="true" tabindex="-1"></a>value and good results in diagnostic plots. Each of them is visualizing</span>
<span id="cb115-700"><a href="#cb115-700" aria-hidden="true" tabindex="-1"></a>interaction between popularity and referral variable.</span>
<span id="cb115-701"><a href="#cb115-701" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-702"><a href="#cb115-702" aria-hidden="true" tabindex="-1"></a><span class="fu">### 3.4. Visualizing interaction:</span></span>
<span id="cb115-703"><a href="#cb115-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-704"><a href="#cb115-704" aria-hidden="true" tabindex="-1"></a>Moderating impact of referral source on relationship between popularity</span>
<span id="cb115-705"><a href="#cb115-705" aria-hidden="true" tabindex="-1"></a>and engagement:</span>
<span id="cb115-706"><a href="#cb115-706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-707"><a href="#cb115-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-708"><a href="#cb115-708" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(model<span class="fl">.9</span>, <span class="at">pred =</span>Uniques , <span class="at">modx =</span>  google, <span class="at">plot.points =</span> <span class="cn">TRUE</span>, <span class="at">data=</span>merged )</span>
<span id="cb115-709"><a href="#cb115-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-710"><a href="#cb115-710" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-711"><a href="#cb115-711" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-712"><a href="#cb115-712" aria-hidden="true" tabindex="-1"></a>This graph shows that for higher levels of Google impact of popularity</span>
<span id="cb115-713"><a href="#cb115-713" aria-hidden="true" tabindex="-1"></a>on exit rate will be lower (i.e. better engagement for the same level of</span>
<span id="cb115-714"><a href="#cb115-714" aria-hidden="true" tabindex="-1"></a>popularity) .</span>
<span id="cb115-715"><a href="#cb115-715" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-716"><a href="#cb115-716" aria-hidden="true" tabindex="-1"></a><span class="fu">### Moderating impact of direct referrals on relationship between popularity and engagement:</span></span>
<span id="cb115-717"><a href="#cb115-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-718"><a href="#cb115-718" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-719"><a href="#cb115-719" aria-hidden="true" tabindex="-1"></a><span class="fu">interact_plot</span>(model<span class="fl">.9</span>, <span class="at">pred =</span> Uniques, <span class="at">modx =</span> direct, <span class="at">plot.points =</span> <span class="cn">TRUE</span> )</span>
<span id="cb115-720"><a href="#cb115-720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-721"><a href="#cb115-721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-722"><a href="#cb115-722" aria-hidden="true" tabindex="-1"></a>Popularity generally decreases engagement. However, with higher levels</span>
<span id="cb115-723"><a href="#cb115-723" aria-hidden="true" tabindex="-1"></a>of direct , impact of popularity on exit rate will be lower.</span>
<span id="cb115-724"><a href="#cb115-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-725"><a href="#cb115-725" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4. Model for N.comments - loyal readers engagement:</span></span>
<span id="cb115-726"><a href="#cb115-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-727"><a href="#cb115-727" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.1. Basic model for n.comments</span></span>
<span id="cb115-728"><a href="#cb115-728" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-729"><a href="#cb115-729" aria-hidden="true" tabindex="-1"></a>Now I will create a model for n.comments as dependent variable, which</span>
<span id="cb115-730"><a href="#cb115-730" aria-hidden="true" tabindex="-1"></a>represents the engagement of loyal readers.</span>
<span id="cb115-731"><a href="#cb115-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-732"><a href="#cb115-732" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-733"><a href="#cb115-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-734"><a href="#cb115-734" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span> <span class="fu">log</span>(Uniques)<span class="sc">+</span> author.sum <span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-735"><a href="#cb115-735" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span> Uniques<span class="sc">+</span> author.sum <span class="sc">+</span> google <span class="sc">+</span>direct <span class="sc">+</span>other.web <span class="sc">+</span>social <span class="sc">+</span>bdc <span class="sc">+</span> ll <span class="sc">+</span> blocked.sum <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-736"><a href="#cb115-736" aria-hidden="true" tabindex="-1"></a><span class="co">#removing unsignificant variables:</span></span>
<span id="cb115-737"><a href="#cb115-737" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-738"><a href="#cb115-738" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.1</span>,model<span class="fl">.2</span>, model<span class="fl">.3</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb115-739"><a href="#cb115-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-740"><a href="#cb115-740" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-741"><a href="#cb115-741" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-742"><a href="#cb115-742" aria-hidden="true" tabindex="-1"></a><span class="fu">## 4.2. Diagnostics:</span></span>
<span id="cb115-743"><a href="#cb115-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-744"><a href="#cb115-744" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-745"><a href="#cb115-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-746"><a href="#cb115-746" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-747"><a href="#cb115-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-748"><a href="#cb115-748" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb115-749"><a href="#cb115-749" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.3</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb115-750"><a href="#cb115-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-751"><a href="#cb115-751" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-752"><a href="#cb115-752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-753"><a href="#cb115-753" aria-hidden="true" tabindex="-1"></a>Observation #48 looks like on outlier impacting the model. I will remove</span>
<span id="cb115-754"><a href="#cb115-754" aria-hidden="true" tabindex="-1"></a>this observation to see if that gives us any different results:</span>
<span id="cb115-755"><a href="#cb115-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-756"><a href="#cb115-756" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-757"><a href="#cb115-757" aria-hidden="true" tabindex="-1"></a>merged.old <span class="ot">&lt;-</span> merged</span>
<span id="cb115-758"><a href="#cb115-758" aria-hidden="true" tabindex="-1"></a>merged <span class="ot">&lt;-</span> merged[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">48</span>), ]</span>
<span id="cb115-759"><a href="#cb115-759" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged.old )</span>
<span id="cb115-760"><a href="#cb115-760" aria-hidden="true" tabindex="-1"></a>model<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">lm</span>(n.comments <span class="sc">~</span>  direct  <span class="sc">+</span>social <span class="sc">+</span> ll  <span class="sc">+</span> pct.positive <span class="sc">+</span>weekday , <span class="at">data =</span> merged)</span>
<span id="cb115-761"><a href="#cb115-761" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>( model<span class="fl">.3</span>, model<span class="fl">.4</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb115-762"><a href="#cb115-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-763"><a href="#cb115-763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-764"><a href="#cb115-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-765"><a href="#cb115-765" aria-hidden="true" tabindex="-1"></a>We can see that removing #48 changed some coefficients, did not impact</span>
<span id="cb115-766"><a href="#cb115-766" aria-hidden="true" tabindex="-1"></a>significance of variables. It also improved R\^2 and adjusted R\^2.</span>
<span id="cb115-767"><a href="#cb115-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-768"><a href="#cb115-768" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-769"><a href="#cb115-769" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">3</span>))</span>
<span id="cb115-770"><a href="#cb115-770" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(model<span class="fl">.4</span>, <span class="at">which =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>)</span>
<span id="cb115-771"><a href="#cb115-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-772"><a href="#cb115-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-773"><a href="#cb115-773" aria-hidden="true" tabindex="-1"></a>In the first and third plot we can see values being concentrated</span>
<span id="cb115-774"><a href="#cb115-774" aria-hidden="true" tabindex="-1"></a>unevenly, which suggests hetersroscedasticity of the variables.</span>
<span id="cb115-775"><a href="#cb115-775" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-776"><a href="#cb115-776" aria-hidden="true" tabindex="-1"></a><span class="fu"># 4. Conlusion</span></span>
<span id="cb115-777"><a href="#cb115-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-778"><a href="#cb115-778" aria-hidden="true" tabindex="-1"></a>We have build tree models for different engagement metrics: engagement</span>
<span id="cb115-779"><a href="#cb115-779" aria-hidden="true" tabindex="-1"></a>of all readers (model 9 and 10) and engagement of loyal readers (model</span>
<span id="cb115-780"><a href="#cb115-780" aria-hidden="true" tabindex="-1"></a>4) . As we can see from the models, different factors contribute to</span>
<span id="cb115-781"><a href="#cb115-781" aria-hidden="true" tabindex="-1"></a>engagement of these two groups of readers:</span>
<span id="cb115-782"><a href="#cb115-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-783"><a href="#cb115-783" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb115-784"><a href="#cb115-784" aria-hidden="true" tabindex="-1"></a><span class="fu">stargazer</span>(model<span class="fl">.9</span>, model<span class="fl">.10</span>, model<span class="fl">.4</span>, <span class="at">type =</span> <span class="st">'text'</span>)</span>
<span id="cb115-785"><a href="#cb115-785" aria-hidden="true" tabindex="-1"></a><span class="co">#  sink("output.txt")</span></span>
<span id="cb115-786"><a href="#cb115-786" aria-hidden="true" tabindex="-1"></a><span class="co"># stargazer(model.9, model.10, model.4, type = 'text')</span></span>
<span id="cb115-787"><a href="#cb115-787" aria-hidden="true" tabindex="-1"></a><span class="co">#   dev.off()</span></span>
<span id="cb115-788"><a href="#cb115-788" aria-hidden="true" tabindex="-1"></a><span class="co">#  sink(type = "output")</span></span>
<span id="cb115-789"><a href="#cb115-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb115-790"><a href="#cb115-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-791"><a href="#cb115-791" aria-hidden="true" tabindex="-1"></a>The main colclusion is that all users and loyal users's engagement</span>
<span id="cb115-792"><a href="#cb115-792" aria-hidden="true" tabindex="-1"></a>should be described by different models, as the are influenced by</span>
<span id="cb115-793"><a href="#cb115-793" aria-hidden="true" tabindex="-1"></a>different variables andvariables' combinations.</span>
<span id="cb115-794"><a href="#cb115-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-795"><a href="#cb115-795" aria-hidden="true" tabindex="-1"></a>We can see, that a few referral sources contribute to users engagement.</span>
<span id="cb115-796"><a href="#cb115-796" aria-hidden="true" tabindex="-1"></a>All readers'engagement (measured with exit rate) is influenced by</span>
<span id="cb115-797"><a href="#cb115-797" aria-hidden="true" tabindex="-1"></a>interaction of referrals from Google and Direct and popularity, internal</span>
<span id="cb115-798"><a href="#cb115-798" aria-hidden="true" tabindex="-1"></a>bdc referrals and somewhat referrals from other web sources.</span>
<span id="cb115-799"><a href="#cb115-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-800"><a href="#cb115-800" aria-hidden="true" tabindex="-1"></a>Loyal readers' engagement is highly impacted by the mood of the post,</span>
<span id="cb115-801"><a href="#cb115-801" aria-hidden="true" tabindex="-1"></a>internal page referrals, social referrals. They also show some direct</span>
<span id="cb115-802"><a href="#cb115-802" aria-hidden="true" tabindex="-1"></a>referrals' impact, but very small in compare with its influence on all</span>
<span id="cb115-803"><a href="#cb115-803" aria-hidden="true" tabindex="-1"></a>users' engagement.</span>
<span id="cb115-804"><a href="#cb115-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-805"><a href="#cb115-805" aria-hidden="true" tabindex="-1"></a>We also see significant contribution of day of the week on readers</span>
<span id="cb115-806"><a href="#cb115-806" aria-hidden="true" tabindex="-1"></a>engagement. Specifically, Monday's engagement of all readers is</span>
<span id="cb115-807"><a href="#cb115-807" aria-hidden="true" tabindex="-1"></a>significantly lower than any other day. For loyal readers, Wednesday</span>
<span id="cb115-808"><a href="#cb115-808" aria-hidden="true" tabindex="-1"></a>showing thee lowest engagement.</span>
<span id="cb115-809"><a href="#cb115-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-810"><a href="#cb115-810" aria-hidden="true" tabindex="-1"></a>It also important to point out, that popularity of the post (Uniques)</span>
<span id="cb115-811"><a href="#cb115-811" aria-hidden="true" tabindex="-1"></a>only plays a role for all user's engagement. Loyal readers appear not</span>
<span id="cb115-812"><a href="#cb115-812" aria-hidden="true" tabindex="-1"></a>being impacted by popularity. Impact of popularity (Uniques) is</span>
<span id="cb115-813"><a href="#cb115-813" aria-hidden="true" tabindex="-1"></a>moderated by Google and Direct referrals, where the posts with higher</span>
<span id="cb115-814"><a href="#cb115-814" aria-hidden="true" tabindex="-1"></a>amounts of referrals show overall better engagement.</span>
<span id="cb115-815"><a href="#cb115-815" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-816"><a href="#cb115-816" aria-hidden="true" tabindex="-1"></a>To conclude, we found significant connection between the referral source</span>
<span id="cb115-817"><a href="#cb115-817" aria-hidden="true" tabindex="-1"></a>and readers engagement. Most ofthe influencing factors related to the</span>
<span id="cb115-818"><a href="#cb115-818" aria-hidden="true" tabindex="-1"></a>source of readers and timing(day of the week), with the exception of</span>
<span id="cb115-819"><a href="#cb115-819" aria-hidden="true" tabindex="-1"></a>post mood positively impacting loyal readers engagement.</span>
<span id="cb115-820"><a href="#cb115-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-821"><a href="#cb115-821" aria-hidden="true" tabindex="-1"></a>Limitations: The role of Google referrals needs to be explored further,</span>
<span id="cb115-822"><a href="#cb115-822" aria-hidden="true" tabindex="-1"></a>to identify how posts with high level of Google referrals contibute to</span>
<span id="cb115-823"><a href="#cb115-823" aria-hidden="true" tabindex="-1"></a>this model. Also, finding out a cause of some pots having high Google</span>
<span id="cb115-824"><a href="#cb115-824" aria-hidden="true" tabindex="-1"></a>referral rate would be beneficial for the blog development.</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>