---
title: "Final Project"
author: "Thrishul Pola"
description: "Final Project"
date: "5/2/2023"
format:
  html:
    df-print: paged
    css: styles.css
    toc: true
    code-fold: true
    code-copy: true
    code-tools: true
categories:
  - Final_Project
---

# Research Question

Can the reading and writing scores of students be used as predictors for their math exam scores?

## Hypothesis

The math exam scores of students are positively associated with their reading and writing scores.


## Importing Libraries

```{r}
library(tidyverse) 
library(ggplot2)
library(dplyr)
library(fBasics) 
library(kableExtra)
library(funModeling)
library(plotly)
library(MASS)
library(corrplot)

```

## Reading and Analysing Dataset
```{r}
data <- read_csv("_data/S.csv", show_col_types = FALSE)
names_columns <- c("gender","race","parent_education","lunch","test_prep","math_score","reading_score","writing_score")
colnames(data) <- names_columns
```
# Dataset Description

The "Students Performance in Exams" dataset contains information about the marks obtained by students in different subjects. The dataset consists of 1000 rows and 8 features.

The categorical features in the dataset include:

Gender: Indicates whether the student is female or male.
Race/Ethnicity: Represents the group to which the student belongs, categorized as Group A, Group B, Group C, Group D, or Group E.
Parental Level of Education: Reflects the educational level of the student's parents, such as associate's degree, bachelor's degree, high school, etc.
Lunch: Specifies the type of lunch provided to the student, categorized as either free/reduced or standard.
Test Preparation Course: Indicates whether the student completed a test preparation course or not.

The numerical features in the dataset are:

Math Score: Represents the marks obtained by the student in the math subject.
Reading Score: Represents the marks obtained by the student in the reading subject.
Writing Score: Represents the marks obtained by the student in the writing subject.
All the scores in the dataset are measured on a scale of 0 to 100.

The dataset provides valuable insights into the performance of students in exams across various subjects. By analyzing this data, we can explore the relationships between different features and understand the factors that influence students' academic achievements.
```{r}
summary(data)
head(data, 10)
```
```{r}
str(data)
anyNA(data)
```
```{r}

freq(data$gender)
```

It can be observed that among the students included, approximately 51.8% of them are female students. This indicates that the majority of the students in the dataset are female.

On the other hand, approximately 48.2% of the students in the dataset are male students. This suggests that male students make up a slightly smaller portion of the total student population compared to female students.

Overall, the dataset represents a relatively balanced distribution in terms of gender, with a slightly higher proportion of female students.

```{r}
freq(data$race)
```

It can be observed that Group C is the most prevalent race/ethnicity among the students. This suggests that a larger number of students in the dataset belong to Group C compared to the other race/ethnicity categories while  Group A is the least represented race/ethnicity among the students.

```{r}

freq(data$parent_education)
```
Above chart reveal the distribution of parent education levels among the students in the dataset. Out of the total number of students, 226 individuals (22.6%) reported having their parents pursued some college education

```{r}
freq(data$lunch)

```
Standard Price Lunch: 64.5%
Approximately 64.5% of the students in the dataset eat lunch at the standard price. This indicates that the majority of the students opt for the standard-priced lunch option.

Free/Reduced Lunch: 35.5%
About 35.5% of the students in the dataset eat lunch at a free or reduced price. This suggests that a smaller portion of the students qualify for and choose the free or reduced lunch option.

```{r}
ggplot(data,aes(data$gender, fill=data$race))+
  geom_bar(position=position_dodge())+
  ggtitle("Ethnic Group distribution by Gender")+
  xlab("Gender")+
  ylab("Frequency")

```
I have compared the gender with their race type and its interesting to see that the majority of students in the dataset are from group C followed by group D race.

So, keeping all the analysed information in mind i want to conduct the correlation analysis for the variables Math, Reading and Writing scores and see if there is any correlation between the variables.

```{r}
profiling_num(data)

```


```{r}

plot_num(data)

```
Based on our hypothesis that the math exam scores of students are positively associated with their reading and writing scores, the findings from the profiling analysis and also plot chart provide evidence supporting this hypothesis. The average scores for math, reading, and writing are relatively close, indicating a positive association between these subjects.

## Math Scores based on Reading and Writing Scores

```{r}
# scatter plot
ggplot(data, aes(x = reading_score, y = writing_score, color = math_score)) +
  geom_point() +
  labs(x = "Reading Score", y = "Writing Score", 
       title = "Math Scores based on Reading and Writing Scores") +
  theme_minimal()
```


## Math Scores based on Gender
```{r}


# Calculate mean math score by gender
mean_scores <- data %>%
  group_by(gender) %>%
  summarise(mean_math_score = mean(math_score))

# bar chart
ggplot(mean_scores, aes(x = gender, y = mean_math_score)) +
  geom_bar(stat = "identity", fill = "steelblue") +
  labs(x = "Gender", y = "Mean Math Score", 
       title = "Mean Math Scores by Gender") +
  theme_minimal() +
  geom_text(aes(label = round(mean_math_score, 2)), vjust = -0.5, color = "black")



```
The chart reveals that the mean math score for males is approximately 68.73, indicating a relatively higher average performance in math compared to females . On the other hand,females have a mean math score of around 63.63, suggesting a slightly lower average performance in math compared to males . These findings highlight a gender-based difference in math scores, with males demonstrating a higher average math score compared to females.

## Math Scores based on Race
```{r}

# Calculate mean math score by race
mean_scores <- data %>%
  group_by(race) %>%
  summarise(mean_math_score = mean(math_score))

# bar chart
ggplot(data, aes(x = race, y = math_score)) +
  geom_bar(stat = "summary", fun = "mean", fill = "steelblue") +
  labs(x = "Race", y = "Math Score", 
       title = "Math Scores by Race") +
  theme_minimal() +
  geom_text(data = mean_scores, aes(x = race, y = mean_math_score, 
                                   label = paste0("Mean: ", round(mean_math_score, 2))),
            vjust = -0.5, color = "black")



```
These findings highlight the variations in math scores across different race categories, with Group E demonstrating the highest average score and Group A showing the lowest average score performance.

## Math Scores based on Parents Education Level

```{r}

# bar chart
ggplot(data, aes(x = parent_education, y = math_score)) +
  geom_bar(stat = "summary", fun = "mean", fill = "steelblue") +
  labs(x = "Parental Education Level", y = "Math Score", 
       title = "Math Scores by Parental Education Level") +
  theme_minimal()

```
Even thought there is a little difference in the math scores there is not significant difference based on their parents education level



```{r}
library(ggplot2)
library(dplyr)

# Calculate mean math score by lunch type
mean_scores <- data %>%
  group_by(lunch) %>%
  summarise(mean_math_score = mean(math_score))

# bar chart
ggplot(data, aes(x = lunch, y = math_score)) +
  geom_bar(stat = "summary", fun = "mean", fill = "steelblue") +
  labs(x = "Lunch Type", y = "Math Score",
       title = "Math Scores by Lunch Type") +
  theme_minimal() +
  geom_text(data = mean_scores, aes(x = lunch, y = mean_math_score,
                                   label = paste0("Mean: ", round(mean_math_score, 2))),
            vjust = -0.5, color = "black")


```
It is interesting to see the math score of students based on their lunch type. Students how are taking standard meal are performing better at math as compared to people taking free or reduced lunch option. 


## Correlation Matrix of Math, Reading, and Writing Scores

```{r}
num_data <- data[, c( "math_score", "reading_score", "writing_score")]
m<-cor(num_data)
m
corrplot(m, method="circle", type='upper', tl.cex=0.8, tl.col = 'black')
```
The correlation analysis reveals interesting insights into the relationships between math scores, reading scores, and writing scores. The strong positive correlation coefficient of 0.8176 between math_score and reading_score suggests that students who excel in math also tend to perform well in reading. Similarly, the high correlation coefficient of 0.8026 between math_score and writing_score indicates a strong positive association, indicating that students who demonstrate proficiency in math often display strong writing skills as well. Furthermore, the very high correlation coefficient of 0.9546 between reading_score and writing_score highlights a robust positive relationship, indicating that students who excel in reading are highly likely to excel in writing.

Taken together, these findings provide substantial evidence supporting our hypothesis that math exam scores are positively associated with both reading and writing scores. These results suggest that students who demonstrate proficiency in one subject area are more likely to excel in the other subjects as well, reinforcing the idea of a positive relationship between math scores and reading/writing scores.

## Comparison of Math Scores between Male and Female Students

### T-Test
```{r}
# T-test for math scores
ttest_math <- t.test(math_score ~ gender, data = data)
ttest_math
```

### One-way ANOVA Test
```{r}
# One-way ANOVA for all three subjects
anova_scores <- aov(math_score + reading_score + writing_score ~ gender, data = data)
summary(anova_scores)
```

Based on the analysis conducted, we performed a Welch Two Sample t-test to examine the differences in math scores between male and female students. The results indicate that there is a statistically significant disparity in the mean math scores between the two groups (t = -5.398, df = 997.98, p-value = 8.421e-08). It was found that the mean math score for females (63.63) is significantly lower compared to males (68.73) with a 95% confidence interval ranging from -6.947209 to -3.242813.

Furthermore, we conducted a one-way ANOVA to explore the impact of gender on math, reading, and writing scores. The ANOVA results demonstrate a significant effect of gender on math scores (F = 17.39, p < 0.001). However, this analysis does not provide information regarding the relationship between math scores and reading/writing scores.

In summary, our analysis reveals a significant difference in math scores between male and female students, with males demonstrating higher performance in this subject compared to females. These findings highlight the influence of gender on academic achievement, particularly in the context of math

# Linear Regression Models for Predicting Math Scores

```{r}

set.seed(123)
train_idx <- sample(nrow(data), nrow(data) * 0.7)
train_data <- data[train_idx, ]
test_data <- data[-train_idx, ]


model1 <- lm(math_score ~ reading_score + writing_score, data = train_data)
predictions1 <- predict(model1, newdata = test_data)
rmse1 <- sqrt(mean((test_data$math_score - predictions1)^2))
r_squared1 <- summary(model1)$r.squared
r_squared1

model2 <- lm(math_score ~ writing_score * reading_score + gender, data = train_data)
predictions2 <- predict(model2, newdata = test_data)
rmse2 <- sqrt(mean((test_data$math_score - predictions2)^2))
r_squared2 <- summary(model2)$r.squared

r_squared2

model3 <- lm(math_score ~  ., data = train_data)
predictions3 <- predict(model3, newdata = test_data)
rmse3 <- sqrt(mean((test_data$math_score - predictions3)^2))
r_squared3 <- summary(model3)$r.squared

r_squared3
```

### Model Comparison using AIC and BIC

```{r}
str(data)
AIC(model1,model2, model3)
BIC(model1,model2, model3)
```

Models 1 and 2 both include the predictors reading_score and writing_score. They have similar R-squared values (around 0.663) and RMSE values (8.753639), indicating that they explain approximately 66.3% of the variance in math scores and have similar predictive performance.

Model 3, which includes all available predictors, yields a higher R-squared value of 0.8774988. This suggests that it explains a larger proportion (approximately 87.7%) of the variance in math scores compared to Models 1 and 2. Additionally, Model 3 has the lowest AIC and BIC values, indicating a better fit compared to the other models.

Overall, the results support our hypothesis that there is a positive association between math scores and reading/writing scores. Model 3, which includes all predictors, provides the best fit and explains the most variance in math scores. This suggests that including additional factors beyond just reading and writing scores can improve the accuracy of predicting math scores.

```{r}
plot(model3)

```

# Regression Diagnostics

```{r}
library(stargazer)

stargazer(model1, model2, model3, type = "text")

```


The linear regression models provide insights into the relationship between math scores and relevant variables based on our hypothesis. Here are the key findings:

Model 1:

Gender: Being male is associated with an average increase of 13.392 points in math score compared to females.
Lunch: Students having a standard lunch score, on average, 3.029 points higher in math compared to students with a free/reduced lunch.
Test Preparation: Students who completed a test preparation course score, on average, 3.775 points higher in math compared to students who did not complete the course.
Reading Score: A one-point increase in reading score is associated with a 0.539-point increase in math score.

Model 2:

The interaction term between writing score and reading score does not have a statistically significant impact on math scores.

Model 3:

Writing Score: A one-point increase in writing score is associated with a 0.750-point increase in math score.
Overall, the regression models suggest that gender, lunch type, test preparation, reading score, and writing score have statistically significant associations with math scores. However, the impact of race/ethnicity and parental education levels on math scores is not statistically significant based on the given models.

# Conclusion

In conclusion, our research focused on examining the factors influencing math scores among students. We analyzed a dataset containing information on various variables such as gender, race/ethnicity, parental education, lunch type, test preparation, and scores in reading and writing.

Our findings revealed several important insights. Firstly, gender played a significant role, with male students showing higher math scores compared to females. Additionally, the type of lunch and completion of a test preparation course were also found to have a positive impact on math scores. Students who had a standard lunch and completed a test preparation course tended to perform better in math.

Furthermore, the scores in reading and writing were strongly correlated with math scores. Higher scores in reading and writing were associated with higher math scores. However, the impact of race/ethnicity and parental education on math scores was found to be statistically insignificant.

Overall, our research suggests that gender, lunch type, test preparation, and literacy skills (reading and writing) are important factors influencing math scores among students. 

It is important to note that this research was based on a specific dataset and may not capture all possible factors influencing math scores. Further research and exploration are recommended to gain a comprehensive understanding of the complex dynamics affecting students' math performance.

# Bibilography

Dataset : "Students Performance in Exams" Dataset. Retrieved from https://www.kaggle.com/datasets/spscientist/students-performance-in-exams

Johnson, R. A. (2010). Applied Multivariate Statistical Analysis (6th ed.). Pearson Education.

Field, A. (2013). Discovering Statistics Using R. SAGE Publications Ltd.

Wickham, H. (2016). ggplot2: Elegant Graphics for Data Analysis. Springer.