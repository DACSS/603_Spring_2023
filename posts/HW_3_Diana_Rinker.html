<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.340">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Diana Rinker">
<meta name="dcterms.date" content="2023-04-11">
<meta name="description" content="HW3">

<title>Homework 3</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta name="twitter:title" content="Homework 3">
<meta name="twitter:description" content="HW3">
<meta name="twitter:image" content="https://dacss.github.io/603_Spring_2023/posts/HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-2-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="true"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target="">
 <span class="menu-text">Spring 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#dacss-603-spring-2023" id="toc-dacss-603-spring-2023" class="nav-link active" data-scroll-target="#dacss-603-spring-2023">DACSS 603, spring 2023</a></li>
  <li><a href="#homework-3-diana-rinker." id="toc-homework-3-diana-rinker." class="nav-link" data-scroll-target="#homework-3-diana-rinker.">Homework 3, Diana Rinker.</a></li>
  <li><a href="#question-1" id="toc-question-1" class="nav-link" data-scroll-target="#question-1">Question 1</a></li>
  <li><a href="#question-2" id="toc-question-2" class="nav-link" data-scroll-target="#question-2">Question 2</a></li>
  <li><a href="#question-3" id="toc-question-3" class="nav-link" data-scroll-target="#question-3">Question 3</a></li>
  <li><a href="#question-4" id="toc-question-4" class="nav-link" data-scroll-target="#question-4">Question 4</a></li>
  <li><a href="#question-5" id="toc-question-5" class="nav-link" data-scroll-target="#question-5">Question 5</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Homework 3</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>

<div>
  <div class="description">
    HW3
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Diana Rinker </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 11, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="dacss-603-spring-2023" class="level1">
<h1>DACSS 603, spring 2023</h1>
</section>
<section id="homework-3-diana-rinker." class="level1">
<h1>Homework 3, Diana Rinker.</h1>
<p>Loading necessary libraries:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'dplyr'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:stats':

    filter, lag</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following objects are masked from 'package:base':

    intersect, setdiff, setequal, union</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: car</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attaching package: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>The following object is masked from 'package:dplyr':

    recode</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Loading required package: effects</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>lattice theme set by effectsTheme()
See ?effectsTheme for details.</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smss)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="question-1" class="level1">
<h1>Question 1</h1>
<p><strong>United Nations (Data file: UN11 in alr4) The data in the file UN11 contains several variables, including ppgdp, the gross national product per person in U.S. dollars, and fertility, the birth rate per 1000 females, both from the year 2009. The data are for 199 localities, mostly UN member countries, but also other areas such as Hong Kong that are not independent countries. The data were collected from the United Nations (2011). <u>We will study the dependence of fertility on ppgdp.</u></strong></p>
<ol type="a">
<li><p><strong>Identify the predictor and the response.</strong></p>
<p>DV/response: fertility</p>
<p>IV/predictor: ppgdp</p></li>
<li><p><strong>Draw the scatterplot of fertility on the vertical axis versus ppgdp on the horizontal axis and summarize the information in this graph. Does a straight-line mean function seem to be plausible for a summary of this graph?</strong></p></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(UN11)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(UN11)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   199 obs. of  6 variables:
 $ region   : Factor w/ 8 levels "Africa","Asia",..: 2 4 1 1 3 5 2 3 8 4 ...
 $ group    : Factor w/ 3 levels "oecd","other",..: 2 2 3 3 2 2 2 2 1 1 ...
 $ fertility: num  5.97 1.52 2.14 5.13 2 ...
 $ ppgdp    : num  499 3677 4473 4322 13750 ...
 $ lifeExpF : num  49.5 80.4 75 53.2 81.1 ...
 $ pctUrban : num  23 53 67 59 100 93 64 47 89 68 ...
 - attr(*, "na.action")= 'omit' Named int [1:34] 4 5 8 28 41 67 68 72 79 83 ...
  ..- attr(*, "names")= chr [1:34] "Am Samoa" "Andorra" "Antigua and Barbuda" "Br Virigin Is" ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data=</span>UN11, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x=</span>ppgdp, <span class="at">y =</span>fertility ))<span class="sc">+</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)<span class="sc">+</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(UN11<span class="sc">$</span>fertility), <span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of fertility by ppgdp"</span>)<span class="sc">+</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the graph above it is obvious, that the straight line mean is not representative of the data. Even if be draw a linear model with “stat_smooth(method =”lm”, se = T)“, the line is still far from most datapoints ( which indicate high value of error in the model)</p>
<ol start="3" type="a">
<li><strong>Draw the scatterplot of log(fertility) versus log(ppgdp) using natural logarithms. Does the simple linear regression model seem plausible for a summary of this graph? If you use a different base of logarithms, the shape of the graph won’t change, but the values on the axes will change.</strong></li>
</ol>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="at">data=</span>UN11, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(ppgdp), <span class="at">y =</span><span class="fu">log</span>(fertility) ))<span class="sc">+</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)<span class="sc">+</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(<span class="fu">log</span>(UN11<span class="sc">$</span>fertility)), <span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of log(fertility) by log(ppgdp) "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Simple linear regression seems much more plausible on this logged scatter plot.</p>
<p>Below, I am using different bases (5 and 7) of the logarithms. The shape of a line doesn’t change, only x-scale limits change:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>UN11, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(ppgdp, <span class="at">base =</span><span class="dv">5</span>), <span class="at">y =</span><span class="fu">log</span>(fertility), <span class="at">base =</span><span class="dv">5</span> ))<span class="sc">+</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)<span class="sc">+</span></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(<span class="fu">log</span>(UN11<span class="sc">$</span>fertility),  <span class="at">base =</span><span class="dv">5</span>), <span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of log(fertility) by log(ppgdp) base =5 "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>UN11, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(ppgdp, <span class="at">base =</span><span class="dv">7</span>), <span class="at">y =</span><span class="fu">log</span>(fertility), <span class="at">base =</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)<span class="sc">+</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(<span class="fu">log</span>(UN11<span class="sc">$</span>fertility),  <span class="at">base =</span><span class="dv">7</span>), <span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of log(fertility) by log(ppgdp), base =7 "</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-4-2.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="question-2" class="level1">
<h1>Question 2</h1>
<p><strong>Annual income, in dollars, is an explanatory variable in a regression analysis. For a British version of the report on the analysis, all responses are converted to British pounds sterling (1 pound equals about 1.33 dollars, as of 2016).</strong></p>
<p><strong>(a) How, if at all, does the slope of the prediction equation change?</strong></p>
<p><strong>(b) How, if at all, does the correlation change?</strong></p>
<p>To answer these questions, I will run linear regressions for the ppgpd in dollars and pounds and compare results.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>UN11<span class="sc">$</span>ppgdp.pound<span class="ot">&lt;-</span>UN11<span class="sc">$</span>ppgdp<span class="sc">*</span><span class="fl">1.33</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExpF <span class="sc">~</span> ppgdp, <span class="at">data =</span> UN11)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExpF ~ ppgdp, data = UN11)

Residuals:
    Min      1Q  Median      3Q     Max 
-20.825  -4.889   2.618   6.619  11.299 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 6.837e+01  7.370e-01  92.762   &lt;2e-16 ***
ppgdp       3.018e-04  3.274e-05   9.218   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.483 on 197 degrees of freedom
Multiple R-squared:  0.3014,    Adjusted R-squared:  0.2978 
F-statistic: 84.98 on 1 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExpF <span class="sc">~</span> ppgdp.pound, <span class="at">data =</span> UN11)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExpF ~ ppgdp.pound, data = UN11)

Residuals:
    Min      1Q  Median      3Q     Max 
-20.825  -4.889   2.618   6.619  11.299 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 6.837e+01  7.370e-01  92.762   &lt;2e-16 ***
ppgdp.pound 2.269e-04  2.462e-05   9.218   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 8.483 on 197 degrees of freedom
Multiple R-squared:  0.3014,    Adjusted R-squared:  0.2978 
F-statistic: 84.98 on 1 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Visualizing the model with both variables (ppgdp and ppgdp.pound ) produces the same model:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>UN11, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span> ppgdp , <span class="at">y=</span>lifeExpF))<span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)<span class="sc">+</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of Female life expectancy by annual income "</span>, <span class="at">x=</span><span class="st">"PPGDP in US dollars"</span>, <span class="at">y=</span><span class="st">"Life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>UN11, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span> ppgdp.pound , <span class="at">y=</span>lifeExpF))<span class="sc">+</span></span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)<span class="sc">+</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of Female life expectancy by annual income "</span>, <span class="at">x=</span><span class="st">"PPGDP in British pounds"</span>, <span class="at">y=</span><span class="st">"Life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Visualizing logged variables ( for the US dollars and British pounds) :</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>UN11, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">log</span>(ppgdp) , <span class="at">y=</span>lifeExpF   )     )<span class="sc">+</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)<span class="sc">+</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of Female life expectancy by annual income "</span>, <span class="at">x=</span><span class="st">"Logged PPGDP in US dollars"</span>, <span class="at">y=</span><span class="st">"Life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>UN11, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">log</span>(ppgdp.pound) , <span class="at">y=</span>lifeExpF    )     )<span class="sc">+</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)<span class="sc">+</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of Female life expectancy by annual income "</span>, <span class="at">x=</span><span class="st">"Logged PPGDP in British pounds"</span>, <span class="at">y=</span><span class="st">"Life expectancy"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-7-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>There is no change in slope and correlation between variablle in US dollars and British pounds.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>fit_logged<span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExpF<span class="sc">~</span> <span class="fu">log</span>(ppgdp), <span class="at">data =</span> UN11)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_logged)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = lifeExpF ~ log(ppgdp), data = UN11)

Residuals:
    Min      1Q  Median      3Q     Max 
-25.749  -2.879   1.280   3.987  12.345 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  29.8148     2.5314   11.78   &lt;2e-16 ***
log(ppgdp)    5.0188     0.2942   17.06   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 6.448 on 197 degrees of freedom
Multiple R-squared:  0.5964,    Adjusted R-squared:  0.5943 
F-statistic: 291.1 on 1 and 197 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>However, using log() function on x variable allowed us to build a better fitted model with R^2 increased from 0.30 to 0.60. I can conclude that 1% change in PPGDP correspons with 5 % increase in Life expectancy.</p>
</section>
<section id="question-3" class="level1">
<h1>Question 3</h1>
<p>Water runoff in the Sierras (Data file: water in alr4) Can Southern California’s water supply in future years be predicted from past data? One factor affecting water availability is stream runoff. If runoff could be predicted, engineers, planners, and policy makers could do their jobs</p>
<p>more efficiently. The data file contains 43 years’ worth of precipitation measurements taken at six sites in the Sierra Nevada mountains (labeled APMAM, APSAB, APSLAKE, OPBPC, OPRC, and OPSLAKE) and stream runoff volume at a site near Bishop, California, labeled BSAAM. Draw the scatterplot matrix for these data and summarize the information available from these plots. (Hint: Use the pairs() function.)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(water)</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(water)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   43 obs. of  8 variables:
 $ Year   : int  1948 1949 1950 1951 1952 1953 1954 1955 1956 1957 ...
 $ APMAM  : num  9.13 5.28 4.2 4.6 7.15 9.7 5.02 6.7 10.5 9.1 ...
 $ APSAB  : num  3.58 4.82 3.77 4.46 4.99 5.65 1.45 7.44 5.85 6.13 ...
 $ APSLAKE: num  3.91 5.2 3.67 3.93 4.88 4.91 1.77 6.51 3.38 4.08 ...
 $ OPBPC  : num  4.1 7.55 9.52 11.14 16.34 ...
 $ OPRC   : num  7.43 11.11 12.2 15.15 20.05 ...
 $ OPSLAKE: num  6.47 10.26 11.35 11.13 22.81 ...
 $ BSAAM  : int  54235 67567 66161 68094 107080 67594 65356 67909 92715 70024 ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(water)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Year APMAM APSAB APSLAKE OPBPC  OPRC OPSLAKE  BSAAM
1 1948  9.13  3.58    3.91  4.10  7.43    6.47  54235
2 1949  5.28  4.82    5.20  7.55 11.11   10.26  67567
3 1950  4.20  3.77    3.67  9.52 12.20   11.35  66161
4 1951  4.60  4.46    3.93 11.14 15.15   11.13  68094
5 1952  7.15  4.99    4.88 16.34 20.05   22.81 107080
6 1953  9.70  5.65    4.91  8.88  8.15    7.41  67594</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>water<span class="sc">$</span>Year <span class="ot">&lt;-</span><span class="fu">as.factor</span>(water<span class="sc">$</span>Year)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(water<span class="sc">$</span>Year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "1948" "1949" "1950" "1951" "1952" "1953" "1954" "1955" "1956" "1957"
[11] "1958" "1959" "1960" "1961" "1962" "1963" "1964" "1965" "1966" "1967"
[21] "1968" "1969" "1970" "1971" "1972" "1973" "1974" "1975" "1976" "1977"
[31] "1978" "1979" "1980" "1981" "1982" "1983" "1984" "1985" "1986" "1987"
[41] "1988" "1989" "1990"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (water, <span class="at">select =</span> <span class="fu">c</span>(APMAM <span class="sc">:</span> BSAAM)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the scatter plot matrix above I can see that some sources of water well correlated to each other, as their scatter plots are very close to a straight line. Moreover, there are two groups of water sources that demonstrate being inter-connected. The first group is APMAM, APSAB and APSLAKE. The second group is OPBPC, OPRC, OPLAKE and BSAAM. It is possible that the sites within a grouop share a water source or separated from each other (may be by mountains).</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(water)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Year APMAM APSAB APSLAKE OPBPC  OPRC OPSLAKE  BSAAM
1 1948  9.13  3.58    3.91  4.10  7.43    6.47  54235
2 1949  5.28  4.82    5.20  7.55 11.11   10.26  67567
3 1950  4.20  3.77    3.67  9.52 12.20   11.35  66161
4 1951  4.60  4.46    3.93 11.14 15.15   11.13  68094
5 1952  7.15  4.99    4.88 16.34 20.05   22.81 107080
6 1953  9.70  5.65    4.91  8.88  8.15    7.41  67594</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (water, <span class="at">select =</span> <span class="fu">c</span>(APMAM <span class="sc">:</span> APSLAKE)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(water)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  Year APMAM APSAB APSLAKE OPBPC  OPRC OPSLAKE  BSAAM
1 1948  9.13  3.58    3.91  4.10  7.43    6.47  54235
2 1949  5.28  4.82    5.20  7.55 11.11   10.26  67567
3 1950  4.20  3.77    3.67  9.52 12.20   11.35  66161
4 1951  4.60  4.46    3.93 11.14 15.15   11.13  68094
5 1952  7.15  4.99    4.88 16.34 20.05   22.81 107080
6 1953  9.70  5.65    4.91  8.88  8.15    7.41  67594</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (water, <span class="at">select =</span> <span class="fu">c</span>(OPBPC <span class="sc">:</span> BSAAM)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="question-4" class="level1">
<h1>Question 4</h1>
<p>Professor ratings (Data file: Rateprof in alr4) In the website and online forum RateMyProfessors.com, students rate and comment on their instructors. Launched in 1999, the site includes millions of ratings on thousands of instructors. The data file includes the summaries of the ratings of 364 instructors at a large campus in the Midwest (Bleske-Rechek and Fritsch, 2011). Each instructor included in the data had at least 10 ratings over a several year period. Students provided ratings of 1–5 on quality, helpfulness, clarity, easiness of instructor’s courses, and rater Interest in the subject matter covered in the instructor’s courses. The data file provides the averages of these five ratings. Create a scatter plot matrix of these five variables. Provide a brief description of the relationships between the five ratings.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Rateprof)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Rateprof)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   366 obs. of  17 variables:
 $ gender         : Factor w/ 2 levels "female","male": 2 2 2 2 2 2 2 2 2 2 ...
 $ numYears       : int  7 6 10 11 11 10 7 11 11 7 ...
 $ numRaters      : int  11 11 43 24 19 15 17 16 12 18 ...
 $ numCourses     : int  5 5 2 5 7 9 3 3 4 4 ...
 $ pepper         : Factor w/ 2 levels "no","yes": 1 1 1 1 1 1 1 1 1 1 ...
 $ discipline     : Factor w/ 4 levels "Hum","SocSci",..: 1 1 1 1 1 1 1 1 1 1 ...
 $ dept           : Factor w/ 48 levels "Accounting","Anthropology",..: 17 42 3 17 45 45 45 17 34 17 ...
 $ quality        : num  4.64 4.32 4.79 4.25 4.68 ...
 $ helpfulness    : num  4.64 4.55 4.72 4.46 4.68 ...
 $ clarity        : num  4.64 4.09 4.86 4.04 4.68 ...
 $ easiness       : num  4.82 4.36 4.6 2.79 4.47 ...
 $ raterInterest  : num  3.55 4 3.43 3.18 4.21 ...
 $ sdQuality      : num  0.552 0.902 0.453 0.933 0.65 ...
 $ sdHelpfulness  : num  0.674 0.934 0.666 0.932 0.82 ...
 $ sdClarity      : num  0.505 0.944 0.413 0.999 0.582 ...
 $ sdEasiness     : num  0.405 0.505 0.541 0.588 0.612 ...
 $ sdRaterInterest: num  1.128 1.074 1.237 1.332 0.975 ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Rateprof)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  gender numYears numRaters numCourses pepper discipline              dept
1   male        7        11          5     no        Hum           English
2   male        6        11          5     no        Hum Religious Studies
3   male       10        43          2     no        Hum               Art
4   male       11        24          5     no        Hum           English
5   male       11        19          7     no        Hum           Spanish
6   male       10        15          9     no        Hum           Spanish
   quality helpfulness  clarity easiness raterInterest sdQuality sdHelpfulness
1 4.636364    4.636364 4.636364 4.818182      3.545455 0.5518564     0.6741999
2 4.318182    4.545455 4.090909 4.363636      4.000000 0.9020179     0.9341987
3 4.790698    4.720930 4.860465 4.604651      3.432432 0.4529343     0.6663898
4 4.250000    4.458333 4.041667 2.791667      3.181818 0.9325048     0.9315329
5 4.684211    4.684211 4.684211 4.473684      4.214286 0.6500112     0.8200699
6 4.233333    4.266667 4.200000 4.533333      3.916667 0.8632717     1.0327956
  sdClarity sdEasiness sdRaterInterest
1 0.5045250  0.4045199       1.1281521
2 0.9438798  0.5045250       1.0744356
3 0.4129681  0.5407021       1.2369438
4 0.9990938  0.5882300       1.3322506
5 0.5823927  0.6117753       0.9749613
6 0.7745967  0.6399405       0.6685579</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (Rateprof, <span class="at">select =</span><span class="fu">c</span>(quality <span class="sc">:</span> raterInterest)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>As we can see from the scatter plot above, three variables are clearly highly correlated: quality, helpfulness and clarity. Particularly, quality highly correlated with both helpfulness and clarity. I suspect, these variables might create multicollinearity problem if used together in multiple regression model.</p>
<p>Connection between clarity and helpfulness is also very distinct, but the variability seems bigger.</p>
<p>Easiness variable appears positively correlated with the first three (quality, helpfulness and clarity), however there is much higher variability.</p>
<p>Rater’s interest appears less connected with the other variables, and might demonstrate a smaller slope of a regression line when calculated.</p>
<hr>
</section>
<section id="question-5" class="level1">
<h1>Question 5</h1>
<p>For the student.survey data file in the smss package, conduct regression analyses relating (by convention, y denotes the outcome variable, x denotes the explanatory variable)</p>
<p>(i) y = political ideology and x = religiosity,</p>
<p>(ii) y = high school GPA and x = hours of TV watching. (You can use ?student.survey in the R console, after loading the package, to see what each variable means.)</p>
<p>(a) Graphically portray how the explanatory variable relates to the outcome variable in each of the two cases</p>
<p>(b) Summarize and interpret results of inferential analyses.</p>
<section id="i.-y-political-ideology-and-x-religiosity" class="level4">
<h4 class="anchored" data-anchor-id="i.-y-political-ideology-and-x-religiosity">i. y = political ideology and x = religiosity</h4>
<p>By using ?student.survey function, I found out that : Political ideology is stored as <code>PI</code> variable, Religiosity doesn’t have its own variable, but can be represented as “how often you attend religious services” from this data set, variable <code>RE</code></p>
<p>Therefore , my model can be presented as</p>
<p><span class="math display">\[
PI =\beta_o +\beta_1*RE
\]</span></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(student.survey)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>?student.survey</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>starting httpd help server ... done</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(student.survey)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   60 obs. of  18 variables:
 $ subj: int  1 2 3 4 5 6 7 8 9 10 ...
 $ ge  : Factor w/ 2 levels "f","m": 2 1 1 1 2 2 2 1 2 2 ...
 $ ag  : int  32 23 27 35 23 39 24 31 34 28 ...
 $ hi  : num  2.2 2.1 3.3 3.5 3.1 3.5 3.6 3 3 4 ...
 $ co  : num  3.5 3.5 3 3.2 3.5 3.5 3.7 3 3 3.1 ...
 $ dh  : int  0 1200 1300 1500 1600 350 0 5000 5000 900 ...
 $ dr  : num  5 0.3 1.5 8 10 3 0.2 1.5 2 2 ...
 $ tv  : num  3 15 0 5 6 4 5 5 7 1 ...
 $ sp  : int  5 7 4 5 6 5 12 3 5 1 ...
 $ ne  : int  0 5 3 6 3 7 4 3 3 2 ...
 $ ah  : int  0 6 0 3 0 0 2 1 0 1 ...
 $ ve  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ pa  : Factor w/ 3 levels "d","i","r": 3 1 1 2 2 1 2 2 2 2 ...
 $ pi  : Ord.factor w/ 7 levels "very liberal"&lt;..: 6 2 2 4 1 2 2 2 1 3 ...
 $ re  : Ord.factor w/ 4 levels "never"&lt;"occasionally"&lt;..: 3 2 3 2 1 2 2 2 2 1 ...
 $ ab  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ aa  : logi  FALSE FALSE FALSE FALSE FALSE FALSE ...
 $ ld  : logi  FALSE NA NA FALSE FALSE NA ...</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="co"># head(student.survey)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(student.survey<span class="sc">$</span>pi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ordered" "factor" </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(student.survey<span class="sc">$</span>pi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "very liberal"          "liberal"               "slightly liberal"     
[4] "moderate"              "slightly conservative" "conservative"         
[7] "very conservative"    </code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(student.survey<span class="sc">$</span>re)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "ordered" "factor" </code></pre>
</div>
</div>
<p>We can see that both variables are ordered factor variables. We will need to convert factor variables into the numeric variables for regression, and then use them in linear model:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>student.survey<span class="sc">$</span>pi <span class="ot">&lt;-</span><span class="fu">as.numeric</span> (student.survey<span class="sc">$</span>pi)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>student.survey<span class="sc">$</span>re <span class="ot">&lt;-</span><span class="fu">as.numeric</span> (student.survey<span class="sc">$</span>re)</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(pi<span class="sc">~</span>re, <span class="at">data=</span>student.survey))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = pi ~ re, data = student.survey)

Residuals:
     Min       1Q   Median       3Q      Max 
-2.81243 -0.87160  0.09882  1.12840  3.09882 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.9308     0.4252   2.189   0.0327 *  
re            0.9704     0.1792   5.416 1.22e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.345 on 58 degrees of freedom
Multiple R-squared:  0.3359,    Adjusted R-squared:  0.3244 
F-statistic: 29.34 on 1 and 58 DF,  p-value: 1.221e-06</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> student.survey, <span class="fu">aes</span>(<span class="at">x =</span> re, <span class="at">y =</span> pi)) <span class="sc">+</span></span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se=</span>F)<span class="sc">+</span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Political ideology and religiosity"</span>, <span class="at">x=</span><span class="st">"Frequency of going to church"</span>, <span class="at">y =</span> <span class="st">"level of consrvatism"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Based on the summary above, we can see that religiosity and political ideology are positively related, but the religiosity only contributes about 30 % of political ideology (R^2 =0.34). Overal w can say that higher level of conservatism can be somewhat (30%) predicted by frequency of church attendance.</p>
</section>
<section id="ii.-y-high-school-gpa-and-x-hours-of-tv-watching" class="level4">
<h4 class="anchored" data-anchor-id="ii.-y-high-school-gpa-and-x-hours-of-tv-watching">ii. y = high school GPA and x = hours of TV watching</h4>
<p>High school GPA is presented as HI variable, and hours of TV watching - by TV variable.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(student.survey<span class="sc">$</span>hi)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(student.survey<span class="sc">$</span>tv)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "numeric"</code></pre>
</div>
</div>
<p>Both variables are numeric, which allows us to run a simple linear regression:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>student.survey, hi <span class="sc">~</span>tv))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = hi ~ tv, data = student.survey)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.2583 -0.2456  0.0417  0.3368  0.7051 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.441353   0.085345  40.323   &lt;2e-16 ***
tv          -0.018305   0.008658  -2.114   0.0388 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.4467 on 58 degrees of freedom
Multiple R-squared:  0.07156,   Adjusted R-squared:  0.05555 
F-statistic: 4.471 on 1 and 58 DF,  p-value: 0.03879</code></pre>
</div>
</div>
<p>We can see that the the slope of Independent variable (tv) is very small and negative. It’s statistical significance is also very low and depends on alpha level that we select. R squared, which indicates the proportion of the variance that can be explained by x (tv watching time), is very low (0.072). Taking this into account, I conclude there is no contribution of TV watching to GPA level.</p>
<p>To visualize these relationship, we can build a scatter plot and a fitted linear line:</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (<span class="at">data=</span>student.survey, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>tv, <span class="at">y=</span>hi))<span class="sc">+</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)<span class="sc">+</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Sctterplot between hours of TV watching and high school GPA"</span>, <span class="at">y=</span><span class="st">"High school GPA"</span>, <span class="at">x=</span><span class="st">"hours of TV watching"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="HW_3_Diana_Rinker_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>From the graph above we can see, that the standard error band is getting wider towards the right side of the chart, due to low amount of observations in that part of the sample. It also adds uncertainty to a conclusion and calls for more data and further investigation. Since the overall slope does go down, I would suggest that there may be another factor that contributes to the relationship between TV watching and GPA.</p>
<hr>


<!-- -->

</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/603_Spring_2023" data-repo-id="R_kgDOI4oXIA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb77" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Homework 3"</span></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Diana Rinker"</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "HW3"</span></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "4/11/2023"</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="an">editor:</span><span class="co"> </span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a><span class="co">  markdown: </span></span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="co">    wrap: 72</span></span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="fu"># DACSS 603, spring 2023</span></span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a><span class="fu"># Homework 3, Diana Rinker.</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-21"><a href="#cb77-21" aria-hidden="true" tabindex="-1"></a>Loading necessary libraries:</span>
<span id="cb77-22"><a href="#cb77-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-23"><a href="#cb77-23" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-24"><a href="#cb77-24" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb77-25"><a href="#cb77-25" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb77-26"><a href="#cb77-26" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb77-27"><a href="#cb77-27" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(smss)</span>
<span id="cb77-28"><a href="#cb77-28" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-29"><a href="#cb77-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-30"><a href="#cb77-30" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 1</span></span>
<span id="cb77-31"><a href="#cb77-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-32"><a href="#cb77-32" aria-hidden="true" tabindex="-1"></a>**United Nations (Data file: UN11 in alr4) The data in the file UN11</span>
<span id="cb77-33"><a href="#cb77-33" aria-hidden="true" tabindex="-1"></a>contains several variables, including ppgdp, the gross national product</span>
<span id="cb77-34"><a href="#cb77-34" aria-hidden="true" tabindex="-1"></a>per person in U.S. dollars, and fertility, the birth rate per 1000</span>
<span id="cb77-35"><a href="#cb77-35" aria-hidden="true" tabindex="-1"></a>females, both from the year 2009. The data are for 199 localities,</span>
<span id="cb77-36"><a href="#cb77-36" aria-hidden="true" tabindex="-1"></a>mostly UN member countries, but also other areas such as Hong Kong that</span>
<span id="cb77-37"><a href="#cb77-37" aria-hidden="true" tabindex="-1"></a>are not independent countries. The data were collected from the United</span>
<span id="cb77-38"><a href="#cb77-38" aria-hidden="true" tabindex="-1"></a>Nations (2011). [We will study the dependence of fertility on</span>
<span id="cb77-39"><a href="#cb77-39" aria-hidden="true" tabindex="-1"></a>ppgdp.]{.underline}**</span>
<span id="cb77-40"><a href="#cb77-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-41"><a href="#cb77-41" aria-hidden="true" tabindex="-1"></a>(a) **Identify the predictor and the response.**</span>
<span id="cb77-42"><a href="#cb77-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-43"><a href="#cb77-43" aria-hidden="true" tabindex="-1"></a><span class="in">    DV/response: fertility</span></span>
<span id="cb77-44"><a href="#cb77-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-45"><a href="#cb77-45" aria-hidden="true" tabindex="-1"></a><span class="in">    IV/predictor: ppgdp</span></span>
<span id="cb77-46"><a href="#cb77-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-47"><a href="#cb77-47" aria-hidden="true" tabindex="-1"></a>(b) **Draw the scatterplot of fertility on the vertical axis versus</span>
<span id="cb77-48"><a href="#cb77-48" aria-hidden="true" tabindex="-1"></a>    ppgdp on the horizontal axis and summarize the information in this</span>
<span id="cb77-49"><a href="#cb77-49" aria-hidden="true" tabindex="-1"></a>    graph. Does a straight-line mean function seem to be plausible for a</span>
<span id="cb77-50"><a href="#cb77-50" aria-hidden="true" tabindex="-1"></a>    summary of this graph?**</span>
<span id="cb77-51"><a href="#cb77-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-52"><a href="#cb77-52" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-53"><a href="#cb77-53" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(UN11)</span>
<span id="cb77-54"><a href="#cb77-54" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(UN11)</span>
<span id="cb77-55"><a href="#cb77-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ggplot</span>(<span class="at">data=</span>UN11, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x=</span>ppgdp, <span class="at">y =</span>fertility ))<span class="sc">+</span></span>
<span id="cb77-56"><a href="#cb77-56" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb77-57"><a href="#cb77-57" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)<span class="sc">+</span></span>
<span id="cb77-58"><a href="#cb77-58" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(UN11<span class="sc">$</span>fertility), <span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb77-59"><a href="#cb77-59" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of fertility by ppgdp"</span>)<span class="sc">+</span></span>
<span id="cb77-60"><a href="#cb77-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)</span>
<span id="cb77-61"><a href="#cb77-61" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb77-62"><a href="#cb77-62" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-63"><a href="#cb77-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-64"><a href="#cb77-64" aria-hidden="true" tabindex="-1"></a>From the graph above it is obvious, that the straight line mean is not</span>
<span id="cb77-65"><a href="#cb77-65" aria-hidden="true" tabindex="-1"></a>representative of the data. Even if be draw a linear model with</span>
<span id="cb77-66"><a href="#cb77-66" aria-hidden="true" tabindex="-1"></a>"stat_smooth(method ="lm", se = T)", the line is still far from most</span>
<span id="cb77-67"><a href="#cb77-67" aria-hidden="true" tabindex="-1"></a>datapoints ( which indicate high value of error in the model)</span>
<span id="cb77-68"><a href="#cb77-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-69"><a href="#cb77-69" aria-hidden="true" tabindex="-1"></a>(c) **Draw the scatterplot of log(fertility) versus log(ppgdp) using</span>
<span id="cb77-70"><a href="#cb77-70" aria-hidden="true" tabindex="-1"></a>    natural logarithms. Does the simple linear regression model seem</span>
<span id="cb77-71"><a href="#cb77-71" aria-hidden="true" tabindex="-1"></a>    plausible for a summary of this graph? If you use a different base</span>
<span id="cb77-72"><a href="#cb77-72" aria-hidden="true" tabindex="-1"></a>    of logarithms, the shape of the graph won't change, but the values</span>
<span id="cb77-73"><a href="#cb77-73" aria-hidden="true" tabindex="-1"></a>    on the axes will change.**</span>
<span id="cb77-74"><a href="#cb77-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-75"><a href="#cb77-75" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-76"><a href="#cb77-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-77"><a href="#cb77-77" aria-hidden="true" tabindex="-1"></a>   <span class="fu">ggplot</span>(<span class="at">data=</span>UN11, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(ppgdp), <span class="at">y =</span><span class="fu">log</span>(fertility) ))<span class="sc">+</span></span>
<span id="cb77-78"><a href="#cb77-78" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb77-79"><a href="#cb77-79" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)<span class="sc">+</span></span>
<span id="cb77-80"><a href="#cb77-80" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(<span class="fu">log</span>(UN11<span class="sc">$</span>fertility)), <span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb77-81"><a href="#cb77-81" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of log(fertility) by log(ppgdp) "</span>)</span>
<span id="cb77-82"><a href="#cb77-82" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-83"><a href="#cb77-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-84"><a href="#cb77-84" aria-hidden="true" tabindex="-1"></a>Simple linear regression seems much more plausible on this logged</span>
<span id="cb77-85"><a href="#cb77-85" aria-hidden="true" tabindex="-1"></a>scatter plot.</span>
<span id="cb77-86"><a href="#cb77-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-87"><a href="#cb77-87" aria-hidden="true" tabindex="-1"></a>Below, I am using different bases (5 and 7) of the logarithms. The shape</span>
<span id="cb77-88"><a href="#cb77-88" aria-hidden="true" tabindex="-1"></a>of a line doesn't change, only x-scale limits change:</span>
<span id="cb77-89"><a href="#cb77-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-90"><a href="#cb77-90" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-91"><a href="#cb77-91" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>UN11, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(ppgdp, <span class="at">base =</span><span class="dv">5</span>), <span class="at">y =</span><span class="fu">log</span>(fertility), <span class="at">base =</span><span class="dv">5</span> ))<span class="sc">+</span></span>
<span id="cb77-92"><a href="#cb77-92" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb77-93"><a href="#cb77-93" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)<span class="sc">+</span></span>
<span id="cb77-94"><a href="#cb77-94" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(<span class="fu">log</span>(UN11<span class="sc">$</span>fertility),  <span class="at">base =</span><span class="dv">5</span>), <span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb77-95"><a href="#cb77-95" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of log(fertility) by log(ppgdp) base =5 "</span>)</span>
<span id="cb77-96"><a href="#cb77-96" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-97"><a href="#cb77-97" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb77-98"><a href="#cb77-98" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data=</span>UN11, <span class="at">mapping=</span> <span class="fu">aes</span>(<span class="at">x=</span><span class="fu">log</span>(ppgdp, <span class="at">base =</span><span class="dv">7</span>), <span class="at">y =</span><span class="fu">log</span>(fertility), <span class="at">base =</span><span class="dv">7</span>))<span class="sc">+</span></span>
<span id="cb77-99"><a href="#cb77-99" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb77-100"><a href="#cb77-100" aria-hidden="true" tabindex="-1"></a>      <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)<span class="sc">+</span></span>
<span id="cb77-101"><a href="#cb77-101" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">mean</span>(<span class="fu">log</span>(UN11<span class="sc">$</span>fertility),  <span class="at">base =</span><span class="dv">7</span>), <span class="at">color =</span> <span class="st">"red"</span>)<span class="sc">+</span></span>
<span id="cb77-102"><a href="#cb77-102" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of log(fertility) by log(ppgdp), base =7 "</span>)</span>
<span id="cb77-103"><a href="#cb77-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-104"><a href="#cb77-104" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-105"><a href="#cb77-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-106"><a href="#cb77-106" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 2</span></span>
<span id="cb77-107"><a href="#cb77-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-108"><a href="#cb77-108" aria-hidden="true" tabindex="-1"></a>**Annual income, in dollars, is an explanatory variable in a regression</span>
<span id="cb77-109"><a href="#cb77-109" aria-hidden="true" tabindex="-1"></a>analysis. For a British version of the report on the analysis, all</span>
<span id="cb77-110"><a href="#cb77-110" aria-hidden="true" tabindex="-1"></a>responses are converted to British pounds sterling (1 pound equals about</span>
<span id="cb77-111"><a href="#cb77-111" aria-hidden="true" tabindex="-1"></a>1.33 dollars, as of 2016).**</span>
<span id="cb77-112"><a href="#cb77-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-113"><a href="#cb77-113" aria-hidden="true" tabindex="-1"></a>**(a) How, if at all, does the slope of the prediction equation</span>
<span id="cb77-114"><a href="#cb77-114" aria-hidden="true" tabindex="-1"></a>change?**</span>
<span id="cb77-115"><a href="#cb77-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-116"><a href="#cb77-116" aria-hidden="true" tabindex="-1"></a>**(b) How, if at all, does the correlation change?**</span>
<span id="cb77-117"><a href="#cb77-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-118"><a href="#cb77-118" aria-hidden="true" tabindex="-1"></a>To answer these questions, I will run linear regressions for the ppgpd</span>
<span id="cb77-119"><a href="#cb77-119" aria-hidden="true" tabindex="-1"></a>in dollars and pounds and compare results.</span>
<span id="cb77-120"><a href="#cb77-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-121"><a href="#cb77-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-122"><a href="#cb77-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-123"><a href="#cb77-123" aria-hidden="true" tabindex="-1"></a>UN11<span class="sc">$</span>ppgdp.pound<span class="ot">&lt;-</span>UN11<span class="sc">$</span>ppgdp<span class="sc">*</span><span class="fl">1.33</span></span>
<span id="cb77-124"><a href="#cb77-124" aria-hidden="true" tabindex="-1"></a>fit1<span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExpF <span class="sc">~</span> ppgdp, <span class="at">data =</span> UN11)</span>
<span id="cb77-125"><a href="#cb77-125" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit1)</span>
<span id="cb77-126"><a href="#cb77-126" aria-hidden="true" tabindex="-1"></a>fit2<span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExpF <span class="sc">~</span> ppgdp.pound, <span class="at">data =</span> UN11)</span>
<span id="cb77-127"><a href="#cb77-127" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit2)</span>
<span id="cb77-128"><a href="#cb77-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-129"><a href="#cb77-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-130"><a href="#cb77-130" aria-hidden="true" tabindex="-1"></a>Visualizing the model with both variables (ppgdp and ppgdp.pound )</span>
<span id="cb77-131"><a href="#cb77-131" aria-hidden="true" tabindex="-1"></a>produces the same model:</span>
<span id="cb77-132"><a href="#cb77-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-133"><a href="#cb77-133" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-134"><a href="#cb77-134" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>UN11, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span> ppgdp , <span class="at">y=</span>lifeExpF))<span class="sc">+</span></span>
<span id="cb77-135"><a href="#cb77-135" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-136"><a href="#cb77-136" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)<span class="sc">+</span></span>
<span id="cb77-137"><a href="#cb77-137" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of Female life expectancy by annual income "</span>, <span class="at">x=</span><span class="st">"PPGDP in US dollars"</span>, <span class="at">y=</span><span class="st">"Life expectancy"</span>)</span>
<span id="cb77-138"><a href="#cb77-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-139"><a href="#cb77-139" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>UN11, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span> ppgdp.pound , <span class="at">y=</span>lifeExpF))<span class="sc">+</span></span>
<span id="cb77-140"><a href="#cb77-140" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-141"><a href="#cb77-141" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)<span class="sc">+</span></span>
<span id="cb77-142"><a href="#cb77-142" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of Female life expectancy by annual income "</span>, <span class="at">x=</span><span class="st">"PPGDP in British pounds"</span>, <span class="at">y=</span><span class="st">"Life expectancy"</span>)</span>
<span id="cb77-143"><a href="#cb77-143" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-144"><a href="#cb77-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-145"><a href="#cb77-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-146"><a href="#cb77-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-147"><a href="#cb77-147" aria-hidden="true" tabindex="-1"></a>Visualizing logged variables ( for the US dollars and British pounds) :</span>
<span id="cb77-148"><a href="#cb77-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-149"><a href="#cb77-149" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-150"><a href="#cb77-150" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>UN11, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">log</span>(ppgdp) , <span class="at">y=</span>lifeExpF   )     )<span class="sc">+</span></span>
<span id="cb77-151"><a href="#cb77-151" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-152"><a href="#cb77-152" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)<span class="sc">+</span></span>
<span id="cb77-153"><a href="#cb77-153" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of Female life expectancy by annual income "</span>, <span class="at">x=</span><span class="st">"Logged PPGDP in US dollars"</span>, <span class="at">y=</span><span class="st">"Life expectancy"</span>)</span>
<span id="cb77-154"><a href="#cb77-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-155"><a href="#cb77-155" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>( <span class="at">data=</span>UN11, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span> <span class="fu">log</span>(ppgdp.pound) , <span class="at">y=</span>lifeExpF    )     )<span class="sc">+</span></span>
<span id="cb77-156"><a href="#cb77-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-157"><a href="#cb77-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>)<span class="sc">+</span></span>
<span id="cb77-158"><a href="#cb77-158" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Scatterplot of Female life expectancy by annual income "</span>, <span class="at">x=</span><span class="st">"Logged PPGDP in British pounds"</span>, <span class="at">y=</span><span class="st">"Life expectancy"</span>)</span>
<span id="cb77-159"><a href="#cb77-159" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-160"><a href="#cb77-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-161"><a href="#cb77-161" aria-hidden="true" tabindex="-1"></a>There is no change in slope and correlation between variablle in US</span>
<span id="cb77-162"><a href="#cb77-162" aria-hidden="true" tabindex="-1"></a>dollars and British pounds.</span>
<span id="cb77-163"><a href="#cb77-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-164"><a href="#cb77-164" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-165"><a href="#cb77-165" aria-hidden="true" tabindex="-1"></a>fit_logged<span class="ot">&lt;-</span> <span class="fu">lm</span>(lifeExpF<span class="sc">~</span> <span class="fu">log</span>(ppgdp), <span class="at">data =</span> UN11)</span>
<span id="cb77-166"><a href="#cb77-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-167"><a href="#cb77-167" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(fit_logged)</span>
<span id="cb77-168"><a href="#cb77-168" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-169"><a href="#cb77-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-170"><a href="#cb77-170" aria-hidden="true" tabindex="-1"></a>However, using log() function on x variable allowed us to build a better</span>
<span id="cb77-171"><a href="#cb77-171" aria-hidden="true" tabindex="-1"></a>fitted model with R\^2 increased from 0.30 to 0.60. I can conclude that</span>
<span id="cb77-172"><a href="#cb77-172" aria-hidden="true" tabindex="-1"></a>1% change in PPGDP correspons with 5 % increase in Life expectancy.</span>
<span id="cb77-173"><a href="#cb77-173" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-174"><a href="#cb77-174" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 3</span></span>
<span id="cb77-175"><a href="#cb77-175" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-176"><a href="#cb77-176" aria-hidden="true" tabindex="-1"></a>Water runoff in the Sierras (Data file: water in alr4) Can Southern</span>
<span id="cb77-177"><a href="#cb77-177" aria-hidden="true" tabindex="-1"></a>California's water supply in future years be predicted from past data?</span>
<span id="cb77-178"><a href="#cb77-178" aria-hidden="true" tabindex="-1"></a>One factor affecting water availability is stream runoff. If runoff</span>
<span id="cb77-179"><a href="#cb77-179" aria-hidden="true" tabindex="-1"></a>could be predicted, engineers, planners, and policy makers could do</span>
<span id="cb77-180"><a href="#cb77-180" aria-hidden="true" tabindex="-1"></a>their jobs</span>
<span id="cb77-181"><a href="#cb77-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-182"><a href="#cb77-182" aria-hidden="true" tabindex="-1"></a>more efficiently. The data file contains 43 years' worth of</span>
<span id="cb77-183"><a href="#cb77-183" aria-hidden="true" tabindex="-1"></a>precipitation measurements taken at six sites in the Sierra Nevada</span>
<span id="cb77-184"><a href="#cb77-184" aria-hidden="true" tabindex="-1"></a>mountains (labeled APMAM, APSAB, APSLAKE, OPBPC, OPRC, and OPSLAKE) and</span>
<span id="cb77-185"><a href="#cb77-185" aria-hidden="true" tabindex="-1"></a>stream runoff volume at a site near Bishop, California, labeled BSAAM.</span>
<span id="cb77-186"><a href="#cb77-186" aria-hidden="true" tabindex="-1"></a>Draw the scatterplot matrix for these data and summarize the information</span>
<span id="cb77-187"><a href="#cb77-187" aria-hidden="true" tabindex="-1"></a>available from these plots. (Hint: Use the pairs() function.)</span>
<span id="cb77-188"><a href="#cb77-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-189"><a href="#cb77-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-190"><a href="#cb77-190" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(alr4)</span>
<span id="cb77-191"><a href="#cb77-191" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(water)</span>
<span id="cb77-192"><a href="#cb77-192" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(water)</span>
<span id="cb77-193"><a href="#cb77-193" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(water)</span>
<span id="cb77-194"><a href="#cb77-194" aria-hidden="true" tabindex="-1"></a>water<span class="sc">$</span>Year <span class="ot">&lt;-</span><span class="fu">as.factor</span>(water<span class="sc">$</span>Year)</span>
<span id="cb77-195"><a href="#cb77-195" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(water<span class="sc">$</span>Year)</span>
<span id="cb77-196"><a href="#cb77-196" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (water, <span class="at">select =</span> <span class="fu">c</span>(APMAM <span class="sc">:</span> BSAAM)))</span>
<span id="cb77-197"><a href="#cb77-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-198"><a href="#cb77-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-199"><a href="#cb77-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-200"><a href="#cb77-200" aria-hidden="true" tabindex="-1"></a>From the scatter plot matrix above I can see that some sources of water</span>
<span id="cb77-201"><a href="#cb77-201" aria-hidden="true" tabindex="-1"></a>well correlated to each other, as their scatter plots are very close to</span>
<span id="cb77-202"><a href="#cb77-202" aria-hidden="true" tabindex="-1"></a>a straight line. Moreover, there are two groups of water sources that</span>
<span id="cb77-203"><a href="#cb77-203" aria-hidden="true" tabindex="-1"></a>demonstrate being inter-connected. The first group is APMAM, APSAB and</span>
<span id="cb77-204"><a href="#cb77-204" aria-hidden="true" tabindex="-1"></a>APSLAKE. The second group is OPBPC, OPRC, OPLAKE and BSAAM. It is</span>
<span id="cb77-205"><a href="#cb77-205" aria-hidden="true" tabindex="-1"></a>possible that the sites within a grouop share a water source or</span>
<span id="cb77-206"><a href="#cb77-206" aria-hidden="true" tabindex="-1"></a>separated from each other (may be by mountains).</span>
<span id="cb77-207"><a href="#cb77-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-208"><a href="#cb77-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-209"><a href="#cb77-209" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(water)</span>
<span id="cb77-210"><a href="#cb77-210" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (water, <span class="at">select =</span> <span class="fu">c</span>(APMAM <span class="sc">:</span> APSLAKE)))</span>
<span id="cb77-211"><a href="#cb77-211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-212"><a href="#cb77-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-213"><a href="#cb77-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-214"><a href="#cb77-214" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-215"><a href="#cb77-215" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(water)</span>
<span id="cb77-216"><a href="#cb77-216" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (water, <span class="at">select =</span> <span class="fu">c</span>(OPBPC <span class="sc">:</span> BSAAM)))</span>
<span id="cb77-217"><a href="#cb77-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-218"><a href="#cb77-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-219"><a href="#cb77-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-220"><a href="#cb77-220" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 4</span></span>
<span id="cb77-221"><a href="#cb77-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-222"><a href="#cb77-222" aria-hidden="true" tabindex="-1"></a>Professor ratings (Data file: Rateprof in alr4) In the website and</span>
<span id="cb77-223"><a href="#cb77-223" aria-hidden="true" tabindex="-1"></a>online forum RateMyProfessors.com, students rate and comment on their</span>
<span id="cb77-224"><a href="#cb77-224" aria-hidden="true" tabindex="-1"></a>instructors. Launched in 1999, the site includes millions of ratings on</span>
<span id="cb77-225"><a href="#cb77-225" aria-hidden="true" tabindex="-1"></a>thousands of instructors. The data file includes the summaries of the</span>
<span id="cb77-226"><a href="#cb77-226" aria-hidden="true" tabindex="-1"></a>ratings of 364 instructors at a large campus in the Midwest</span>
<span id="cb77-227"><a href="#cb77-227" aria-hidden="true" tabindex="-1"></a>(Bleske-Rechek and Fritsch, 2011). Each instructor included in the data</span>
<span id="cb77-228"><a href="#cb77-228" aria-hidden="true" tabindex="-1"></a>had at least 10 ratings over a several year period. Students provided</span>
<span id="cb77-229"><a href="#cb77-229" aria-hidden="true" tabindex="-1"></a>ratings of 1--5 on quality, helpfulness, clarity, easiness of</span>
<span id="cb77-230"><a href="#cb77-230" aria-hidden="true" tabindex="-1"></a>instructor's courses, and rater Interest in the subject matter covered</span>
<span id="cb77-231"><a href="#cb77-231" aria-hidden="true" tabindex="-1"></a>in the instructor's courses. The data file provides the averages of</span>
<span id="cb77-232"><a href="#cb77-232" aria-hidden="true" tabindex="-1"></a>these five ratings. Create a scatter plot matrix of these five</span>
<span id="cb77-233"><a href="#cb77-233" aria-hidden="true" tabindex="-1"></a>variables. Provide a brief description of the relationships between the</span>
<span id="cb77-234"><a href="#cb77-234" aria-hidden="true" tabindex="-1"></a>five ratings.</span>
<span id="cb77-235"><a href="#cb77-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-236"><a href="#cb77-236" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-237"><a href="#cb77-237" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(Rateprof)</span>
<span id="cb77-238"><a href="#cb77-238" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(Rateprof)</span>
<span id="cb77-239"><a href="#cb77-239" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(Rateprof)</span>
<span id="cb77-240"><a href="#cb77-240" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(<span class="fu">subset</span> (Rateprof, <span class="at">select =</span><span class="fu">c</span>(quality <span class="sc">:</span> raterInterest)))</span>
<span id="cb77-241"><a href="#cb77-241" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-242"><a href="#cb77-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-243"><a href="#cb77-243" aria-hidden="true" tabindex="-1"></a>As we can see from the scatter plot above, three variables are clearly</span>
<span id="cb77-244"><a href="#cb77-244" aria-hidden="true" tabindex="-1"></a>highly correlated: quality, helpfulness and clarity. Particularly,</span>
<span id="cb77-245"><a href="#cb77-245" aria-hidden="true" tabindex="-1"></a>quality highly correlated with both helpfulness and clarity. I suspect,</span>
<span id="cb77-246"><a href="#cb77-246" aria-hidden="true" tabindex="-1"></a>these variables might create multicollinearity problem if used together</span>
<span id="cb77-247"><a href="#cb77-247" aria-hidden="true" tabindex="-1"></a>in multiple regression model.</span>
<span id="cb77-248"><a href="#cb77-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-249"><a href="#cb77-249" aria-hidden="true" tabindex="-1"></a>Connection between clarity and helpfulness is also very distinct, but</span>
<span id="cb77-250"><a href="#cb77-250" aria-hidden="true" tabindex="-1"></a>the variability seems bigger.</span>
<span id="cb77-251"><a href="#cb77-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-252"><a href="#cb77-252" aria-hidden="true" tabindex="-1"></a>Easiness variable appears positively correlated with the first three</span>
<span id="cb77-253"><a href="#cb77-253" aria-hidden="true" tabindex="-1"></a>(quality, helpfulness and clarity), however there is much higher</span>
<span id="cb77-254"><a href="#cb77-254" aria-hidden="true" tabindex="-1"></a>variability.</span>
<span id="cb77-255"><a href="#cb77-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-256"><a href="#cb77-256" aria-hidden="true" tabindex="-1"></a>Rater's interest appears less connected with the other variables, and</span>
<span id="cb77-257"><a href="#cb77-257" aria-hidden="true" tabindex="-1"></a>might demonstrate a smaller slope of a regression line when calculated.</span>
<span id="cb77-258"><a href="#cb77-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-259"><a href="#cb77-259" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span>
<span id="cb77-260"><a href="#cb77-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-261"><a href="#cb77-261" aria-hidden="true" tabindex="-1"></a><span class="fu"># Question 5</span></span>
<span id="cb77-262"><a href="#cb77-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-263"><a href="#cb77-263" aria-hidden="true" tabindex="-1"></a>For the student.survey data file in the smss package, conduct regression</span>
<span id="cb77-264"><a href="#cb77-264" aria-hidden="true" tabindex="-1"></a>analyses relating (by convention, y denotes the outcome variable, x</span>
<span id="cb77-265"><a href="#cb77-265" aria-hidden="true" tabindex="-1"></a>denotes the explanatory variable)</span>
<span id="cb77-266"><a href="#cb77-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-267"><a href="#cb77-267" aria-hidden="true" tabindex="-1"></a><span class="sc">\(</span>i<span class="sc">\)</span> y = political ideology and x = religiosity,</span>
<span id="cb77-268"><a href="#cb77-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-269"><a href="#cb77-269" aria-hidden="true" tabindex="-1"></a><span class="sc">\(</span>ii<span class="sc">\)</span> y = high school GPA and x = hours of TV watching. (You can use</span>
<span id="cb77-270"><a href="#cb77-270" aria-hidden="true" tabindex="-1"></a>?student.survey in the R console, after loading the package, to see what</span>
<span id="cb77-271"><a href="#cb77-271" aria-hidden="true" tabindex="-1"></a>each variable means.)</span>
<span id="cb77-272"><a href="#cb77-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-273"><a href="#cb77-273" aria-hidden="true" tabindex="-1"></a><span class="sc">\(</span>a<span class="sc">\)</span> Graphically portray how the explanatory variable relates to the</span>
<span id="cb77-274"><a href="#cb77-274" aria-hidden="true" tabindex="-1"></a>outcome variable in each of the two cases</span>
<span id="cb77-275"><a href="#cb77-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-276"><a href="#cb77-276" aria-hidden="true" tabindex="-1"></a><span class="sc">\(</span>b<span class="sc">\)</span> Summarize and interpret results of inferential analyses.</span>
<span id="cb77-277"><a href="#cb77-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-278"><a href="#cb77-278" aria-hidden="true" tabindex="-1"></a><span class="fu">#### i. y = political ideology and x = religiosity</span></span>
<span id="cb77-279"><a href="#cb77-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-280"><a href="#cb77-280" aria-hidden="true" tabindex="-1"></a>By using ?student.survey function, I found out that : Political ideology</span>
<span id="cb77-281"><a href="#cb77-281" aria-hidden="true" tabindex="-1"></a>is stored as <span class="in">`PI`</span> variable, Religiosity doesn't have its own variable,</span>
<span id="cb77-282"><a href="#cb77-282" aria-hidden="true" tabindex="-1"></a>but can be represented as "how often you attend religious services" from</span>
<span id="cb77-283"><a href="#cb77-283" aria-hidden="true" tabindex="-1"></a>this data set, variable <span class="in">`RE`</span></span>
<span id="cb77-284"><a href="#cb77-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-285"><a href="#cb77-285" aria-hidden="true" tabindex="-1"></a>Therefore , my model can be presented as</span>
<span id="cb77-286"><a href="#cb77-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-287"><a href="#cb77-287" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb77-288"><a href="#cb77-288" aria-hidden="true" tabindex="-1"></a>PI =\beta_o +\beta_1*RE</span>
<span id="cb77-289"><a href="#cb77-289" aria-hidden="true" tabindex="-1"></a>$$</span>
<span id="cb77-290"><a href="#cb77-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-291"><a href="#cb77-291" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-292"><a href="#cb77-292" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(student.survey)</span>
<span id="cb77-293"><a href="#cb77-293" aria-hidden="true" tabindex="-1"></a>?student.survey</span>
<span id="cb77-294"><a href="#cb77-294" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(student.survey)</span>
<span id="cb77-295"><a href="#cb77-295" aria-hidden="true" tabindex="-1"></a><span class="co"># head(student.survey)</span></span>
<span id="cb77-296"><a href="#cb77-296" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(student.survey<span class="sc">$</span>pi)</span>
<span id="cb77-297"><a href="#cb77-297" aria-hidden="true" tabindex="-1"></a><span class="fu">levels</span>(student.survey<span class="sc">$</span>pi)</span>
<span id="cb77-298"><a href="#cb77-298" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(student.survey<span class="sc">$</span>re)</span>
<span id="cb77-299"><a href="#cb77-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-300"><a href="#cb77-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-301"><a href="#cb77-301" aria-hidden="true" tabindex="-1"></a>We can see that both variables are ordered factor variables. We will</span>
<span id="cb77-302"><a href="#cb77-302" aria-hidden="true" tabindex="-1"></a>need to convert factor variables into the numeric variables for</span>
<span id="cb77-303"><a href="#cb77-303" aria-hidden="true" tabindex="-1"></a>regression, and then use them in linear model:</span>
<span id="cb77-304"><a href="#cb77-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-305"><a href="#cb77-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-306"><a href="#cb77-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-307"><a href="#cb77-307" aria-hidden="true" tabindex="-1"></a>student.survey<span class="sc">$</span>pi <span class="ot">&lt;-</span><span class="fu">as.numeric</span> (student.survey<span class="sc">$</span>pi)</span>
<span id="cb77-308"><a href="#cb77-308" aria-hidden="true" tabindex="-1"></a>student.survey<span class="sc">$</span>re <span class="ot">&lt;-</span><span class="fu">as.numeric</span> (student.survey<span class="sc">$</span>re)</span>
<span id="cb77-309"><a href="#cb77-309" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(pi<span class="sc">~</span>re, <span class="at">data=</span>student.survey))</span>
<span id="cb77-310"><a href="#cb77-310" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="at">data =</span> student.survey, <span class="fu">aes</span>(<span class="at">x =</span> re, <span class="at">y =</span> pi)) <span class="sc">+</span></span>
<span id="cb77-311"><a href="#cb77-311" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb77-312"><a href="#cb77-312" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">'lm'</span>, <span class="at">se=</span>F)<span class="sc">+</span></span>
<span id="cb77-313"><a href="#cb77-313" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Political ideology and religiosity"</span>, <span class="at">x=</span><span class="st">"Frequency of going to church"</span>, <span class="at">y =</span> <span class="st">"level of consrvatism"</span>)</span>
<span id="cb77-314"><a href="#cb77-314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-315"><a href="#cb77-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-316"><a href="#cb77-316" aria-hidden="true" tabindex="-1"></a>Based on the summary above, we can see that religiosity and political</span>
<span id="cb77-317"><a href="#cb77-317" aria-hidden="true" tabindex="-1"></a>ideology are positively related, but the religiosity only contributes</span>
<span id="cb77-318"><a href="#cb77-318" aria-hidden="true" tabindex="-1"></a>about 30 % of political ideology (R\^2 =0.34). Overal w can say that</span>
<span id="cb77-319"><a href="#cb77-319" aria-hidden="true" tabindex="-1"></a>higher level of conservatism can be somewhat (30%) predicted by</span>
<span id="cb77-320"><a href="#cb77-320" aria-hidden="true" tabindex="-1"></a>frequency of church attendance.</span>
<span id="cb77-321"><a href="#cb77-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-322"><a href="#cb77-322" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ii. y = high school GPA and x = hours of TV watching</span></span>
<span id="cb77-323"><a href="#cb77-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-324"><a href="#cb77-324" aria-hidden="true" tabindex="-1"></a>High school GPA is presented as HI variable, and hours of TV watching -</span>
<span id="cb77-325"><a href="#cb77-325" aria-hidden="true" tabindex="-1"></a>by TV variable.</span>
<span id="cb77-326"><a href="#cb77-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-327"><a href="#cb77-327" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-328"><a href="#cb77-328" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(student.survey<span class="sc">$</span>hi)</span>
<span id="cb77-329"><a href="#cb77-329" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(student.survey<span class="sc">$</span>tv)</span>
<span id="cb77-330"><a href="#cb77-330" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-331"><a href="#cb77-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-332"><a href="#cb77-332" aria-hidden="true" tabindex="-1"></a>Both variables are numeric, which allows us to run a simple linear</span>
<span id="cb77-333"><a href="#cb77-333" aria-hidden="true" tabindex="-1"></a>regression:</span>
<span id="cb77-334"><a href="#cb77-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-335"><a href="#cb77-335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-336"><a href="#cb77-336" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">lm</span>(<span class="at">data=</span>student.survey, hi <span class="sc">~</span>tv))</span>
<span id="cb77-337"><a href="#cb77-337" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-338"><a href="#cb77-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-339"><a href="#cb77-339" aria-hidden="true" tabindex="-1"></a>We can see that the the slope of Independent variable (tv) is very small</span>
<span id="cb77-340"><a href="#cb77-340" aria-hidden="true" tabindex="-1"></a>and negative. It's statistical significance is also very low and depends</span>
<span id="cb77-341"><a href="#cb77-341" aria-hidden="true" tabindex="-1"></a>on alpha level that we select. R squared, which indicates the proportion</span>
<span id="cb77-342"><a href="#cb77-342" aria-hidden="true" tabindex="-1"></a>of the variance that can be explained by x (tv watching time), is very</span>
<span id="cb77-343"><a href="#cb77-343" aria-hidden="true" tabindex="-1"></a>low (0.072). Taking this into account, I conclude there is no</span>
<span id="cb77-344"><a href="#cb77-344" aria-hidden="true" tabindex="-1"></a>contribution of TV watching to GPA level.</span>
<span id="cb77-345"><a href="#cb77-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-346"><a href="#cb77-346" aria-hidden="true" tabindex="-1"></a>To visualize these relationship, we can build a scatter plot and a</span>
<span id="cb77-347"><a href="#cb77-347" aria-hidden="true" tabindex="-1"></a>fitted linear line:</span>
<span id="cb77-348"><a href="#cb77-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-349"><a href="#cb77-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=T}</span></span>
<span id="cb77-350"><a href="#cb77-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-351"><a href="#cb77-351" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span> (<span class="at">data=</span>student.survey, <span class="at">mapping=</span><span class="fu">aes</span>(<span class="at">x=</span>tv, <span class="at">y=</span>hi))<span class="sc">+</span></span>
<span id="cb77-352"><a href="#cb77-352" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb77-353"><a href="#cb77-353" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>, <span class="at">se =</span> T)<span class="sc">+</span></span>
<span id="cb77-354"><a href="#cb77-354" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title=</span><span class="st">"Sctterplot between hours of TV watching and high school GPA"</span>, <span class="at">y=</span><span class="st">"High school GPA"</span>, <span class="at">x=</span><span class="st">"hours of TV watching"</span>)</span>
<span id="cb77-355"><a href="#cb77-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb77-356"><a href="#cb77-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-357"><a href="#cb77-357" aria-hidden="true" tabindex="-1"></a>From the graph above we can see, that the standard error band is getting</span>
<span id="cb77-358"><a href="#cb77-358" aria-hidden="true" tabindex="-1"></a>wider towards the right side of the chart, due to low amount of</span>
<span id="cb77-359"><a href="#cb77-359" aria-hidden="true" tabindex="-1"></a>observations in that part of the sample. It also adds uncertainty to a</span>
<span id="cb77-360"><a href="#cb77-360" aria-hidden="true" tabindex="-1"></a>conclusion and calls for more data and further investigation. Since the</span>
<span id="cb77-361"><a href="#cb77-361" aria-hidden="true" tabindex="-1"></a>overall slope does go down, I would suggest that there may be another</span>
<span id="cb77-362"><a href="#cb77-362" aria-hidden="true" tabindex="-1"></a>factor that contributes to the relationship between TV watching and GPA.</span>
<span id="cb77-363"><a href="#cb77-363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-364"><a href="#cb77-364" aria-hidden="true" tabindex="-1"></a>------------------------------------------------------------------------</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>