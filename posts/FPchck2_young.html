<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.361">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Young Soo Choi">
<meta name="dcterms.date" content="2023-04-20">
<meta name="description" content="Final Project Check In 2">

<title>Final Project Check In</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../images/DACSS_Round_Network.png" rel="icon" type="image/png">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<meta name="twitter:title" content="Final Project Check In">
<meta name="twitter:description" content="Final Project Check In 2">
<meta name="twitter:image" content="https://dacss.github.io/603_Spring_2023/posts/FPchck2_young_files/figure-html/unnamed-chunk-13-1.png">
<meta name="twitter:creator" content="@UMassDACSS">
<meta name="twitter:site" content="@UMassDACSS">
<meta name="twitter:image-height" content="960">
<meta name="twitter:image-width" content="1344">
<meta name="twitter:card" content="summary_large_image">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a href="../index.html" class="navbar-brand navbar-brand-logo">
    <img src="../images/UMass White Wordmark Horiz.png" alt="" class="navbar-logo">
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target="">
 <span class="menu-text">Spring 2023 Posts</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../about.html" rel="" target="">
 <span class="menu-text">Contributors</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="https://umass.edu/sbs/dacss" rel="" target="">
 <span class="menu-text">DACSS</span></a>
  </li>  
  <li class="nav-item compact">
    <a class="nav-link" href="https://dacss.github.io/603_Spring_2023/" rel="" target=""><i class="bi bi-github" role="img" aria-label="GitHub">
</i> 
 <span class="menu-text"></span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#research-problems" id="toc-research-problems" class="nav-link active" data-scroll-target="#research-problems">Research Problems</a></li>
  <li><a href="#research-design" id="toc-research-design" class="nav-link" data-scroll-target="#research-design">Research Design</a></li>
  <li><a href="#data-load" id="toc-data-load" class="nav-link" data-scroll-target="#data-load">Data Load</a></li>
  <li><a href="#simple-analysis" id="toc-simple-analysis" class="nav-link" data-scroll-target="#simple-analysis">Simple Analysis</a>
  <ul class="collapse">
  <li><a href="#a-comparison-of-average-scores-in-two-groups" id="toc-a-comparison-of-average-scores-in-two-groups" class="nav-link" data-scroll-target="#a-comparison-of-average-scores-in-two-groups">A Comparison of Average Scores in Two Groups</a></li>
  <li><a href="#raising-the-criteria-for-determining-a-high-degree-of-intervention" id="toc-raising-the-criteria-for-determining-a-high-degree-of-intervention" class="nav-link" data-scroll-target="#raising-the-criteria-for-determining-a-high-degree-of-intervention">Raising the criteria for determining a high degree of intervention</a></li>
  <li><a href="#correlation-analysis-between-intervention-frequency-and-score" id="toc-correlation-analysis-between-intervention-frequency-and-score" class="nav-link" data-scroll-target="#correlation-analysis-between-intervention-frequency-and-score">Correlation Analysis between Intervention Frequency and Score</a></li>
  </ul></li>
  <li><a href="#analysis-considering-scoring-environment" id="toc-analysis-considering-scoring-environment" class="nav-link" data-scroll-target="#analysis-considering-scoring-environment">Analysis considering scoring environment</a>
  <ul class="collapse">
  <li><a href="#review-analysis-scope" id="toc-review-analysis-scope" class="nav-link" data-scroll-target="#review-analysis-scope">Review Analysis Scope</a></li>
  <li><a href="#comparison-of-average-scores-by-group-since-2015" id="toc-comparison-of-average-scores-by-group-since-2015" class="nav-link" data-scroll-target="#comparison-of-average-scores-by-group-since-2015">Comparison of average scores by group since 2015</a></li>
  <li><a href="#correlation-analysis-since-2015" id="toc-correlation-analysis-since-2015" class="nav-link" data-scroll-target="#correlation-analysis-since-2015">Correlation Analysis since 2015</a></li>
  <li><a href="#polynomial-regression" id="toc-polynomial-regression" class="nav-link" data-scroll-target="#polynomial-regression">Polynomial regression</a></li>
  </ul></li>
  <li><a href="#analysis-using-expected-score" id="toc-analysis-using-expected-score" class="nav-link" data-scroll-target="#analysis-using-expected-score">Analysis using expected score</a>
  <ul class="collapse">
  <li><a href="#adjust-descriptive-variables" id="toc-adjust-descriptive-variables" class="nav-link" data-scroll-target="#adjust-descriptive-variables">Adjust Descriptive Variables</a></li>
  <li><a href="#on-base-percentage-and-slugging-percentage" id="toc-on-base-percentage-and-slugging-percentage" class="nav-link" data-scroll-target="#on-base-percentage-and-slugging-percentage">On-base percentage and Slugging percentage</a></li>
  </ul></li>
  <li><a href="#standardization-analysis" id="toc-standardization-analysis" class="nav-link" data-scroll-target="#standardization-analysis">Standardization Analysis</a>
  <ul class="collapse">
  <li><a href="#a-comparison-of-standardization-scores-in-three-groups" id="toc-a-comparison-of-standardization-scores-in-three-groups" class="nav-link" data-scroll-target="#a-comparison-of-standardization-scores-in-three-groups">A Comparison of Standardization Scores in Three Groups</a></li>
  <li><a href="#regression-with-intervention-variable" id="toc-regression-with-intervention-variable" class="nav-link" data-scroll-target="#regression-with-intervention-variable">Regression with intervention variable</a></li>
  </ul></li>
  <li><a href="#finish" id="toc-finish" class="nav-link" data-scroll-target="#finish">Finish</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Final Project Check In</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
  <div class="quarto-categories">
    <div class="quarto-category">finalpart2</div>
  </div>
  </div>

<div>
  <div class="description">
    Final Project Check In 2
  </div>
</div>


<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Young Soo Choi </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 20, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<section id="research-problems" class="level1">
<h1>Research Problems</h1>
<p>As discussed in check-in 1, my research topics are as follows. “Does the baseball manager’s intervention in games improve the team’s scoring ability?”</p>
<p>The main concepts of the research topic are first “scoring”. This is a simple concept that does not require a separate operational definition. You just have to find and compare scoring column in the data frame. The next concept is “intervention in the game.” This can be defined in various ways. Since the purpose of this study is not to discuss these topics, in order to simplify the research problem, I will define intervention in the game as the concepts of “bunt” and “stolen attempt.” In a baseball game between a pitcher and a batter, a bunt that sacrifices batter himself to advance a runner and a steal to send another base is a difficult choice for a batter or runner without the manager’s instructions, or at least acquiescence. There is also a great deal of discussion about this topic, but in this study, I will briefly summarize it and move on.</p>
<p>To measure the concept of intervention defined from this perspective, this study defines intervention as the sum of bunt (sacrifice, sh) and steal attempt (sb+cs). In other words, in this study, “intervention in the game” is operatively defined as sh+sb+cs.</p>
</section>
<section id="research-design" class="level1">
<h1>Research Design</h1>
<p>This research problem can be approached in various ways. First of all, I can think of a way to simply compare the average score of a team that has a lot of operational intervention and a team that does not. Next, the correlation between the frequency of intervention in the game and the score can be reviewed. In other words, through the t-test, it is possible to examine whether there is a difference between average scores between the two groups and how the correlation between game intervention and scores appears through correlation analysis.</p>
<p>However, this is a simple approach that does not take into account the characteristics of baseball. The environment of baseball is different every year. Numerous variables such as the number of participating teams, the level of players, climate, and stadiums change the pattern of scoring every year. From this point of view, it may be more reasonable to select and analyze specific years with similar league environments rather than using all data for analysis.</p>
<p>The next thing to consider is that each team has a different batting ability involved in baseball’s scoring. For example, a team with strong basic offense naturally scores more points than a team with weak basic offense. Therefore, these points need to be considered as well.</p>
<p>From this point of view, I will limit the scope of the analysis to a specific year after considering various variables. I will also consider analytical methods that take into account the team’s basic offense. Fortunately, there are several ways to get expected scores, and I will use these methods to find the difference between the actual score of a team with a lot of managerial intervention and the expected score and compare it to a team that does not.</p>
</section>
<section id="data-load" class="level1">
<h1>Data Load</h1>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>── Attaching packages ─────────────────────────────────────── tidyverse 1.3.2 ──
✔ ggplot2 3.4.1     ✔ purrr   1.0.1
✔ tibble  3.1.8     ✔ dplyr   1.1.0
✔ tidyr   1.3.0     ✔ stringr 1.5.0
✔ readr   2.1.4     ✔ forcats 1.0.0
── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
✖ dplyr::filter() masks stats::filter()
✖ dplyr::lag()    masks stats::lag()</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co"># loading data</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>kbo_df<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"~/R/603_Spring_2023/posts/_data/kbo_df.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>New names:
Rows: 313 Columns: 28
── Column specification
────────────────────────────────────────────────────────
Delimiter: "," chr (1): team dbl (27): ...1, year, game, win, lose, tie,
run_scored, run_allowed, batters...
ℹ Use `spec()` to retrieve the full column specification for this data. ℹ
Specify the column types or set `show_col_types = FALSE` to quiet this message.
• `` -&gt; `...1`</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kbo_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 28
   ...1  year team    game   win  lose   tie run_s…¹ run_a…² batters   tpa    ab
  &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1     1  1982 Bears     80    56    24     0     399     318     930  3098  2745
2     2  1982 Giants    80    31    49     0     353     385     863  3062  2628
3     3  1982 Lions     80    54    26     0     429     257     887  3043  2647
4     4  1982 Tigers    80    38    42     0     374     388     873  2990  2665
5     5  1982 Twins     80    46    34     0     419     350     952  3061  2686
6     6  1982 Unico…    80    15    65     0     302     574     867  2954  2653
# … with 16 more variables: hit &lt;dbl&gt;, double &lt;dbl&gt;, triple &lt;dbl&gt;, hr &lt;dbl&gt;,
#   bb &lt;dbl&gt;, ibb &lt;dbl&gt;, hbp &lt;dbl&gt;, so &lt;dbl&gt;, rbi &lt;dbl&gt;, r &lt;dbl&gt;, sh &lt;dbl&gt;,
#   sf &lt;dbl&gt;, sb &lt;dbl&gt;, cs &lt;dbl&gt;, gidp &lt;dbl&gt;, e &lt;dbl&gt;, and abbreviated variable
#   names ¹​run_scored, ²​run_allowed</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>kbo_df<span class="ot">&lt;-</span>kbo_df[,<span class="dv">2</span><span class="sc">:</span><span class="dv">28</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="simple-analysis" class="level1">
<h1>Simple Analysis</h1>
<section id="a-comparison-of-average-scores-in-two-groups" class="level2">
<h2 class="anchored" data-anchor-id="a-comparison-of-average-scores-in-two-groups">A Comparison of Average Scores in Two Groups</h2>
<p>First of all, let’s compare the difference in the scores of teams with many manager’s interventions and those who don’t. To this end, teams with more than average manager intervention and teams that do not are classified by year. According to the previous operational definition, the sum of steal attempts (stolen base(sb) + caught stolen(cs)) and bunt(sacrifice hit, sh) is considered as the frequency of manager intervention, so the average number of manager interventions of each team by year is calculated, and the higher team is classified into the high group and lower team is classified into the lower group.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making average variables by years</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="co"># for sh</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="do">## create an empty data frame to store the results</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>sh_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">avr_sh =</span> <span class="fu">numeric</span>())</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a><span class="do">## loop over the years</span></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>  <span class="do">## filter the data for the current year and calculate the sum of sh variable</span></span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  year_sh <span class="ot">&lt;-</span> kbo_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_av_sh =</span> <span class="fu">sum</span>(sh)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_av_sh)</span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  <span class="do">## add the result to the data frame</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>  sh_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sh_df, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">avr_sh =</span> year_sh))</span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-19"><a href="#cb8-19" aria-hidden="true" tabindex="-1"></a><span class="co"># for sb</span></span>
<span id="cb8-20"><a href="#cb8-20" aria-hidden="true" tabindex="-1"></a>sb_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">avr_sb =</span> <span class="fu">numeric</span>())</span>
<span id="cb8-21"><a href="#cb8-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-22"><a href="#cb8-22" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb8-23"><a href="#cb8-23" aria-hidden="true" tabindex="-1"></a>  year_sb <span class="ot">&lt;-</span> kbo_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-24"><a href="#cb8-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb8-25"><a href="#cb8-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_av_sb =</span> <span class="fu">sum</span>(sb)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb8-26"><a href="#cb8-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_av_sb)</span>
<span id="cb8-27"><a href="#cb8-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-28"><a href="#cb8-28" aria-hidden="true" tabindex="-1"></a>  sb_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sb_df, <span class="fu">data.frame</span>(<span class="at">year=</span>i, <span class="at">avr_sb=</span>year_sb))</span>
<span id="cb8-29"><a href="#cb8-29" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-30"><a href="#cb8-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-31"><a href="#cb8-31" aria-hidden="true" tabindex="-1"></a><span class="co"># for cs</span></span>
<span id="cb8-32"><a href="#cb8-32" aria-hidden="true" tabindex="-1"></a>cs_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">avr_cs =</span> <span class="fu">numeric</span>())</span>
<span id="cb8-33"><a href="#cb8-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-34"><a href="#cb8-34" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb8-35"><a href="#cb8-35" aria-hidden="true" tabindex="-1"></a>  year_cs <span class="ot">&lt;-</span> kbo_df <span class="sc">%&gt;%</span> </span>
<span id="cb8-36"><a href="#cb8-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb8-37"><a href="#cb8-37" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_av_cs =</span> <span class="fu">sum</span>(cs)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb8-38"><a href="#cb8-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_av_cs)</span>
<span id="cb8-39"><a href="#cb8-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-40"><a href="#cb8-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-41"><a href="#cb8-41" aria-hidden="true" tabindex="-1"></a>  cs_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cs_df, <span class="fu">data.frame</span>(<span class="at">year=</span>i, <span class="at">avr_cs=</span>year_cs))</span>
<span id="cb8-42"><a href="#cb8-42" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb8-43"><a href="#cb8-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-44"><a href="#cb8-44" aria-hidden="true" tabindex="-1"></a><span class="co"># print the results data frame</span></span>
<span id="cb8-45"><a href="#cb8-45" aria-hidden="true" tabindex="-1"></a>sh_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   year    avr_sh
1  1982  36.00000
2  1983  65.50000
3  1984  56.83333
4  1985  78.50000
5  1986  86.71429
6  1987  74.42857
7  1988  78.14286
8  1989  77.14286
9  1990  79.71429
10 1991  81.75000
11 1992  77.87500
12 1993  87.25000
13 1994  88.62500
14 1995  75.25000
15 1996  93.25000
16 1997 101.25000
17 1998  87.25000
18 1999  79.87500
19 2000  64.50000
20 2001  80.50000
21 2002  67.00000
22 2003  94.37500
23 2004  84.00000
24 2005  88.00000
25 2006 100.75000
26 2007  91.62500
27 2008  65.12500
28 2009  69.87500
29 2010  91.62500
30 2011  97.75000
31 2012 102.75000
32 2013  75.22222
33 2014  68.11111
34 2015  83.40000
35 2016  65.10000
36 2017  60.00000
37 2018  44.70000
38 2019  43.60000
39 2020  48.60000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>sb_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   year    avr_sb
1  1982 116.50000
2  1983  83.33333
3  1984  87.00000
4  1985 105.16667
5  1986  91.28571
6  1987  94.14286
7  1988 106.14286
8  1989 138.14286
9  1990 118.28571
10 1991 126.87500
11 1992 105.12500
12 1993 116.62500
13 1994 124.25000
14 1995 126.62500
15 1996 113.62500
16 1997 120.75000
17 1998  99.25000
18 1999 116.75000
19 2000  93.37500
20 2001 107.00000
21 2002  97.12500
22 2003  89.25000
23 2004  84.75000
24 2005  97.75000
25 2006  93.12500
26 2007  95.50000
27 2008 123.37500
28 2009 132.00000
29 2010 139.12500
30 2011 116.62500
31 2012 127.75000
32 2013 129.66667
33 2014 113.66667
34 2015 120.20000
35 2016 105.80000
36 2017  77.80000
37 2018  92.80000
38 2019  98.90000
39 2020  89.20000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>cs_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   year   avr_cs
1  1982 51.83333
2  1983 57.83333
3  1984 56.16667
4  1985 69.50000
5  1986 65.85714
6  1987 59.00000
7  1988 56.85714
8  1989 75.85714
9  1990 71.57143
10 1991 77.00000
11 1992 55.87500
12 1993 64.50000
13 1994 65.87500
14 1995 56.25000
15 1996 65.50000
16 1997 66.12500
17 1998 53.50000
18 1999 53.12500
19 2000 44.87500
20 2001 53.87500
21 2002 50.75000
22 2003 53.12500
23 2004 48.62500
24 2005 43.00000
25 2006 43.50000
26 2007 45.75000
27 2008 55.37500
28 2009 49.87500
29 2010 58.75000
30 2011 56.00000
31 2012 57.50000
32 2013 55.77778
33 2014 48.44444
34 2015 52.60000
35 2016 54.70000
36 2017 40.70000
37 2018 41.00000
38 2019 42.30000
39 2020 37.70000</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co"># merge those data</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>int_df<span class="ot">&lt;-</span><span class="fu">merge</span>(<span class="fu">merge</span>(sh_df, sb_df, <span class="at">by =</span> <span class="st">"year"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>), cs_df, <span class="at">by=</span><span class="st">"year"</span>, <span class="at">all=</span><span class="cn">TRUE</span>)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="co"># left join to original data</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>tot_df<span class="ot">&lt;-</span><span class="fu">left_join</span>(kbo_df, int_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(year)`</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making intervention variables</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>tot_df<span class="ot">&lt;-</span>tot_df <span class="sc">%&gt;%</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_att=</span>sb<span class="sc">+</span>cs, <span class="at">inter =</span> sh<span class="sc">+</span>st_att, <span class="at">avr_inter=</span>avr_sh<span class="sc">+</span>avr_sb<span class="sc">+</span>avr_cs)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>tot_df[, <span class="fu">c</span>(<span class="st">'year'</span>,<span class="st">'team'</span>,<span class="st">'sh'</span>,<span class="st">'st_att'</span>,<span class="st">'inter'</span>,<span class="st">'avr_inter'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 313 × 6
    year team        sh st_att inter avr_inter
   &lt;dbl&gt; &lt;chr&gt;    &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;     &lt;dbl&gt;
 1  1982 Bears       46    167   213      204.
 2  1982 Giants      41    136   177      204.
 3  1982 Lions       36    189   225      204.
 4  1982 Tigers      28    207   235      204.
 5  1982 Twins       32    194   226      204.
 6  1982 Unicorns    33    117   150      204.
 7  1983 Bears       89    105   194      207.
 8  1983 Giants      58    137   195      207.
 9  1983 Lions       66    112   178      207.
10  1983 Tigers      37    222   259      207.
# … with 303 more rows</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making intervention type variables</span></span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>tot_df<span class="ot">&lt;-</span>tot_df <span class="sc">%&gt;%</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inter_fre=</span><span class="fu">ifelse</span>(inter<span class="sc">&gt;</span>avr_inter, <span class="st">"high"</span>, <span class="st">"no"</span>))</span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>tot_df[,<span class="fu">c</span>(<span class="st">'year'</span>, <span class="st">'team'</span>, <span class="st">'inter_fre'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 313 × 3
    year team     inter_fre
   &lt;dbl&gt; &lt;chr&gt;    &lt;chr&gt;    
 1  1982 Bears    high     
 2  1982 Giants   no       
 3  1982 Lions    high     
 4  1982 Tigers   high     
 5  1982 Twins    high     
 6  1982 Unicorns no       
 7  1983 Bears    no       
 8  1983 Giants   no       
 9  1983 Lions    no       
10  1983 Tigers   high     
# … with 303 more rows</code></pre>
</div>
</div>
<p>The necessary processing has been completed. Let’s look at the frequency of groups with high and low interventions by year.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tot_df<span class="sc">$</span>inter_fre, tot_df<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>      
       1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
  high    4    2    3    4    5    4    3    3    4    4    4    4    3    4
  no      2    4    3    2    2    3    4    4    3    4    4    4    5    4
      
       1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009
  high    5    3    3    6    4    3    4    5    4    5    5    4    4    3
  no      3    5    5    2    4    5    4    3    4    3    3    4    4    5
      
       2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 2020
  high    3    3    3    6    6    4    4    6    5    6    4
  no      5    5    5    3    3    6    6    4    5    4    6</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tot_df<span class="sc">$</span>inter_fre)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
high   no 
 159  154 </code></pre>
</div>
</div>
<p>The number of high and low groups is almost the same because they are divided into teams that are higher than average and those that are not.</p>
<p>Now, let’s compare the average scores between the two groups. (Since the study was a population, the average was simply compared instead of the t-test.)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing average score</span></span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(inter_fre) <span class="sc">%&gt;%</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_score=</span><span class="fu">mean</span>(run_scored))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 × 2
  inter_fre mean_score
  &lt;chr&gt;          &lt;dbl&gt;
1 high            595.
2 no              594.</code></pre>
</div>
</div>
<p>There is little difference in the average score between the two groups. In other words, the analysis classified in this way did not produce meaningful results.</p>
</section>
<section id="raising-the-criteria-for-determining-a-high-degree-of-intervention" class="level2">
<h2 class="anchored" data-anchor-id="raising-the-criteria-for-determining-a-high-degree-of-intervention">Raising the criteria for determining a high degree of intervention</h2>
<p>Since the previous simple classification did not have much meaning, I further strengthened the criteria for classifying the frequency of intervention. This time, the group that intervened more than 1 standard deviation from the average was divided into a high group, the group that intervened less than 1 standard deviation from the average was divided into a low group, and the rest into a normal group.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making sd of intervention by each year</span></span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>sd_int<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">sd_i=</span> <span class="fu">numeric</span>())</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  year_sd <span class="ot">&lt;-</span> tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_sd_int =</span> <span class="fu">sd</span>(inter)) <span class="sc">%&gt;%</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_sd_int)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  sd_int<span class="ot">&lt;-</span> <span class="fu">rbind</span>(sd_int, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">sd_i=</span> year_sd))</span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>tot_df<span class="ot">&lt;-</span><span class="fu">left_join</span>(tot_df, sd_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(year)`</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making three type variables</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>tot_df<span class="ot">&lt;-</span>tot_df <span class="sc">%&gt;%</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inter_fre_sd=</span><span class="fu">ifelse</span>(inter<span class="sc">&gt;</span>avr_inter<span class="sc">+</span>sd_i, <span class="st">"high"</span>, </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(inter<span class="sc">&lt;</span>avr_inter<span class="sc">-</span>sd_i, <span class="st">"low"</span>, <span class="st">"normal"</span>)))</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>tot_df[, <span class="fu">c</span>(<span class="st">'year'</span>,<span class="st">'team'</span>,<span class="st">'run_scored'</span>, <span class="st">'inter_fre_sd'</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 313 × 4
    year team     run_scored inter_fre_sd
   &lt;dbl&gt; &lt;chr&gt;         &lt;dbl&gt; &lt;chr&gt;       
 1  1982 Bears           399 normal      
 2  1982 Giants          353 normal      
 3  1982 Lions           429 normal      
 4  1982 Tigers          374 normal      
 5  1982 Twins           419 normal      
 6  1982 Unicorns        302 low         
 7  1983 Bears           418 normal      
 8  1983 Giants          370 normal      
 9  1983 Lions           448 normal      
10  1983 Tigers          423 high        
# … with 303 more rows</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tot_df<span class="sc">$</span>inter_fre_sd, tot_df<span class="sc">$</span>year)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>        
         1982 1983 1984 1985 1986 1987 1988 1989 1990 1991 1992 1993 1994 1995
  high      0    2    1    1    1    1    1    2    1    2    1    1    2    1
  low       1    1    1    1    1    1    2    2    2    2    1    1    1    2
  normal    5    3    4    4    5    5    4    3    4    4    6    6    5    5
        
         1996 1997 1998 1999 2000 2001 2002 2003 2004 2005 2006 2007 2008 2009
  high      1    1    1    1    1    1    1    1    2    1    0    2    1    1
  low       1    2    1    2    2    1    1    2    1    1    1    1    2    1
  normal    6    5    6    5    5    6    6    5    5    6    7    5    5    6
        
         2010 2011 2012 2013 2014 2015 2016 2017 2018 2019 2020
  high      1    2    1    1    2    1    2    2    2    0    2
  low       2    1    0    1    2    1    2    1    1    2    2
  normal    5    5    7    7    5    8    6    7    7    8    6</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tot_df<span class="sc">$</span>inter_fre_sd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
  high    low normal 
    48     53    212 </code></pre>
</div>
</div>
<p>As a result, a total of 313 team data from 1982 to 2020 were divided into 48 high groups, 53 low groups, and 212 normal groups. Now, I compared the average score between these three groups.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing average scores</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>tot_df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(inter_fre_sd) <span class="sc">%&gt;%</span></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_sco=</span><span class="fu">mean</span>(run_scored))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  inter_fre_sd mean_sco
  &lt;chr&gt;           &lt;dbl&gt;
1 high             610.
2 low              596.
3 normal           591.</code></pre>
</div>
</div>
<p>The team that intervenes a lot shows a high average score. However, even the low intervention team showed higher scoring ability than the average team. It seems that something further analysis is needed.</p>
</section>
<section id="correlation-analysis-between-intervention-frequency-and-score" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis-between-intervention-frequency-and-score">Correlation Analysis between Intervention Frequency and Score</h2>
<p>Next, beyond a simple average comparison between groups, the correlation between the frequency of game intervention and scores was examined.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation analysis</span></span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(tot_df<span class="sc">$</span>run_scored, tot_df<span class="sc">$</span>inter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.1734817</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="co"># simple regression</span></span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>lm_int<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>inter, tot_df)</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = run_scored ~ inter, data = tot_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-334.31  -85.82    2.56   91.53  323.55 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 706.1534    36.5710  19.309  &lt; 2e-16 ***
inter        -0.4656     0.1499  -3.106  0.00207 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 130.8 on 311 degrees of freedom
Multiple R-squared:  0.0301,    Adjusted R-squared:  0.02698 
F-statistic:  9.65 on 1 and 311 DF,  p-value: 0.002068</code></pre>
</div>
</div>
<p>In this way, there is a negative correlation between game intervention and scoring. Even from the regression equation between the two variables, it can be seen that the coefficient attached to the game intervention variable is negative.</p>
<p>I separated the steal attempt and the bunt and examined it in more detail.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Stolen attempt and bunt separation</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(tot_df<span class="sc">$</span>run_scored, tot_df<span class="sc">$</span>sh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.2197821</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(tot_df<span class="sc">$</span>run_scored, tot_df<span class="sc">$</span>st_att)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.0730271</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>lm_int_each<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>sh<span class="sc">+</span>st_att, tot_df)</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_int_each)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = run_scored ~ sh + st_att, data = tot_df)

Residuals:
    Min      1Q  Median      3Q     Max 
-350.17  -81.72    1.41   94.93  310.52 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 711.3843    36.2739  19.611  &lt; 2e-16 ***
sh           -1.1214     0.2881  -3.892 0.000122 ***
st_att       -0.1898     0.1812  -1.048 0.295524    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 129.5 on 310 degrees of freedom
Multiple R-squared:  0.05166,   Adjusted R-squared:  0.04554 
F-statistic: 8.444 on 2 and 310 DF,  p-value: 0.0002687</code></pre>
</div>
</div>
<p>Both steal attempts and bunt variables show a negative correlation with scoring.</p>
<p>Why are the average comparison and correlation analysis results different?</p>
<p>As pointed out earlier, there are countless variables that affect baseball’s score, and it is likely that the result is that the variable called “scoring environment,” which is generally batter-friendly and pitcher-friendly, is not considered. In other words, the difference in average scores that occur by year is not reflected in this simple comparison. For example, if the average score per game in one year is 12 points, and if it is only 8 points in another year, an analysis that ignores these differences will not be valid.</p>
<p>In consideration of these points, the analysis was conducted in consideration of the scoring environment of baseball.</p>
</section>
</section>
<section id="analysis-considering-scoring-environment" class="level1">
<h1>Analysis considering scoring environment</h1>
<section id="review-analysis-scope" class="level2">
<h2 class="anchored" data-anchor-id="review-analysis-scope">Review Analysis Scope</h2>
<p>Through the boxplot figure, the distribution of scores and game intervention by year was briefly examined.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(tot_df<span class="sc">$</span>run_scored<span class="sc">/</span>tot_df<span class="sc">$</span>game<span class="sc">~</span>tot_df<span class="sc">$</span>year, <span class="at">ylab=</span><span class="st">"Score/G"</span>, <span class="at">xlab =</span><span class="st">'Year'</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(tot_df<span class="sc">$</span>inter<span class="sc">/</span>tot_df<span class="sc">$</span>game<span class="sc">~</span>tot_df<span class="sc">$</span>year, <span class="at">ylab=</span><span class="st">"Intervention/G"</span>, <span class="at">xlab=</span><span class="st">"Year"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FPchck2_young_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>The left is a boxplot diagram showing the distribution of the average score per game and the right is the distribution of the average number of interventions per game. As expected, the year-to-year variation is significant. Scores are generally up and down and intervention is down.</p>
<p>We looked more closely at how the average score and batting average per game have changed year by year. Here, the batting average is calculated as hit/ab (at bat) as the ratio of hits at bat.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate batting average of each year</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="co"># at bat</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>ab_year<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">at_bat=</span> <span class="fu">numeric</span>())</span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>  year_ab <span class="ot">&lt;-</span> tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_ab_sum =</span> <span class="fu">sum</span>(ab)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_ab_sum)</span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  ab_year<span class="ot">&lt;-</span> <span class="fu">rbind</span>(ab_year, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">at_bat=</span> year_ab))</span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="co"># hits</span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a>hit_year<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">hits=</span> <span class="fu">numeric</span>())</span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a>  year_hit <span class="ot">&lt;-</span> tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_hit_sum =</span> <span class="fu">sum</span>(hit)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_hit_sum)</span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a>  hit_year<span class="ot">&lt;-</span> <span class="fu">rbind</span>(hit_year, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">hits=</span> year_hit))</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>batting_average<span class="ot">&lt;-</span><span class="fu">merge</span>(ab_year, hit_year, <span class="at">by =</span> <span class="st">"year"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>batting_average<span class="ot">&lt;-</span>batting_average<span class="sc">%&gt;%</span></span>
<span id="cb47-30"><a href="#cb47-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">batting_average=</span>hits<span class="sc">/</span>at_bat)</span>
<span id="cb47-31"><a href="#cb47-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-32"><a href="#cb47-32" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate average score of each year</span></span>
<span id="cb47-33"><a href="#cb47-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-34"><a href="#cb47-34" aria-hidden="true" tabindex="-1"></a><span class="do">## sum of score</span></span>
<span id="cb47-35"><a href="#cb47-35" aria-hidden="true" tabindex="-1"></a>score_year<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">score=</span> <span class="fu">numeric</span>())</span>
<span id="cb47-36"><a href="#cb47-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-37"><a href="#cb47-37" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb47-38"><a href="#cb47-38" aria-hidden="true" tabindex="-1"></a>  year_score <span class="ot">&lt;-</span> tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb47-39"><a href="#cb47-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb47-40"><a href="#cb47-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_score_sum =</span> <span class="fu">sum</span>(run_scored)) <span class="sc">%&gt;%</span> </span>
<span id="cb47-41"><a href="#cb47-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_score_sum)</span>
<span id="cb47-42"><a href="#cb47-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-43"><a href="#cb47-43" aria-hidden="true" tabindex="-1"></a>  score_year<span class="ot">&lt;-</span> <span class="fu">rbind</span>(score_year, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">score=</span> year_score))</span>
<span id="cb47-44"><a href="#cb47-44" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-45"><a href="#cb47-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-46"><a href="#cb47-46" aria-hidden="true" tabindex="-1"></a><span class="do">## total games</span></span>
<span id="cb47-47"><a href="#cb47-47" aria-hidden="true" tabindex="-1"></a>games_year<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">gp=</span> <span class="fu">numeric</span>())</span>
<span id="cb47-48"><a href="#cb47-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-49"><a href="#cb47-49" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb47-50"><a href="#cb47-50" aria-hidden="true" tabindex="-1"></a>  year_games <span class="ot">&lt;-</span> tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb47-51"><a href="#cb47-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb47-52"><a href="#cb47-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_games_sum =</span> <span class="fu">sum</span>(game)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb47-53"><a href="#cb47-53" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_games_sum)</span>
<span id="cb47-54"><a href="#cb47-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-55"><a href="#cb47-55" aria-hidden="true" tabindex="-1"></a>  games_year<span class="ot">&lt;-</span> <span class="fu">rbind</span>(games_year, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">gp=</span> year_games))</span>
<span id="cb47-56"><a href="#cb47-56" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb47-57"><a href="#cb47-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-58"><a href="#cb47-58" aria-hidden="true" tabindex="-1"></a>average_score<span class="ot">&lt;-</span><span class="fu">merge</span>(score_year, games_year, <span class="at">by =</span> <span class="st">"year"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb47-59"><a href="#cb47-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-60"><a href="#cb47-60" aria-hidden="true" tabindex="-1"></a>average_score<span class="ot">&lt;-</span>average_score<span class="sc">%&gt;%</span></span>
<span id="cb47-61"><a href="#cb47-61" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">average_score=</span>score<span class="sc">/</span>gp)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>average_score[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"average_score"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   year average_score
1  1982      9.483333
2  1983      8.030000
3  1984      7.666667
4  1985      8.166667
5  1986      7.343915
6  1987      7.994709
7  1988      8.518519
8  1989      8.352381
9  1990      8.301587
10 1991      8.803571
11 1992      9.523810
12 1993      7.359127
13 1994      8.305556
14 1995      8.309524
15 1996      8.140873
16 1997      8.835317
17 1998      8.821429
18 1999     10.765152
19 2000     10.103383
20 2001     10.351504
21 2002      9.270677
22 2003      9.272556
23 2004      9.379699
24 2005      9.178571
25 2006      7.898810
26 2007      8.543651
27 2008      8.972222
28 2009     10.323308
29 2010      9.964286
30 2011      9.063910
31 2012      8.233083
32 2013      9.293403
33 2014     11.243056
34 2015     10.552778
35 2016     11.213889
36 2017     10.669444
37 2018     11.102778
38 2019      9.094444
39 2020     10.327778</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>batting_average[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"batting_average"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>   year batting_average
1  1982       0.2650399
2  1983       0.2557265
3  1984       0.2535147
4  1985       0.2603929
5  1986       0.2505728
6  1987       0.2653134
7  1988       0.2681318
8  1989       0.2567079
9  1990       0.2567293
10 1991       0.2561911
11 1992       0.2643017
12 1993       0.2467434
13 1994       0.2570741
14 1995       0.2509807
15 1996       0.2510156
16 1997       0.2578578
17 1998       0.2607412
18 1999       0.2764104
19 2000       0.2697075
20 2001       0.2738850
21 2002       0.2633735
22 2003       0.2685470
23 2004       0.2664191
24 2005       0.2633025
25 2006       0.2549982
26 2007       0.2626301
27 2008       0.2668192
28 2009       0.2752146
29 2010       0.2698236
30 2011       0.2647216
31 2012       0.2577346
32 2013       0.2683662
33 2014       0.2892902
34 2015       0.2797730
35 2016       0.2895784
36 2017       0.2859668
37 2018       0.2857736
38 2019       0.2670202
39 2020       0.2728060</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(average_score<span class="sc">$</span>year, average_score<span class="sc">$</span>average_score, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"Average Score/G"</span>)</span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(batting_average<span class="sc">$</span>year, batting_average<span class="sc">$</span>batting_average, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"Batting Average"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FPchck2_young_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>It can also be seen that the league’s batting and scoring environment is changing significantly every year.</p>
<p>In the end, it is judged that choosing an appropriate range is good for achieving more rigorous results. The question now is how to determine the scope.</p>
<p>Considering that the trend of scoring and batting average has not changed significantly since 2015, and that 10 teams have participated in the KBO League since 2015, the target of the analysis was set from 2015 to 2020.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>tot_df<span class="sc">%&gt;%</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2015</span>)</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_2015)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 36
   year team    game   win  lose   tie run_s…¹ run_a…² batters   tpa    ab   hit
  &lt;dbl&gt; &lt;chr&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
1  2015 Bears    144    79    65     0     807     776    1704  5759  4957  1436
2  2015 Dinos    144    84    57     3     844     655    1960  5727  4967  1437
3  2015 Eagles   144    68    76     0     717     800    1899  5713  4850  1316
4  2015 Giants   144    66    77     1     765     802    1821  5680  4972  1393
5  2015 Heros    144    78    65     1     904     790    1769  5811  5069  1512
6  2015 Lande…   144    69    73     2     693     724    1845  5588  4861  1323
# … with 24 more variables: double &lt;dbl&gt;, triple &lt;dbl&gt;, hr &lt;dbl&gt;, bb &lt;dbl&gt;,
#   ibb &lt;dbl&gt;, hbp &lt;dbl&gt;, so &lt;dbl&gt;, rbi &lt;dbl&gt;, r &lt;dbl&gt;, sh &lt;dbl&gt;, sf &lt;dbl&gt;,
#   sb &lt;dbl&gt;, cs &lt;dbl&gt;, gidp &lt;dbl&gt;, e &lt;dbl&gt;, avr_sh &lt;dbl&gt;, avr_sb &lt;dbl&gt;,
#   avr_cs &lt;dbl&gt;, st_att &lt;dbl&gt;, inter &lt;dbl&gt;, avr_inter &lt;dbl&gt;, inter_fre &lt;chr&gt;,
#   sd_i &lt;dbl&gt;, inter_fre_sd &lt;chr&gt;, and abbreviated variable names ¹​run_scored,
#   ²​run_allowed</code></pre>
</div>
</div>
</section>
<section id="comparison-of-average-scores-by-group-since-2015" class="level2">
<h2 class="anchored" data-anchor-id="comparison-of-average-scores-by-group-since-2015">Comparison of average scores by group since 2015</h2>
<p>The average score for each of the three groups classified in the same way as above was compared.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>df_2015 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(inter_fre_sd) <span class="sc">%&gt;%</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avr_sco=</span><span class="fu">mean</span>(run_scored))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  inter_fre_sd avr_sco
  &lt;chr&gt;          &lt;dbl&gt;
1 high            766.
2 low             748.
3 normal          755.</code></pre>
</div>
</div>
<p>Also, the average score of the group, which frequently intervenes in the game, was high.</p>
</section>
<section id="correlation-analysis-since-2015" class="level2">
<h2 class="anchored" data-anchor-id="correlation-analysis-since-2015">Correlation Analysis since 2015</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation of intervention and score</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df_2015<span class="sc">$</span>run_scored, df_2015<span class="sc">$</span>inter)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08159777</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>lm_2015<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>inter, df_2015)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_2015)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = run_scored ~ inter, data = df_2015)

Residuals:
     Min       1Q   Median       3Q      Max 
-192.376  -81.702    5.755   65.895  195.249 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 719.7232    58.6681  12.268   &lt;2e-16 ***
inter         0.1792     0.2874   0.624    0.535    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 92.75 on 58 degrees of freedom
Multiple R-squared:  0.006658,  Adjusted R-squared:  -0.01047 
F-statistic: 0.3888 on 1 and 58 DF,  p-value: 0.5354</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df_2015<span class="sc">$</span>run_scored<span class="sc">~</span>df_2015<span class="sc">$</span>inter, <span class="at">xlab=</span><span class="st">"Intervention"</span>, <span class="at">ylab=</span><span class="st">"Run Scored"</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(run_scored<span class="sc">~</span>inter, df_2015),<span class="at">col=</span><span class="st">'red'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FPchck2_young_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Although it is also weak, there is a positive correlation in which the more interventions there are, the more points scored.</p>
<p>Next, the intervention of the game was subdivided into steal attempts and bunt, and each correlation was examined.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation of sh, steal attemps and score</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df_2015<span class="sc">$</span>run_scored, df_2015<span class="sc">$</span>sh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.02183413</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df_2015<span class="sc">$</span>run_scored, df_2015<span class="sc">$</span>st_att)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.08638145</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>lm_2015_sep<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>sh<span class="sc">+</span>st_att, df_2015)</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_2015_sep)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = run_scored ~ sh + st_att, data = df_2015)

Residuals:
     Min       1Q   Median       3Q      Max 
-191.266  -80.470    5.174   61.712  194.576 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 719.96961   59.16131  12.170   &lt;2e-16 ***
sh            0.05624    0.59915   0.094    0.926    
st_att        0.22720    0.35482   0.640    0.525    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 93.51 on 57 degrees of freedom
Multiple R-squared:  0.007615,  Adjusted R-squared:  -0.02721 
F-statistic: 0.2187 on 2 and 57 DF,  p-value: 0.8042</code></pre>
</div>
</div>
<p>Although the explanatory power is low, both steal attempts and bunt show a positive correlation with scoring. These results show a different aspect from the recently accepted perception that “operation in baseball negatively affects the team’s offensive power.” Is Korean baseball different from American baseball? I did some more analysis. First, I conducted a polynomial regression analysis.</p>
</section>
<section id="polynomial-regression" class="level2">
<h2 class="anchored" data-anchor-id="polynomial-regression">Polynomial regression</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting polynomial regression</span></span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>lm_2015_qua<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>inter<span class="sc">+</span><span class="fu">I</span>(inter<span class="sc">^</span><span class="dv">2</span>), df_2015)</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_2015_qua)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = run_scored ~ inter + I(inter^2), data = df_2015)

Residuals:
     Min       1Q   Median       3Q      Max 
-200.969  -78.462    6.364   59.548  194.162 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 802.998847 222.242294   3.613 0.000641 ***
inter        -0.643710   2.136729  -0.301 0.764313    
I(inter^2)    0.001948   0.005011   0.389 0.698944    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 93.43 on 57 degrees of freedom
Multiple R-squared:  0.009284,  Adjusted R-squared:  -0.02548 
F-statistic: 0.2671 on 2 and 57 DF,  p-value: 0.7666</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df_2015<span class="sc">$</span>inter, df_2015<span class="sc">$</span>run_scored, <span class="at">xlab=</span><span class="st">"Intervention"</span>, <span class="at">ylab=</span><span class="st">"Run Scored"</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_2015_qua)</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>ix <span class="ot">&lt;-</span> <span class="fu">sort</span>(df_2015<span class="sc">$</span>inter, <span class="at">index.return=</span>T)<span class="sc">$</span>ix</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(df_2015<span class="sc">$</span>inter[ix], pred[ix], <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FPchck2_young_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Although the model’s explanatory power has increased slightly, the positive correlation between match intervention and scoring continues to appear. (Since it is a quadratic equation, the correlation between scoring and intervention is negative until a specific level of intervention.)</p>
</section>
</section>
<section id="analysis-using-expected-score" class="level1">
<h1>Analysis using expected score</h1>
<p>As a result of the analysis so far, the results were different from the results of recent studies.</p>
<p>From now on, I will analyze the effect of the manager’s intervention in the game using the concept of expected scores.</p>
<p>First, I will introduce the concept of expected score. The score of baseball is caused by various variables working together. In other words, if the runner gets on base due to hits and walks, and the follow-up batter hits again, the score will be scored. In other words, indicators such as hits and walks and scores have a high correlation, and outs do not.</p>
<p>Using this concept, a regression model between batting indicators such as hits and walks of the team and scores can be obtained, and expected scores can be obtained by substituting each team’s batting indicators into the regression model obtained in this way.</p>
<p>Now, by looking at the difference between the expected score and the actual score obtained by each group divided by the manager’s intervention, we can see whether the manager’s intervention improves the actual score compared to the team’s expected score.</p>
<p>Then, first, the regression equation was obtained.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting regression</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>exp_lm<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>hit<span class="sc">+</span>double<span class="sc">+</span>triple<span class="sc">+</span>hr<span class="sc">+</span>bb<span class="sc">+</span>ibb<span class="sc">+</span>hbp<span class="sc">+</span>so<span class="sc">+</span>sf<span class="sc">+</span>gidp, df_2015)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(exp_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = run_scored ~ hit + double + triple + hr + bb + ibb + 
    hbp + so + sf + gidp, data = df_2015)

Residuals:
    Min      1Q  Median      3Q     Max 
-54.750  -9.564   0.773  12.749  33.562 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -413.66438   82.53095  -5.012 7.42e-06 ***
hit            0.48736    0.05270   9.248 2.53e-12 ***
double         0.32361    0.15117   2.141   0.0373 *  
triple         1.10204    0.46735   2.358   0.0224 *  
hr             0.93490    0.11086   8.433 4.18e-11 ***
bb             0.45364    0.05571   8.143 1.16e-10 ***
ibb           -0.09291    0.56884  -0.163   0.8709    
hbp            0.26767    0.16555   1.617   0.1123    
so            -0.01222    0.04394  -0.278   0.7820    
sf             0.56138    0.39545   1.420   0.1621    
gidp          -0.08900    0.25885  -0.344   0.7325    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 19.79 on 49 degrees of freedom
Multiple R-squared:  0.9618,    Adjusted R-squared:  0.954 
F-statistic: 123.4 on 10 and 49 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>It is possible to roughly grasp the impact of batting indicators such as hits, doubles, triples, and home runs on scoring.</p>
<p>It is a little surprising that the intentional base on balls (ibb) has a negative coefficient, but it is natural that the strikeout (so) and the double play (gidp) have a negative coefficient. Because these two variables mean out.</p>
<p>Now, using this model, the expected score for each team was obtained and the difference from the actual score was calculated.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get expected score</span></span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>df_2015<span class="sc">$</span>exp_score<span class="ot">&lt;-</span><span class="fu">predict</span>(exp_lm, <span class="at">newdata =</span> df_2015)</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">run_diff=</span>run_scored<span class="sc">-</span>exp_score)</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>df_2015[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"team"</span>,<span class="st">"run_scored"</span>,<span class="st">"exp_score"</span>, <span class="st">"run_diff"</span>, <span class="st">"inter_fre_sd"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 6
    year team    run_scored exp_score run_diff inter_fre_sd
   &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;     &lt;dbl&gt;    &lt;dbl&gt; &lt;chr&gt;       
 1  2015 Bears          807      816.    -9.29 normal      
 2  2015 Dinos          844      837.     7.16 high        
 3  2015 Eagles         717      726.    -9.24 normal      
 4  2015 Giants         765      780.   -15.5  normal      
 5  2015 Heros          904      908.    -3.98 low         
 6  2015 Landers        693      688.     5.31 normal      
 7  2015 Lions          897      892.     5.12 normal      
 8  2015 Tigers         648      626.    22.2  normal      
 9  2015 Twins          653      678.   -24.9  normal      
10  2015 Wiz            670      690.   -20.3  normal      
# … with 50 more rows</code></pre>
</div>
</div>
<p>The average difference between actual and expected scores was examined for each group.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>df_2015<span class="sc">%&gt;%</span><span class="fu">group_by</span>(inter_fre_sd) <span class="sc">%&gt;%</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">run_diff_avr=</span><span class="fu">mean</span>(run_diff))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  inter_fre_sd run_diff_avr
  &lt;chr&gt;               &lt;dbl&gt;
1 high                 3.40
2 low                  1.75
3 normal              -1.10</code></pre>
</div>
</div>
<p>As with the previous results, the difference between the actual score and the expected score of the team with frequent intervention is higher. In other words, a team with a lot of manager intervention is scoring more actual points than expected by the team’s attack indicators.</p>
<section id="adjust-descriptive-variables" class="level2">
<h2 class="anchored" data-anchor-id="adjust-descriptive-variables">Adjust Descriptive Variables</h2>
<p>Next, we adjusted the explanatory variables. The batting indicators included in the model above actually show a fairly high correlation with each other. In other words, a team that batting well is more likely to hit long balls such as doubles and home runs and get walks better.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># check the multicollinearity</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(df_2015[,<span class="dv">12</span><span class="sc">:</span><span class="dv">19</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FPchck2_young_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid" width="672"></p>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df_2015[,<span class="dv">12</span><span class="sc">:</span><span class="dv">19</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>              hit      double      triple          hr         bb        ibb
hit     1.0000000  0.73805947  0.38683193  0.54309756  0.2894128 0.22311500
double  0.7380595  1.00000000  0.28915285  0.46159048  0.1254726 0.22334895
triple  0.3868319  0.28915285  1.00000000 -0.01066422  0.2474792 0.09522725
hr      0.5430976  0.46159048 -0.01066422  1.00000000  0.0922088 0.20661688
bb      0.2894128  0.12547263  0.24747916  0.09220880  1.0000000 0.23571499
ibb     0.2231150  0.22334895  0.09522725  0.20661688  0.2357150 1.00000000
hbp     0.1955686  0.15696699  0.01914115  0.38753295 -0.1052230 0.32714658
so     -0.2481782 -0.08083035 -0.28829988  0.23558753 -0.3059192 0.09115365
               hbp          so
hit     0.19556855 -0.24817821
double  0.15696699 -0.08083035
triple  0.01914115 -0.28829988
hr      0.38753295  0.23558753
bb     -0.10522298 -0.30591922
ibb     0.32714658  0.09115365
hbp     1.00000000  0.13166728
so      0.13166728  1.00000000</code></pre>
</div>
</div>
<p>In fact, it can be seen that hits, doubles, triples, and home runs show a significant amount of correlation.</p>
<p>Such high multicollinearity is likely to distort the results of regression analysis, so it is necessary to select the appropriate variable again as an explanatory variable.</p>
</section>
<section id="on-base-percentage-and-slugging-percentage" class="level2">
<h2 class="anchored" data-anchor-id="on-base-percentage-and-slugging-percentage">On-base percentage and Slugging percentage</h2>
<p>In this regard, recent studies have shown the usefulness of the on-base percentage and the slugging percentage. You can simply think of it as how much on-base percentage you get on base alive without being out, and how many bases you get with one hit.</p>
<p>Baseball can score as many bases as possible at a given opportunity while consuming a limited out count (less out), and the on-base percentage and long-base percentage are used as good indicators for evaluating hitting from this point of view</p>
<p>A baseball team can score as many points as possible if it consumes a small out count (less out) and secures as many bases as possible at a given opportunity (long hit, send the ball away). From this point of view, the on-base percentage and slugging percentage are used as good indicators for evaluating battings. In this study, the on-base percentage and the slugging percentage were used as explanatory variables to take this perspective and obtain expected scores.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># OBP = (Hits + Walks + Hit-by-Pitches) / (At-Bats + Walks + Hit-by-Pitches + Sacrifice Flies)</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">obp=</span>(hit<span class="sc">+</span>bb<span class="sc">+</span>ibb<span class="sc">+</span>hbp)<span class="sc">/</span>(ab<span class="sc">+</span>bb<span class="sc">+</span>ibb<span class="sc">+</span>hbp<span class="sc">+</span>sf))</span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="co"># SLG = (1B + 2B x 2 + 3B x 3 + HR x 4) / AB</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015<span class="sc">%&gt;%</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tb=</span>hit<span class="sc">-</span>(double<span class="sc">+</span>triple<span class="sc">+</span>hr)<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>double<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>triple<span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>hr)</span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015<span class="sc">%&gt;%</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">slg=</span>tb<span class="sc">/</span>ab)</span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a>df_2015[,<span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"team"</span>, <span class="st">"run_scored"</span>, <span class="st">"obp"</span>, <span class="st">"slg"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 5
    year team    run_scored   obp   slg
   &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1  2015 Bears          807 0.373 0.435
 2  2015 Dinos          844 0.370 0.455
 3  2015 Eagles         717 0.364 0.405
 4  2015 Giants         765 0.358 0.446
 5  2015 Heros          904 0.374 0.486
 6  2015 Landers        693 0.350 0.410
 7  2015 Lions          897 0.380 0.469
 8  2015 Tigers         648 0.328 0.392
 9  2015 Twins          653 0.341 0.399
10  2015 Wiz            670 0.348 0.402
# … with 50 more rows</code></pre>
</div>
</div>
<p>For reference, the trend of on-base percentage and slugging percentage across the league by year since 2015 was also confirmed.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># take a look at obp and slg</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a>ba_2015 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">tot_ab=</span> <span class="fu">numeric</span>(), </span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tot_hit=</span><span class="fu">numeric</span>(), <span class="at">tot_bb=</span><span class="fu">numeric</span>(), <span class="at">tot_ibb=</span><span class="fu">numeric</span>(),</span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tot_hbp=</span><span class="fu">numeric</span>(), <span class="at">tot_sf=</span><span class="fu">numeric</span>(), <span class="at">tot_tb=</span><span class="fu">numeric</span>(),</span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>  year_ab_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span> </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_ab_2015 =</span> <span class="fu">sum</span>(ab)) <span class="sc">%&gt;%</span> </span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_ab_2015)</span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a>  year_hit_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_hit_2015 =</span> <span class="fu">sum</span>(hit)) <span class="sc">%&gt;%</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_hit_2015)</span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a>  year_bb_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_bb_2015 =</span> <span class="fu">sum</span>(bb)) <span class="sc">%&gt;%</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_bb_2015)</span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a>  year_ibb_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_ibb_2015 =</span> <span class="fu">sum</span>(ibb)) <span class="sc">%&gt;%</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_ibb_2015)</span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a>  year_hbp_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_hbp_2015 =</span> <span class="fu">sum</span>(hbp)) <span class="sc">%&gt;%</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_hbp_2015)</span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a>  year_sf_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_sf_2015 =</span> <span class="fu">sum</span>(sf)) <span class="sc">%&gt;%</span></span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_sf_2015)</span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb82-38"><a href="#cb82-38" aria-hidden="true" tabindex="-1"></a>  year_tb_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb82-39"><a href="#cb82-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb82-40"><a href="#cb82-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_tb_2015 =</span> <span class="fu">sum</span>(tb)) <span class="sc">%&gt;%</span></span>
<span id="cb82-41"><a href="#cb82-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_tb_2015)</span>
<span id="cb82-42"><a href="#cb82-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-43"><a href="#cb82-43" aria-hidden="true" tabindex="-1"></a>  ba_2015<span class="ot">&lt;-</span> <span class="fu">rbind</span>(ba_2015, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">tot_ab=</span>year_ab_2015,</span>
<span id="cb82-44"><a href="#cb82-44" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">tot_hit=</span>year_hit_2015, <span class="at">tot_bb=</span>year_bb_2015,</span>
<span id="cb82-45"><a href="#cb82-45" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">tot_ibb=</span>year_ibb_2015, <span class="at">tot_hbp=</span>year_hbp_2015,</span>
<span id="cb82-46"><a href="#cb82-46" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">tot_sf=</span>year_sf_2015, <span class="at">tot_tb=</span>year_tb_2015))</span>
<span id="cb82-47"><a href="#cb82-47" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb82-48"><a href="#cb82-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-49"><a href="#cb82-49" aria-hidden="true" tabindex="-1"></a>ba_2015 <span class="ot">&lt;-</span> ba_2015 <span class="sc">%&gt;%</span></span>
<span id="cb82-50"><a href="#cb82-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tot_obp=</span>(tot_hit<span class="sc">+</span>tot_bb<span class="sc">+</span>tot_ibb<span class="sc">+</span>tot_hbp)<span class="sc">/</span>(tot_ab<span class="sc">+</span>tot_bb<span class="sc">+</span>tot_ibb<span class="sc">+</span>tot_hbp<span class="sc">+</span>tot_sf))</span>
<span id="cb82-51"><a href="#cb82-51" aria-hidden="true" tabindex="-1"></a>ba_2015<span class="ot">&lt;-</span>ba_2015 <span class="sc">%&gt;%</span></span>
<span id="cb82-52"><a href="#cb82-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tot_slg=</span>tot_tb<span class="sc">/</span>tot_ab)</span>
<span id="cb82-53"><a href="#cb82-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-54"><a href="#cb82-54" aria-hidden="true" tabindex="-1"></a>ba_2015_os<span class="ot">&lt;-</span><span class="fu">select</span>(ba_2015, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb82-55"><a href="#cb82-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-56"><a href="#cb82-56" aria-hidden="true" tabindex="-1"></a>ba_2015_os</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>  year   tot_obp   tot_slg
1 2015 0.3589008 0.4301378
2 2016 0.3655517 0.4372514
3 2017 0.3551946 0.4381766
4 2018 0.3549076 0.4496014
5 2019 0.3388575 0.3844904
6 2020 0.3505034 0.4093399</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ba_2015_os, <span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_obp, <span class="at">color =</span> <span class="st">"OBP"</span>)) <span class="sc">+</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_slg, <span class="at">color =</span> <span class="st">"SLG"</span>)) <span class="sc">+</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"OBP"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"SLG"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<p><img src="FPchck2_young_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting regression model using obp and slg</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a>exp_os_lm<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>obp<span class="sc">+</span>slg, df_2015)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(exp_os_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = run_scored ~ obp + slg, data = df_2015)

Residuals:
    Min      1Q  Median      3Q     Max 
-56.288 -18.876   1.651  19.630  46.770 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  -912.09      80.51 -11.328 3.20e-16 ***
obp          3019.45     341.62   8.839 2.84e-12 ***
slg          1411.78     157.31   8.975 1.70e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 25.4 on 57 degrees of freedom
Multiple R-squared:  0.9268,    Adjusted R-squared:  0.9242 
F-statistic: 360.9 on 2 and 57 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>As a result of regression analysis, it can be seen that both the on-base percentage and the slugging percentage show a high correlation with scoring. Although only two variables were used in the explanatory power, it shows a high explanatory power that is almost close to the model using many variables.(r-squared: 0.9268)</p>
<p>Now, in the same way as the previous analysis, the expected score using the on-base percentage and the slugging percentage was obtained and compared with the actual score.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get expected score by obp, slg</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a>df_2015<span class="sc">$</span>exp_score_os<span class="ot">&lt;-</span><span class="fu">predict</span>(exp_os_lm, <span class="at">newdata =</span> df_2015)</span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">run_diff_os=</span>run_scored<span class="sc">-</span>exp_score_os)</span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>df_2015[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"team"</span>,<span class="st">"run_scored"</span>,<span class="st">"exp_score_os"</span>,<span class="st">"run_diff_os"</span>,<span class="st">"inter_fre_sd"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 6
    year team    run_scored exp_score_os run_diff_os inter_fre_sd
   &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;       
 1  2015 Bears          807         826.     -19.2   normal      
 2  2015 Dinos          844         847.      -2.75  high        
 3  2015 Eagles         717         757.     -39.9   normal      
 4  2015 Giants         765         799.     -34.3   normal      
 5  2015 Heros          904         903.       0.924 low         
 6  2015 Landers        693         724.     -31.4   normal      
 7  2015 Lions          897         898.      -1.34  normal      
 8  2015 Tigers         648         631.      16.6   normal      
 9  2015 Twins          653         681.     -27.8   normal      
10  2015 Wiz            670         706.     -35.8   normal      
# … with 50 more rows</code></pre>
</div>
</div>
<p>Using this, the average of the difference between the actual score and the expected score by the manager’s intervention frequency group was examined.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>df_2015<span class="sc">%&gt;%</span><span class="fu">group_by</span>(inter_fre_sd) <span class="sc">%&gt;%</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">run_diff_os_avr=</span><span class="fu">mean</span>(run_diff_os))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  inter_fre_sd run_diff_os_avr
  &lt;chr&gt;                  &lt;dbl&gt;
1 high                  -3.78 
2 low                    8.26 
3 normal                -0.959</code></pre>
</div>
</div>
<p>At last a new result came out.</p>
<p>Compared to the expected score estimated by the on-base percentage and slugging percentage, the actual score of the group with a high degree of intervention in the game was lower than the expected score. The coach’s intervention is rather lowering the team’s scoring ability!!</p>
</section>
</section>
<section id="standardization-analysis" class="level1">
<h1>Standardization Analysis</h1>
<p>Although the analysis period is limited, the annual score distribution is not completely constant. Finally, I examined the effect of manager’s intervention with standardized figures considering the scoring environment by year.</p>
<p>Likewise, only the results after 2015 were considered, and only the on-base percentage and the slugging percentage were used as explanatory variables.</p>
<p>Since the average intervention and standard deviation by year have already been obtained, the average and standard deviation of the average score and standard deviation of the average score and the on-base rate by year were obtained,</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="co"># making average and sd of run scored by each year</span></span>
<span id="cb91-2"><a href="#cb91-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-3"><a href="#cb91-3" aria-hidden="true" tabindex="-1"></a>as_sco_2015 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">avr_run=</span> <span class="fu">numeric</span>(), <span class="at">sd_run=</span> <span class="fu">numeric</span>(),</span>
<span id="cb91-4"><a href="#cb91-4" aria-hidden="true" tabindex="-1"></a>                          <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb91-5"><a href="#cb91-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-6"><a href="#cb91-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb91-7"><a href="#cb91-7" aria-hidden="true" tabindex="-1"></a>  year_avr_sco_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span> </span>
<span id="cb91-8"><a href="#cb91-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb91-9"><a href="#cb91-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_avr_r_2015 =</span> <span class="fu">sum</span>(run_scored)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb91-10"><a href="#cb91-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_avr_r_2015)</span>
<span id="cb91-11"><a href="#cb91-11" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-12"><a href="#cb91-12" aria-hidden="true" tabindex="-1"></a>  year_sd_sco_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span> </span>
<span id="cb91-13"><a href="#cb91-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb91-14"><a href="#cb91-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_sd_r_2015 =</span> <span class="fu">sd</span>(run_scored)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-15"><a href="#cb91-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_sd_r_2015)</span>
<span id="cb91-16"><a href="#cb91-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-17"><a href="#cb91-17" aria-hidden="true" tabindex="-1"></a>  as_sco_2015<span class="ot">&lt;-</span> <span class="fu">rbind</span>(as_sco_2015, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">avr_run=</span>year_avr_sco_2015,</span>
<span id="cb91-18"><a href="#cb91-18" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">sd_run=</span>year_sd_sco_2015))</span>
<span id="cb91-19"><a href="#cb91-19" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-20"><a href="#cb91-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-21"><a href="#cb91-21" aria-hidden="true" tabindex="-1"></a><span class="co"># making average and sd of obp and slg by each year</span></span>
<span id="cb91-22"><a href="#cb91-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-23"><a href="#cb91-23" aria-hidden="true" tabindex="-1"></a>os_2015<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">avr_obp=</span> <span class="fu">numeric</span>(), <span class="at">avr_slg=</span><span class="fu">numeric</span>(), </span>
<span id="cb91-24"><a href="#cb91-24" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sd_obp=</span><span class="fu">numeric</span>(), <span class="at">sd_slg=</span><span class="fu">numeric</span>(), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb91-25"><a href="#cb91-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-26"><a href="#cb91-26" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb91-27"><a href="#cb91-27" aria-hidden="true" tabindex="-1"></a>  year_obp_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span> </span>
<span id="cb91-28"><a href="#cb91-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb91-29"><a href="#cb91-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_obp_2015 =</span> <span class="fu">mean</span>(obp)) <span class="sc">%&gt;%</span> </span>
<span id="cb91-30"><a href="#cb91-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_obp_2015)</span>
<span id="cb91-31"><a href="#cb91-31" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-32"><a href="#cb91-32" aria-hidden="true" tabindex="-1"></a>  year_slg_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb91-33"><a href="#cb91-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb91-34"><a href="#cb91-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_slg_2015 =</span> <span class="fu">mean</span>(slg)) <span class="sc">%&gt;%</span></span>
<span id="cb91-35"><a href="#cb91-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_slg_2015)</span>
<span id="cb91-36"><a href="#cb91-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-37"><a href="#cb91-37" aria-hidden="true" tabindex="-1"></a>  year_obp_sd_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb91-38"><a href="#cb91-38" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb91-39"><a href="#cb91-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_obp_sd_2015 =</span> <span class="fu">sd</span>(obp)) <span class="sc">%&gt;%</span></span>
<span id="cb91-40"><a href="#cb91-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_obp_sd_2015)</span>
<span id="cb91-41"><a href="#cb91-41" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb91-42"><a href="#cb91-42" aria-hidden="true" tabindex="-1"></a>  year_slg_sd_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb91-43"><a href="#cb91-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb91-44"><a href="#cb91-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_slg_sd_2015 =</span> <span class="fu">sd</span>(slg)) <span class="sc">%&gt;%</span></span>
<span id="cb91-45"><a href="#cb91-45" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_slg_sd_2015)</span>
<span id="cb91-46"><a href="#cb91-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-47"><a href="#cb91-47" aria-hidden="true" tabindex="-1"></a>  os_2015<span class="ot">&lt;-</span> <span class="fu">rbind</span>(os_2015, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">avr_obp=</span>year_obp_2015,</span>
<span id="cb91-48"><a href="#cb91-48" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">avr_slg=</span>year_slg_2015, <span class="at">sd_obp=</span>year_obp_sd_2015,</span>
<span id="cb91-49"><a href="#cb91-49" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">sd_slg=</span>year_slg_sd_2015))</span>
<span id="cb91-50"><a href="#cb91-50" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb91-51"><a href="#cb91-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb91-52"><a href="#cb91-52" aria-hidden="true" tabindex="-1"></a><span class="co"># left join to original data</span></span>
<span id="cb91-53"><a href="#cb91-53" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span><span class="fu">left_join</span>(<span class="fu">left_join</span>(<span class="fu">left_join</span>(df_2015, as_sco_2015), ba_2015_os), os_2015)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stderr">
<pre><code>Joining with `by = join_by(year)`
Joining with `by = join_by(year)`
Joining with `by = join_by(year)`</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="co"># standardization</span></span>
<span id="cb93-2"><a href="#cb93-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-3"><a href="#cb93-3" aria-hidden="true" tabindex="-1"></a><span class="do">## runs</span></span>
<span id="cb93-4"><a href="#cb93-4" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015<span class="sc">%&gt;%</span></span>
<span id="cb93-5"><a href="#cb93-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_run=</span>(run_scored<span class="sc">-</span>avr_run)<span class="sc">/</span>sd_run) </span>
<span id="cb93-6"><a href="#cb93-6" aria-hidden="true" tabindex="-1"></a><span class="do">## obp</span></span>
<span id="cb93-7"><a href="#cb93-7" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015<span class="sc">%&gt;%</span></span>
<span id="cb93-8"><a href="#cb93-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_obp=</span>(obp<span class="sc">-</span>avr_obp)<span class="sc">/</span>sd_obp)</span>
<span id="cb93-9"><a href="#cb93-9" aria-hidden="true" tabindex="-1"></a><span class="do">## slg</span></span>
<span id="cb93-10"><a href="#cb93-10" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb93-11"><a href="#cb93-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_slg=</span>(slg<span class="sc">-</span>avr_slg)<span class="sc">/</span>sd_slg)</span>
<span id="cb93-12"><a href="#cb93-12" aria-hidden="true" tabindex="-1"></a><span class="do">##intervention</span></span>
<span id="cb93-13"><a href="#cb93-13" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb93-14"><a href="#cb93-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_inter=</span>(inter<span class="sc">-</span>avr_inter)<span class="sc">/</span>sd_i)</span>
<span id="cb93-15"><a href="#cb93-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb93-16"><a href="#cb93-16" aria-hidden="true" tabindex="-1"></a>df_2015[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"team"</span>,<span class="st">"st_run"</span>,<span class="st">"st_obp"</span>,<span class="st">"st_slg"</span>,<span class="st">"st_inter"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 6
    year team     st_run  st_obp st_slg st_inter
   &lt;dbl&gt; &lt;chr&gt;     &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;    &lt;dbl&gt;
 1  2015 Bears    0.479   0.839   0.147   -0.707
 2  2015 Dinos    0.855   0.678   0.760    2.19 
 3  2015 Eagles  -0.435   0.301  -0.762    0.299
 4  2015 Giants   0.0528 -0.0110  0.485   -0.676
 5  2015 Heros    1.46    0.915   1.71    -1.47 
 6  2015 Landers -0.679  -0.494  -0.603    0.207
 7  2015 Lions    1.39    1.32    1.18     0.877
 8  2015 Tigers  -1.14   -1.85   -1.15    -0.372
 9  2015 Twins   -1.08   -1.05   -0.945   -0.189
10  2015 Wiz     -0.912  -0.653  -0.830   -0.158
# … with 50 more rows</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting with standardization data</span></span>
<span id="cb95-2"><a href="#cb95-2" aria-hidden="true" tabindex="-1"></a>st_exp_sco<span class="ot">&lt;-</span><span class="fu">lm</span>(st_run<span class="sc">~</span>st_obp<span class="sc">+</span>st_slg, df_2015)</span>
<span id="cb95-3"><a href="#cb95-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(st_exp_sco)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = st_run ~ st_obp + st_slg, data = df_2015)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.79061 -0.16089 -0.00973  0.16722  0.62107 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 1.350e-16  3.914e-02   0.000        1    
st_obp      5.674e-01  6.228e-02   9.110 1.02e-12 ***
st_slg      4.477e-01  6.228e-02   7.188 1.55e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3032 on 57 degrees of freedom
Multiple R-squared:  0.903, Adjusted R-squared:  0.8996 
F-statistic: 265.3 on 2 and 57 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a><span class="co"># get expected score using standardization data</span></span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>df_2015<span class="sc">$</span>exp_st_sco<span class="ot">&lt;-</span><span class="fu">predict</span>(st_exp_sco, <span class="at">newdata =</span> df_2015)</span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_run_diff=</span>st_run<span class="sc">-</span>exp_st_sco)</span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>df_2015[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"team"</span>,<span class="st">"exp_st_sco"</span>, <span class="st">"st_run_diff"</span>, <span class="st">"inter_fre_sd"</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 60 × 5
    year team    exp_st_sco st_run_diff inter_fre_sd
   &lt;dbl&gt; &lt;chr&gt;        &lt;dbl&gt;       &lt;dbl&gt; &lt;chr&gt;       
 1  2015 Bears        0.542     -0.0622 normal      
 2  2015 Dinos        0.725      0.130  high        
 3  2015 Eagles      -0.170     -0.264  normal      
 4  2015 Giants       0.211     -0.158  normal      
 5  2015 Heros        1.29       0.178  low         
 6  2015 Landers     -0.550     -0.128  normal      
 7  2015 Lions        1.28       0.118  normal      
 8  2015 Tigers      -1.56       0.424  normal      
 9  2015 Twins       -1.02      -0.0680 normal      
10  2015 Wiz         -0.742     -0.170  normal      
# … with 50 more rows</code></pre>
</div>
</div>
<section id="a-comparison-of-standardization-scores-in-three-groups" class="level2">
<h2 class="anchored" data-anchor-id="a-comparison-of-standardization-scores-in-three-groups">A Comparison of Standardization Scores in Three Groups</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing three groups</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a>df_2015 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(inter_fre_sd) <span class="sc">%&gt;%</span></span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">st_r_d=</span><span class="fu">mean</span>(st_run_diff))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 2
  inter_fre_sd   st_r_d
  &lt;chr&gt;           &lt;dbl&gt;
1 high         -0.104  
2 low           0.0713 
3 normal        0.00695</code></pre>
</div>
</div>
<p>Looking at the results of standardizing and analyzing the variables, it can be seen that the actual score of the group with a lot of manager intervention is lower than the expected score.</p>
</section>
<section id="regression-with-intervention-variable" class="level2">
<h2 class="anchored" data-anchor-id="regression-with-intervention-variable">Regression with intervention variable</h2>
<p>Finally, I looked at the regression model that included the standardized intervention of manager.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting with intervention</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>st_exp_sco_int<span class="ot">&lt;-</span><span class="fu">lm</span>(st_run<span class="sc">~</span>st_obp<span class="sc">+</span>st_slg<span class="sc">+</span>st_inter, df_2015)</span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(st_exp_sco_int)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = st_run ~ st_obp + st_slg + st_inter, data = df_2015)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.75685 -0.16865 -0.03597  0.20718  0.65370 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.289e-16  3.894e-02   0.000    1.000    
st_obp       5.789e-01  6.264e-02   9.242 7.35e-13 ***
st_slg       4.356e-01  6.271e-02   6.947 4.24e-09 ***
st_inter    -5.226e-02  4.158e-02  -1.257    0.214    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.3016 on 56 degrees of freedom
Multiple R-squared:  0.9056,    Adjusted R-squared:  0.9006 
F-statistic: 179.2 on 3 and 56 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The slugging percentage and the on-base percentage show a positive correlation with the score, but the coach’s intervention shows a negative correlation with the score.</p>
</section>
</section>
<section id="finish" class="level1">
<h1>Finish</h1>
<p>When the analysis range and explanatory variables are appropriately selected, it can be seen that the manager’s intervention and the team’s score show a negative correlation. In other words, it is difficult to predict that the manager’s involvement in the batting, represented by bunt and steal attempts, will produce such a positive result in the KBO baseball game.</p>


<!-- -->

</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<script src="https://giscus.app/client.js" data-repo="DACSS/603_Spring_2023" data-repo-id="R_kgDOI4oXIA" data-category="Announcements" data-category-id="" data-mapping="title" data-reactions-enabled="1" data-emit-metadata="0" data-input-position="top" data-theme="light" data-lang="en" crossorigin="anonymous" async="">
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb103" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Final Project Check In"</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Young Soo Choi"</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a><span class="an">description:</span><span class="co"> "Final Project Check In 2"</span></span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a><span class="an">date:</span><span class="co"> "04/20/2023"</span></span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co">    toc: true</span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a><span class="co">    code-fold: true</span></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a><span class="co">    code-copy: true</span></span>
<span id="cb103-11"><a href="#cb103-11" aria-hidden="true" tabindex="-1"></a><span class="co">    code-tools: true</span></span>
<span id="cb103-12"><a href="#cb103-12" aria-hidden="true" tabindex="-1"></a><span class="an">categories:</span></span>
<span id="cb103-13"><a href="#cb103-13" aria-hidden="true" tabindex="-1"></a><span class="co">  - finalpart2</span></span>
<span id="cb103-14"><a href="#cb103-14" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb103-15"><a href="#cb103-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-16"><a href="#cb103-16" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research Problems</span></span>
<span id="cb103-17"><a href="#cb103-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-18"><a href="#cb103-18" aria-hidden="true" tabindex="-1"></a>As discussed in check-in 1, my research topics are as follows.</span>
<span id="cb103-19"><a href="#cb103-19" aria-hidden="true" tabindex="-1"></a>"Does the baseball manager's intervention in games improve the team's scoring ability?"</span>
<span id="cb103-20"><a href="#cb103-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-21"><a href="#cb103-21" aria-hidden="true" tabindex="-1"></a>The main concepts of the research topic are first "scoring". This is a simple concept that does not require a separate operational definition. You just have to find and compare scoring column in the data frame. The next concept is "intervention in the game." This can be defined in various ways. Since the purpose of this study is not to discuss these topics, in order to simplify the research problem, I will define intervention in the game as the concepts of "bunt" and "stolen attempt." In a baseball game between a pitcher and a batter, a bunt that sacrifices batter himself to advance a runner and a steal to send another base is a difficult choice for a batter or runner without the manager's instructions, or at least acquiescence. There is also a great deal of discussion about this topic, but in this study, I will briefly summarize it and move on.</span>
<span id="cb103-22"><a href="#cb103-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-23"><a href="#cb103-23" aria-hidden="true" tabindex="-1"></a>To measure the concept of intervention defined from this perspective, this study defines intervention as the sum of bunt (sacrifice, sh) and steal attempt (sb+cs). In other words, in this study, "intervention in the game" is operatively defined as sh+sb+cs.</span>
<span id="cb103-24"><a href="#cb103-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-25"><a href="#cb103-25" aria-hidden="true" tabindex="-1"></a><span class="fu"># Research Design</span></span>
<span id="cb103-26"><a href="#cb103-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-27"><a href="#cb103-27" aria-hidden="true" tabindex="-1"></a>This research problem can be approached in various ways. First of all, I can think of a way to simply compare the average score of a team that has a lot of operational intervention and a team that does not. Next, the correlation between the frequency of intervention in the game and the score can be reviewed.</span>
<span id="cb103-28"><a href="#cb103-28" aria-hidden="true" tabindex="-1"></a>In other words, through the t-test, it is possible to examine whether there is a difference between average scores between the two groups and how the correlation between game intervention and scores appears through correlation analysis.</span>
<span id="cb103-29"><a href="#cb103-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-30"><a href="#cb103-30" aria-hidden="true" tabindex="-1"></a>However, this is a simple approach that does not take into account the characteristics of baseball. The environment of baseball is different every year. Numerous variables such as the number of participating teams, the level of players, climate, and stadiums change the pattern of scoring every year. From this point of view, it may be more reasonable to select and analyze specific years with similar league environments rather than using all data for analysis.</span>
<span id="cb103-31"><a href="#cb103-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-32"><a href="#cb103-32" aria-hidden="true" tabindex="-1"></a>The next thing to consider is that each team has a different batting ability involved in baseball's scoring. For example, a team with strong basic offense naturally scores more points than a team with weak basic offense. Therefore, these points need to be considered as well.</span>
<span id="cb103-33"><a href="#cb103-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-34"><a href="#cb103-34" aria-hidden="true" tabindex="-1"></a>From this point of view, I will limit the scope of the analysis to a specific year after considering various variables. I will also consider analytical methods that take into account the team's basic offense. Fortunately, there are several ways to get expected scores, and I will use these methods to find the difference between the actual score of a team with a lot of managerial intervention and the expected score and compare it to a team that does not.</span>
<span id="cb103-35"><a href="#cb103-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-36"><a href="#cb103-36" aria-hidden="true" tabindex="-1"></a><span class="fu"># Data Load</span></span>
<span id="cb103-37"><a href="#cb103-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-40"><a href="#cb103-40" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-41"><a href="#cb103-41" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb103-42"><a href="#cb103-42" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-43"><a href="#cb103-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-46"><a href="#cb103-46" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-47"><a href="#cb103-47" aria-hidden="true" tabindex="-1"></a><span class="co"># loading data</span></span>
<span id="cb103-48"><a href="#cb103-48" aria-hidden="true" tabindex="-1"></a>kbo_df<span class="ot">&lt;-</span><span class="fu">read_csv</span>(<span class="st">"~/R/603_Spring_2023/posts/_data/kbo_df.csv"</span>)</span>
<span id="cb103-49"><a href="#cb103-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-50"><a href="#cb103-50" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(kbo_df)</span>
<span id="cb103-51"><a href="#cb103-51" aria-hidden="true" tabindex="-1"></a>kbo_df<span class="ot">&lt;-</span>kbo_df[,<span class="dv">2</span><span class="sc">:</span><span class="dv">28</span>]</span>
<span id="cb103-52"><a href="#cb103-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-53"><a href="#cb103-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-54"><a href="#cb103-54" aria-hidden="true" tabindex="-1"></a><span class="fu"># Simple Analysis</span></span>
<span id="cb103-55"><a href="#cb103-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-56"><a href="#cb103-56" aria-hidden="true" tabindex="-1"></a><span class="fu">## A Comparison of Average Scores in Two Groups</span></span>
<span id="cb103-57"><a href="#cb103-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-58"><a href="#cb103-58" aria-hidden="true" tabindex="-1"></a>First of all, let's compare the difference in the scores of teams with many manager's interventions and those who don't. To this end, teams with more than average manager intervention and teams that do not are classified by year. According to the previous operational definition, the sum of steal attempts (stolen base(sb) + caught stolen(cs)) and bunt(sacrifice hit, sh) is considered as the frequency of manager intervention, so the average number of manager interventions of each team by year is calculated, and the higher team is classified into the high group and lower team is classified into the lower group.</span>
<span id="cb103-59"><a href="#cb103-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-62"><a href="#cb103-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-63"><a href="#cb103-63" aria-hidden="true" tabindex="-1"></a><span class="co"># making average variables by years</span></span>
<span id="cb103-64"><a href="#cb103-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-65"><a href="#cb103-65" aria-hidden="true" tabindex="-1"></a><span class="co"># for sh</span></span>
<span id="cb103-66"><a href="#cb103-66" aria-hidden="true" tabindex="-1"></a><span class="do">## create an empty data frame to store the results</span></span>
<span id="cb103-67"><a href="#cb103-67" aria-hidden="true" tabindex="-1"></a>sh_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">avr_sh =</span> <span class="fu">numeric</span>())</span>
<span id="cb103-68"><a href="#cb103-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-69"><a href="#cb103-69" aria-hidden="true" tabindex="-1"></a><span class="do">## loop over the years</span></span>
<span id="cb103-70"><a href="#cb103-70" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-71"><a href="#cb103-71" aria-hidden="true" tabindex="-1"></a>  <span class="do">## filter the data for the current year and calculate the sum of sh variable</span></span>
<span id="cb103-72"><a href="#cb103-72" aria-hidden="true" tabindex="-1"></a>  year_sh <span class="ot">&lt;-</span> kbo_df <span class="sc">%&gt;%</span> </span>
<span id="cb103-73"><a href="#cb103-73" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-74"><a href="#cb103-74" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_av_sh =</span> <span class="fu">sum</span>(sh)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb103-75"><a href="#cb103-75" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_av_sh)</span>
<span id="cb103-76"><a href="#cb103-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-77"><a href="#cb103-77" aria-hidden="true" tabindex="-1"></a>  <span class="do">## add the result to the data frame</span></span>
<span id="cb103-78"><a href="#cb103-78" aria-hidden="true" tabindex="-1"></a>  sh_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sh_df, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">avr_sh =</span> year_sh))</span>
<span id="cb103-79"><a href="#cb103-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-80"><a href="#cb103-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-81"><a href="#cb103-81" aria-hidden="true" tabindex="-1"></a><span class="co"># for sb</span></span>
<span id="cb103-82"><a href="#cb103-82" aria-hidden="true" tabindex="-1"></a>sb_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">avr_sb =</span> <span class="fu">numeric</span>())</span>
<span id="cb103-83"><a href="#cb103-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-84"><a href="#cb103-84" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-85"><a href="#cb103-85" aria-hidden="true" tabindex="-1"></a>  year_sb <span class="ot">&lt;-</span> kbo_df <span class="sc">%&gt;%</span> </span>
<span id="cb103-86"><a href="#cb103-86" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-87"><a href="#cb103-87" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_av_sb =</span> <span class="fu">sum</span>(sb)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb103-88"><a href="#cb103-88" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_av_sb)</span>
<span id="cb103-89"><a href="#cb103-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-90"><a href="#cb103-90" aria-hidden="true" tabindex="-1"></a>  sb_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(sb_df, <span class="fu">data.frame</span>(<span class="at">year=</span>i, <span class="at">avr_sb=</span>year_sb))</span>
<span id="cb103-91"><a href="#cb103-91" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-92"><a href="#cb103-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-93"><a href="#cb103-93" aria-hidden="true" tabindex="-1"></a><span class="co"># for cs</span></span>
<span id="cb103-94"><a href="#cb103-94" aria-hidden="true" tabindex="-1"></a>cs_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">avr_cs =</span> <span class="fu">numeric</span>())</span>
<span id="cb103-95"><a href="#cb103-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-96"><a href="#cb103-96" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-97"><a href="#cb103-97" aria-hidden="true" tabindex="-1"></a>  year_cs <span class="ot">&lt;-</span> kbo_df <span class="sc">%&gt;%</span> </span>
<span id="cb103-98"><a href="#cb103-98" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-99"><a href="#cb103-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_av_cs =</span> <span class="fu">sum</span>(cs)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb103-100"><a href="#cb103-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_av_cs)</span>
<span id="cb103-101"><a href="#cb103-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-102"><a href="#cb103-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-103"><a href="#cb103-103" aria-hidden="true" tabindex="-1"></a>  cs_df <span class="ot">&lt;-</span> <span class="fu">rbind</span>(cs_df, <span class="fu">data.frame</span>(<span class="at">year=</span>i, <span class="at">avr_cs=</span>year_cs))</span>
<span id="cb103-104"><a href="#cb103-104" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-105"><a href="#cb103-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-106"><a href="#cb103-106" aria-hidden="true" tabindex="-1"></a><span class="co"># print the results data frame</span></span>
<span id="cb103-107"><a href="#cb103-107" aria-hidden="true" tabindex="-1"></a>sh_df</span>
<span id="cb103-108"><a href="#cb103-108" aria-hidden="true" tabindex="-1"></a>sb_df</span>
<span id="cb103-109"><a href="#cb103-109" aria-hidden="true" tabindex="-1"></a>cs_df</span>
<span id="cb103-110"><a href="#cb103-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-111"><a href="#cb103-111" aria-hidden="true" tabindex="-1"></a><span class="co"># merge those data</span></span>
<span id="cb103-112"><a href="#cb103-112" aria-hidden="true" tabindex="-1"></a>int_df<span class="ot">&lt;-</span><span class="fu">merge</span>(<span class="fu">merge</span>(sh_df, sb_df, <span class="at">by =</span> <span class="st">"year"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>), cs_df, <span class="at">by=</span><span class="st">"year"</span>, <span class="at">all=</span><span class="cn">TRUE</span>)</span>
<span id="cb103-113"><a href="#cb103-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-114"><a href="#cb103-114" aria-hidden="true" tabindex="-1"></a><span class="co"># left join to original data</span></span>
<span id="cb103-115"><a href="#cb103-115" aria-hidden="true" tabindex="-1"></a>tot_df<span class="ot">&lt;-</span><span class="fu">left_join</span>(kbo_df, int_df)</span>
<span id="cb103-116"><a href="#cb103-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-117"><a href="#cb103-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-118"><a href="#cb103-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-121"><a href="#cb103-121" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-122"><a href="#cb103-122" aria-hidden="true" tabindex="-1"></a><span class="co"># making intervention variables</span></span>
<span id="cb103-123"><a href="#cb103-123" aria-hidden="true" tabindex="-1"></a>tot_df<span class="ot">&lt;-</span>tot_df <span class="sc">%&gt;%</span></span>
<span id="cb103-124"><a href="#cb103-124" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_att=</span>sb<span class="sc">+</span>cs, <span class="at">inter =</span> sh<span class="sc">+</span>st_att, <span class="at">avr_inter=</span>avr_sh<span class="sc">+</span>avr_sb<span class="sc">+</span>avr_cs)</span>
<span id="cb103-125"><a href="#cb103-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-126"><a href="#cb103-126" aria-hidden="true" tabindex="-1"></a>tot_df[, <span class="fu">c</span>(<span class="st">'year'</span>,<span class="st">'team'</span>,<span class="st">'sh'</span>,<span class="st">'st_att'</span>,<span class="st">'inter'</span>,<span class="st">'avr_inter'</span>)]</span>
<span id="cb103-127"><a href="#cb103-127" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-128"><a href="#cb103-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-131"><a href="#cb103-131" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-132"><a href="#cb103-132" aria-hidden="true" tabindex="-1"></a><span class="co"># making intervention type variables</span></span>
<span id="cb103-133"><a href="#cb103-133" aria-hidden="true" tabindex="-1"></a>tot_df<span class="ot">&lt;-</span>tot_df <span class="sc">%&gt;%</span></span>
<span id="cb103-134"><a href="#cb103-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inter_fre=</span><span class="fu">ifelse</span>(inter<span class="sc">&gt;</span>avr_inter, <span class="st">"high"</span>, <span class="st">"no"</span>))</span>
<span id="cb103-135"><a href="#cb103-135" aria-hidden="true" tabindex="-1"></a>tot_df[,<span class="fu">c</span>(<span class="st">'year'</span>, <span class="st">'team'</span>, <span class="st">'inter_fre'</span>)]</span>
<span id="cb103-136"><a href="#cb103-136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-137"><a href="#cb103-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-138"><a href="#cb103-138" aria-hidden="true" tabindex="-1"></a>The necessary processing has been completed. Let's look at the frequency of groups with high and low interventions by year.</span>
<span id="cb103-139"><a href="#cb103-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-142"><a href="#cb103-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-143"><a href="#cb103-143" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tot_df<span class="sc">$</span>inter_fre, tot_df<span class="sc">$</span>year)</span>
<span id="cb103-144"><a href="#cb103-144" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tot_df<span class="sc">$</span>inter_fre)</span>
<span id="cb103-145"><a href="#cb103-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-146"><a href="#cb103-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-147"><a href="#cb103-147" aria-hidden="true" tabindex="-1"></a>The number of high and low groups is almost the same because they are divided into teams that are higher than average and those that are not.</span>
<span id="cb103-148"><a href="#cb103-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-149"><a href="#cb103-149" aria-hidden="true" tabindex="-1"></a>Now, let's compare the average scores between the two groups. (Since the study was a population, the average was simply compared instead of the t-test.)</span>
<span id="cb103-150"><a href="#cb103-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-153"><a href="#cb103-153" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-154"><a href="#cb103-154" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing average score</span></span>
<span id="cb103-155"><a href="#cb103-155" aria-hidden="true" tabindex="-1"></a>tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb103-156"><a href="#cb103-156" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(inter_fre) <span class="sc">%&gt;%</span></span>
<span id="cb103-157"><a href="#cb103-157" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_score=</span><span class="fu">mean</span>(run_scored))</span>
<span id="cb103-158"><a href="#cb103-158" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-159"><a href="#cb103-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-160"><a href="#cb103-160" aria-hidden="true" tabindex="-1"></a>There is little difference in the average score between the two groups. In other words, the analysis classified in this way did not produce meaningful results.</span>
<span id="cb103-161"><a href="#cb103-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-162"><a href="#cb103-162" aria-hidden="true" tabindex="-1"></a><span class="fu">## Raising the criteria for determining a high degree of intervention</span></span>
<span id="cb103-163"><a href="#cb103-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-164"><a href="#cb103-164" aria-hidden="true" tabindex="-1"></a>Since the previous simple classification did not have much meaning, I further strengthened the criteria for classifying the frequency of intervention. This time, the group that intervened more than 1 standard deviation from the average was divided into a high group, the group that intervened less than 1 standard deviation from the average was divided into a low group, and the rest into a normal group.</span>
<span id="cb103-165"><a href="#cb103-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-168"><a href="#cb103-168" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-169"><a href="#cb103-169" aria-hidden="true" tabindex="-1"></a><span class="co"># making sd of intervention by each year</span></span>
<span id="cb103-170"><a href="#cb103-170" aria-hidden="true" tabindex="-1"></a>sd_int<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">sd_i=</span> <span class="fu">numeric</span>())</span>
<span id="cb103-171"><a href="#cb103-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-172"><a href="#cb103-172" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-173"><a href="#cb103-173" aria-hidden="true" tabindex="-1"></a>  year_sd <span class="ot">&lt;-</span> tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb103-174"><a href="#cb103-174" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-175"><a href="#cb103-175" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_sd_int =</span> <span class="fu">sd</span>(inter)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-176"><a href="#cb103-176" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_sd_int)</span>
<span id="cb103-177"><a href="#cb103-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-178"><a href="#cb103-178" aria-hidden="true" tabindex="-1"></a>  sd_int<span class="ot">&lt;-</span> <span class="fu">rbind</span>(sd_int, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">sd_i=</span> year_sd))</span>
<span id="cb103-179"><a href="#cb103-179" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-180"><a href="#cb103-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-181"><a href="#cb103-181" aria-hidden="true" tabindex="-1"></a>tot_df<span class="ot">&lt;-</span><span class="fu">left_join</span>(tot_df, sd_int)</span>
<span id="cb103-182"><a href="#cb103-182" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-183"><a href="#cb103-183" aria-hidden="true" tabindex="-1"></a><span class="co"># making three type variables</span></span>
<span id="cb103-184"><a href="#cb103-184" aria-hidden="true" tabindex="-1"></a>tot_df<span class="ot">&lt;-</span>tot_df <span class="sc">%&gt;%</span></span>
<span id="cb103-185"><a href="#cb103-185" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">inter_fre_sd=</span><span class="fu">ifelse</span>(inter<span class="sc">&gt;</span>avr_inter<span class="sc">+</span>sd_i, <span class="st">"high"</span>, </span>
<span id="cb103-186"><a href="#cb103-186" aria-hidden="true" tabindex="-1"></a>                               <span class="fu">ifelse</span>(inter<span class="sc">&lt;</span>avr_inter<span class="sc">-</span>sd_i, <span class="st">"low"</span>, <span class="st">"normal"</span>)))</span>
<span id="cb103-187"><a href="#cb103-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-188"><a href="#cb103-188" aria-hidden="true" tabindex="-1"></a>tot_df[, <span class="fu">c</span>(<span class="st">'year'</span>,<span class="st">'team'</span>,<span class="st">'run_scored'</span>, <span class="st">'inter_fre_sd'</span>)]</span>
<span id="cb103-189"><a href="#cb103-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-190"><a href="#cb103-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-193"><a href="#cb103-193" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-194"><a href="#cb103-194" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tot_df<span class="sc">$</span>inter_fre_sd, tot_df<span class="sc">$</span>year)</span>
<span id="cb103-195"><a href="#cb103-195" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(tot_df<span class="sc">$</span>inter_fre_sd)</span>
<span id="cb103-196"><a href="#cb103-196" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-197"><a href="#cb103-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-198"><a href="#cb103-198" aria-hidden="true" tabindex="-1"></a>As a result, a total of 313 team data from 1982 to 2020 were divided into 48 high groups, 53 low groups, and 212 normal groups.</span>
<span id="cb103-199"><a href="#cb103-199" aria-hidden="true" tabindex="-1"></a>Now, I compared the average score between these three groups.</span>
<span id="cb103-200"><a href="#cb103-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-203"><a href="#cb103-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-204"><a href="#cb103-204" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing average scores</span></span>
<span id="cb103-205"><a href="#cb103-205" aria-hidden="true" tabindex="-1"></a>tot_df <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(inter_fre_sd) <span class="sc">%&gt;%</span></span>
<span id="cb103-206"><a href="#cb103-206" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">mean_sco=</span><span class="fu">mean</span>(run_scored))</span>
<span id="cb103-207"><a href="#cb103-207" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-208"><a href="#cb103-208" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-209"><a href="#cb103-209" aria-hidden="true" tabindex="-1"></a>The team that intervenes a lot shows a high average score. However, even the low intervention team showed higher scoring ability than the average team. It seems that something further analysis is needed.</span>
<span id="cb103-210"><a href="#cb103-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-211"><a href="#cb103-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation Analysis between Intervention Frequency and Score</span></span>
<span id="cb103-212"><a href="#cb103-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-213"><a href="#cb103-213" aria-hidden="true" tabindex="-1"></a>Next, beyond a simple average comparison between groups, the correlation between the frequency of game intervention and scores was examined.</span>
<span id="cb103-214"><a href="#cb103-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-217"><a href="#cb103-217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-218"><a href="#cb103-218" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation analysis</span></span>
<span id="cb103-219"><a href="#cb103-219" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(tot_df<span class="sc">$</span>run_scored, tot_df<span class="sc">$</span>inter)</span>
<span id="cb103-220"><a href="#cb103-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-221"><a href="#cb103-221" aria-hidden="true" tabindex="-1"></a><span class="co"># simple regression</span></span>
<span id="cb103-222"><a href="#cb103-222" aria-hidden="true" tabindex="-1"></a>lm_int<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>inter, tot_df)</span>
<span id="cb103-223"><a href="#cb103-223" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_int)</span>
<span id="cb103-224"><a href="#cb103-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-225"><a href="#cb103-225" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-226"><a href="#cb103-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-227"><a href="#cb103-227" aria-hidden="true" tabindex="-1"></a>In this way, there is a negative correlation between game intervention and scoring. Even from the regression equation between the two variables, it can be seen that the coefficient attached to the game intervention variable is negative.</span>
<span id="cb103-228"><a href="#cb103-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-229"><a href="#cb103-229" aria-hidden="true" tabindex="-1"></a>I separated the steal attempt and the bunt and examined it in more detail.</span>
<span id="cb103-230"><a href="#cb103-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-233"><a href="#cb103-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-234"><a href="#cb103-234" aria-hidden="true" tabindex="-1"></a><span class="co"># Stolen attempt and bunt separation</span></span>
<span id="cb103-235"><a href="#cb103-235" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(tot_df<span class="sc">$</span>run_scored, tot_df<span class="sc">$</span>sh)</span>
<span id="cb103-236"><a href="#cb103-236" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(tot_df<span class="sc">$</span>run_scored, tot_df<span class="sc">$</span>st_att)</span>
<span id="cb103-237"><a href="#cb103-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-238"><a href="#cb103-238" aria-hidden="true" tabindex="-1"></a>lm_int_each<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>sh<span class="sc">+</span>st_att, tot_df)</span>
<span id="cb103-239"><a href="#cb103-239" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_int_each)</span>
<span id="cb103-240"><a href="#cb103-240" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-241"><a href="#cb103-241" aria-hidden="true" tabindex="-1"></a>Both steal attempts and bunt variables show a negative correlation with scoring.</span>
<span id="cb103-242"><a href="#cb103-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-243"><a href="#cb103-243" aria-hidden="true" tabindex="-1"></a>Why are the average comparison and correlation analysis results different?</span>
<span id="cb103-244"><a href="#cb103-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-245"><a href="#cb103-245" aria-hidden="true" tabindex="-1"></a>As pointed out earlier, there are countless variables that affect baseball's score, and it is likely that the result is that the variable called "scoring environment," which is generally batter-friendly and pitcher-friendly, is not considered. In other words, the difference in average scores that occur by year is not reflected in this simple comparison. For example, if the average score per game in one year is 12 points, and if it is only 8 points in another year, an analysis that ignores these differences will not be valid.</span>
<span id="cb103-246"><a href="#cb103-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-247"><a href="#cb103-247" aria-hidden="true" tabindex="-1"></a>In consideration of these points, the analysis was conducted in consideration of the scoring environment of baseball.</span>
<span id="cb103-248"><a href="#cb103-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-249"><a href="#cb103-249" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis considering scoring environment</span></span>
<span id="cb103-250"><a href="#cb103-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-251"><a href="#cb103-251" aria-hidden="true" tabindex="-1"></a><span class="fu">## Review Analysis Scope</span></span>
<span id="cb103-252"><a href="#cb103-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-253"><a href="#cb103-253" aria-hidden="true" tabindex="-1"></a>Through the boxplot figure, the distribution of scores and game intervention by year was briefly examined.</span>
<span id="cb103-254"><a href="#cb103-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-257"><a href="#cb103-257" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-258"><a href="#cb103-258" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb103-259"><a href="#cb103-259" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(tot_df<span class="sc">$</span>run_scored<span class="sc">/</span>tot_df<span class="sc">$</span>game<span class="sc">~</span>tot_df<span class="sc">$</span>year, <span class="at">ylab=</span><span class="st">"Score/G"</span>, <span class="at">xlab =</span><span class="st">'Year'</span>)</span>
<span id="cb103-260"><a href="#cb103-260" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot</span>(tot_df<span class="sc">$</span>inter<span class="sc">/</span>tot_df<span class="sc">$</span>game<span class="sc">~</span>tot_df<span class="sc">$</span>year, <span class="at">ylab=</span><span class="st">"Intervention/G"</span>, <span class="at">xlab=</span><span class="st">"Year"</span>)</span>
<span id="cb103-261"><a href="#cb103-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-262"><a href="#cb103-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-263"><a href="#cb103-263" aria-hidden="true" tabindex="-1"></a>The left is a boxplot diagram showing the distribution of the average score per game and the right is the distribution of the average number of interventions per game.</span>
<span id="cb103-264"><a href="#cb103-264" aria-hidden="true" tabindex="-1"></a>As expected, the year-to-year variation is significant. Scores are generally up and down and intervention is down.</span>
<span id="cb103-265"><a href="#cb103-265" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-266"><a href="#cb103-266" aria-hidden="true" tabindex="-1"></a>We looked more closely at how the average score and batting average per game have changed year by year. Here, the batting average is calculated as hit/ab (at bat) as the ratio of hits at bat.</span>
<span id="cb103-267"><a href="#cb103-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-270"><a href="#cb103-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-271"><a href="#cb103-271" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate batting average of each year</span></span>
<span id="cb103-272"><a href="#cb103-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-273"><a href="#cb103-273" aria-hidden="true" tabindex="-1"></a><span class="co"># at bat</span></span>
<span id="cb103-274"><a href="#cb103-274" aria-hidden="true" tabindex="-1"></a>ab_year<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">at_bat=</span> <span class="fu">numeric</span>())</span>
<span id="cb103-275"><a href="#cb103-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-276"><a href="#cb103-276" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-277"><a href="#cb103-277" aria-hidden="true" tabindex="-1"></a>  year_ab <span class="ot">&lt;-</span> tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb103-278"><a href="#cb103-278" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-279"><a href="#cb103-279" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_ab_sum =</span> <span class="fu">sum</span>(ab)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-280"><a href="#cb103-280" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_ab_sum)</span>
<span id="cb103-281"><a href="#cb103-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-282"><a href="#cb103-282" aria-hidden="true" tabindex="-1"></a>  ab_year<span class="ot">&lt;-</span> <span class="fu">rbind</span>(ab_year, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">at_bat=</span> year_ab))</span>
<span id="cb103-283"><a href="#cb103-283" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-284"><a href="#cb103-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-285"><a href="#cb103-285" aria-hidden="true" tabindex="-1"></a><span class="co"># hits</span></span>
<span id="cb103-286"><a href="#cb103-286" aria-hidden="true" tabindex="-1"></a>hit_year<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">hits=</span> <span class="fu">numeric</span>())</span>
<span id="cb103-287"><a href="#cb103-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-288"><a href="#cb103-288" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-289"><a href="#cb103-289" aria-hidden="true" tabindex="-1"></a>  year_hit <span class="ot">&lt;-</span> tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb103-290"><a href="#cb103-290" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-291"><a href="#cb103-291" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_hit_sum =</span> <span class="fu">sum</span>(hit)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-292"><a href="#cb103-292" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_hit_sum)</span>
<span id="cb103-293"><a href="#cb103-293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-294"><a href="#cb103-294" aria-hidden="true" tabindex="-1"></a>  hit_year<span class="ot">&lt;-</span> <span class="fu">rbind</span>(hit_year, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">hits=</span> year_hit))</span>
<span id="cb103-295"><a href="#cb103-295" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-296"><a href="#cb103-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-297"><a href="#cb103-297" aria-hidden="true" tabindex="-1"></a>batting_average<span class="ot">&lt;-</span><span class="fu">merge</span>(ab_year, hit_year, <span class="at">by =</span> <span class="st">"year"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-298"><a href="#cb103-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-299"><a href="#cb103-299" aria-hidden="true" tabindex="-1"></a>batting_average<span class="ot">&lt;-</span>batting_average<span class="sc">%&gt;%</span></span>
<span id="cb103-300"><a href="#cb103-300" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">batting_average=</span>hits<span class="sc">/</span>at_bat)</span>
<span id="cb103-301"><a href="#cb103-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-302"><a href="#cb103-302" aria-hidden="true" tabindex="-1"></a><span class="co"># calculate average score of each year</span></span>
<span id="cb103-303"><a href="#cb103-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-304"><a href="#cb103-304" aria-hidden="true" tabindex="-1"></a><span class="do">## sum of score</span></span>
<span id="cb103-305"><a href="#cb103-305" aria-hidden="true" tabindex="-1"></a>score_year<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">score=</span> <span class="fu">numeric</span>())</span>
<span id="cb103-306"><a href="#cb103-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-307"><a href="#cb103-307" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-308"><a href="#cb103-308" aria-hidden="true" tabindex="-1"></a>  year_score <span class="ot">&lt;-</span> tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb103-309"><a href="#cb103-309" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-310"><a href="#cb103-310" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_score_sum =</span> <span class="fu">sum</span>(run_scored)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-311"><a href="#cb103-311" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_score_sum)</span>
<span id="cb103-312"><a href="#cb103-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-313"><a href="#cb103-313" aria-hidden="true" tabindex="-1"></a>  score_year<span class="ot">&lt;-</span> <span class="fu">rbind</span>(score_year, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">score=</span> year_score))</span>
<span id="cb103-314"><a href="#cb103-314" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-315"><a href="#cb103-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-316"><a href="#cb103-316" aria-hidden="true" tabindex="-1"></a><span class="do">## total games</span></span>
<span id="cb103-317"><a href="#cb103-317" aria-hidden="true" tabindex="-1"></a>games_year<span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">gp=</span> <span class="fu">numeric</span>())</span>
<span id="cb103-318"><a href="#cb103-318" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-319"><a href="#cb103-319" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1982</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-320"><a href="#cb103-320" aria-hidden="true" tabindex="-1"></a>  year_games <span class="ot">&lt;-</span> tot_df <span class="sc">%&gt;%</span> </span>
<span id="cb103-321"><a href="#cb103-321" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-322"><a href="#cb103-322" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_games_sum =</span> <span class="fu">sum</span>(game)<span class="sc">/</span><span class="dv">2</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb103-323"><a href="#cb103-323" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_games_sum)</span>
<span id="cb103-324"><a href="#cb103-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-325"><a href="#cb103-325" aria-hidden="true" tabindex="-1"></a>  games_year<span class="ot">&lt;-</span> <span class="fu">rbind</span>(games_year, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">gp=</span> year_games))</span>
<span id="cb103-326"><a href="#cb103-326" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-327"><a href="#cb103-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-328"><a href="#cb103-328" aria-hidden="true" tabindex="-1"></a>average_score<span class="ot">&lt;-</span><span class="fu">merge</span>(score_year, games_year, <span class="at">by =</span> <span class="st">"year"</span>, <span class="at">all =</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-329"><a href="#cb103-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-330"><a href="#cb103-330" aria-hidden="true" tabindex="-1"></a>average_score<span class="ot">&lt;-</span>average_score<span class="sc">%&gt;%</span></span>
<span id="cb103-331"><a href="#cb103-331" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">average_score=</span>score<span class="sc">/</span>gp)</span>
<span id="cb103-332"><a href="#cb103-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-333"><a href="#cb103-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-336"><a href="#cb103-336" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-337"><a href="#cb103-337" aria-hidden="true" tabindex="-1"></a>average_score[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"average_score"</span>)]</span>
<span id="cb103-338"><a href="#cb103-338" aria-hidden="true" tabindex="-1"></a>batting_average[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"batting_average"</span>)]</span>
<span id="cb103-339"><a href="#cb103-339" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-340"><a href="#cb103-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-343"><a href="#cb103-343" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-344"><a href="#cb103-344" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>))</span>
<span id="cb103-345"><a href="#cb103-345" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(average_score<span class="sc">$</span>year, average_score<span class="sc">$</span>average_score, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"Average Score/G"</span>)</span>
<span id="cb103-346"><a href="#cb103-346" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(batting_average<span class="sc">$</span>year, batting_average<span class="sc">$</span>batting_average, <span class="at">xlab=</span><span class="st">"Year"</span>, <span class="at">ylab=</span><span class="st">"Batting Average"</span>)</span>
<span id="cb103-347"><a href="#cb103-347" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-348"><a href="#cb103-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-349"><a href="#cb103-349" aria-hidden="true" tabindex="-1"></a>It can also be seen that the league's batting and scoring environment is changing significantly every year.</span>
<span id="cb103-350"><a href="#cb103-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-351"><a href="#cb103-351" aria-hidden="true" tabindex="-1"></a>In the end, it is judged that choosing an appropriate range is good for achieving more rigorous results. The question now is how to determine the scope.</span>
<span id="cb103-352"><a href="#cb103-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-353"><a href="#cb103-353" aria-hidden="true" tabindex="-1"></a>Considering that the trend of scoring and batting average has not changed significantly since 2015, and that 10 teams have participated in the KBO League since 2015, the target of the analysis was set from 2015 to 2020.</span>
<span id="cb103-354"><a href="#cb103-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-357"><a href="#cb103-357" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-358"><a href="#cb103-358" aria-hidden="true" tabindex="-1"></a><span class="co"># Filtering</span></span>
<span id="cb103-359"><a href="#cb103-359" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>tot_df<span class="sc">%&gt;%</span></span>
<span id="cb103-360"><a href="#cb103-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(year <span class="sc">&gt;=</span> <span class="dv">2015</span>)</span>
<span id="cb103-361"><a href="#cb103-361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-362"><a href="#cb103-362" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(df_2015)</span>
<span id="cb103-363"><a href="#cb103-363" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-364"><a href="#cb103-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-365"><a href="#cb103-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## Comparison of average scores by group since 2015</span></span>
<span id="cb103-366"><a href="#cb103-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-367"><a href="#cb103-367" aria-hidden="true" tabindex="-1"></a>The average score for each of the three groups classified in the same way as above was compared.</span>
<span id="cb103-368"><a href="#cb103-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-371"><a href="#cb103-371" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-372"><a href="#cb103-372" aria-hidden="true" tabindex="-1"></a>df_2015 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(inter_fre_sd) <span class="sc">%&gt;%</span></span>
<span id="cb103-373"><a href="#cb103-373" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">avr_sco=</span><span class="fu">mean</span>(run_scored))</span>
<span id="cb103-374"><a href="#cb103-374" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-375"><a href="#cb103-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-376"><a href="#cb103-376" aria-hidden="true" tabindex="-1"></a>Also, the average score of the group, which frequently intervenes in the game, was high.</span>
<span id="cb103-377"><a href="#cb103-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-378"><a href="#cb103-378" aria-hidden="true" tabindex="-1"></a><span class="fu">## Correlation Analysis since 2015</span></span>
<span id="cb103-379"><a href="#cb103-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-382"><a href="#cb103-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-383"><a href="#cb103-383" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation of intervention and score</span></span>
<span id="cb103-384"><a href="#cb103-384" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df_2015<span class="sc">$</span>run_scored, df_2015<span class="sc">$</span>inter)</span>
<span id="cb103-385"><a href="#cb103-385" aria-hidden="true" tabindex="-1"></a>lm_2015<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>inter, df_2015)</span>
<span id="cb103-386"><a href="#cb103-386" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_2015)</span>
<span id="cb103-387"><a href="#cb103-387" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-388"><a href="#cb103-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-391"><a href="#cb103-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-392"><a href="#cb103-392" aria-hidden="true" tabindex="-1"></a><span class="co"># plot</span></span>
<span id="cb103-393"><a href="#cb103-393" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df_2015<span class="sc">$</span>run_scored<span class="sc">~</span>df_2015<span class="sc">$</span>inter, <span class="at">xlab=</span><span class="st">"Intervention"</span>, <span class="at">ylab=</span><span class="st">"Run Scored"</span>)</span>
<span id="cb103-394"><a href="#cb103-394" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="fu">lm</span>(run_scored<span class="sc">~</span>inter, df_2015),<span class="at">col=</span><span class="st">'red'</span>)</span>
<span id="cb103-395"><a href="#cb103-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-396"><a href="#cb103-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-397"><a href="#cb103-397" aria-hidden="true" tabindex="-1"></a>Although it is also weak, there is a positive correlation in which the more interventions there are, the more points scored.</span>
<span id="cb103-398"><a href="#cb103-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-399"><a href="#cb103-399" aria-hidden="true" tabindex="-1"></a>Next, the intervention of the game was subdivided into steal attempts and bunt, and each correlation was examined.</span>
<span id="cb103-400"><a href="#cb103-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-403"><a href="#cb103-403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-404"><a href="#cb103-404" aria-hidden="true" tabindex="-1"></a><span class="co"># correlation of sh, steal attemps and score</span></span>
<span id="cb103-405"><a href="#cb103-405" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df_2015<span class="sc">$</span>run_scored, df_2015<span class="sc">$</span>sh)</span>
<span id="cb103-406"><a href="#cb103-406" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df_2015<span class="sc">$</span>run_scored, df_2015<span class="sc">$</span>st_att)</span>
<span id="cb103-407"><a href="#cb103-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-408"><a href="#cb103-408" aria-hidden="true" tabindex="-1"></a>lm_2015_sep<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>sh<span class="sc">+</span>st_att, df_2015)</span>
<span id="cb103-409"><a href="#cb103-409" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_2015_sep)</span>
<span id="cb103-410"><a href="#cb103-410" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-411"><a href="#cb103-411" aria-hidden="true" tabindex="-1"></a>Although the explanatory power is low, both steal attempts and bunt show a positive correlation with scoring.</span>
<span id="cb103-412"><a href="#cb103-412" aria-hidden="true" tabindex="-1"></a>These results show a different aspect from the recently accepted perception that "operation in baseball negatively affects the team's offensive power." Is Korean baseball different from American baseball?</span>
<span id="cb103-413"><a href="#cb103-413" aria-hidden="true" tabindex="-1"></a>I did some more analysis. First, I conducted a polynomial regression analysis.</span>
<span id="cb103-414"><a href="#cb103-414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-415"><a href="#cb103-415" aria-hidden="true" tabindex="-1"></a><span class="fu">## Polynomial regression </span></span>
<span id="cb103-416"><a href="#cb103-416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-419"><a href="#cb103-419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-420"><a href="#cb103-420" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting polynomial regression</span></span>
<span id="cb103-421"><a href="#cb103-421" aria-hidden="true" tabindex="-1"></a>lm_2015_qua<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>inter<span class="sc">+</span><span class="fu">I</span>(inter<span class="sc">^</span><span class="dv">2</span>), df_2015)</span>
<span id="cb103-422"><a href="#cb103-422" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(lm_2015_qua)</span>
<span id="cb103-423"><a href="#cb103-423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-424"><a href="#cb103-424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-427"><a href="#cb103-427" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-428"><a href="#cb103-428" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(df_2015<span class="sc">$</span>inter, df_2015<span class="sc">$</span>run_scored, <span class="at">xlab=</span><span class="st">"Intervention"</span>, <span class="at">ylab=</span><span class="st">"Run Scored"</span>)</span>
<span id="cb103-429"><a href="#cb103-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-430"><a href="#cb103-430" aria-hidden="true" tabindex="-1"></a>pred <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_2015_qua)</span>
<span id="cb103-431"><a href="#cb103-431" aria-hidden="true" tabindex="-1"></a>ix <span class="ot">&lt;-</span> <span class="fu">sort</span>(df_2015<span class="sc">$</span>inter, <span class="at">index.return=</span>T)<span class="sc">$</span>ix</span>
<span id="cb103-432"><a href="#cb103-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-433"><a href="#cb103-433" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(df_2015<span class="sc">$</span>inter[ix], pred[ix], <span class="at">col=</span><span class="st">'red'</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb103-434"><a href="#cb103-434" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-435"><a href="#cb103-435" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-436"><a href="#cb103-436" aria-hidden="true" tabindex="-1"></a>Although the model's explanatory power has increased slightly, the positive correlation between match intervention and scoring continues to appear. (Since it is a quadratic equation, the correlation between scoring and intervention is negative until a specific level of intervention.)</span>
<span id="cb103-437"><a href="#cb103-437" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-438"><a href="#cb103-438" aria-hidden="true" tabindex="-1"></a><span class="fu"># Analysis using expected score</span></span>
<span id="cb103-439"><a href="#cb103-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-440"><a href="#cb103-440" aria-hidden="true" tabindex="-1"></a>As a result of the analysis so far, the results were different from the results of recent studies.</span>
<span id="cb103-441"><a href="#cb103-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-442"><a href="#cb103-442" aria-hidden="true" tabindex="-1"></a>From now on, I will analyze the effect of the manager's intervention in the game using the concept of expected scores.</span>
<span id="cb103-443"><a href="#cb103-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-444"><a href="#cb103-444" aria-hidden="true" tabindex="-1"></a>First, I will introduce the concept of expected score.</span>
<span id="cb103-445"><a href="#cb103-445" aria-hidden="true" tabindex="-1"></a>The score of baseball is caused by various variables working together. In other words, if the runner gets on base due to hits and walks, and the follow-up batter hits again, the score will be scored. In other words, indicators such as hits and walks and scores have a high correlation, and outs do not.</span>
<span id="cb103-446"><a href="#cb103-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-447"><a href="#cb103-447" aria-hidden="true" tabindex="-1"></a>Using this concept, a regression model between batting indicators such as hits and walks of the team and scores can be obtained, and expected scores can be obtained by substituting each team's batting indicators into the regression model obtained in this way.</span>
<span id="cb103-448"><a href="#cb103-448" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-449"><a href="#cb103-449" aria-hidden="true" tabindex="-1"></a>Now, by looking at the difference between the expected score and the actual score obtained by each group divided by the manager's intervention, we can see whether the manager's intervention improves the actual score compared to the team's expected score.</span>
<span id="cb103-450"><a href="#cb103-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-451"><a href="#cb103-451" aria-hidden="true" tabindex="-1"></a>Then, first, the regression equation was obtained.</span>
<span id="cb103-452"><a href="#cb103-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-455"><a href="#cb103-455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-456"><a href="#cb103-456" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting regression</span></span>
<span id="cb103-457"><a href="#cb103-457" aria-hidden="true" tabindex="-1"></a>exp_lm<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>hit<span class="sc">+</span>double<span class="sc">+</span>triple<span class="sc">+</span>hr<span class="sc">+</span>bb<span class="sc">+</span>ibb<span class="sc">+</span>hbp<span class="sc">+</span>so<span class="sc">+</span>sf<span class="sc">+</span>gidp, df_2015)</span>
<span id="cb103-458"><a href="#cb103-458" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(exp_lm)</span>
<span id="cb103-459"><a href="#cb103-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-460"><a href="#cb103-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-461"><a href="#cb103-461" aria-hidden="true" tabindex="-1"></a>It is possible to roughly grasp the impact of batting indicators such as hits, doubles, triples, and home runs on scoring.</span>
<span id="cb103-462"><a href="#cb103-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-463"><a href="#cb103-463" aria-hidden="true" tabindex="-1"></a>It is a little surprising that the intentional base on balls (ibb) has a negative coefficient, but it is natural that the strikeout (so) and the double play (gidp) have a negative coefficient. Because these two variables mean out.</span>
<span id="cb103-464"><a href="#cb103-464" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-465"><a href="#cb103-465" aria-hidden="true" tabindex="-1"></a>Now, using this model, the expected score for each team was obtained and the difference from the actual score was calculated.</span>
<span id="cb103-466"><a href="#cb103-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-469"><a href="#cb103-469" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-470"><a href="#cb103-470" aria-hidden="true" tabindex="-1"></a><span class="co"># get expected score</span></span>
<span id="cb103-471"><a href="#cb103-471" aria-hidden="true" tabindex="-1"></a>df_2015<span class="sc">$</span>exp_score<span class="ot">&lt;-</span><span class="fu">predict</span>(exp_lm, <span class="at">newdata =</span> df_2015)</span>
<span id="cb103-472"><a href="#cb103-472" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-473"><a href="#cb103-473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">run_diff=</span>run_scored<span class="sc">-</span>exp_score)</span>
<span id="cb103-474"><a href="#cb103-474" aria-hidden="true" tabindex="-1"></a>df_2015[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"team"</span>,<span class="st">"run_scored"</span>,<span class="st">"exp_score"</span>, <span class="st">"run_diff"</span>, <span class="st">"inter_fre_sd"</span>)]</span>
<span id="cb103-475"><a href="#cb103-475" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-476"><a href="#cb103-476" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-477"><a href="#cb103-477" aria-hidden="true" tabindex="-1"></a>The average difference between actual and expected scores was examined for each group.</span>
<span id="cb103-478"><a href="#cb103-478" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-481"><a href="#cb103-481" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-482"><a href="#cb103-482" aria-hidden="true" tabindex="-1"></a>df_2015<span class="sc">%&gt;%</span><span class="fu">group_by</span>(inter_fre_sd) <span class="sc">%&gt;%</span></span>
<span id="cb103-483"><a href="#cb103-483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">run_diff_avr=</span><span class="fu">mean</span>(run_diff))</span>
<span id="cb103-484"><a href="#cb103-484" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-485"><a href="#cb103-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-486"><a href="#cb103-486" aria-hidden="true" tabindex="-1"></a>As with the previous results, the difference between the actual score and the expected score of the team with frequent intervention is higher.</span>
<span id="cb103-487"><a href="#cb103-487" aria-hidden="true" tabindex="-1"></a>In other words, a team with a lot of manager intervention is scoring more actual points than expected by the team's attack indicators.</span>
<span id="cb103-488"><a href="#cb103-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-489"><a href="#cb103-489" aria-hidden="true" tabindex="-1"></a><span class="fu">## Adjust Descriptive Variables</span></span>
<span id="cb103-490"><a href="#cb103-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-491"><a href="#cb103-491" aria-hidden="true" tabindex="-1"></a>Next, we adjusted the explanatory variables. The batting indicators included in the model above actually show a fairly high correlation with each other. In other words, a team that batting well is more likely to hit long balls such as doubles and home runs and get walks better.</span>
<span id="cb103-492"><a href="#cb103-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-495"><a href="#cb103-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-496"><a href="#cb103-496" aria-hidden="true" tabindex="-1"></a><span class="co"># check the multicollinearity</span></span>
<span id="cb103-497"><a href="#cb103-497" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(df_2015[,<span class="dv">12</span><span class="sc">:</span><span class="dv">19</span>])</span>
<span id="cb103-498"><a href="#cb103-498" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(df_2015[,<span class="dv">12</span><span class="sc">:</span><span class="dv">19</span>])</span>
<span id="cb103-499"><a href="#cb103-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-500"><a href="#cb103-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-501"><a href="#cb103-501" aria-hidden="true" tabindex="-1"></a>In fact, it can be seen that hits, doubles, triples, and home runs show a significant amount of correlation.</span>
<span id="cb103-502"><a href="#cb103-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-503"><a href="#cb103-503" aria-hidden="true" tabindex="-1"></a>Such high multicollinearity is likely to distort the results of regression analysis, so it is necessary to select the appropriate variable again as an explanatory variable.</span>
<span id="cb103-504"><a href="#cb103-504" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-505"><a href="#cb103-505" aria-hidden="true" tabindex="-1"></a><span class="fu">## On-base percentage and Slugging percentage</span></span>
<span id="cb103-506"><a href="#cb103-506" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-507"><a href="#cb103-507" aria-hidden="true" tabindex="-1"></a>In this regard, recent studies have shown the usefulness of the on-base percentage and the slugging percentage. You can simply think of it as how much on-base percentage you get on base alive without being out, and how many bases you get with one hit.</span>
<span id="cb103-508"><a href="#cb103-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-509"><a href="#cb103-509" aria-hidden="true" tabindex="-1"></a>Baseball can score as many bases as possible at a given opportunity while consuming a limited out count (less out), and the on-base percentage and long-base percentage are used as good indicators for evaluating hitting from this point of view</span>
<span id="cb103-510"><a href="#cb103-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-511"><a href="#cb103-511" aria-hidden="true" tabindex="-1"></a>A baseball team can score as many points as possible if it consumes a small out count (less out) and secures as many bases as possible at a given opportunity (long hit, send the ball away). From this point of view, the on-base percentage and slugging percentage are used as good indicators for evaluating battings. In this study, the on-base percentage and the slugging percentage were used as explanatory variables to take this perspective and obtain expected scores.</span>
<span id="cb103-512"><a href="#cb103-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-515"><a href="#cb103-515" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-516"><a href="#cb103-516" aria-hidden="true" tabindex="-1"></a><span class="co"># OBP = (Hits + Walks + Hit-by-Pitches) / (At-Bats + Walks + Hit-by-Pitches + Sacrifice Flies)</span></span>
<span id="cb103-517"><a href="#cb103-517" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-518"><a href="#cb103-518" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-519"><a href="#cb103-519" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">obp=</span>(hit<span class="sc">+</span>bb<span class="sc">+</span>ibb<span class="sc">+</span>hbp)<span class="sc">/</span>(ab<span class="sc">+</span>bb<span class="sc">+</span>ibb<span class="sc">+</span>hbp<span class="sc">+</span>sf))</span>
<span id="cb103-520"><a href="#cb103-520" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-521"><a href="#cb103-521" aria-hidden="true" tabindex="-1"></a><span class="co"># SLG = (1B + 2B x 2 + 3B x 3 + HR x 4) / AB</span></span>
<span id="cb103-522"><a href="#cb103-522" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015<span class="sc">%&gt;%</span></span>
<span id="cb103-523"><a href="#cb103-523" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tb=</span>hit<span class="sc">-</span>(double<span class="sc">+</span>triple<span class="sc">+</span>hr)<span class="sc">+</span><span class="dv">2</span><span class="sc">*</span>double<span class="sc">+</span><span class="dv">3</span><span class="sc">*</span>triple<span class="sc">+</span><span class="dv">4</span><span class="sc">*</span>hr)</span>
<span id="cb103-524"><a href="#cb103-524" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015<span class="sc">%&gt;%</span></span>
<span id="cb103-525"><a href="#cb103-525" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">slg=</span>tb<span class="sc">/</span>ab)</span>
<span id="cb103-526"><a href="#cb103-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-527"><a href="#cb103-527" aria-hidden="true" tabindex="-1"></a>df_2015[,<span class="fu">c</span>(<span class="st">"year"</span>, <span class="st">"team"</span>, <span class="st">"run_scored"</span>, <span class="st">"obp"</span>, <span class="st">"slg"</span>)]</span>
<span id="cb103-528"><a href="#cb103-528" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-529"><a href="#cb103-529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-530"><a href="#cb103-530" aria-hidden="true" tabindex="-1"></a>For reference, the trend of on-base percentage and slugging percentage across the league by year since 2015 was also confirmed.</span>
<span id="cb103-531"><a href="#cb103-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-534"><a href="#cb103-534" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-535"><a href="#cb103-535" aria-hidden="true" tabindex="-1"></a><span class="co"># take a look at obp and slg</span></span>
<span id="cb103-536"><a href="#cb103-536" aria-hidden="true" tabindex="-1"></a>ba_2015 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">tot_ab=</span> <span class="fu">numeric</span>(), </span>
<span id="cb103-537"><a href="#cb103-537" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tot_hit=</span><span class="fu">numeric</span>(), <span class="at">tot_bb=</span><span class="fu">numeric</span>(), <span class="at">tot_ibb=</span><span class="fu">numeric</span>(),</span>
<span id="cb103-538"><a href="#cb103-538" aria-hidden="true" tabindex="-1"></a>                      <span class="at">tot_hbp=</span><span class="fu">numeric</span>(), <span class="at">tot_sf=</span><span class="fu">numeric</span>(), <span class="at">tot_tb=</span><span class="fu">numeric</span>(),</span>
<span id="cb103-539"><a href="#cb103-539" aria-hidden="true" tabindex="-1"></a>                      <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb103-540"><a href="#cb103-540" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-541"><a href="#cb103-541" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-542"><a href="#cb103-542" aria-hidden="true" tabindex="-1"></a>  year_ab_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span> </span>
<span id="cb103-543"><a href="#cb103-543" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-544"><a href="#cb103-544" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_ab_2015 =</span> <span class="fu">sum</span>(ab)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-545"><a href="#cb103-545" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_ab_2015)</span>
<span id="cb103-546"><a href="#cb103-546" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-547"><a href="#cb103-547" aria-hidden="true" tabindex="-1"></a>  year_hit_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-548"><a href="#cb103-548" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb103-549"><a href="#cb103-549" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_hit_2015 =</span> <span class="fu">sum</span>(hit)) <span class="sc">%&gt;%</span></span>
<span id="cb103-550"><a href="#cb103-550" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_hit_2015)</span>
<span id="cb103-551"><a href="#cb103-551" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-552"><a href="#cb103-552" aria-hidden="true" tabindex="-1"></a>  year_bb_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-553"><a href="#cb103-553" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb103-554"><a href="#cb103-554" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_bb_2015 =</span> <span class="fu">sum</span>(bb)) <span class="sc">%&gt;%</span></span>
<span id="cb103-555"><a href="#cb103-555" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_bb_2015)</span>
<span id="cb103-556"><a href="#cb103-556" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-557"><a href="#cb103-557" aria-hidden="true" tabindex="-1"></a>  year_ibb_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-558"><a href="#cb103-558" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb103-559"><a href="#cb103-559" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_ibb_2015 =</span> <span class="fu">sum</span>(ibb)) <span class="sc">%&gt;%</span></span>
<span id="cb103-560"><a href="#cb103-560" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_ibb_2015)</span>
<span id="cb103-561"><a href="#cb103-561" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-562"><a href="#cb103-562" aria-hidden="true" tabindex="-1"></a>  year_hbp_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-563"><a href="#cb103-563" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb103-564"><a href="#cb103-564" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_hbp_2015 =</span> <span class="fu">sum</span>(hbp)) <span class="sc">%&gt;%</span></span>
<span id="cb103-565"><a href="#cb103-565" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_hbp_2015)</span>
<span id="cb103-566"><a href="#cb103-566" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-567"><a href="#cb103-567" aria-hidden="true" tabindex="-1"></a>  year_sf_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-568"><a href="#cb103-568" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb103-569"><a href="#cb103-569" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_sf_2015 =</span> <span class="fu">sum</span>(sf)) <span class="sc">%&gt;%</span></span>
<span id="cb103-570"><a href="#cb103-570" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_sf_2015)</span>
<span id="cb103-571"><a href="#cb103-571" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-572"><a href="#cb103-572" aria-hidden="true" tabindex="-1"></a>  year_tb_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-573"><a href="#cb103-573" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb103-574"><a href="#cb103-574" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_tb_2015 =</span> <span class="fu">sum</span>(tb)) <span class="sc">%&gt;%</span></span>
<span id="cb103-575"><a href="#cb103-575" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_tb_2015)</span>
<span id="cb103-576"><a href="#cb103-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-577"><a href="#cb103-577" aria-hidden="true" tabindex="-1"></a>  ba_2015<span class="ot">&lt;-</span> <span class="fu">rbind</span>(ba_2015, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">tot_ab=</span>year_ab_2015,</span>
<span id="cb103-578"><a href="#cb103-578" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">tot_hit=</span>year_hit_2015, <span class="at">tot_bb=</span>year_bb_2015,</span>
<span id="cb103-579"><a href="#cb103-579" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">tot_ibb=</span>year_ibb_2015, <span class="at">tot_hbp=</span>year_hbp_2015,</span>
<span id="cb103-580"><a href="#cb103-580" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">tot_sf=</span>year_sf_2015, <span class="at">tot_tb=</span>year_tb_2015))</span>
<span id="cb103-581"><a href="#cb103-581" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-582"><a href="#cb103-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-583"><a href="#cb103-583" aria-hidden="true" tabindex="-1"></a>ba_2015 <span class="ot">&lt;-</span> ba_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-584"><a href="#cb103-584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tot_obp=</span>(tot_hit<span class="sc">+</span>tot_bb<span class="sc">+</span>tot_ibb<span class="sc">+</span>tot_hbp)<span class="sc">/</span>(tot_ab<span class="sc">+</span>tot_bb<span class="sc">+</span>tot_ibb<span class="sc">+</span>tot_hbp<span class="sc">+</span>tot_sf))</span>
<span id="cb103-585"><a href="#cb103-585" aria-hidden="true" tabindex="-1"></a>ba_2015<span class="ot">&lt;-</span>ba_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-586"><a href="#cb103-586" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tot_slg=</span>tot_tb<span class="sc">/</span>tot_ab)</span>
<span id="cb103-587"><a href="#cb103-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-588"><a href="#cb103-588" aria-hidden="true" tabindex="-1"></a>ba_2015_os<span class="ot">&lt;-</span><span class="fu">select</span>(ba_2015, <span class="dv">1</span>, <span class="dv">9</span>, <span class="dv">10</span>)</span>
<span id="cb103-589"><a href="#cb103-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-590"><a href="#cb103-590" aria-hidden="true" tabindex="-1"></a>ba_2015_os</span>
<span id="cb103-591"><a href="#cb103-591" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-592"><a href="#cb103-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-595"><a href="#cb103-595" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-596"><a href="#cb103-596" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(ba_2015_os, <span class="fu">aes</span>(<span class="at">x =</span> year)) <span class="sc">+</span></span>
<span id="cb103-597"><a href="#cb103-597" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_obp, <span class="at">color =</span> <span class="st">"OBP"</span>)) <span class="sc">+</span></span>
<span id="cb103-598"><a href="#cb103-598" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> tot_slg, <span class="at">color =</span> <span class="st">"SLG"</span>)) <span class="sc">+</span></span>
<span id="cb103-599"><a href="#cb103-599" aria-hidden="true" tabindex="-1"></a>  <span class="fu">scale_color_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">"OBP"</span> <span class="ot">=</span> <span class="st">"blue"</span>, <span class="st">"SLG"</span> <span class="ot">=</span> <span class="st">"red"</span>)) <span class="sc">+</span></span>
<span id="cb103-600"><a href="#cb103-600" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">y =</span> <span class="st">""</span>,</span>
<span id="cb103-601"><a href="#cb103-601" aria-hidden="true" tabindex="-1"></a>       <span class="at">color =</span> <span class="st">""</span>)</span>
<span id="cb103-602"><a href="#cb103-602" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-603"><a href="#cb103-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-604"><a href="#cb103-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-607"><a href="#cb103-607" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-608"><a href="#cb103-608" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting regression model using obp and slg</span></span>
<span id="cb103-609"><a href="#cb103-609" aria-hidden="true" tabindex="-1"></a>exp_os_lm<span class="ot">&lt;-</span><span class="fu">lm</span>(run_scored<span class="sc">~</span>obp<span class="sc">+</span>slg, df_2015)</span>
<span id="cb103-610"><a href="#cb103-610" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(exp_os_lm)</span>
<span id="cb103-611"><a href="#cb103-611" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-612"><a href="#cb103-612" aria-hidden="true" tabindex="-1"></a>As a result of regression analysis, it can be seen that both the on-base percentage and the slugging percentage show a high correlation with scoring. Although only two variables were used in the explanatory power, it shows a high explanatory power that is almost close to the model using many variables.(r-squared: 0.9268)</span>
<span id="cb103-613"><a href="#cb103-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-614"><a href="#cb103-614" aria-hidden="true" tabindex="-1"></a>Now, in the same way as the previous analysis, the expected score using the on-base percentage and the slugging percentage was obtained and compared with the actual score.</span>
<span id="cb103-615"><a href="#cb103-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-618"><a href="#cb103-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-619"><a href="#cb103-619" aria-hidden="true" tabindex="-1"></a><span class="co"># get expected score by obp, slg</span></span>
<span id="cb103-620"><a href="#cb103-620" aria-hidden="true" tabindex="-1"></a>df_2015<span class="sc">$</span>exp_score_os<span class="ot">&lt;-</span><span class="fu">predict</span>(exp_os_lm, <span class="at">newdata =</span> df_2015)</span>
<span id="cb103-621"><a href="#cb103-621" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-622"><a href="#cb103-622" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">run_diff_os=</span>run_scored<span class="sc">-</span>exp_score_os)</span>
<span id="cb103-623"><a href="#cb103-623" aria-hidden="true" tabindex="-1"></a>df_2015[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"team"</span>,<span class="st">"run_scored"</span>,<span class="st">"exp_score_os"</span>,<span class="st">"run_diff_os"</span>,<span class="st">"inter_fre_sd"</span>)]</span>
<span id="cb103-624"><a href="#cb103-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-625"><a href="#cb103-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-626"><a href="#cb103-626" aria-hidden="true" tabindex="-1"></a>Using this, the average of the difference between the actual score and the expected score by the manager's intervention frequency group was examined.</span>
<span id="cb103-627"><a href="#cb103-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-630"><a href="#cb103-630" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-631"><a href="#cb103-631" aria-hidden="true" tabindex="-1"></a>df_2015<span class="sc">%&gt;%</span><span class="fu">group_by</span>(inter_fre_sd) <span class="sc">%&gt;%</span></span>
<span id="cb103-632"><a href="#cb103-632" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">run_diff_os_avr=</span><span class="fu">mean</span>(run_diff_os))</span>
<span id="cb103-633"><a href="#cb103-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-634"><a href="#cb103-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-635"><a href="#cb103-635" aria-hidden="true" tabindex="-1"></a>At last a new result came out.</span>
<span id="cb103-636"><a href="#cb103-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-637"><a href="#cb103-637" aria-hidden="true" tabindex="-1"></a>Compared to the expected score estimated by the on-base percentage and slugging percentage, the actual score of the group with a high degree of intervention in the game was lower than the expected score. The coach's intervention is rather lowering the team's scoring ability!!</span>
<span id="cb103-638"><a href="#cb103-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-639"><a href="#cb103-639" aria-hidden="true" tabindex="-1"></a><span class="fu"># Standardization Analysis</span></span>
<span id="cb103-640"><a href="#cb103-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-641"><a href="#cb103-641" aria-hidden="true" tabindex="-1"></a>Although the analysis period is limited, the annual score distribution is not completely constant. Finally, I examined the effect of manager's intervention with standardized figures considering the scoring environment by year.</span>
<span id="cb103-642"><a href="#cb103-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-643"><a href="#cb103-643" aria-hidden="true" tabindex="-1"></a>Likewise, only the results after 2015 were considered, and only the on-base percentage and the slugging percentage were used as explanatory variables.</span>
<span id="cb103-644"><a href="#cb103-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-645"><a href="#cb103-645" aria-hidden="true" tabindex="-1"></a>Since the average intervention and standard deviation by year have already been obtained, the average and standard deviation of the average score and standard deviation of the average score and the on-base rate by year were obtained,</span>
<span id="cb103-646"><a href="#cb103-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-649"><a href="#cb103-649" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-650"><a href="#cb103-650" aria-hidden="true" tabindex="-1"></a><span class="co"># making average and sd of run scored by each year</span></span>
<span id="cb103-651"><a href="#cb103-651" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-652"><a href="#cb103-652" aria-hidden="true" tabindex="-1"></a>as_sco_2015 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">avr_run=</span> <span class="fu">numeric</span>(), <span class="at">sd_run=</span> <span class="fu">numeric</span>(),</span>
<span id="cb103-653"><a href="#cb103-653" aria-hidden="true" tabindex="-1"></a>                          <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb103-654"><a href="#cb103-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-655"><a href="#cb103-655" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-656"><a href="#cb103-656" aria-hidden="true" tabindex="-1"></a>  year_avr_sco_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span> </span>
<span id="cb103-657"><a href="#cb103-657" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-658"><a href="#cb103-658" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_avr_r_2015 =</span> <span class="fu">sum</span>(run_scored)<span class="sc">/</span><span class="fu">n</span>()) <span class="sc">%&gt;%</span> </span>
<span id="cb103-659"><a href="#cb103-659" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_avr_r_2015)</span>
<span id="cb103-660"><a href="#cb103-660" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-661"><a href="#cb103-661" aria-hidden="true" tabindex="-1"></a>  year_sd_sco_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span> </span>
<span id="cb103-662"><a href="#cb103-662" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-663"><a href="#cb103-663" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_sd_r_2015 =</span> <span class="fu">sd</span>(run_scored)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-664"><a href="#cb103-664" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_sd_r_2015)</span>
<span id="cb103-665"><a href="#cb103-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-666"><a href="#cb103-666" aria-hidden="true" tabindex="-1"></a>  as_sco_2015<span class="ot">&lt;-</span> <span class="fu">rbind</span>(as_sco_2015, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">avr_run=</span>year_avr_sco_2015,</span>
<span id="cb103-667"><a href="#cb103-667" aria-hidden="true" tabindex="-1"></a>                                                <span class="at">sd_run=</span>year_sd_sco_2015))</span>
<span id="cb103-668"><a href="#cb103-668" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-669"><a href="#cb103-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-670"><a href="#cb103-670" aria-hidden="true" tabindex="-1"></a><span class="co"># making average and sd of obp and slg by each year</span></span>
<span id="cb103-671"><a href="#cb103-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-672"><a href="#cb103-672" aria-hidden="true" tabindex="-1"></a>os_2015<span class="ot">&lt;-</span><span class="fu">data.frame</span>(<span class="at">year =</span> <span class="fu">integer</span>(), <span class="at">avr_obp=</span> <span class="fu">numeric</span>(), <span class="at">avr_slg=</span><span class="fu">numeric</span>(), </span>
<span id="cb103-673"><a href="#cb103-673" aria-hidden="true" tabindex="-1"></a>                    <span class="at">sd_obp=</span><span class="fu">numeric</span>(), <span class="at">sd_slg=</span><span class="fu">numeric</span>(), <span class="at">stringsAsFactors =</span> <span class="cn">FALSE</span>)</span>
<span id="cb103-674"><a href="#cb103-674" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-675"><a href="#cb103-675" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2015</span><span class="sc">:</span><span class="dv">2020</span>) {</span>
<span id="cb103-676"><a href="#cb103-676" aria-hidden="true" tabindex="-1"></a>  year_obp_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span> </span>
<span id="cb103-677"><a href="#cb103-677" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span> </span>
<span id="cb103-678"><a href="#cb103-678" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_obp_2015 =</span> <span class="fu">mean</span>(obp)) <span class="sc">%&gt;%</span> </span>
<span id="cb103-679"><a href="#cb103-679" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_obp_2015)</span>
<span id="cb103-680"><a href="#cb103-680" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-681"><a href="#cb103-681" aria-hidden="true" tabindex="-1"></a>  year_slg_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-682"><a href="#cb103-682" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb103-683"><a href="#cb103-683" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_slg_2015 =</span> <span class="fu">mean</span>(slg)) <span class="sc">%&gt;%</span></span>
<span id="cb103-684"><a href="#cb103-684" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_slg_2015)</span>
<span id="cb103-685"><a href="#cb103-685" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-686"><a href="#cb103-686" aria-hidden="true" tabindex="-1"></a>  year_obp_sd_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-687"><a href="#cb103-687" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb103-688"><a href="#cb103-688" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_obp_sd_2015 =</span> <span class="fu">sd</span>(obp)) <span class="sc">%&gt;%</span></span>
<span id="cb103-689"><a href="#cb103-689" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_obp_sd_2015)</span>
<span id="cb103-690"><a href="#cb103-690" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb103-691"><a href="#cb103-691" aria-hidden="true" tabindex="-1"></a>  year_slg_sd_2015 <span class="ot">&lt;-</span> df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-692"><a href="#cb103-692" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(year <span class="sc">==</span> i) <span class="sc">%&gt;%</span></span>
<span id="cb103-693"><a href="#cb103-693" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">year_slg_sd_2015 =</span> <span class="fu">sd</span>(slg)) <span class="sc">%&gt;%</span></span>
<span id="cb103-694"><a href="#cb103-694" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pull</span>(year_slg_sd_2015)</span>
<span id="cb103-695"><a href="#cb103-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-696"><a href="#cb103-696" aria-hidden="true" tabindex="-1"></a>  os_2015<span class="ot">&lt;-</span> <span class="fu">rbind</span>(os_2015, <span class="fu">data.frame</span>(<span class="at">year =</span> i, <span class="at">avr_obp=</span>year_obp_2015,</span>
<span id="cb103-697"><a href="#cb103-697" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">avr_slg=</span>year_slg_2015, <span class="at">sd_obp=</span>year_obp_sd_2015,</span>
<span id="cb103-698"><a href="#cb103-698" aria-hidden="true" tabindex="-1"></a>                                      <span class="at">sd_slg=</span>year_slg_sd_2015))</span>
<span id="cb103-699"><a href="#cb103-699" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb103-700"><a href="#cb103-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-701"><a href="#cb103-701" aria-hidden="true" tabindex="-1"></a><span class="co"># left join to original data</span></span>
<span id="cb103-702"><a href="#cb103-702" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span><span class="fu">left_join</span>(<span class="fu">left_join</span>(<span class="fu">left_join</span>(df_2015, as_sco_2015), ba_2015_os), os_2015)</span>
<span id="cb103-703"><a href="#cb103-703" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-704"><a href="#cb103-704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-707"><a href="#cb103-707" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-708"><a href="#cb103-708" aria-hidden="true" tabindex="-1"></a><span class="co"># standardization</span></span>
<span id="cb103-709"><a href="#cb103-709" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-710"><a href="#cb103-710" aria-hidden="true" tabindex="-1"></a><span class="do">## runs</span></span>
<span id="cb103-711"><a href="#cb103-711" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015<span class="sc">%&gt;%</span></span>
<span id="cb103-712"><a href="#cb103-712" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_run=</span>(run_scored<span class="sc">-</span>avr_run)<span class="sc">/</span>sd_run) </span>
<span id="cb103-713"><a href="#cb103-713" aria-hidden="true" tabindex="-1"></a><span class="do">## obp</span></span>
<span id="cb103-714"><a href="#cb103-714" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015<span class="sc">%&gt;%</span></span>
<span id="cb103-715"><a href="#cb103-715" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_obp=</span>(obp<span class="sc">-</span>avr_obp)<span class="sc">/</span>sd_obp)</span>
<span id="cb103-716"><a href="#cb103-716" aria-hidden="true" tabindex="-1"></a><span class="do">## slg</span></span>
<span id="cb103-717"><a href="#cb103-717" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-718"><a href="#cb103-718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_slg=</span>(slg<span class="sc">-</span>avr_slg)<span class="sc">/</span>sd_slg)</span>
<span id="cb103-719"><a href="#cb103-719" aria-hidden="true" tabindex="-1"></a><span class="do">##intervention</span></span>
<span id="cb103-720"><a href="#cb103-720" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-721"><a href="#cb103-721" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_inter=</span>(inter<span class="sc">-</span>avr_inter)<span class="sc">/</span>sd_i)</span>
<span id="cb103-722"><a href="#cb103-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-723"><a href="#cb103-723" aria-hidden="true" tabindex="-1"></a>df_2015[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"team"</span>,<span class="st">"st_run"</span>,<span class="st">"st_obp"</span>,<span class="st">"st_slg"</span>,<span class="st">"st_inter"</span>)]</span>
<span id="cb103-724"><a href="#cb103-724" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-725"><a href="#cb103-725" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-728"><a href="#cb103-728" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-729"><a href="#cb103-729" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting with standardization data</span></span>
<span id="cb103-730"><a href="#cb103-730" aria-hidden="true" tabindex="-1"></a>st_exp_sco<span class="ot">&lt;-</span><span class="fu">lm</span>(st_run<span class="sc">~</span>st_obp<span class="sc">+</span>st_slg, df_2015)</span>
<span id="cb103-731"><a href="#cb103-731" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(st_exp_sco)</span>
<span id="cb103-732"><a href="#cb103-732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-733"><a href="#cb103-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-736"><a href="#cb103-736" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-737"><a href="#cb103-737" aria-hidden="true" tabindex="-1"></a><span class="co"># get expected score using standardization data</span></span>
<span id="cb103-738"><a href="#cb103-738" aria-hidden="true" tabindex="-1"></a>df_2015<span class="sc">$</span>exp_st_sco<span class="ot">&lt;-</span><span class="fu">predict</span>(st_exp_sco, <span class="at">newdata =</span> df_2015)</span>
<span id="cb103-739"><a href="#cb103-739" aria-hidden="true" tabindex="-1"></a>df_2015<span class="ot">&lt;-</span>df_2015 <span class="sc">%&gt;%</span></span>
<span id="cb103-740"><a href="#cb103-740" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">st_run_diff=</span>st_run<span class="sc">-</span>exp_st_sco)</span>
<span id="cb103-741"><a href="#cb103-741" aria-hidden="true" tabindex="-1"></a>df_2015[,<span class="fu">c</span>(<span class="st">"year"</span>,<span class="st">"team"</span>,<span class="st">"exp_st_sco"</span>, <span class="st">"st_run_diff"</span>, <span class="st">"inter_fre_sd"</span>)]</span>
<span id="cb103-742"><a href="#cb103-742" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-743"><a href="#cb103-743" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-744"><a href="#cb103-744" aria-hidden="true" tabindex="-1"></a><span class="fu">## A Comparison of Standardization Scores in Three Groups</span></span>
<span id="cb103-745"><a href="#cb103-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-748"><a href="#cb103-748" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-749"><a href="#cb103-749" aria-hidden="true" tabindex="-1"></a><span class="co"># comparing three groups</span></span>
<span id="cb103-750"><a href="#cb103-750" aria-hidden="true" tabindex="-1"></a>df_2015 <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(inter_fre_sd) <span class="sc">%&gt;%</span></span>
<span id="cb103-751"><a href="#cb103-751" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">st_r_d=</span><span class="fu">mean</span>(st_run_diff))</span>
<span id="cb103-752"><a href="#cb103-752" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-753"><a href="#cb103-753" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-754"><a href="#cb103-754" aria-hidden="true" tabindex="-1"></a>Looking at the results of standardizing and analyzing the variables, it can be seen that the actual score of the group with a lot of manager intervention is lower than the expected score.</span>
<span id="cb103-755"><a href="#cb103-755" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-756"><a href="#cb103-756" aria-hidden="true" tabindex="-1"></a><span class="fu">## Regression with intervention variable</span></span>
<span id="cb103-757"><a href="#cb103-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-758"><a href="#cb103-758" aria-hidden="true" tabindex="-1"></a>Finally, I looked at the regression model that included the standardized intervention of manager.</span>
<span id="cb103-759"><a href="#cb103-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-762"><a href="#cb103-762" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb103-763"><a href="#cb103-763" aria-hidden="true" tabindex="-1"></a><span class="co"># fitting with intervention</span></span>
<span id="cb103-764"><a href="#cb103-764" aria-hidden="true" tabindex="-1"></a>st_exp_sco_int<span class="ot">&lt;-</span><span class="fu">lm</span>(st_run<span class="sc">~</span>st_obp<span class="sc">+</span>st_slg<span class="sc">+</span>st_inter, df_2015)</span>
<span id="cb103-765"><a href="#cb103-765" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(st_exp_sco_int)</span>
<span id="cb103-766"><a href="#cb103-766" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb103-767"><a href="#cb103-767" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-768"><a href="#cb103-768" aria-hidden="true" tabindex="-1"></a>The slugging percentage and the on-base percentage show a positive correlation with the score, but the coach's intervention shows a negative correlation with the score.</span>
<span id="cb103-769"><a href="#cb103-769" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-770"><a href="#cb103-770" aria-hidden="true" tabindex="-1"></a><span class="fu"># Finish</span></span>
<span id="cb103-771"><a href="#cb103-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-772"><a href="#cb103-772" aria-hidden="true" tabindex="-1"></a>When the analysis range and explanatory variables are appropriately selected, it can be seen that the manager's intervention and the team's score show a negative correlation. In other words, it is difficult to predict that the manager's involvement in the batting, represented by bunt and steal attempts, will produce such a positive result in the KBO baseball game.</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>